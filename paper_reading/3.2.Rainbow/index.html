<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>论文精读 Rainbow | 37.2° Blog</title><meta name="author" content="Firefly"><meta name="copyright" content="Firefly"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="RainbowRainbow: Combining Improvements in Deep Reinforcement LearningRainbow: 结合深度强化学习的改进论文地址：https:&#x2F;&#x2F;arxiv.org&#x2F;abs&#x2F;1710.02298 摘要深度强化学习社区对DQN算法进行了几项独立改进。然而，尚不清楚这些扩展中的哪一个是互补的，并且可以有效地结合。本文研究了DQN算法的六个扩展，">
<meta property="og:type" content="article">
<meta property="og:title" content="论文精读 Rainbow">
<meta property="og:url" content="https://wdndev.github.io/paper_reading/3.2.Rainbow/index.html">
<meta property="og:site_name" content="37.2° Blog">
<meta property="og:description" content="RainbowRainbow: Combining Improvements in Deep Reinforcement LearningRainbow: 结合深度强化学习的改进论文地址：https:&#x2F;&#x2F;arxiv.org&#x2F;abs&#x2F;1710.02298 摘要深度强化学习社区对DQN算法进行了几项独立改进。然而，尚不清楚这些扩展中的哪一个是互补的，并且可以有效地结合。本文研究了DQN算法的六个扩展，">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://wdndev.github.io/img/wdn_icon.png">
<meta property="article:published_time" content="2022-11-24T16:00:00.000Z">
<meta property="article:modified_time" content="2025-11-01T23:46:10.760Z">
<meta property="article:author" content="Firefly">
<meta property="article:tag" content="RL">
<meta property="article:tag" content="PaperReading">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wdndev.github.io/img/wdn_icon.png"><link rel="shortcut icon" href="/img/wdn_icon.png"><link rel="canonical" href="https://wdndev.github.io/paper_reading/3.2.Rainbow/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search/.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":100,"languages":{"author":"Author: Firefly","link":"Link: ","source":"Source: 37.2° Blog","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '论文精读 Rainbow',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-11-02 07:46:10'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/wdn_icon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">565</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">15</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> Content</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/paper_reading/pr_content"><i class="fa-fw fas fa-newspaper"></i><span> Paper</span></a></li><li><a class="site-page child" href="/llms/llms_idx"><i class="fa-fw fa-regular fa-bookmark"></i><span> LLMs</span></a></li><li><a class="site-page child" href="/jupyter"><i class="fa-fw fa-solid fa-file"></i><span> Jupyter</span></a></li><li><a class="site-page child" href="/dsa/dsa_idx"><i class="fa-fw fas fa-tree"></i><span> Algorithm</span></a></li><li><a class="site-page child" href="/program_language/pl_idx"><i class="fa-fw fas fa-code"></i><span> PLs</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-calendar-days"></i><span> Daily</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/daily/github/index"><i class="fa-fw fas fa-arrow-trend-up"></i><span> Github</span></a></li><li><a class="site-page child" href="/daily/weibo/index"><i class="fa-fw fas fa-brands fa-weibo"></i><span> Weibo</span></a></li><li><a class="site-page child" href="/daily/hf/index"><i class="fa-fw fas fa-face-smile"></i><span> HF</span></a></li><li><a class="site-page child" href="/daily/domain/index"><i class="fa-fw fas fa-book-open"></i><span> Arxiv</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img fixed" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="37.2° Blog"><span class="site-name">37.2° Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> Content</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/paper_reading/pr_content"><i class="fa-fw fas fa-newspaper"></i><span> Paper</span></a></li><li><a class="site-page child" href="/llms/llms_idx"><i class="fa-fw fa-regular fa-bookmark"></i><span> LLMs</span></a></li><li><a class="site-page child" href="/jupyter"><i class="fa-fw fa-solid fa-file"></i><span> Jupyter</span></a></li><li><a class="site-page child" href="/dsa/dsa_idx"><i class="fa-fw fas fa-tree"></i><span> Algorithm</span></a></li><li><a class="site-page child" href="/program_language/pl_idx"><i class="fa-fw fas fa-code"></i><span> PLs</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-calendar-days"></i><span> Daily</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/daily/github/index"><i class="fa-fw fas fa-arrow-trend-up"></i><span> Github</span></a></li><li><a class="site-page child" href="/daily/weibo/index"><i class="fa-fw fas fa-brands fa-weibo"></i><span> Weibo</span></a></li><li><a class="site-page child" href="/daily/hf/index"><i class="fa-fw fas fa-face-smile"></i><span> HF</span></a></li><li><a class="site-page child" href="/daily/domain/index"><i class="fa-fw fas fa-book-open"></i><span> Arxiv</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">论文精读 Rainbow</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-11-24T16:00:00.000Z" title="Created 2022-11-25 00:00:00">2022-11-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-11-01T23:46:10.760Z" title="Updated 2025-11-02 07:46:10">2025-11-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/PaperReading/">PaperReading</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>26min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="论文精读 Rainbow"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h1 id="Rainbow"><a href="#Rainbow" class="headerlink" title="Rainbow"></a>Rainbow</h1><h1 id="Rainbow-Combining-Improvements-in-Deep-Reinforcement-Learning"><a href="#Rainbow-Combining-Improvements-in-Deep-Reinforcement-Learning" class="headerlink" title="Rainbow: Combining Improvements in Deep Reinforcement Learning"></a>Rainbow: Combining Improvements in Deep Reinforcement Learning</h1><h1 id="Rainbow-结合深度强化学习的改进"><a href="#Rainbow-结合深度强化学习的改进" class="headerlink" title="Rainbow: 结合深度强化学习的改进"></a>Rainbow: 结合深度强化学习的改进</h1><p>论文地址：<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1710.02298" title="https://arxiv.org/abs/1710.02298">https://arxiv.org/abs/1710.02298</a></p>
<h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>深度强化学习社区对DQN算法进行了几项独立改进。然而，尚不清楚这些扩展中的哪一个是互补的，并且可以有效地结合。本文研究了DQN算法的六个扩展，并实证研究了它们的组合。我们的实验表明，在数据效率和最终性能方面，该组合在雅达利2600基准上提供了最先进的性能。我们还提供了详细的消融研究结果，该研究显示了每个部件对整体性能的贡献。</p>
<h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>The deep reinforcement learning community has made several independent improvements to the DQN algorithm. However, it is unclear which of these extensions are complementary and can be fruitfully combined. This paper examines six extensions to the DQN algorithm and empirically studies their combination. Our experiments show that the combination provides state-of-the-art performance on the Atari 2600 benchmark, both in terms of data efficiency and final performance. We also provide results from a detailed ablation study that shows the contribution of each component to overall per-formance.</p>
<h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1.简介"></a>1.简介</h2><p>最近在将强化学习（RL）扩展到复杂顺序决策问题方面取得的许多成功都是由深度Q网络算法（DQN；Mnih等人，20132015）开创的。DQN将Q学习与卷积神经网络和经验回放相结合，能够从原始像素中学习如何玩许多雅达利游戏。从那时起，人们提出了许多技巧，以提高其速度或稳定性。Double DQN（DDQN；van Hasselt、Guez和Silver 2016）通过解耦选择和评估引导动作，解决了Q学习的高估偏差问题（van Haselt 2010）。优先经验回放（Schaul，2015）通过更频繁地重放需要学习的内容，提高了数据效率。Dueling Network（Wang，2016）通过将最有动作价值分解为最优状态价值和最优优势， 有助于跨动作进行学习。从A3C中使用的多步TD（Sutton 1988；Sutton和Barto 1998）中学习（Mnih，2016），改变了偏差-方差权衡，有助于更快地将新获得到的奖励传播到较早访过的结点。分布Q学习（Bellemare、Dabney和Munos 2017）学习现有收益的分类分布，而不是估计平均值。Noisy DQN（Fortunato等人，2017）使用随机网络层进行探索。当然，这份清单还远远不够详尽。</p>
<p>这些算法中的每一个都能够单独实现显著的性能改进。由于它们是通过解决根本不同的问题来实现的，而且它们建立在同一个网络上，因此它们可以合理地结合在一起。在某些情况下，已经做到了这一点：Prioritized DDQN和 Dueling DDQN都使用 Double DQN，Dueling DDQN还与优先经验回放相结合。在本文中，我们建议研究一种结合上述所有技巧的方法。我们展示了如何整合这些不同的方法，并且它们实际上在很大程度上是互补的。事实上，他们的结合在Arcade Learning Environment（Bellemare et al.2013）的57款Atari 2600游戏的基准测试平台上，在效率和性能方面都取得了很好的结果。最后，我们展示了研究的结果，以帮助理解不同方法对性能和效率的贡献。</p>
<p><img src="image/image_eYnp9irvB4.png" alt=""></p>
<p>图1：57款雅达利游戏中人类正常化表现的中位数。我们将我们的集成智能体（Rainbow彩虹色）与DQN（灰色）和六个已发布的baseline进行了比较。请注意，我们在7M帧后达到了DQN的最佳性能，超过了44M帧内的任何基线，并达到了显著提高的最终性能。在5个点上使用移动平均值平滑曲线。</p>
<h2 id="2-背景"><a href="#2-背景" class="headerlink" title="2.背景"></a>2.背景</h2><p>强化学习解决了智能体在环境中行动以最大化标量奖励信号的问题。没有向智能体提供直接监督，例如，从未直接告知智能体最佳行动。</p>
<h3 id="2-1智能体和环境"><a href="#2-1智能体和环境" class="headerlink" title="2.1智能体和环境"></a>2.1智能体和环境</h3><p>在每个离散时间步$t=0,1,2…$，环境向智能体提供当前状态$S<em>t$，智能体通过选择动作$A_t$进行行动，然后环境提供下一个奖励$R</em>{t+1}$、折扣系数$\gamma<em>{t+1}$和状态$S</em>{t+1}$。这种交互被形式化为马尔可夫决策过程（MDP），即元组$<S、 A、T、r、γ>$, 其中S是有限状态集，a是有限动作集，$T(s,a,a’)=P[S<em>{t+1}=s’|S_t=s, A_t=a]$ 是（随机）转移函数，$r(s,a)=E[R</em>{t+1}|S_t=s,A_t=a]$是奖励函数，$γ\in [0, 1]$是折扣系数。在我们的实验中，MDP是具有常数$γ_t=γ$的，除了在$γ_t=0$时，但算法以一般形式表示。</p>
<p>在智能体端，动作选择由策略$π$给出，策略$π$定义每个状态的动作概率分布。在t时刻，状态为$S<em>t$，我们定义折扣回报函数$G_t=\sum</em>{k=0}^{\infty} \gamma<em>t^{(k)} R</em>{t+k+1}$，为智能体计算未来奖励的折扣总和，其中，未来$k$步奖励的折扣由该时间之前的折扣乘积给出$\gamma<em>t^{(k)}=\Pi</em>{i=1}^k \gamma_{t+i}$。智能体的目标是通过找到一个好的政策来最大化预期的折扣回报。</p>
<p>策略可以直接学习，也可以根据其他学习来构建。在基于价值的强化学习中，当从给定状态开始执行策略 $\pi$ 时，智能体可以获得预期折扣收益或价值的估计，$v<em>π(s)=E</em>π[G<em>t|S_t=s]$，或状态动作价值函数$q</em>π(s，a)=E_\pi[G_t |S_t=s,A_t=a]$。从状态动作价值函数中导出新策略的常用方法是 $ \epsilon-greed<br>ly  $方法。意味着以概率 $1-\epsilon$ 的概率取价值最高的动作，否则以 $\epsilon$ 的概率随机选取动作。这类策略用于引入一种探索形式：通过根据其当前估计随机选择次优行为，智能体可以在适当时发现并纠正其估计。主要的限制是，很难找到延伸到未来的替代行动方案；这激发了对更直接探索形式的研究。</p>
<h3 id="2-2深度强化学习和DQN"><a href="#2-2深度强化学习和DQN" class="headerlink" title="2.2深度强化学习和DQN"></a>2.2深度强化学习和DQN</h3><p>对于过大的状态和动作空间，很难独立学习每个状态和动作对的Q值估计。在深度强化学习中，我们使用深度（即多层）神经网络表示智能体的各种组件，如策略$π(s,a)$或值$q(s,b)$。这些网络的参数通过梯度下降来训练，最小化损失函数。</p>
<p>在DQN（Mnih，2015）中，通过使用卷积神经网络来近似拟合给定状态$S_t$的动作值（以原始像素帧的形式作为输入送到神经网络），成功地将深度神经网络和强化学习相结合。在每个步骤中，智能体都会根据当前状态选择一个 $\epsilon - greedily$ 动作值，并将转换$(St, At, Rt+1, γt+1,St+1)$添加到经验回放缓冲区（Lin 1992），该缓冲区保存最后一百万个经验。采用随机梯度下降法对神经网络参数进行优化，最小化损失函数</p>
<script type="math/tex; mode=display">
(R_{t+1} + \gamma_{t+1} \underset{a'}{max} q_\theta^-(S_{t+1}, a') - q_\theta(S_t, A_t))^2 ~~~~~~~~~~~~~~~~~~~~~~ (1)</script><p>其中t是从经验回放池中随机选取的时间步长。损失的梯度仅反向传播到策略网络的参数$θ$中（也用于选择动作）；$\overline θ$表示目标网络的参数；没有直接优化，而是从策略网络的定期复制参数。使用RMSprop（Tieleman和Hinton 2012），一种随机梯度下降的变体，对从经验回放池中的数据均匀采样，进行小批次梯度优化。这意味着，在上述损失中，时间索引t将是来自最后一百万次经验的随机时间索引，而不是当前时间。使用经验回放和目标网络可以相对稳定地学习Q值，并在几款雅达利游戏中获得超人的表现。</p>
<h2 id="3-DQN扩展"><a href="#3-DQN扩展" class="headerlink" title="3.DQN扩展"></a>3.DQN扩展</h2><p>DQN是一个重要的里程碑，但目前已知该算法的若干局限性，并提出了许多扩展。我们选择了六个扩展，每个扩展都解决了一个问题并提高了整体性能。为了保持选择的大小可管理，我们选择了一组解决不同问题的扩展（例如，只是众多解决探索中的一个）。</p>
<h3 id="3-1-Double-Q-learning"><a href="#3-1-Double-Q-learning" class="headerlink" title="3.1 Double Q-learning"></a>3.1 Double Q-learning</h3><p>由于等式1中的最大化步骤，传统的Q学习受到高估偏差的影响，这可能会影响学习。Double Q-learning（van Hasselt 2010）通过解耦来解决这种高估，在原始DQN网络中最大化选择动作，在目标网络中评估动作的好坏。使用损失函数如下，可以将其与DQN（van Hasselt、Guez和Silver 2016）有效结合</p>
<script type="math/tex; mode=display">
(R_{t+1}+\gamma_{t+1}q_\theta^-(S_{t+1}, \underset{a'}{argmax~} q_\theta(S_{t+1},a')) - q_\theta(S_t, A_t))^2</script><p>这一变化被证明可以减少对DQN的有害高估，从而提高性能。</p>
<h3 id="3-2-优先经验回放"><a href="#3-2-优先经验回放" class="headerlink" title="3.2 优先经验回放"></a>3.2 优先经验回放</h3><p>DQN从经验回放池中均匀采样。理想情况下，我们希望更频繁地对那些需要学习错误的样本进行采样。作为学习的智能体，优先经验回放（Schaul et al.2015）以相对于上次遇到的绝对TD误差的概率$p_t$采样：</p>
<script type="math/tex; mode=display">
p_t \propto |R_{t+1} + \gamma_{t+1} \underset{a'}{max~} q_\theta^-(S_{t+1}, a') - q_\theta(S_t, A_t)|^w</script><p>其中ω是决定分布形状的超参数。新的样本以最大优先级（权重）插入到重放缓冲区中，从而提供对最近样本的偏差。请注意，随机采样也可能是受欢迎的，即使在对它们的了解所剩无几的情况下。</p>
<h3 id="3-3-Dueling网络"><a href="#3-3-Dueling网络" class="headerlink" title="3.3 Dueling网络"></a>3.3 Dueling网络</h3><p>对决网络是为基于价值的强化学习神经网络架构。它具有两个计算输出，即状态价值输出和最优势输出，共享部分卷积层，并由一个特殊的聚合器合并（Wang，2016）。这对应于以下动作值的分解：</p>
<script type="math/tex; mode=display">
q_\theta(s,a)=v_\eta f_\xi(s) + a_\psi(f_\xi(s)-a)-\frac{\sum_{a'} a_\psi(f_\xi(s), a')}{N_{actions}}</script><p>其中$ξ$、$η$和$ψ$分别是共享卷积层$f<em>ξ$、状态价值输出$v</em>η$和优势输出$a_ψ$的参数；$θ={ξ，η，ψ}$是它们的连接。</p>
<h3 id="3-4-多步TD"><a href="#3-4-多步TD" class="headerlink" title="3.4 多步TD"></a>3.4 多步TD</h3><p>Q学习累积一个奖励，然后在下一步使用贪婪策略来自举更新动作。或者，可以使用前视多步目标（Sutton 1988）。我们将给定状态$S_t$的选择n步奖励定义为：</p>
<script type="math/tex; mode=display">
R_t^{(n)} = \sum_{k=0}^{n-1} \gamma_t^{(k)} R_{t+k+1}     ~~~~~~~~~~~~~~~~~(2)</script><p>然后通过最小化损失来定义DQN的多步TD损失函数，</p>
<script type="math/tex; mode=display">
(R_t^{(n)}+\gamma_t^{(n)}~ \underset{a'}{q_\theta^-}(S_{t+n}, a') - q_\theta(S_t, A_t))^2</script><p>具有适当调整n的多步目标通常会导致更快的学习（Sutton和Barto 1998）。</p>
<h3 id="3-5-分布式RL"><a href="#3-5-分布式RL" class="headerlink" title="3.5 分布式RL"></a>3.5 分布式RL</h3><p>我们可以学习近似收益的分布而不是预期收益。最近，Bellemare、Dabney和Munos（2017）提出将概率分布放置在离散的$z$上，对这种分布进行建模，其中$z$是带有$N<em>{atoms} \in N^+$原子，定义为 $z^i=v</em>{min}+(i-1)\frac{v<em>{max}-v</em>{min}}{N<em>{atoms}-1}$，其中，$i \in {1,…, N</em>{atoms}}$. 时间t处的近似分布$d<em>t$是在该支持下定义的，每个原子i上的概率密度为$p^i</em>θ(S<em>t, a_t)$，使得$d_t=(z, p</em>θ(S_t, a_t))$。目标是更新θ，使该分布与实际收益分布紧密匹配。</p>
<p>要了解概率密度，关键是返回的分布满足Bellman方程的一个变体。对于给定状态$S<em>t$和动作$A_t$，最优策略$π^*$下的收益分布，应匹配通过下一状态$S</em>{t+1}$的分布和动作$a^<em>_{t+1}=\pi^</em>(S<em>{t+1})$定义的目标分布，根据折扣系数将其收敛，并根据奖励（或随机情况下的奖励分配）将计算奖励。然后，通过首先构建对目标分布，然后最小化分布$d_t$和目标分布之间的Kullbeck-Leibler发散，目标Q学习的分布变体$ d’_t=(R</em>{t+1} + \gamma<em>{t+1} z, p^-</em>\theta(S<em>{t+1}, \overline a^*</em>{t_1}))  $：</p>
<script type="math/tex; mode=display">
D_{KL}(\Phi_z d'_t || d_t) ~~~~~~~~~~ (3)</script><p>这里，$Φ<em>z$是目标分布在z上的L2范数，再状态$S</em>{t+1}$， $a^∗<em>{t+1}=\underset{a}{argmax~}q</em>θ^-(S<em>{t+1},a)$）是相对于平均值$q</em>{\overline θ} = z^T p<em>\theta(S</em>{t+1},a)$更真实。</p>
<p>与不同分布情况一样，我们可以使用参数$\overline θ$的冻结副本来构建目标分布。参数化分布可以用神经网络表示，如在DQN中，但使用$N<em>{atoms}×N</em>{actions}$输出。softmax独立地应用于输出的每个动作维度，以确保每个动作的分布被适当地归一化。</p>
<h3 id="3-6-噪声网络"><a href="#3-6-噪声网络" class="headerlink" title="3.6 噪声网络"></a>3.6 噪声网络</h3><p>探索使用的局限性$  \epsilon -greedy $ 策略在诸如《蒙特祖马的复仇》这样的游戏中是明确的，在游戏中必须执行许多动作才能获得第一笔奖励。Noisy Nets（Fortunato，2017）提出了一种噪声线性层，</p>
<script type="math/tex; mode=display">
y=(b+wx)+(b_{noisy} \odot \epsilon^b + (w_{noisy} \odot \epsilon^w)x), ~~~~~~~(4)</script><p>其中，$\epsilon^b$和$\epsilon^w$是随机变量，$\odot$ 表示元素乘积。然后可以使用该变换来代替标准线性$y＝b+wx$。随着时间的推移，网络可以学会忽略噪声流，但会在状态空间的不同部分以不同的速率这样做，从而允许以自退火的形式进行状态条件探索。</p>
<h2 id="4-集成智能体"><a href="#4-集成智能体" class="headerlink" title="4.集成智能体"></a>4.集成智能体</h2><p>在本文中，我们将上述所有组件集成到一个集成智能体中，我们称之为Rainbow。</p>
<p>首先，我们将1-step 分布损失（3）替换为多步变量。我们通过根据累积折扣收缩$S<em>{t+n}$中的价值分布，并将其采样为截断的n步折扣收益来构建目标分布。这对应于将目标分布定义为$d^{(n)}_t = (R_t^{(n)} - \gamma_t^{(n)}z, p</em>\theta^-(S<em>{t+n}, a^*</em>{t+n}))$，损失为：</p>
<script type="math/tex; mode=display">
D_{KL}(\Phi_zd_t^{(n)} || d_t)</script><p>其中，$Φz$是z的投影。</p>
<p>我们通过使用根据 <em>在线网络</em> 选择的$S<em>{t+n}$中的贪婪动作$a^*</em>{t+n}$作为目标动作，将多步分布损失与双Q学习相结合， 并使用目标网络评估这种动作。</p>
<p>在标准比例优先经验重放（Schaul et al.2015）中，绝对TD误差被用于确定采样的优先级。这可以在分布设置中使用平均作用值进行计算。然而，在我们的实验中，所有分布 Rainbow 变种都通过KL损失来优先考虑过渡，因为这是算法所最小化的：</p>
<script type="math/tex; mode=display">
p_t \propto (D_{KL}(\Phi_zd_t^{(n)} || d_t))^w</script><p>作为优先权的KL损失可能对有噪声的随机环境更具鲁棒性，因为即使在收益不确定的情况下，损失也会继续减少。</p>
<p>网络结构是一种分布式Q函数和对决网络一起使用的结构。网络具有共享卷积层$f<em>ξ(s)$，然后输出$ N</em>{atoms}<br>  $维的状态价值$v<em>η$和$ N</em>{atoms}<br>  $维的优势头$a<em>\xi$，其中$a^i</em>ξ(f_ξ(s),a)$将表示对应于原子i和动作a的输出，对于每个原子$z_i$，如在对决DQN中一样，将价值流和优势流聚合，然后通过softmax层，以获得用于估计收益分布的归一化参数分布</p>
<script type="math/tex; mode=display">
p_\theta^i(s,a)=\frac{exp(v_\eta^i(\phi) + a^i_\psi(\phi,a) - \overline a^i_\psi(s))}{\sum_j exp(v_\eta^i(\phi) + a^i_\psi(\phi,a) - \overline a^i_\psi(s))}</script><p>其中$  \phi=f<em>\xi(s) $,  $\overline a^i</em>\phi(s)=\frac{1}{N<em>{actions}} \sum</em>{a’} a^i_\psi(\phi, a’)$</p>
<p>然后，我们用等式（4）中描述的噪声等效物替换所有线性层。在这些噪声线性层中，我们使用因子化高斯噪声（Fortunato，2017）来减少独立噪声变量的数量。</p>
<h2 id="5-实验方法"><a href="#5-实验方法" class="headerlink" title="5.实验方法"></a>5.实验方法</h2><p>我们现在描述用于配置和评估集成智能体的方法和设置。</p>
<h3 id="5-1-评估方法"><a href="#5-1-评估方法" class="headerlink" title="5.1 评估方法"></a>5.1 评估方法</h3><p>我们评估了57款雅达利游戏中2600个智能体上的效果（Bellemare，2013）。我们遵循Mnih等人（2015）和van Hasselt等人（2016）的训练和评估程序。在训练期间，通过暂停学习并评估500K帧的最新智能体，在环境中每1M步评估智能体的平均分数。如van Hasselt等人（2016）所述，训练轮次在108K帧（或30分钟的模拟播放）时被截断。</p>
<p>智能体的得分在每场游戏中被标准化，因此0%对应于随机代理，100%对应于人类专家的平均得分。标准化分数可以在所有Atari级别上进行汇总，以比较不同代理的性能。跟踪所有游戏中人类正常化表现的中位数是很常见的。我们还考虑了智能体的表现高于人类表现的一小部分的游戏数量，以理解中位数的改进来自何处。人类正常化的平均表现可能信息量较小，因为它主要由一些游戏（如亚特兰蒂斯）主导，在这些游戏中，智能体的得分比人类高出几个数量级。</p>
<p>除了跟踪中值性能作为环境步骤的函数之外，在训练结束时，我们使用两种不同的测试方案重新评估最佳智能体。在无操作启动机制中，我们在每个轮次开始时插入一个随机数（最多30个）的无操作操作（正如我们在训练中所做的那样）。在人类开始游戏中，使用从人类专家轨迹的初始部分随机采样的点来初始化每个轮次初始值（Nair等人，2015）；这两种方法之间的差异表明，智能体在多大程度上对自己的轨迹过拟合。</p>
<p>由于空间限制，我们专注于游戏的总体结果。然而，在附录中，我们提供了所有游戏和所有智能体的完整学习曲线，以及无操作和人工启动测试制度中原始和标准化分数的详细对比表。</p>
<h3 id="5-2-超参数调整"><a href="#5-2-超参数调整" class="headerlink" title="5.2 超参数调整"></a>5.2 超参数调整</h3><p>Rainbow的所有组件都有许多超参数。超参数的组合空间太大，无法进行穷举搜索，因此我们进行了有限的调整。对于每个组件，我们从介绍该组件的文章中使用的值开始，并通过手动坐标下降调整超参数中最敏感的参数。</p>
<p>DQN及其变体在前200K轮次期间不执行学习更新，以确保足够不相关的更新。我们发现，有了优先经验回放，可以在80K轮次后更快地开始学习。</p>
<p>DQN从探索开始$\epsilon$对应于随机均匀作用；它将前4M帧上的探测量退火到最终值0.1（在以后的变型中降低到0.01）。无论何时使用噪声的网络，我们都采取贪心策略（$\epsilon = 0$）， $σ_0$超参数的值为0.5，用于初始化噪声中的权重。对于没有噪声网络的智能体，我们使用$\epsilon - greedy$策略，但是降低探索速度比以前更快，在前250K帧中为0.01。</p>
<p>我们使用了Adam优化器（Kingma和Ba 2014），我们发现它对学习率的选择比RMSProp更不敏感。DQN使用$α=0.00025$的学习率。在所有Rainbow变体中，我们使用$α/4$的学习率，选自$｛α/2、α/4、α/6｝$，超参数Adam的值为$1.5×10^{-4}$。</p>
<p>对于优先级经验回放，我们使用推荐的比例变量，优先级指数$ω$为0.5，并在训练过程中将重要性采样指数$β$从0.4线性增加到1。比较${0.4、0.5、0.7}$的值，调整优先级指数$ω$。使用分布DQN的KL损失作为优先级，我们观察到性能对ω的选择非常稳健。</p>
<p>多步TD中n的值是Rainbow的一个敏感超参数。我们比较了n=1、3和5的值。我们观察到，n=3和5最初都表现得很好，但到最后，总体上n=3表现得最好。</p>
<p>超级参数（见表1）在所有57款游戏中都是相同的，即Rainbow智能体实际上是一个在所有游戏中都表现良好的单一智能体设置。</p>
<p>表1 Rainbow 超参数</p>
<p><img src="image/image_be-fxwSpIp.png" alt=""></p>
<p><img src="image/image_cpWH5yX0p1.png" alt=""></p>
<p>图2：每一个图都显示了几个智能体的游戏数量，其中他们至少达到了人类性能的给定分数，作为时间的函数。从左到右，我们考虑20%、50%、100%、200%和500%的阈值。在第一行，我们将Rainbow与基线进行比较。在第二排，我们将Rainbow与它的消融进行了比较。</p>
<h2 id="6-分析"><a href="#6-分析" class="headerlink" title="6.分析"></a>6.分析</h2><p>在本节中，我们分析了主要的实验结果。首先，我们表明Rainbow比已发布的DQN变体更受欢迎。然后我们进行消融研究，比较几种不同的消融，每种消融都对应于从Rainbow中去除一种成分。</p>
<h3 id="6-1-与已发布baseline的比较"><a href="#6-1-与已发布baseline的比较" class="headerlink" title="6.1 与已发布baseline的比较"></a>6.1 与已发布baseline的比较</h3><p>在图1中，我们将Rainbow的表现（根据游戏中人类归一化得分的中位数来衡量）与A3C、DQN、DDQN、优先DDQN和对决DDQN的相应曲线进行了比较。我们感谢Dueling和Prioritized代理的作者提供了这些代理的学习曲线，并报告了我们自己对DQN、A3C、DDQN、Distributional DQN和Noisy DQN的重新运行。Rainbow的性能在数据效率和最终性能方面都明显优于任何基线。请注意，我们在7M帧后匹配了DQN的最终性能，在44M帧中超过了这些基线的最佳最终性能，并达到了显著改进的最终性能。</p>
<p>在对智能体的最终评估中，训练结束后，Rainbow在无操作制度下的中位数得分为223%；在人类起步阶段，我们测得的中位数为153%。在表2中，我们将这些分数与个别基线的公布中值分数进行了比较。</p>
<p>在图2（顶行）中，我们绘制了智能体达到人类标准化性能特定水平的游戏数量。从左到右，子图显示了不同代理实现了20%、50%、100%、200%和500%人类标准化性能的游戏数量。这使我们能够确定性能的总体改进来自何处。请注意，Rainbow和其他智能体之间的性能差距在各个级别的性能上都是显而易见的：Rainbow智能体正在提高基线智能体已经很好的游戏的分数，以及在基线智能体与人类性能相差很远的游戏中的分数。</p>
<h3 id="6-2-学习速度"><a href="#6-2-学习速度" class="headerlink" title="6.2 学习速度"></a>6.2 学习速度</h3><p>与最初的DQN设置一样，我们在单个GPU上运行每个智能体。匹配DQN最终性能所需的7M帧对应于不到10小时的时间。200M帧的完整运行对应于大约10天，并且在所有讨论的变体之间，这一变化小于20%。文献中包含了许多可替代的训练设置，它们通过利用并行性来提高作为挂钟时间函数的性能，例如，Nair（2015）、Salimans（2017）和Mnih（2016）。在如此不同的硬件/计算资源之间正确地关联性能是非常重要的，因此我们只关注算法变化。虽然我们认为它们是重要的和互补的，但我们将可伸缩性和并行性的问题留给未来的工作。</p>
<p>表2：Rainbow和基线的最佳智能体的中位数标准化分数。对于标有星号的方法，分数来自相应的论文。DQN的分数来自对决网络的论文，因为DQN论文没有报告所有57场比赛的分数。其他分数来自我们自己的实现。</p>
<p><img src="image/image_TwrSrMRwve.png" alt=""></p>
<p><img src="image/image_DgM8zGSGEA.png" alt=""></p>
<p>图3：57款雅达利游戏中人类正常化表现的中位数，作为时间的函数。我们将我们的集成智能体（彩虹色）与DQN（灰色）和六种不同的消融（虚线）进行比较。在5个点上使用移动平均值平滑曲线。</p>
<h3 id="6-3-消融研究"><a href="#6-3-消融研究" class="headerlink" title="6.3 消融研究"></a>6.3 消融研究</h3><p>由于Rainbow将几个不同的想法集成到一个智能体中，我们进行了额外的实验，以了解在这种特定组合的背景下，各个组件的贡献。</p>
<p>为了更好地了解每个成分对Rainbow的贡献，我们进行了消融研究。在每次消融中，我们从完整的Rainbow组合中移除一个组件。图3显示了完整Rainbow和六种消融变体的中位数标准化评分的比较。图2（下一行）显示了这些消融如何相对于人类标准化性能的不同阈值进行的更详细的细分，图4显示了每个游戏中每次消融的增益或损失，在整个学习过程中的平均值。</p>
<p>优先经验回放和多步TD是Rainbow最关键的两个组成部分，因为删除其中一个组成部分会导致中位数的大幅下降。毫不奇怪，这两个因素的移除都会影响早期表现。也许更令人惊讶的是，取消多步TD也会影响最终成绩。放大单个游戏（图4），我们看到两个组件在整个游戏中的帮助几乎是一致的（在57场游戏中，完整的彩虹在53场游戏中的表现优于消融）。</p>
<p>分布Q学习在与智能体性能相关的100%之前的技术中排名靠后。值得注意的是，在早期学习中，没有明显的差异，如图3所示，在最初的4000万帧中，分布消融与完全消融效果一样好。然而，如果没有分布Q学习，智能体的性能就会开始落后。当结果与图2中的人类表现相分离时，我们发现分布消融主要似乎滞后于高于人类水平或接近人类水平的游戏。</p>
<p>就中位数表现而言，包括噪声网络时，智能体表现更好；当这些被移除并且探索使用传统的 $\epsilon - greedy$ 策略，总体性能较差（图3中的红线）。虽然移除“噪声网络”导致几场游戏的成绩大幅下降，但在其他游戏中也有小幅上升（图4）。</p>
<p>总的来说，当从完整的Rainbow中移除对决网络时，我们没有观察到显著的差异。然而，如图4所示，中位数分数掩盖了对决网络的影响在不同游戏之间存在差异的事实。图2显示，对决网络可能在高于人类表现水平的游戏（#games\&gt;200%）上有所改善，而在低于人类表现的游戏（#games\&gt;20%）上有所下降。</p>
<p>同样，在双Q学习的情况下，观察到的中位性能差异（图3）是有限的，根据游戏的不同，组件有时会导致性能下降或帮助（图4）。为了进一步研究双重Q 学习的作用，我们将我们训练过的智能体的预测与根据折扣奖励计算的实际折扣回报进行了比较。将Rainbow与双Q学习被消融的智能体进行比较，我们发现实际回报通常高于10，因此不在分布的支持范围内，从−10到+10。这导致回报被低估，而不是高估。我们假设，将值限制在这个限制范围内可以抵消Q学习的高估偏差。然而，请注意，如果分布的支持扩大，双Q学习的重要性可能会增加。</p>
<p>在附录中，我们展示了每个游戏的最终表现和Rainbow的学习曲线、消融和基线。</p>
<p><img src="image/image_l5uqxT0nbP.png" alt=""></p>
<p>图4：所有57款雅达利游戏中消融的性能下降。性能是学习曲线下的区域，相对于Rainbow智能体和DQN进行标准化。DQN表现优于Rainbow的两个游戏被省略。每场比赛都会突出显示导致最强跌落的消融。取消优先级或多步TD会降低大多数游戏的性能，但每个组件的贡献因游戏而异。</p>
<h2 id="7-讨论"><a href="#7-讨论" class="headerlink" title="7.讨论"></a>7.讨论</h2><p>我们已经证明，DQN的若干改进可以成功地集成到单个学习算法中，从而实现最先进的性能。此外，我们已经表明，在集成算法中，除了一个组件之外，所有组件都提供了明显的性能优势。还有许多我们无法包含的算法组件，这将是集成智能体进一步实验的有希望的候选。在众多可能的候选人中，我们将在下面讨论几个。</p>
<p>我们在这里关注的是Q学习家族中基于价值的方法。我们没有考虑纯粹基于策略的RL算法，如信任区域策略优化（Schulman，2015），也没有考虑行actor-critic方法（Mnih，2016；O’Donoghue，2016）。</p>
<p>许多算法利用数据序列来提高学习效率。最优收紧（He et al.2016）使用多步收益来构建额外的不等式边界，而不是使用它们来代替Q学习中使用的1步目标。跟踪允许n步回报的软组合（Sutton 1988）。然而，与Rainbow中使用的多步目标相比，顺序方法在每个梯度上都利用了更多的计算。此外，引入优先序列重放提出了如何存储、重放和优先序列的问题。</p>
<p>偶发控制（Blundell，2016）也关注数据效率，并显示在某些领域非常有效。它通过使用情景记忆作为补充学习系统来改善早期学习，能够立即重演成功的动作序列。</p>
<p>除了Noisy Nets，许多其他探索方法也可能是有用的算法成分：在这些Bootstrapped DQN（Osband等人2016）、内在动机（Stadie、Levine和Abbeel 2015）和基于计数的探索（Bellemare等人2016）中。这些替代组件的集成是进一步研究的富有成果的课题。</p>
<p>在本文中，我们专注于学习更新，而没有探索其他计算架构。在A3C（Mnih等人，2016）、Gorila（Nair等人，2015）或Evolution Strategies（Salimans等人，2017）中，从环境的并行副本进行异步学习可以有效地加速学习，至少在时间方面是如此。然而，请注意，它们的数据效率可能较低。</p>
<p>分层RL也成功地应用于几个复杂的雅达利游戏。在HRL的成功应用中，我们重点介绍了h-DQN（Kulkarni等人，2016a）和Feudal Networks（Vezhnevets等人，2017）。</p>
<p>通过利用辅助任务，如像素控制或特征控制（Jaderberg et al.2016）、监督预测（Dosovitskiy and Koltun 2016）或后续特征（Kulkarni et al.2016b），状态表示也可以变得更有效。</p>
<p>为了根据基线公平地评估Rainbow，我们遵循了折扣奖励、固定动作重复和帧堆叠的常见领域修改，但这些可能会被其他学习算法改进所消除。波普艺术规范化（van Hasselt et al.2016）允许删除奖励这苦，同时保持类似的表现水平。细粒度动作重复（Sharma、Lakshminarayanan和Ravindran 2017）能够学习如何重复动作。循环状态网络（Hausknecht and Stone 2015）可以学习时间状态表示，取代观测帧的固定堆栈。总的来说，我们认为将真实游戏暴露给智能体是未来研究的一个有希望的方向。</p>
<h2 id="8-参考文献"><a href="#8-参考文献" class="headerlink" title="8.参考文献"></a>8.参考文献</h2></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://wdndev.github.io">Firefly</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://wdndev.github.io/paper_reading/3.2.Rainbow/">https://wdndev.github.io/paper_reading/3.2.Rainbow/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/RL/">RL</a><a class="post-meta__tags" href="/tags/PaperReading/">PaperReading</a></div><div class="post_share"><div class="social-share" data-image="/img/wdn_icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/paper_reading/3.1.WU_UCT/" title="论文精读 一种简单的蒙特卡洛树搜索并行化方法"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-29</div><div class="title">论文精读 一种简单的蒙特卡洛树搜索并行化方法</div></div></a></div><div><a href="/easy_rl_exercise/1.%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/" title="1.强化学习基础"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-24</div><div class="title">1.强化学习基础</div></div></a></div><div><a href="/easy_rl_exercise/10.%E6%A8%A1%E4%BB%BF%E5%AD%A6%E4%B9%A0/" title="10.模仿学习"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-24</div><div class="title">10.模仿学习</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Rainbow"><span class="toc-text">Rainbow</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Rainbow-Combining-Improvements-in-Deep-Reinforcement-Learning"><span class="toc-text">Rainbow: Combining Improvements in Deep Reinforcement Learning</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Rainbow-%E7%BB%93%E5%90%88%E6%B7%B1%E5%BA%A6%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%94%B9%E8%BF%9B"><span class="toc-text">Rainbow: 结合深度强化学习的改进</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%91%98%E8%A6%81"><span class="toc-text">摘要</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Abstract"><span class="toc-text">Abstract</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%AE%80%E4%BB%8B"><span class="toc-text">1.简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%83%8C%E6%99%AF"><span class="toc-text">2.背景</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1%E6%99%BA%E8%83%BD%E4%BD%93%E5%92%8C%E7%8E%AF%E5%A2%83"><span class="toc-text">2.1智能体和环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2%E6%B7%B1%E5%BA%A6%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E5%92%8CDQN"><span class="toc-text">2.2深度强化学习和DQN</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-DQN%E6%89%A9%E5%B1%95"><span class="toc-text">3.DQN扩展</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-Double-Q-learning"><span class="toc-text">3.1 Double Q-learning</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E4%BC%98%E5%85%88%E7%BB%8F%E9%AA%8C%E5%9B%9E%E6%94%BE"><span class="toc-text">3.2 优先经验回放</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-Dueling%E7%BD%91%E7%BB%9C"><span class="toc-text">3.3 Dueling网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E5%A4%9A%E6%AD%A5TD"><span class="toc-text">3.4 多步TD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E5%88%86%E5%B8%83%E5%BC%8FRL"><span class="toc-text">3.5 分布式RL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-%E5%99%AA%E5%A3%B0%E7%BD%91%E7%BB%9C"><span class="toc-text">3.6 噪声网络</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E9%9B%86%E6%88%90%E6%99%BA%E8%83%BD%E4%BD%93"><span class="toc-text">4.集成智能体</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%AE%9E%E9%AA%8C%E6%96%B9%E6%B3%95"><span class="toc-text">5.实验方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E8%AF%84%E4%BC%B0%E6%96%B9%E6%B3%95"><span class="toc-text">5.1 评估方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E8%B6%85%E5%8F%82%E6%95%B0%E8%B0%83%E6%95%B4"><span class="toc-text">5.2 超参数调整</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%88%86%E6%9E%90"><span class="toc-text">6.分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E4%B8%8E%E5%B7%B2%E5%8F%91%E5%B8%83baseline%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-text">6.1 与已发布baseline的比较</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E5%AD%A6%E4%B9%A0%E9%80%9F%E5%BA%A6"><span class="toc-text">6.2 学习速度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E6%B6%88%E8%9E%8D%E7%A0%94%E7%A9%B6"><span class="toc-text">6.3 消融研究</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E8%AE%A8%E8%AE%BA"><span class="toc-text">7.讨论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="toc-text">8.参考文献</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By Firefly</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">簡</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'oe7vzWxH80qwJJjWslYTCViT-gzGzoHsz',
      appKey: 'k89nSbK0BTbmzmpQottRHvNI',
      avatar: 'monsterid',
      serverURLs: 'https://oe7vzwxh.lc-cn-n1-shared.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: true
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script async src="/js/title.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"left","width":180,"height":360,"hOffset":0,"vOffset":-100},"mobile":{"show":true},"react":{"opacity":0.85},"log":false});</script></body></html>