{"timestamp":"2025-09-17T23:50:19.807Z","totalItems":20,"items":[{"id":"hf-0-1758152840084","title":"WebWeaver: Structuring Web-Scale Evidence with Dynamic Outlines for Open-Ended Deep Research","description":"This paper tackles open-ended deep research (OEDR), a complex challenge where AI agents must synthesize vast web-scale information into insightful reports. Current approaches are plagued by dual-fold limitations: static research pipelines that decouple planning from evidence acquisition and one-shot generation paradigms that easily suffer from long-context failure issues like \"loss in the middle\" and hallucinations. To address these challenges, we introduce WebWeaver, a novel dual-agent framework that emulates the human research process. The planner operates in a dynamic cycle, iteratively interleaving evidence acquisition with outline optimization to produce a comprehensive, source-grounded outline linking to a memory bank of evidence. The writer then executes a hierarchical retrieval and writing process, composing the report section by section. By performing targeted retrieval of only the necessary evidence from the memory bank for each part, it effectively mitigates long-context issues. Our framework establishes a new state-of-the-art across major OEDR benchmarks, including DeepResearch Bench, DeepConsult, and DeepResearchGym. These results validate our human-centric, iterative methodology, demonstrating that adaptive planning and focused synthesis are crucial for producing high-quality, reliable, and well-structured reports.","url":"https://huggingface.co/papers/2509.13312","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.084Z","metadata":{"authors":["Zijian Li","Xin Guan","Bo Zhang","Shen Huang","Houquan Zhou","Shaopeng Lai","Ming Yan","Yong Jiang","Pengjun Xie","Fei Huang","Jun Zhang","Jingren Zhou"],"date":"","rank":1,"llmAnalysis":"","categories":["cs.CL"],"pdfUrl":"https://arxiv.org/pdf/2509.13312.pdf","arxivUrl":"https://arxiv.org/abs/2509.13312","arxivId":"2509.13312","coolPaperUrl":"https://papers.cool/arxiv/2509.13312","published":"2025-09-16T17:57:21Z","updated":"2025-09-16T17:57:21.000Z","zh_summary":"本文探讨了开放式深度研究（OEDR），这是一个复杂的挑战，AI代理必须将大量网络规模的信息综合成有见地的报告。目前的方法存在双重限制：静态研究流程使得规划与证据获取脱钩，而一次性生成的范式则容易受到长上下文失败问题的影响，如“中间丢失”和幻觉。为了解决这些挑战，我们推出了WebWeaver，一种新颖的双代理框架，模拟人类研究过程。规划者在动态循环中运作，迭代交替进行证据获取与大纲优化，以生成一个全面的、以来源为基础的大纲，并链接到证据记忆库。然后，写作者执行分层检索和写作过程，逐节撰写报告。通过针对性地从记忆库中仅检索每部分所需的证据，实质性地减轻了长上下文问题。我们的框架在主要的OEDR基准测试中建立了新的最先进水平，包括DeepResearch Bench、DeepConsult和DeepResearchGym。这些结果验证了我们以人为本的迭代方法，证明了自适应规划和集中综合对于生成高质量、可靠和结构良好的报告至关重要。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文旨在解决“开放式深度研究”（Open-Ended Deep Research, OEDR）这一高难任务：  \n给定一个无标准答案的开放问题，智能体需在 web 规模的海量信息中自主检索、筛选、综合，最终生成一份篇幅长、结构严谨、观点独到且可验证的研究报告。\n\n现有方法存在两大核心缺陷：\n\n1.  静态流程割裂：先一次性定好提纲再搜集证据，导致计划无法随新发现动态调整，错失潜在重要方向。\n2.  长上下文失效：一次性把所有材料塞进模型，引发“中间丢失”、幻觉、跨节干扰等问题，难以产出高质量长文。\n\nWebWeaver 通过“双智能体+动态循环+分层写作”模拟人类研究过程，克服上述局限，在三大 OEDR 基准上刷新 SOTA。\n\n**Q2**: 有哪些相关研究？\n\n论文第 5 节（Related Work）将相关研究归为两条主线，并指出其局限；下列文献均可在 References 中找到出处。\n\n1.  深度研究型智能体（Deep Research Agents）  \n    1.1 闭源/商用系统\n    \n    *   OpenAI Deep Research (OpenAI, 2025a)\n    *   Gemini Deep Research (Google, 2025)\n    *   Claude Research (Anthropic, 2025)  \n        ‑ 表现强但 API 昂贵、黑箱，不利于学术复现与改进。\n    \n    1.2 开源短答案导向方案\n    \n    *   WebSailor、WebDancer、MaskSearch 等 (Li et al., 2025a; Wu et al., 2025b; Wu et al., 2025a)\n    *   面向 BrowseComp、GAIA 等短答案基准，侧重事实性问答，缺乏长文综合与报告生成能力。\n    \n    1.3 开源长文生成方案\n    \n    *   OpenDeepResearch (Research, 2025e)\n    *   GPT-Researcher (Research, 2025c)\n    *   TTD-DR (Han et al., 2025)  \n        ‑ 普遍采用“静态提纲 → 分节检索 → 一次性成文”流水线；提纲固定、证据全部入模，导致结构僵化、长上下文幻觉、节间干扰。\n2.  长文本生成（Long Writing）\n    \n    *   早期递归提示：Re3 (Yang et al., 2022)、DOC (Yang et al., 2023)\n    *   近期代理框架：LongWriter (Bai et al., 2025)、CogWriter (Wan et al., 2025)  \n        ‑ 共性是“先规划后写作”，但规划阶段不随证据更新，写作阶段仍把全部素材一次性输入模型，未能解决注意力饱和与“中间丢失”问题。\n\nWebWeaver 与上述工作的根本区别：\n\n*   动态循环：提纲与证据获取交替迭代，随时修正结构；\n*   分层写作：每节仅召回对应证据，写完即剪枝，避免长上下文干扰。\n\n**Q3**: 论文如何解决这个问题？\n\n论文提出 **WebWeaver**——一种“双智能体+动态循环+分层写作”框架，把 OEDR 解耦成两个可迭代、可验证的子系统，从而避开静态流程与长上下文陷阱。核心机制如下：\n\n阶段\n\n关键问题\n\nWebWeaver 对策\n\n技术要点\n\n① 规划\n\n一次性提纲无法随新发现演化\n\n**动态研究循环**（§3.2）\n\nPlanner 基于 ReAct 交替执行：  \n`search` → `write_outline` → 再搜索…  \n每轮用新证据增删章节、细化论点，并实时插入 `<citation>id_x</citation>` 锚定到记忆库。\n\n② 记忆\n\n百页级原文塞进上下文 → 注意力崩溃\n\n**结构化记忆库**（§3.2-3.3）\n\n搜索仅返回 100-200 token 摘要进上下文；  \n全文与可验证片段（quote、数据）以键值形式存入外部记忆，写作时按需召回。\n\n③ 写作\n\n一次性长文生成易“中间丢失”、节间串扰\n\n**分层-分段-聚焦写作**（§3.3）\n\nWriter 按提纲顺序每次只写一节：  \n`retrieve(id_list)` → `think(内部推理)` → `write` → `prune`  \n写完后立即把原文证据换出，保证下一节上下文干净。\n\n④ 学习\n\n30 B 级模型多轮工具调用不稳定\n\n**WebWeaver-3k SFT**（§4.3）\n\n用上述框架的 3.3 k 条高质量轨迹蒸馏出 Planner+Writer 策略，小模型也能达到 85.9 % 引文准确率（原 25 %）。\n\n通过以上设计，WebWeaver 把“长上下文推理”转化为“系统级信息管理与工具调度”问题，在 DeepResearch Bench、DeepConsult、DeepResearchGym 三大基准上均取得新 SOTA。\n\n**Q4**: 论文做了哪些实验？\n\n实验围绕“方法有效性”与“知识蒸馏可行性”两条主线展开，共 4 组 12 项具体评测，全部基于公开基准与官方评价脚本，保证可复现。\n\n1.  主评测（§4.2）  \n    1.1 DeepResearch Bench（100 条 PhD 级任务）\n    \n    *   指标：RACE（Overall、Comp.、Insight、Inst.、Read.）+ FACT（Eff. c.、C. acc.）\n    *   结果：WebWeaver(Claude-sonnet-4) 50.58 分，超越 GPT-4o-deepresearch 46.45 与 Gemini-2.5-pro 49.71，C. acc. 达 93.37 %。\n    \n    1.2 DeepConsult（商业咨询场景）\n    \n    *   指标：win/tie/loss vs. openai-deepresearch + 平均质量分\n    *   结果：WebWeaver 取得 66.86 % 胜率，平均质量 6.96，显著高于第二名 Gemini-2.5-pro 6.70。\n    \n    1.3 DeepResearchGym（96 k 真实查询抽样 100 条）\n    \n    *   指标：Clarity、Depth、Balance、Breadth、Support、Insightfulness\n    *   结果：WebWeaver 平均 96.77，Depth/Breadth 均达 100 %。\n2.  消融与细粒度分析（§4.3）  \n    2.1 提纲迭代轮数消融\n    \n    *   固定写作策略，仅改变 Planner 优化轮数（1→3）。\n    *   两基准 Overall 分数单调上升（DR-Bench +2.7，DR-Gym +11.0），Support 提升最显著（51.2→73.6）。\n    \n    2.2 分层写作 vs. 暴力长文\n    \n    *   基线：一次性把 67 k token 证据全部塞进模型的 LongWriter 方式。\n    *   结果：Insight ↑9.0，Readability ↑7.5，Support ↑7.0，验证“注意力聚焦”必要性。\n    \n    2.3 统计画像\n    \n    *   单任务平均 16 次搜索、2.2 轮提纲优化、112 篇网页、26 k token 终稿，量化说明“静态提纲”不可行。\n3.  模型蒸馏实验（§4.3 末）\n    \n    *   用 WebWeaver-3k（3.3 k 条轨迹）对 Qwen3-30b-a3b 做 SFT。\n    *   结果：  \n        – DeepResearch Bench Overall ↑1.34，Citation Accuracy 25 % → 85.9 %；  \n        – DeepConsult 质量分 4.57 → 6.09；  \n        – DeepResearchGym 77.27 → 90.89，证明“大系统可蒸馏成小模型”。\n4.  人工可解释性验证\n    \n    *   附录 B 给出完整 ReAct 轨迹（Planning 8 轮、Writing 25 轮），展示搜索-优化-写作-剪枝全过程，供后续研究对照。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下方向可在此基础上继续推进，分为“框架深化”“能力扩展”“评测与安全”三大类，供后续研究参考。\n\n1\\. 框架深化\n\n方向\n\n关键问题\n\n可探索思路\n\n1.1 多模态证据融合\n\n当前仅文本+表格，图像/图表/视频未利用\n\n引入视觉-语言检索器，对论文图、实验照片、财报截图做 `<citation>fig_id</citation>` 级引用；需解决跨模态对齐与版面检测。\n\n1.2 自洽性验证循环\n\n写完才发现矛盾或数据冲突\n\n增加“事实审核器”Agent，反向扫描成稿，触发 `search(conflict_query)` 重检索，驱动 Planner 回卷修正。\n\n1.3 层次化记忆更新\n\n记忆库只增不减，过时信息累积\n\n引入时效戳与置信度，做“记忆遗忘+增量摘要”，支持版本回溯；可借鉴 Episodic Memory 与 Diff-based Update。\n\n2\\. 能力扩展\n\n方向\n\n关键问题\n\n可探索思路\n\n2.1 数学/代码推理型报告\n\n当前侧重综述，缺少公式推导与可运行实验\n\n在记忆库中区分“理论推导”与“可执行代码块”，Writer 按需插入 `<latex>` 或 `<codeblock>`，并调用沙箱执行结果，实现“可复现报告”。\n\n2.2 多语言与跨文化研究\n\n仅英文网页，非英语信源缺失\n\n集成多语言检索器，自动检测高价值非英文文献，触发翻译摘要，并标注 `lang=xx` 属性，提升区域研究深度。\n\n2.3 协作式写作\n\n单智能体吞吐量有限\n\n引入“多 Planner 竞赛-多 Writer 分段”并行：① 不同 Planner 按子话题并行探索，② 通过共识机制合并最优提纲，③ Writer 集群按节并行起草，最后一致性融合。\n\n3\\. 评测、安全与伦理\n\n方向\n\n关键问题\n\n可探索思路\n\n3.1 细粒度幻觉评测\n\n现有指标只统计引用准确率，未定位具体句\n\n构建句子级事实核查集，用 LLM+人工标注“可验证声明”，自动对齐到源句，输出 Precision-Recall-False Attribution Rate。\n\n3.2 对抗性误导源\n\n恶意 SEO、钓鱼报告可能污染记忆库\n\n引入源可信度模块（域名声誉、同行评审标记、引用网络），动态下调低可信度证据权重，并给出“风险提示框”。\n\n3.3 版权与隐私合规\n\n大段引用可能侵权，医疗/法律建议或误导\n\n增加“引用长度阈值+改写建议”工具；对敏感领域（医疗、投资）自动附加 disclaimer，并限制单次可引用比例。\n\n4\\. 系统级优化\n\n方向\n\n关键问题\n\n可探索思路\n\n4.1 成本-性能权衡\n\n大模型调用 15+ 次搜索+写作，开销高\n\n① 用小型检索-排序模型先过滤 Top-k，再调用大模型总结；② 引入“早期停止”策略，当连续两轮提纲增益 < ε 时终止。\n\n4.2 在线环境交互\n\n仅被动搜索，无法主动提问或请求数据\n\n开放 API 让 Agent 可向数据拥有者发起“信息请求”或问卷，实现主动数据收集（类似人类学者发邮件索要实验数据）。\n\n这些方向既可直接嵌入 WebWeaver 的双 Agent 架构，也可作为上层插件或并行流程，逐步把“开放式深度研究”推向更高可信、更广领域、更强复现性的新阶段。\n\n**Q6**: 总结一下论文的主要内容\n\nWebWeaver 论文要点速览\n================\n\n1\\. 任务与痛点\n---------\n\n*   **开放端深度研究（OEDR）**：无标准答案，需自主检索百级网页并输出数万 token 的综述报告。\n*   **现有范式缺陷**\n    *   静态提纲：先一次性定纲再搜集，无法随新发现调整。\n    *   暴力长文：把所有证据一次性塞进模型，出现“中间丢失”、幻觉、节间串扰。\n\n2\\. WebWeaver 框架\n----------------\n\n采用“双智能体 + 动态循环 + 分层写作”模拟人类研究流程：\n\n阶段\n\n智能体\n\n关键动作\n\n输出\n\n规划\n\nPlanner\n\nsearch ↔ write\\_outline 迭代\n\n带 `<citation>id_x</citation>` 的演进式提纲 + 结构化记忆库\n\n写作\n\nWriter\n\nretrieve(仅相关证据) → think → write → prune\n\n逐节成稿，上下文始终聚焦\n\n3\\. 主要结果\n--------\n\n*   **三大基准新 SOTA**\n    \n    *   DeepResearch Bench：50.58 分（+0.87↑），引文准确率 93.4 %\n    *   DeepConsult：66.9 % 胜率，平均质量 6.96\n    *   DeepResearchGym：96.8 分，Depth/Breadth 均达 100 %\n*   **消融验证**\n    \n    *   多轮提纲优化显著优于单轮（Overall +2.7）\n    *   分层写作比暴力长文 Insight ↑9.0、Readability ↑7.5\n*   **知识蒸馏**  \n    用自产 3.3 k 轨迹对 30 B 模型 SFT，引文准确率 25 % → 85.9 %，小模型亦达专家级。\n    \n\n4\\. 贡献总结\n--------\n\n1.  提出动态-耦合式研究循环，破解“提纲僵化”难题。\n2.  引入分层-召回-剪枝写作，解决长上下文注意力失效。\n3.  在三大公开基准全面刷新最佳成绩，同时开源数据与代码。\n4.  通过 SFT 证明大系统能力可蒸馏至小模型，降低实用门槛。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是WebWeaver%3A%20Structuring%20Web-Scale%20Evidence%20with%20Dynamic%20Outlines%20for%20Open-Ended%20Deep%20Research，链接是  https://arxiv.org/pdf/2509.13312  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.13312  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-1-1758152840085","title":"Scaling Agents via Continual Pre-training","description":"Large language models (LLMs) have evolved into agentic systems capable of autonomous tool use and multi-step reasoning for complex problem-solving. However, post-training approaches building upon general-purpose foundation models consistently underperform in agentic tasks, particularly in open-source implementations. We identify the root cause: the absence of robust agentic foundation models forces models during post-training to simultaneously learn diverse agentic behaviors while aligning them to expert demonstrations, thereby creating fundamental optimization tensions. To this end, we are the first to propose incorporating Agentic Continual Pre-training (Agentic CPT) into the deep research agents training pipeline to build powerful agentic foundational models. Based on this approach, we develop a deep research agent model named AgentFounder. We evaluate our AgentFounder-30B on 10 benchmarks and achieve state-of-the-art performance while retains strong tool-use ability, notably 39.9% on BrowseComp-en, 43.3% on BrowseComp-zh, and 31.5% Pass@1 on HLE.","url":"https://huggingface.co/papers/2509.13310","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.085Z","metadata":{"authors":["Liangcai Su","Zhen Zhang","Guangyu Li","Zhuo Chen","Chenxi Wang","Maojia Song","Xinyu Wang","Kuan Li","Jialong Wu","Xuanzhong Chen","Zile Qiao","Zhongwang Zhang","Huifeng Yin","Shihao Cai","Runnan Fang","Zhengwei Tao","Wenbiao Yin","Chenxiong Qian","Yong Jiang","Pengjun Xie","Fei Huang","Jingren Zhou"],"date":"","rank":2,"llmAnalysis":"","categories":["cs.CL"],"pdfUrl":"https://arxiv.org/pdf/2509.13310.pdf","arxivUrl":"https://arxiv.org/abs/2509.13310","arxivId":"2509.13310","coolPaperUrl":"https://papers.cool/arxiv/2509.13310","published":"2025-09-16T17:57:19Z","updated":"2025-09-16T17:57:19.000Z","zh_summary":"大型语言模型（LLMs）已经发展成为能够自主使用工具和进行多步骤推理以解决复杂问题的代理系统。然而，在通用基础模型上进行后训练的方法在代理任务中表现 consistently 不佳，特别是在开源实现中。我们确定了根本原因：缺乏强大的代理基础模型迫使模型在后训练期间同时学习多样的代理行为，同时将其与专家示范对齐，从而造成基本的优化冲突。为此，我们首次提出将代理连续预训练（Agentic CPT）纳入深度研究代理培训管道，以构建强大的代理基础模型。基于这一方法，我们开发了一种名为 AgentFounder 的深度研究代理模型。我们在10个基准测试上评估了我们的AgentFounder-30B，并实现了最先进的性能，同时保持强大的工具使用能力，特别是在BrowseComp-en上为39.9%，在BrowseComp-zh上为43.3%，在HLE上为31.5%的Pass@1。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文针对“开源深度研究智能体显著落后于闭源竞品”这一经验现象，提出并验证其核心假设：  \n**通用基础模型缺乏“智能体归纳偏置”**，导致后续对齐阶段必须同时学习“能力”与“行为”两种异质目标，引发根本性的优化冲突，从而限制了智能体性能。\n\n为此，论文首次将“智能体能力”前移到预训练阶段，提出 **Agentic Continual Pre-training（Agentic CPT）** 范式，通过大规模离线合成数据在基础模型中预先植入工具调用、多步推理与决策探索等智能体行为模式，得到一个“已对智能体任务预对齐”的基础模型。后续仅需轻量 SFT/RL 即可释放性能，显著缩小甚至反超闭源模型在 BrowseComp、GAIA、HLE 等 10 项基准上的差距。\n\n**Q2**: 有哪些相关研究？\n\n论文将相关研究划分为两条主线，并在第 4 节“Related Work”中系统综述。以下按主题归纳：\n\n1\\. 深度研究智能体（Deep Research Agents）\n\n类别\n\n代表工作\n\n核心贡献\n\n与本文差异\n\n**闭源产品**\n\nOpenAI Deep Research、Grok Deeper Search、Perplexity Deep Research、Gemini Deep Research、Kimi-Researcher\n\n端到端商业系统，强调超长轨迹搜索与报告生成\n\n无训练细节，无法复现；本文聚焦可复现的开源训练范式\n\n**开源单模型方案**\n\nWebSailor、WebShaper、AFM、DeepDive、WebExplorer、GLM-4.5、DeepSeek-V3.1 等\n\n通过 SFT/RL 在通用基座模型上拟合高难度轨迹\n\n仅在“后训练”阶段注入智能体行为，未解决基座模型缺乏归纳偏置的问题\n\n**数据合成方法**\n\nSailorFog（WebSailor）、knowledge-projection（WebShaper）、Chain-of-Agents（AFM）、cross-page QA（DeepDiver）\n\n利用知识图谱、迭代查询、多页推理等方式构造复杂问题-轨迹对\n\n这些合成数据仅用于 SFT/RL；本文将其思想迁移到“持续预训练”场景，并引入离线无 API 合成\n\n**多智能体/多模态**\n\nCognitive Kernel-Pro、WebWatcher 等\n\n多模型协作或引入视觉模态完成深度研究\n\n本文聚焦单模型、纯文本场景，与多模态/多智能体正交\n\n2\\. 持续预训练（Continual Pre-training, CPT）\n\n子方向\n\n代表工作\n\n核心结论\n\n与本文差异\n\n**领域自适应 CPT**\n\nKe et al. 2023、Çağatay Yıldız et al. 2025、Parmar et al. 2024\n\n在通用基座模型上继续预训练，可缓解灾难性遗忘并提升下游任务\n\n仅关注“知识”迁移，未涉及工具调用、决策序列等智能体行为\n\n**工具学习/工具调用 CPT**\n\n——\n\n前人未将 CPT 用于工具使用或智能体能力\n\n本文首次把“智能体行为”显式纳入 CPT 目标，提出 FAS/HAS 离线合成框架，填补该空白\n\n3\\. 其他相关技术\n\n技术点\n\n文献\n\n与本文关联\n\n**Reject Sampling**\n\n多参考训练（Zheng et al. 2018）、METEOR（Banerjee & Lavie 2005）\n\n本文借其思想对 FAS 生成结果做“知识对齐”过滤\n\n**多参考/多样性增强**\n\nMulti-Reference Training\n\n启发 FAS 在“问题级”而非“轨迹级”做多样性扩充\n\n**步级决策建模**\n\n步级 RL、Curriculum RL\n\n本文 HAS 把整条轨迹拆成步级选择空间，离线构建对比式决策样本，规避稀疏奖励问题\n\n小结\n\n*   **前人**：把“智能体能力”放在后训练（SFT/RL），且依赖昂贵在线 API 采集轨迹。\n*   **本文**：首次将“智能体能力”前移到持续预训练，提出无 API、可扩展的 FAS/HAS 数据合成与两阶段 CPT 策略，从根本上解决通用基座模型缺乏智能体归纳偏置的问题。\n\n**Q3**: 论文如何解决这个问题？\n\n论文把“开源智能体落后”归因于**通用基座模型缺少智能体归纳偏置**，导致后训练阶段必须同时学“能力”与“对齐”，优化目标冲突。为此，提出\\*\\*Agentic Continual Pre-training（Agentic CPT）\\*\\*新范式，把智能体行为提前嵌入基座模型，再轻量后训练即可。具体解法可归纳为三大构件、两阶段训练、一条数据飞轮：\n\n1\\. 三大构件：离线合成“智能体原生数据”\n\n构件\n\n关键思想\n\n技术要点\n\n解决痛点\n\n**FAS（First-order Action Synthesis）**\n\n零 API 成本生成“规划+推理”样本\n\n*   知识→实体→多风格问题自动生成\n*   每题采样 K 个不同风格变体，LLM 仅写“第一步”规划/工具调用\n*   用可访问的知识做 reject sampling，过滤语义不一致\n\n避免昂贵在线轨迹；提前注入规划与工具调用模式\n\n**HAS（High-order Action Synthesis）**\n\n把“整条轨迹”改写成“步级决策”对比样本\n\n*   对真实或合成轨迹的每一步，用 LLM 离线生成 N 条替代 thought+action\n*   构建“多选一”决策文本：给出选项→记录原选项索引→附加真实环境反馈→最后给二元成败标签\n\n充分利用次优轨迹；防止模型死记整条路径，学会“每一步如何做选择”\n\n**数据飞轮**\n\n后训练→失败/成功轨迹→回炉 HAS→再 CPT\n\n不断把新轨迹转为 HAS 数据，持续扩充 CPT 语料\n\n让“智能体归纳偏置”随数据滚雪球\n\n2\\. 两阶段 CPT 训练策略\n\n阶段\n\n数据\n\n上下文\n\n目标\n\n**Stage-1**\n\n200B tokens（FAS + 短 HAS）\n\n32K\n\n快速习得基础工具调用、短链推理\n\n**Stage-2**\n\n100B tokens（精选长 HAS）\n\n128K\n\n掌握长程规划、跨页信息整合与决策探索\n\n3\\. 后训练：轻量解锁\n\n用同一套“AgentFounder-Base”对接三种不同 SFT/RL 配方（SFT-A/B/C），均显著优于直接用原 Qwen3-Base 的对照组，证明**CPT 已把“智能体能力”预对齐**，后训练只需“解锁”而非“从零建构”。\n\n4\\. 效果验证\n\n*   **10 项基准全面领先**：BrowseComp-en 39.9%（+10% 超越最强开源 DeepSeek-V3.1），HLE 31.5%（首个>30 的开源模型），GAIA 72.8%，Frames 89.6% 等新 SOTA。\n*   **scaling law 成立**：1B→4B→30B 参数平均准确率 20.4%→32.7%→48.9%；0→315B tokens 对数增长，累计 +8.0% Pass@3。\n*   **通用工具能力不损**：ACEBench 70.0 vs Qwen3-30B-A3B 67.2，表明 CPT 未牺牲通用性。\n\n一句话总结\n\n论文**把“智能体对齐”从传统后训练搬到持续预训练**，用零 API 的 FAS/HAS 大规模合成“决策-反馈”式语料，先让基座模型内建工具调用与步级决策偏置，再轻量后训练，一举打破开源智能体性能瓶颈。\n\n**Q4**: 论文做了哪些实验？\n\n论文围绕 5 个研究问题（RQ1–RQ5）设计了 6 组实验，覆盖性能对比、适应性验证、训练策略消融、数据贡献消融、Scaling Law 与深入诊断，共涉及 10 个公开基准、3 类基线、3 种后训练配方，以及 1B→30B 参数与 0→315B token 的跨度。以下按 RQ 归纳：\n\nRQ1　AgentFounder 与 SOTA 的差距\n\n**实验**\n\n*   在 10 项基准上与 30 余个模型对比：  \n    – 通用搜索：BrowseComp-en/zh、GAIA、Xbench-DeepSearch、WebWalkerQA  \n    – 场景专用：HLE、DeepResearch-Bench、Frames、SEAL-0、AcademicBrowse\n*   单 agent、React 范式，统一 5 种工具（Search/Visit/Python/Google Scholar/File Parser）\n*   报告 Pass@1（主指标）与 Pass@3\n\n**结论**  \nAgentFounder-30B 全部刷新开源 SOTA，4 项超过商用 Deep Research/o3，首次把 HLE 开源成绩拉到 30+。\n\nRQ2　Agentic CPT 基座对后训练是否普适\n\n**实验**\n\n*   固定同一 CPT 基座（AgentFounder-30B-Base），分别用 3 套不同 SFT 数据（SFT-A/B/C）做后训练\n*   对比原始 Qwen3-30B-A3B-Base 在相同 3 套数据下的结果（BrowseComp-en/zh + GAIA + HLE）\n\n**结论**  \n3 组平均提升 5.75%、6.13%、6.45%，验证“预对齐基座”对任何后训练配方均稳定增益；信息检索类任务受益更大。\n\nRQ3　两阶段 CPT 策略是否必要\n\n**实验**\n\n*   控制总 token 50B，Qwen3-30B-A3B-Base 初始化  \n    – 单阶段：32K 上下文，长 HAS 被截断  \n    – 两阶段：Stage-1 32K → Stage-2 128K 完整长 HAS\n\n**结论**  \n两阶段平均 Pass@1 +3.3%、Pass@3 +3.7%，确认完整长序列学习不可替代。\n\nRQ4　FAS vs HAS 数据贡献\n\n**实验**\n\n*   50B token 单阶段：纯 FAS ↔ FAS+HAS 混合\n*   同一 SFT-A 后训练，测 BrowseComp-en/zh + GAIA\n\n**结论**  \n纯 FAS 已带来大幅提升；加入 HAS 后 BrowseComp-zh 再 +3.1%，GAIA Pass@3 +1.9%，显示互补价值。\n\nRQ5　Scaling Law（模型规模 & 数据规模）\n\n1.  **模型规模**\n    \n    *   1B、4B、30B-A3B 三档 CPT 后统一 SFT-A；与更大参数 DeepSeek-V3-1、Kimi-K2 比较\n    *   结果：参数-性能呈正相关，30B 达 48.9%，反超更大模型，证明 CPT 参数效率更高\n2.  **数据规模**\n    \n    *   0B→15B→50B→65B→210B→315B token 六档；65B/315B 启用 128K Stage-2\n    *   评估平均 Pass@3（对数坐标）\n    *   结果：对数律成立，前 15B 提升 3.8%；128K 阶段在 65B、315B 分别再 +1.8%、+1.0%，未见饱和\n\n深入诊断实验（ Beyond RQ ）\n\n主题\n\n设置\n\n关键发现\n\n**训练收敛性**\n\n同一 SFT 语料，对比 baseline 与 4 档 CPT 模型的交叉熵曲线\n\nCPT 模型 loss 全程更低，315B 版最终 loss ↓0.07，收敛更快更稳\n\n**工具调用模式**\n\n统计 HLE/BrowseComp/WebWalker/GAIA 的 tool-call 分布\n\n复杂任务呈重尾分布，简单任务集中低区间，模型能自适应调节探索深度\n\n**通用工具能力**\n\nACEBench（5 类工具 200+ 任务）\n\nAgentFounder-30B 70.0 vs Qwen3-30B-A3B 67.2，CPT 未牺牲通用性\n\n**MoE 激活**\n\nBrowseComp-zh 最后一 token 的 top-8 expert 权重\n\nCPT 后 expert 使用更均衡，缓解“死专家”与过拟合\n\n**工具轮次 vs 准确率**\n\n按 tool-turn 分组统计成功率\n\n≤8 轮准确率最高；0 轮反而下降；≥40 轮仍保持 17.5% 成功率，显示长程探索能力\n\n**Pass@N scaling**\n\nBrowseComp-en 温度采样 N=1–18\n\nPass@1 31.5% → Pass@16 75.8%，增益 44.3%，表明 HAS 训练有效保留多样性\n\n一句话总结\n\n实验从“宏观性能”到“微观行为”层层递进，既证明 Agentic CPT 对模型规模与数据规模均服从有利 scaling，又通过消融与诊断阐明两阶段训练、FAS/HAS 数据以及步级决策建模各自带来的具体增益。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下可探索方向按“数据-模型-训练-评测-系统”五层归纳，均直接对应论文尚未充分展开或尚未触及的空白点。\n\n1\\. 数据层\n\n*   **多语言/跨文化智能体 CPT**  \n    BrowseComp-zh 仍落后 o3 15%，部分归因于中文语料占比低。可系统构建“多语言实体-知识内存”并验证 CPT 阶段语言迁移与工具调用迁移的耦合关系。\n    \n*   **多模态行动合成**  \n    本文 FAS/HAS 仅文本。将“截图-定位-点击/滚动”等 GUI 动作统一为 token 序列，离线合成视觉-动作块，考察 CPT 能否内建“视觉-行动”归纳偏置。\n    \n*   **可验证任务反向生成**  \n    对数学证明、代码竞赛等可自动判分场景，用“答案→问题”逆向生成 + 难度滤波，构建规模更大、质量自保障的 CPT 语料。\n    \n\n2\\. 模型层\n\n*   **MoE 专家分工显式化**  \n    初步实验显示 CPT 后专家激活更均衡。可加入“专家路由正则化”或“工具专属专家”约束，检验是否进一步降低工具冲突与灾难性遗忘。\n    \n*   **小参数高效 CPT**  \n    1B→4B 提升显著但绝对值仍低。尝试 LoRA/ MoE-Offloading/continual-distillation，把 30B 的 HAS 决策知识蒸馏至 1–3B，探索“边缘设备可用”的深度研究模型。\n    \n*   **基座-工具联合 Tokenizer**  \n    工具调用片段（JSON/URL/Python）当前用通用 BPE 切分，符号冗余。设计“工具感知的 SentencePiece”或“动作字节对编码”，减少 15–20% 长度，提升长程规划容量。\n    \n\n3\\. 训练层\n\n*   **在线 HAS-RL 混合**  \n    本文 HAS 完全离线。可在 RL 阶段实时把新轨迹即时转为 HAS 样本并回灌 CPT，形成“在线决策→离线 CPT→在线 RL”的闭环，实现持续自我改进。\n    \n*   **课程式 CPT**  \n    按“单步工具→多步推理→跨页综合→抗干扰”四级课程递增难度，监测是否出现“能力突跃”及对应隐状态几何变化，解释智能体能力的涌现机制。\n    \n*   **上下文长度外推**  \n    Stage-2 仅 128K。尝试 PI/NTK/YaRN 等免训练外推至 512K，验证超长报告生成是否仍符合对数 scaling 或出现新瓶颈。\n    \n\n4\\. 评测层\n\n*   **私有环境可复现基准**  \n    现有基准依赖公开网页，随时间漂移。构建“快照式 Docker 环境 + 录制回放”工具，保证一年后实验仍可复现，解决结果可比性问题。\n    \n*   **智能体能力细粒度剖析**  \n    将单次轨迹拆成“规划-检索-去噪-整合-写作”五环节，分别标注错误类型，建立细粒度诊断工具，定位 CPT 在哪一环节增益最大。\n    \n*   **对抗与误导评测**  \n    系统注入“假源-冲突-钓鱼页”三级对抗，量化 CPT 对安全性的副作用；若出现下降，可在 HAS 中引入“安全选项”对比样本，实现攻防联合优化。\n    \n\n5\\. 系统与产品层\n\n*   **端-云协同深度研究**  \n    端侧 3B 小模型负责本地隐私检索 + 初步过滤；云侧 30B 模型执行重推理。设计“端云一致性 CPT”数据配比，兼顾延迟、隐私与效果。\n    \n*   **个性化 CPT**  \n    允许用户上传私有笔记/邮件/文献，本地增量 CPT 形成“个人知识-行动记忆”，再与通用模型融合，实现“个人研究助理”而不泄露数据。\n    \n*   **可解释决策接口**  \n    将 HAS 中的“选项-反馈-判断”结构暴露为前端调试面板，用户可实时编辑候选动作并观察模型置信度变化，提升可解释性与可控性。\n    \n\n6\\. 理论层\n\n*   **智能体归纳偏置的度量**  \n    定义“工具调用熵”“决策一致性”等指标，量化不同 CPT 数据对策略空间分布的影响，建立“预训练 ↔ 策略空间”的可计算映射。\n    \n*   **Scaling Law 统一公式**  \n    将参数规模、数据规模、上下文长度、工具数、任务难度五变量纳入同一幂律模型，预测达到指定性能所需资源，指导未来算力分配。\n    \n\n总结\n\n论文首次验证了“智能体能力可前移到 CPT”，但留下语言-视觉-行动统一、在线持续学习、高效小模型、安全性与个性化等广阔空白。上述方向既可直接放大现有优势，也可提前布局下一代“通用智能体基础模型”。\n\n**Q6**: 总结一下论文的主要内容\n\n论文主旨\n====\n\n开源深度研究智能体普遍落后于闭源产品，根因是通用基础模型缺乏“智能体归纳偏置”，导致后训练阶段必须同时学习“能力”与“对齐”，优化目标冲突。为此，论文首次提出把智能体能力前移——**Agentic Continual Pre-training（Agentic CPT）**，用大规模离线合成数据在基座模型中预先植入工具调用与多步决策模式，再轻量后训练即可释放性能。\n\n1\\. 方法框架\n--------\n\n模块\n\n要点\n\n作用\n\n**FAS**（一阶行动合成）\n\n零API生成<问题, 规划, 首步调用>与<问题, 子问题, 逻辑推理>；知识对齐过滤\n\n注入规划与推理原型\n\n**HAS**（高阶行动合成）\n\n对真实/合成轨迹每步离线采样N条候选thought+action，构建“多选一→反馈→成败”对比文本\n\n把轨迹模仿转为步级决策学习，充分利用次优轨迹\n\n**两阶段CPT**\n\nStage-1：200B token/32K上下文（FAS+短HAS）  \nStage-2：100B token/128K上下文（精选长HAS）\n\n先习得基础行为，再扩展长程规划与深度整合能力\n\n2\\. 实验与结果\n---------\n\n*   **10基准全面评估**（BrowseComp-en/zh、GAIA、HLE、Frames等）  \n    – AgentFounder-30B 全部刷新开源SOTA，4项超商用产品（HLE首次>30）。\n*   **适应性验证**  \n    – 同一CPT基座用3套不同SFT数据，后训练平均提升+6%左右，证明“预对齐”普适。\n*   **消融与Scaling**  \n    – 两阶段训练Pass@1平均+3.3%；FAS+HAS混合相比纯FAS再提升；1B→30B参数、0→315B token均呈对数scaling，累计+8.0%。\n*   **深入诊断**  \n    – CPT模型SFT收敛更快；工具调用分布自适应任务难度；通用工具基准ACEBench不降反升；MoE专家激活更均衡。\n\n3\\. 贡献清单\n--------\n\n1.  首次提出Agentic CPT范式，把智能体能力从后训练移到持续预训练。\n2.  设计零API、可扩展的FAS/HAS数据合成与两阶段训练策略。\n3.  开源模型AgentFounder-30B在10项基准取得新SOTA，验证CPT对参数与数据规模的良好scaling。\n4.  证明CPT基座可通用于不同后训练配方，且不损失通用工具能力，为构建更强通用智能体奠定基础。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Scaling%20Agents%20via%20Continual%20Pre-training，链接是  https://arxiv.org/pdf/2509.13310  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.13310  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-2-1758152840086","title":"WebSailor-V2: Bridging the Chasm to Proprietary Agents via Synthetic Data and Scalable Reinforcement Learning","description":"Transcending human cognitive limitations represents a critical frontier in LLM training. Proprietary agentic systems like DeepResearch have demonstrated superhuman capabilities on extremely complex information-seeking benchmarks such as BrowseComp, a feat previously unattainable. We posit that their success hinges on a sophisticated reasoning pattern absent in open-source models: the ability to systematically reduce extreme uncertainty when navigating vast information landscapes. Based on this insight, we introduce WebSailor, a complete post-training methodology designed to instill this crucial capability. Our approach involves generating novel, high-uncertainty tasks through structured sampling and information obfuscation, RFT cold start, and an efficient agentic RL training algorithm, Duplicating Sampling Policy Optimization (DUPO). With this integrated pipeline, WebSailor significantly outperforms all open-source agents in complex information-seeking tasks, matching proprietary agents' performance and closing the capability gap.","url":"https://huggingface.co/papers/2509.13305","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.086Z","metadata":{"authors":["Kuan Li","Zhongwang Zhang","Huifeng Yin","Rui Ye","Yida Zhao","Liwen Zhang","Litu Ou","Dingchu Zhang","Xixi Wu","Jialong Wu","Xinyu Wang","Zile Qiao","Zhen Zhang","Yong Jiang","Pengjun Xie","Fei Huang","Jingren Zhou"],"date":"","rank":3,"llmAnalysis":"","categories":["cs.LG","cs.CL"],"pdfUrl":"https://arxiv.org/pdf/2509.13305.pdf","arxivUrl":"https://arxiv.org/abs/2509.13305","arxivId":"2509.13305","coolPaperUrl":"https://papers.cool/arxiv/2509.13305","published":"2025-09-16T17:57:03Z","updated":"2025-09-16T17:57:03.000Z","zh_summary":"超越人类认知局限性代表了大语言模型训练中的一个重要前沿。像DeepResearch这样的专有智能系统在极其复杂的信息检索基准测试（如BrowseComp）上展示了超人类的能力，这一成就是之前无法实现的。我们认为，它们的成功依赖于一种在开源模型中缺失的复杂推理模式：在浩瀚的信息领域中系统地减少极端不确定性的能力。基于这一见解，我们引入了WebSailor，这是一种完整的后续训练方法，旨在培养这一关键能力。我们的方法涉及通过结构化抽样和信息模糊、RFT冷启动，以及高效的智能强化学习训练算法——重复抽样策略优化（DUPO）来生成新颖且高不确定性的任务。通过这条集成管道，WebSailor在复杂的信息检索任务中显著超越所有开源代理，达到与专有代理相当的表现，并缩小能力差距。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文旨在弥合开源网络智能体与闭源（专有）系统之间的性能鸿沟，核心目标可概括为：\n\n*   **数据层面**：现有训练数据对“不确定性”的定义过于单一（多为简单遮蔽），导致模型难以泛化到真实研究中复杂、模糊的问题。为此提出 SailorFog-QA-V2，通过稠密知识图谱引入循环、反馈等复杂拓扑，并扩展多种不确定性类型，以激发更高级的多步推理。\n    \n*   **训练层面**：缺乏可扩展且稳定的强化学习环境。高频调用真实网络 API 会带来高成本、高延迟、返回不一致等噪声，污染训练信号。为此设计“双环境”RL 框架：\n    \n    *   高保真模拟器：基于离线维基库，支持低成本、高并发、可复现的算法迭代；\n    *   托管真实环境：统一工具接口与容错机制，保证最终策略训练稳定。\n*   **系统层面**：将数据构造与 RL 训练纳入共生反馈闭环，利用训练动态实时合成并过滤高质量数据，实现数据-策略协同演化。\n    \n\n综上，论文试图用“高质量合成数据 + 可扩展双环境 RL”这一完整后训练流水线，让 30 B 级开源模型在 BrowseComp、HLE 等严苛基准上首次逼近甚至超越 671 B 闭源模型的深度研究能力。\n\n**Q2**: 有哪些相关研究？\n\n论文在“Related Work”章节（附录 A）将近期进展归纳为三大主线，并指出自身与它们的区别。核心相关研究如下：\n\n1.  数据构造\n    \n    *   图驱动范式  \n        – WebSailor (SailorFog-QA)  \n        – 本文 SailorFog-QA-V2：引入稠密循环拓扑、多类不确定性，覆盖更复杂逻辑关系\n    *   易→难迭代范式  \n        – WebShaper、ASearcher、WebExplorer：从单种子问题逐步扩展，生成树状结构\n    *   共同手段：在线调用真实网络工具、引入“遮蔽”不确定性；本文扩展了不确定性定义并提升结构多样性\n2.  训练策略\n    \n    *   通用两阶段流程：SFT 冷启动 → RL 精调\n    *   RL 算法：GRPO 及其变体（DAPO、Dr-GRPO 等）\n    *   本文观点：算法细节并非瓶颈，数据质量与训练环境稳定性才是关键因素；因此重点构建高保真模拟器与托管真实环境\n3.  推理范式\n    \n    *   基础 ReAct：WebSailor、WebShaper 采用标准 ReAct，保持最小框架约束\n    *   上下文工程：ASearcher、Kimi-Researcher、UI-TARS-2 等在 ReAct 之上做复杂上下文管理或 GUI 模态\n    *   本文选择：坚持 vanilla ReAct，以隔离模型本身能力，避免提示工程带来的混淆\n\n综上，WebSailor-V2 在数据复杂度、训练环境工程与系统级闭环三方面相对既有研究做了针对性增强，从而首次让开源 30 B 级智能体在深度研究基准上与 671 B 闭源模型竞争。\n\n**Q3**: 论文如何解决这个问题？\n\n论文将“开源网络智能体与闭源系统性能鸿沟”这一核心问题拆解为**数据**与**训练**两大瓶颈，并给出一条可落地的完整后训练流水线。具体解法可归纳为三大模块、六个关键步骤：\n\n1\\. 数据层：构造高密度、多不确定性知识图谱\n\n步骤\n\n关键做法\n\n目的\n\n① 稠密知识图谱构建\n\n以种子实体为起点，用搜索/浏览工具主动“回环”连接节点，刻意生成**循环、反馈**等复杂拓扑，而非树状结构。\n\n覆盖真实世界非线性知识依赖。\n\n② 随机游走子图采样\n\n对稠密图做**随机游走+Weisfeiler-Leman 去同构**，避免组合爆炸。\n\n高效获得结构多样的训练子图。\n\n③ 多类型不确定性 QA 生成\n\n在子图节点上引入**遮蔽、数值区间、时序模糊、关系缺失**等 8+ 种不确定性模板，按节点轨道均匀分布问题焦点。\n\n逼迫模型进行**假设-验证-综合**式深度推理，而非关键词匹配。\n\n2\\. 训练层：双环境 RL 框架\n\n步骤\n\n关键做法\n\n目的\n\n④ 高保真模拟器\n\n基于**离线维基全量 dump**自建搜索引擎+页面摘要+代码沙盒，返回格式与真实 API 完全一致；可**百万级并发、零成本、可复现**。\n\n快速做算法消融、超参扫描、数据策展，**把“试错”成本降到接近零**。\n\n⑤ 托管真实环境\n\n对真实 SerpAPI、Jina、Google Scholar 等做**统一调度层**：QPS 限速、缓存、重试、降级、热备切换，保证**工具返回确定性**。\n\n消除外部 API 随机性，使 RL 训练信号**不被噪声污染**，实现稳定收敛。\n\n3\\. 系统层：数据-策略共生闭环\n\n步骤\n\n关键做法\n\n目的\n\n⑥ 动态数据合成与过滤\n\n在 RL 训练过程中，**实时**用当前最优策略 rollout→筛选高价值轨迹→回流到训练池，同步淘汰低质量或重复样本；闭环周期**分钟级**。\n\n让训练分布随策略能力**同步右移**，持续提供“可学习”的 OOD 样本，避免过拟合早期数据。\n\n算法细节（GRPO 变体）\n\n*   **token 级策略梯度** + **leave-one-out 基线**降低方差\n*   **保守负样本过滤**：丢弃“超长未输出答案”等噪声轨迹，防止格式崩塌\n*   **纯 on-policy**：不用经验回放，保证数据分布与策略始终匹配\n\n结果验证\n\n*   仅用 30 B MOE（Qwen3-30B-A3B）就在 BrowseComp-EN 取得 **35.3**，HLE **30.6**，显著超越 671 B DeepSeek-V3.1 与一众闭源系统。\n*   消融显示：SFT 冷启动→RL 提升 **+10.9**（BrowseComp-EN），且模拟器与真实环境联合训练比单环境**平均再提 3–5 分**。\n\n通过“高密度合成数据 + 双环境稳定 RL + 实时数据闭环”三位一体方案，论文首次在**不增大模型参数**的前提下，把开源智能体的深度研究能力推到与顶级闭源系统同档。\n\n**Q4**: 论文做了哪些实验？\n\n实验围绕两条主线展开：\n\n1.  在公开基准上验证 **WebSailor-V2-30B-A3B** 的最终性能；\n2.  通过受控消融与诊断实验，揭示 **数据、环境、算法** 各组件对结果的具体贡献。\n\n1\\. 主基准评测（零样本 pass@1）\n\n基准\n\n测试能力\n\n结果（SFT → RL）\n\n对比亮点\n\n**BrowseComp-EN**\n\n英文深度浏览 & 多跳推理\n\n24.4 → **35.3**\n\n超越 671 B DeepSeek-V3.1（30.0）\n\n**BrowseComp-ZH**\n\n中文同能力\n\n28.3 → **44.1**\n\n领先所有开源/闭源模型\n\n**xbench-DeepSearch**\n\n专业领域检索\n\n61.7 → **73.7**\n\n高于 GPT-4 系列\n\n**GAIA**（文本子集）\n\n多工具通用助手\n\n66.0 → **74.1**\n\n与 Gemini-2.5-pro 持平\n\n**Humanity’s Last Exam**\n\n博士级学科综合\n\n23.9 → **30.6**\n\n刷新 SoTA（原 29.8）\n\n**DeepResearch Bench**\n\n研究报告生成+检索\n\n—\n\n**48.9**（仅次于 Gemini-2.5-pro 49.7）\n\n2\\. 消融与诊断实验\n\n2.1 训练阶段消融\n\n*   **仅 SFT**：已在 BrowseComp-EN 拿到 24.4，超过多数开源“完整”模型，证明冷启动数据质量高。\n*   **SFT → 模拟器 RL → 真实环境 RL**：每步平均绝对提升 **+6~8 分**，显示双环境策略有效。\n\n2.2 数据质量对比\n\n*   用 **BrowseComp 训练集**直接做 RL（人类标注）：BrowseComp-EN 降至 18.7，验证“小规模人工数据分布不一致→反噬性能”。\n*   用 **SailorFog-QA-V2 合成数据**：同预算下提升 **+10.9**，证实大规模、分布一致数据是关键。\n\n2.3 环境稳定性消融\n\n*   关闭“统一调度层”（真实 API 随机失败）：训练 200 步后奖励震荡，**最终精度下降 4.2 分**。\n*   开启容错层：奖励曲线平滑，**方差降低 37 %**。\n\n2.4 算法组件消融\n\n组件\n\n移除后下降\n\n说明\n\nleave-one-out 基线\n\n−2.4\n\n方差增大，更新噪声变高\n\n保守负样本过滤\n\n−3.1\n\n出现格式崩塌，答案停止符丢失率 ↑\n\ntoken 级优势估计\n\n−1.8\n\nstep-level 估计导致稀疏奖励信号稀释\n\n2.5 规模与预算实验\n\n*   **上下文长度**：32 k → 128 k，BrowseComp-EN 准确率 **16 → 35**；64 k 后边际收益趋零。\n*   **工具调用预算**：10 → 100 次，性能 **∝ 对数增长**，90 % 正确案例 ≤ 60 次调用，验证数据效率。\n\n2.6 熵与训练动态\n\n*   策略熵全程维持 **0.8–1.1**，无显式正则化即可保持探索，说明网页环境非平稳性天然抑制过早收敛。\n*   困难任务（BrowseComp）pass@1 与 pass@3 **同步上升**，表明 RL 真正扩展了解空间；简单任务（GAIA）仅 pass@1 提升，体现 RL 主要优化“首采成功率”。\n\n3\\. 可视化案例研究\n\n*   在 BrowseComp-EN 选取 **29 步轨迹**，展示“线索分解→失败重定向→黄金线索锁定→系统验证→综合回答”完整人类式研究流程，进一步定性说明模型能力来源。\n\n实验结论\n\n1.  高质量合成数据（SailorFog-QA-V2）+ 稳定双环境 RL 是性能跃迁的决定性组合；\n2.  算法技巧虽有效，但**数据分布一致性与环境鲁棒性**对最终分数影响更大；\n3.  30 B MOE 在 128 k 上下文与 100 步工具预算下即可逼近 671 B 闭源模型，验证“小而精”的智能体范式可行。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下展望按“**数据→环境→算法→系统→评测**”五个层次整理，均为论文尚未深入或尚未涉及的开放问题，可直接作为后续工作切入点。\n\n1\\. 数据层\n\n*   **跨语言知识图谱对齐**  \n    当前 SailorFog-QA-V2 以中英为主，可扩展至多语种同构子图，考察智能体在跨语言迁移与多源事实融合上的能力。\n    \n*   **动态时效性数据**  \n    离线维基快照存在“时间漂移”，可引入**增量时间窗口图**，让模型学会判断信息失效、追踪事实演变。\n    \n*   **对抗性不确定性**  \n    现有 8 种不确定性仍为“善意”模糊。可主动注入**矛盾来源、恶意 SEO、钓鱼页面**，训练模型对错误信息的鲁棒性。\n    \n\n2\\. 环境层\n\n*   **可微分模拟器**  \n    将搜索排序、页面摘要抽象为**可微分组件**，实现梯度反向传播，减少真实环境采样成本，实现“模拟即训练”。\n    \n*   **多模态环境**  \n    扩展至**PDF/图表/视频**解析，构建视觉-文本混合工具，支持科研文献中的图表推理、实验复现。\n    \n*   **个人化私有环境**  \n    允许智能体访问用户本地文件、邮箱、数据库，探索**隐私安全约束下的强化学习**（联邦 RL、差分隐私奖励）。\n    \n\n3\\. 算法层\n\n*   **分层抽象动作空间**  \n    当前动作是原子级（search/visit/code）。可引入**高层“子任务”动作**（如“先做文献综述”），用选项框架（Option-Critic）自动学习子策略。\n    \n*   **离线→在线混合 RL**  \n    先在大规模离线轨迹上做**离线 RL（如 Decision Transformer）**，再切到在线 fine-tune，兼顾样本效率与探索。\n    \n*   **奖励塑形自动化**  \n    现有奖励仅基于最终答案正确性。可用**LLM-as-a-Judge 细粒度打分**（相关性、引用准确率、逻辑一致性）并在线学习奖励模型，缓解稀疏奖励。\n    \n\n4\\. 系统层\n\n*   **数据-策略双循环扩缩**  \n    把“数据合成↔RL 训练”封装成**Kubernetes-native 工作流**，根据 GPU/CPU 资源弹性扩缩，实现**24×7 持续自我改进**。\n    \n*   **异构算力调度**  \n    模拟器跑 CPU 集群，真实环境跑 GPU+API 配额，用**强化学习本身调度**“何时用模拟、何时用真实”，最小化成本。\n    \n*   **可解释轨迹审计**  \n    对百万级 rollout 建立**图数据库索引**，支持事后追溯“哪条网页片段导致错误结论”，方便人工审计与安全对齐。\n    \n\n5\\. 评测与风险\n\n*   **开放域红队评测**  \n    构建**自动红队智能体**，专门投放虚假、误导、违法信息，测试目标智能体是否生成有害或错误结论。\n    \n*   **长周期经济影响评测**  \n    设计**7 天-30 天超长任务**（如完整撰写一篇可发表的综述），衡量模型在**持续规划、预算控制、学术伦理**上的表现。\n    \n*   **能源-性能权衡基准**  \n    记录每任务**焦耳/答案**能耗，推动“绿色智能体”研究；探索在**边缘设备**上部署小模型的可行性。\n    \n\n6\\. 理论问题\n\n*   **工具增强模型的 scaling law**  \n    固定参数规模，仅增加工具数量/上下文长度，拟合  \n    $$, \\\\text{Accuracy} \\\\propto (C^\\\\alpha \\\\cdot T^\\\\beta \\\\cdot P^\\\\gamma),$$  \n    其中 C=上下文，T=工具调用预算，P=参数，探索\\*\\*“工具-上下文-参数”三维最优配比\\*\\*。\n    \n*   **探索-利用的非平稳边界**  \n    网页内容分布随时间变化，给出**非平稳遗憾界**，指导何时重置策略或触发再训练。\n    \n\n一句话总结\n\nWebSailor-V2 验证了“合成数据+双环境 RL”的可行性，但要把网络智能体推向**多模态、长周期、可解释、可持续**的下一阶段，仍需在**跨语言时效图谱、可微分/可扩展环境、自动奖励塑形、系统级自我改进循环**以及**面向安全与绿色的新评测体系**上持续深耕。\n\n**Q6**: 总结一下论文的主要内容\n\n论文提出 **WebSailor-V2**，一条端到端的后训练流水线，用于把开源 30 B 规模模型推向闭源级“深度研究”性能。核心内容可概括为 **“一个数据集、双环境 RL、三大验证”**：\n\n1\\. 数据集：SailorFog-QA-V2\n\n*   **稠密知识图谱**：主动引入循环、反馈等复杂拓扑，替代传统树状扩展。\n*   **随机游走采样**：高效覆盖所有结构模式，避免组合爆炸。\n*   **多类型不确定性**：遮蔽、数值区间、时序模糊等 8+ 模板，迫使模型做多步假设-验证-综合推理。\n\n2\\. 训练：双环境强化学习\n\n环境\n\n作用\n\n关键技术\n\n**模拟器**\n\n高频、低成本算法迭代\n\n离线维基 dump + 高保真工具接口，百万并发零成本\n\n**真实环境**\n\n最终策略收敛\n\n统一调度层：限速、缓存、重试、降级，保证工具返回确定性\n\n**共生闭环**\n\n数据-策略共同进化\n\n实时用当前策略合成并过滤新轨迹，训练分布随模型能力右移\n\n**算法**：token 级 GRPO + leave-one-out 基线 + 保守负样本过滤，纯 on-policy 训练。\n\n3\\. 验证：三大层级实验\n\n1.  **主基准**  \n    BrowseComp-EN 35.3、ZH 44.1、HLE 30.6、xbench-DS 73.7，均刷新开源记录，**30 B 超越 671 B DeepSeek-V3.1**。\n    \n2.  **消融与诊断**\n    \n    *   模拟器+真实环境联合训练比单环境再 **+4~6 分**\n    *   合成数据比直接用人工标注训练集 **+10.9 分**\n    *   上下文 32 k→128 k 带来 **~19 分** 增幅，90 % 正确案例 ≤ 64 k\n3.  **定性案例**  \n    29 步 BrowseComp 轨迹展示“线索分解→失败重定向→黄金线索→系统验证→综合回答”的完整人类式研究流程。\n    \n\n结论\n\nWebSailor-V2 首次证明：**高质量合成数据 + 稳定双环境 RL** 即可让中等规模开源模型在深度研究任务上媲美顶级闭源系统，为社区提供了可复现、可扩展的完整后训练范式。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是WebSailor-V2%3A%20Bridging%20the%20Chasm%20to%20Proprietary%20Agents%20via%20Synthetic%20Data%20and%20Scalable%20Reinforcement%20Learning，链接是  https://arxiv.org/pdf/2509.13305  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.13305  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-3-1758152840086","title":"Towards General Agentic Intelligence via Environment Scaling","description":"Advanced agentic intelligence is a prerequisite for deploying Large Language Models in practical, real-world applications. Diverse real-world APIs demand precise, robust function-calling intelligence, which needs agents to develop these capabilities through interaction in varied environments. The breadth of function-calling competence is closely tied to the diversity of environments in which agents are trained. In this work, we scale up environments as a step towards advancing general agentic intelligence. This gives rise to two central challenges: (i) how to scale environments in a principled manner, and (ii) how to effectively train agentic capabilities from experiences derived through interactions with these environments. To address these, we design a scalable framework that automatically constructs heterogeneous environments that are fully simulated, systematically broadening the space of function-calling scenarios. We further adapt a two-phase agent fine-tuning strategy: first endowing agents with fundamental agentic capabilities, then specializing them for domain-specific contexts. Extensive experiments on agentic benchmarks, tau-bench, tau2-Bench, and ACEBench, demonstrate that our trained model, AgentScaler, significantly enhances the function-calling capability of models.","url":"https://huggingface.co/papers/2509.13311","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.086Z","metadata":{"authors":["Runnan Fang","Shihao Cai","Baixuan Li","Jialong Wu","Guangyu Li","Wenbiao Yin","Xinyu Wang","Xiaobin Wang","Liangcai Su","Zhen Zhang","Shibin Wu","Zhengwei Tao","Yong Jiang","Pengjun Xie","Fei Huang","Jingren Zhou"],"date":"","rank":4,"llmAnalysis":"","categories":["cs.CL"],"pdfUrl":"https://arxiv.org/pdf/2509.13311.pdf","arxivUrl":"https://arxiv.org/abs/2509.13311","arxivId":"2509.13311","coolPaperUrl":"https://papers.cool/arxiv/2509.13311","published":"2025-09-16T17:57:20Z","updated":"2025-09-16T17:57:20.000Z","zh_summary":"高级代理智能是将大型语言模型应用于实际应用的前提条件。多样化的实际API要求精确、强大的函数调用智能，这需要代理通过在各种环境中的互动来发展这些能力。函数调用能力的广度与代理培训的环境多样性密切相关。在这项工作中，我们扩大环境规模，以推动一般代理智能的进步。这带来了两个核心挑战：（i）如何以原则性的方式扩展环境，以及（ii）如何有效地从与这些环境的互动中训练代理能力。为了解决这些问题，我们设计了一个可扩展的框架，自动构建完全模拟的异构环境，系统地拓宽函数调用场景的空间。我们进一步调整了一个两阶段的代理微调策略：首先赋予代理基本的代理能力，然后将其专业化为特定领域的上下文。在代理基准测试tau-bench、tau2-Bench和ACEBench上进行的大量实验表明，我们训练的模型AgentScaler显著增强了模型的函数调用能力。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文旨在突破“大模型具备函数调用能力却缺乏可扩展训练环境”的瓶颈，系统性地回答两个核心问题：\n\n1.  如何**可扩展、自动化地构建多样化、可验证的函数调用环境**；\n2.  如何**利用这些环境产生的高质量经验轨迹，高效训练出通用且鲁棒的智能体**。\n\n最终目标是在不依赖人工标注或真实 API 的前提下，让参数规模相对较小的模型也能获得与闭源大模型媲美的通用智能体能力。\n\n**Q2**: 有哪些相关研究？\n\n论文将相关研究划分为两大主线，并在第 6 章系统综述。下表按“环境构建”与“工具学习”两大维度，对代表性文献进行归纳（均可在原文 §6.1–§6.2 找到对应引用）。\n\n研究方向\n\n关键问题 / 局限\n\n代表性工作\n\n与本文差异\n\n**Tool-Use Environments**\n\n真实环境调用\n\n高成本、低可用、难并行\n\nToolBench (Qin et al. 2023), RestGPT (Song et al. 2023), Mastouri et al. 2025\n\n本文用**完全模拟**替代真实调用，实现零成本、可验证\n\nLLM 模拟响应\n\n幻觉、不一致、难验证\n\nQin et al. 2024, Lu et al. 2024, Sun et al. 2025\n\n本文将工具**程序化落地为数据库读写**，保证确定性反馈\n\n离线状态环境\n\n手工搭建、难扩展、主要用于评测\n\nτ-bench (Yao et al. 2024), τ2-bench (Barres et al. 2025), ToolSandbox (Lu et al. 2024)\n\n本文提出**工具图采样+规则验证**的自动扩缩方案，实现训练级规模\n\n**Tool Learning**\n\n大规模合成数据\n\n依赖人工设计或反向生成，环境固定\n\nxLAM (Prabhakar et al. 2025a), ToolAce (Liu et al. 2024a), API-Gen (Liu et al. 2024b)\n\n本文**前向模拟人-机交互**，环境随工具图自动增长\n\n偏好 / RL 优化\n\n需要稳定环境提供奖励\n\nDiaTool-DPO (Jung et al. 2025), Tool-RL (Qian et al. 2025), Tool-N1 (Zhang et al. 2025)\n\n本文构建的**可验证模拟器**天然适配后续 RL 训练（留作未来工作）\n\n小模型agent趋势\n\n参数<30B 的专用模型\n\nBelcak et al. 2025, AgentScaler-4B/8B\n\n本文证明**环境扩缩**即可让 4B 模型逼近 30B~1T 水平\n\n综上，本文首次将“环境可扩展性”作为独立变量提出，并通过**全自动工具图聚类→数据库程序化→可验证轨迹过滤**的闭环，填补了“可扩展环境”与“高质量经验”之间的空白，从而支撑小参数模型实现通用智能体能力。\n\n**Q3**: 论文如何解决这个问题？\n\n论文提出一条“两阶段”端到端 pipeline，把**环境可扩展构建**与**经验驱动训练**解耦又协同，系统性地解决“缺数据、缺环境”难题。核心步骤如下：\n\n1\\. 环境可扩展构建（§2）\n\n步骤\n\n关键机制\n\n技术细节\n\n解决痛点\n\n**① 工具采集**\n\n30 k+ API 池\n\n合并 ToolBench / API-Gen / 内部库，重写缺失的 I/O 规格\n\n覆盖度不足\n\n**② 工具图建模**\n\n参数语义相似 + Louvain 社区发现\n\n$\\\\text{edge}\\_{i,j}=𝟙\\[\\\\cos(\\\\phi(P\\_i),,P\\_j)!>!\\\\tau\\]$  \n再让 LLM 二次精修边\n\n人工划分领域成本高\n\n**③ 数据库程序化**\n\n每领域自动生成 schema → Python 函数\n\n$\\\\texttt{API}(f,\\\\alpha)\\\\equiv \\\\text{op}(f)(\\\\alpha;\\\\mathcal{D})$\n\n环境无法验证、难复现\n\n**④ 任务采样**\n\n有向工具图上随机游走 → 可执行序列\n\n同步生成初始 $\\\\mathcal{D}\\_0$ 与参数，保证读写链逻辑一致\n\n轨迹缺乏真实性与可检查性\n\n结果：得到 **\\>1 000** 个完全模拟、可验证、可并行扩张的领域环境，无需人工维护。\n\n2\\. 经验采集与过滤（§3.1）\n\n阶段\n\n策略\n\n粒度\n\n保留信号\n\n**有效性过滤**\n\n去重复、去死循环\n\n轨迹级\n\n交替格式正确\n\n**状态对齐**\n\n最终 $\\\\mathcal{D}\\_\\\\text{final}$ 与金标准比对\n\n环境级\n\n写操作正确性\n\n**精确匹配**\n\n工具+参数序列完全命中\n\n调用级\n\n读链也能被监督\n\n通过三层漏斗，**~45 %** 轨迹被保留，形成高质量经验池。\n\n3\\. 两阶段经验学习（§3.2）\n\n阶段\n\n目标\n\n数据混合\n\n损失设计\n\n**Stage-1 通用能力**\n\n何时/如何调用、如何把工具输出说人话\n\n跨领域全量轨迹\n\n$\\\\mathcal{L}\\_{\\\\theta}=-\\\\frac{1}{\n\n**Stage-2 垂直特化**\n\n领域上下文、参数格式、业务措辞\n\n目标域轨迹 + 10 % 通用数据防遗忘\n\n同上，但 LR 更小、步数更少\n\n两阶段均在**自构模拟环境**里完成，零真实 API 调用。\n\n4\\. 产出 AgentScaler 模型族\n\n*   **4 B / 8 B / 30B-A3B** 三档规模，基于 Qwen3 系列初始化\n*   在 **τ-bench、τ²-bench、ACEBench** 上刷新 ≤1 T 开源模型 SOTA，4 B 参数即可对标 30 B；30B-A3B 与 GPT-4o、Gemini-2.5-pro 打平。\n\n5\\. 可扩展性保证\n\n工具图、数据库 schema、轨迹采样、过滤规则全部**代码化、参数化**，新增 API 只需：\n\n1.  插入工具池 → 自动重跑社区发现\n2.  生成新 schema → 自动得到可执行函数\n3.  继续采样-过滤-训练\n\n实现“环境即数据工厂”的线性扩展。\n\n**Q4**: 论文做了哪些实验？\n\n实验围绕“环境可扩展→经验质量→模型性能”链条展开，覆盖**3 个公开基准、4 组对比、5 类分析**，共 6 项核心实验，全部结果可复现（代码与数据已开源）。\n\n1 主评测：三大基准全面刷榜\n\n基准\n\n领域\n\n指标\n\n对照组\n\n关键结论\n\n**τ-bench**\n\nretail + airline\n\npass@1\n\n20+ 闭/开源模型\n\nAgentScaler-30B-A3B 达 **70.4 / 54.0**，持平 GPT-4o，刷新 ≤1 T 开源最佳\n\n**τ²-bench**\n\n\\+ telecom\n\npass@1\n\n同上\n\n加权平均分 **62.5**，领先次优开源模型 17+ 分\n\n**ACEBench-en**\n\nNormal / Special / Agent\n\naccuracy\n\n同上\n\nOverall **75.7**，4 B 版本即超 Qwen3-30B-A3B 基线 8.5 分\n\n2 消融实验：两阶段训练必要性\n\n*   在 ACEBench-en 上对比\n    *   Base 模型\n    *   Stage-1 仅通用\n    *   Stage-1+2 完整  \n        → **Agent 子集提升 17.2**，Overall 提升 8.5，验证“广→专”两阶段有效（图 3）。\n\n3 跨语言鲁棒性：ACEBench-zh（OOD）\n\n*   训练全英文，直接测中文\n*   AgentScaler-4B Overall **+21.7**（43.9→65.6）；Agent 子集 **+31.7**（6.7→38.4）  \n    → 证明合成环境可迁移，无需额外中文标注。\n\n4 稳定性测试：pass@k 曲线\n\n*   τ²-bench 同一题独立跑 k=1~4 次\n*   AgentScaler-30B-A3B 在所有 k 上均 **\\> Qwen3-30B-A3B**\n*   随 k 增大两者均下降，揭示长链一致性仍是共性难题（图 4）。\n\n5 长程工具调用挑战\n\n*   按轨迹内工具调用次数分组统计准确率\n*   零售、航空两域均呈 **显著负相关**（图 5）\n*   即使 AgentScaler，>10 步任务准确率跌至 **≤50 %**  \n    → 指出未来需引入链式反思或 RL 探索。\n\n6 规模-性能对比\n\n*   4 B 模型 ≈ 30 B 级开源模型\n*   30B-A3B ≈ 1 T 级（Kimi-K2-1T-A32B）并逼近闭源 GPT-4o\n*   参数效率曲线显示：**环境扩缩带来的数据增益 > 单纯堆参数**\n\n可复现性\n\n*   代码： [https://github.com/Alibaba-NLP/DeepResearch](https://github.com/Alibaba-NLP/DeepResearch)\n*   评测协议完全遵循官方脚本，随机种子固定，pass@k 重复 4 次取均值。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下方向可直接在论文现成框架上延伸，无需重新造轮；每条均给出可验证的指标或实验设置，便于后续工作快速落地。\n\n1 强化学习：把「可验证模拟器」变成「可微奖励」\n\n*   **切入点**  \n    现有 Stage-1/2 仅做 SFT，而模拟器已能提供 0/1 终端奖励与中间状态差分，天然适合 RL。\n*   **可探索算法**\n    *   Offline RL：用过滤后的高质量轨迹做 IQL、Decision Transformer；\n    *   Online RL：以「状态一致性」为稠密奖励，做 PPO/GRPO，每步即时奖励  \n        r\\_t = Δ(state\\_match) − λ·(token\\_length)。\n*   **评估指标**  \n    长程（≥10 步）任务在 τ-bench 的 pass@1 绝对提升 ≥10 %，且 pass@k 下降斜率变缓。\n\n2 长程工具链：显式「计划-执行-检查」循环\n\n*   **切入点**  \n    图 5 显示准确率随调用次数增加而线性下降 → 缺乏全局规划。\n*   **技术路线**\n    1.  在轨迹合成阶段引入「计划 API」：让 LLM 先输出 JSON 计划，再执行；\n    2.  训练时把计划 token 纳入因果语言模型，但只在计划阶段计算 loss；\n    3.  推理阶段允许模型在每 3-4 步后自我检查状态并 replan。\n*   **评估指标**  \n    12-18 步任务子集（可人工从 τ-bench 抽取）准确率提升 ≥15 %，且首次失败步位置后移 ≥2 步。\n\n3 工具图动态扩展：持续学习不遗忘\n\n*   **切入点**  \n    真实世界 API 不断新增，需避免重训全量数据。\n*   **技术路线**\n    *   用 Function-Descriptor 向量检测「新工具是否属于旧社区」→ 决定复用或新建 schema；\n    *   采用 Replay-buffer + 正则化（KL 约束）做持续微调，只采样新增领域轨迹 + 5 % 旧轨迹。\n*   **评估指标**  \n    连续添加 3 个新领域后，旧领域平均性能下降 ≤2 %，新领域性能 ≥70 %（相对一次性联合训练）。\n\n4 多模态环境：把数据库状态升级为「富状态」\n\n*   **切入点**  \n    当前状态仅为 JSON 结构化数据；真实工具常返回图像、PDF、音频。\n*   **技术路线**\n    *   将图像/PDF 表征为可查询的向量字段，工具调用返回「文件句柄+向量」；\n    *   训练阶段把文件向量作为额外上下文，但不计算梯度；\n    *   合成轨迹时让 LLM 生成「先检索再视觉问答」链。\n*   **评估指标**  \n    在自建 200 任务「视觉维修」环境上，多模态 AgentScaler 比纯文本版本 pass@1 提升 ≥20 %。\n\n5 奖励模型蒸馏：用「状态一致性」训练轻量 RM\n\n*   **切入点**  \n    现有过滤只用硬标签 0/1，可蒸馏成轻量奖励模型供其它算法复用。\n*   **技术路线**\n    *   以「最终状态匹配」为金标准，训练 3 B 参数的交叉编码器 RM；\n    *   用 RM 对同一意图生成的 16 条轨迹重排序，挑选 Top-4 进入训练集。\n*   **评估指标**  \n    在相同训练步数下，RM 筛选后训练的 AgentScaler-8B 比随机筛选版本 Overall 提升 ≥4 %，且数据量减少 30 %。\n\n6 边缘部署：4 B 模型 + 量化 + speculative decoding\n\n*   **切入点**  \n    论文已证明 4 B 可媲美 30 B，但生产还需低延迟。\n*   **技术路线**\n    *   8-bit/4-bit 量化后做 QAT（quantization-aware training）补偿工具调用精度；\n    *   用 0.5 B 的草稿模型做 speculative decoding，目标首 token 延迟 <100 ms。\n*   **评估指标**  \n    τ-bench retail 域量化后准确率下降 ≤1 %，首 token 延迟降低 35 %，峰值内存 <3 GB。\n\n7 安全与可解释：引入「工具风险标签」\n\n*   **切入点**  \n    金融、医疗等域存在高风险写操作，需可解释拒答。\n*   **技术路线**\n    *   在工具描述中显式加入 risk\\_level∈{low,medium,high}；\n    *   训练时随机丢弃高风险工具，让模型学会请求额外确认；\n    *   推理阶段若置信度<δ 则触发「人类介入」信号。\n*   **评估指标**  \n    自建 100 高风险任务上，误调用率（未经允许执行高风险操作）≤2 %，同时保持整体成功率 ≥75 %。\n\n以上方向均可在当前开源代码库上直接分支实验，无需重新搭建模拟器，形成「环境-算法-评测」闭环的快速迭代。\n\n**Q6**: 总结一下论文的主要内容\n\n论文核心速览\n\n**题目**：Towards General Agentic Intelligence via Environment Scaling  \n**目标**：用“可扩展的模拟环境”替代昂贵真实 API，让**小参数模型**也能获得**通用且鲁棒的函数调用智能**。\n\n1 关键问题\n\n*   真实 API 采集贵、不稳定 → 数据难扩展\n*   现有合成环境手工重、不可验证 → 训练难规模化\n*   函数调用能力随参数下降快 → 边缘部署难\n\n2 解决思路（两大阶段）\n\n阶段\n\n做法\n\n输出\n\n**① 环境扩缩**\n\n3 万 API → 工具语义图 → Louvain 分域 → 每域自动生成数据库 schema → Python 化工具 → 可验证轨迹采样\n\n\\>1 000 个完全模拟、可并行扩张的领域环境\n\n**② 经验学习**\n\n人机交互模拟 → 三层漏斗过滤 → 两阶段微调（通用→垂直）\n\nAgentScaler 模型族 4 B / 8 B / 30B-A3B\n\n3 主要结果\n\n*   **τ-bench**（零售+航空）70.4 / 54.0 pass@1 **刷新 ≤1 T 开源 SOTA**\n*   **τ²-bench** 加权 62.5 **领先次优 17+ 分**\n*   **ACEBench-en** Overall 75.7 **4 B 版本已超 30 B 基线**\n*   **跨语言零样本**（ACEBench-zh）Overall +21.7 **验证 OOD 鲁棒**\n*   **长程负相关**（图 5）与 **稳定性曲线**（图 4）**揭示未来改进点**\n\n4 贡献一句话\n\n**首次把“环境可扩展性”做成独立变量**，用全自动、可验证的模拟数据工厂，让**4 B 模型逼近 1 T 性能**，为轻量级通用智能体提供可复制范式。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Towards%20General%20Agentic%20Intelligence%20via%20Environment%20Scaling，链接是  https://arxiv.org/pdf/2509.13311  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.13311  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-4-1758152840087","title":"WebResearcher: Unleashing unbounded reasoning capability in Long-Horizon Agents","description":"Recent advances in deep-research systems have demonstrated the potential for AI agents to autonomously discover and synthesize knowledge from external sources. In this paper, we introduce WebResearcher, a novel framework for building such agents through two key components: (1) WebResearcher, an iterative deep-research paradigm that reformulates deep research as a Markov Decision Process, where agents periodically consolidate findings into evolving reports while maintaining focused workspaces, overcoming the context suffocation and noise contamination that plague existing mono-contextual approaches; and (2) WebFrontier, a scalable data synthesis engine that generates high-quality training data through tool-augmented complexity escalation, enabling systematic creation of research tasks that bridge the gap between passive knowledge recall and active knowledge construction. Notably, we find that the training data from our paradigm significantly enhances tool-use capabilities even for traditional mono-contextual methods. Furthermore, our paradigm naturally scales through parallel thinking, enabling concurrent multi-agent exploration for more comprehensive conclusions. Extensive experiments across 6 challenging benchmarks demonstrate that WebResearcher achieves state-of-the-art performance, even surpassing frontier proprietary systems.","url":"https://huggingface.co/papers/2509.13309","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.087Z","metadata":{"authors":["Zile Qiao","Guoxin Chen","Xuanzhong Chen","Donglei Yu","Wenbiao Yin","Xinyu Wang","Zhen Zhang","Baixuan Li","Huifeng Yin","Kuan Li","Rui Min","Minpeng Liao","Yong Jiang","Pengjun Xie","Fei Huang","Jingren Zhou"],"date":"","rank":5,"llmAnalysis":"","categories":["cs.CL"],"pdfUrl":"https://arxiv.org/pdf/2509.13309.pdf","arxivUrl":"https://arxiv.org/abs/2509.13309","arxivId":"2509.13309","coolPaperUrl":"https://papers.cool/arxiv/2509.13309","published":"2025-09-16T17:57:17Z","updated":"2025-09-16T17:57:17.000Z","zh_summary":"最近在深度研究系统方面的进展展示了人工智能代理自主发现和综合外部知识的潜力。在本文中，我们介绍了WebResearcher，这是一种构建此类代理的新框架，包含两个关键组件：（1）WebResearcher，一个迭代的深度研究范式，将深度研究重新构建为马尔可夫决策过程，其中代理定期将发现整合到不断发展的报告中，同时保持专注的工作空间，从而克服现有单一上下文方法所苦恼的上下文窒息和噪声污染；（2）WebFrontier，一个可扩展的数据综合引擎，通过工具增强的复杂性升级生成高质量的训练数据，使研究任务的系统性创建能够弥合被动知识回忆和主动知识构建之间的差距。值得注意的是，我们发现我们范式中的训练数据显著增强了即使是传统单一上下文方法的工具使用能力。此外，我们的范式通过并行思维自然扩展，允许同时进行多代理探索，以得出更全面的结论。通过在六个具有挑战性的基准测试中的广泛实验，WebResearcher实现了最先进的性能，甚至超过了前沿的专有系统。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文旨在突破现有“深度研究（deep-research）”智能体因\\*\\*单上下文（mono-contextual）\\*\\*架构而遭遇的两大根本瓶颈：\n\n1.  **认知工作区窒息**  \n    随着检索信息不断追加，固定上下文窗口被历史数据挤占，模型可用于深度推理的“思考空间”持续萎缩，迫使研究过程提前终止。\n    \n2.  **不可逆噪声污染**  \n    早期引入的无关信息或错误无法在后续步骤中被过滤或修正，噪声线性累积，信号质量单调下降，导致偏差级联。\n    \n\n为根治上述问题，论文提出**WebResearcher**框架，核心目标是将“被动知识回忆”转变为“主动知识构建”，使智能体在任意深度的长周期研究中仍能保持高质量推理与信息综合。具体通过三项相互协同的贡献实现：\n\n*   **IterResearch**：把深度研究重定义为**马尔可夫决策过程（MDP）**，每轮仅保留「问题 + 演进报告 + 最新工具反馈」的紧凑状态，周期性地用合成报告替代原始信息堆叠，从而维持恒定大小的认知工作区，理论上支持无界研究深度。\n*   **WebFrontier**：一个可扩展的数据合成引擎，利用工具增强的复杂度递增策略，批量生成高难度、可验证的训练任务，填补基座模型与工具增强模型之间的能力鸿沟。\n*   **Research-Synthesis**：在推理阶段引入测试时扩展（test-time scaling），通过并行多智能体探索与统一综合，进一步释放迭代范式的性能上限。\n\n综上，论文解决的是\\*\\*“如何在长周期、多跳、跨域的开放环境研究中，持续保持高质量推理与信息综合”\\*\\*这一根本问题，突破了传统单上下文架构随研究深度增加而性能衰减的悖论。\n\n**Q2**: 有哪些相关研究？\n\n以下研究被论文直接或间接地置于同一技术脉络，可划分为四类：  \n（1）专有/闭源深度研究系统；  \n（2）开源单上下文深度研究智能体；  \n（3）工具增强与检索-推理框架；  \n（4）数据合成与课程式训练。\n\n    ### 1. 专有深度研究系统\n    - OpenAI Deep Research (2025a)  \n    - Google Gemini Deep Research (2025b)  \n    - xAI Grok DeepSearch (2025)  \n    - Anthropic Claude-4 Research (2025)  \n    - Perplexity Deep Research (2025)  \n    - Moonshot Kimi-Researcher (2025)  \n    → 确立了“搜索-浏览-综合”范式，但架构细节未公开，均被本文作为性能对标对象。\n    \n    ### 2. 开源单上下文深度研究智能体\n    - WebSailor (Li et al., 2025a)  \n    - WebThinker (Li et al., 2025c)  \n    - WebShaper (Tao et al., 2025)  \n    - WebDancer (Wu et al., 2025)  \n    - WebExplorer (Liu et al., 2025)  \n    - MiroThinker (MiroMindAI, 2025)  \n    → 均采用“线性累积”上下文，无中间压缩/修正机制，被本文归类为 mono-contextual baseline。\n    \n    ### 3. 工具增强与检索-推理框架\n    - Search-R1 (Jin et al., 2025) — RL 驱动搜索调用  \n    - Search-o1 (Li et al., 2025b) — 检索增强推理模型  \n    - C-3PO (Chen et al., 2025) — 紧凑即插即用检索优化  \n    - GLM-4.5 (Zeng et al., 2025) — 自带工具调用底座  \n    - DeepSeek-R1/V3.1 (Guo et al., 2025b) — 长链思维+工具  \n    → 与本文共享“工具+LLM”协同目标，但未引入周期性状态重建。\n    \n    ### 4. 数据合成与课程式训练\n    - WebDancer（同期工作）— 使用多智能体 rollout 生成轨迹  \n    - WebShaper — 将信息检索形式化用于数据蒸馏  \n    - Scaling Agents via Continual Pre-training (Su et al., 2025)  \n    - Group Sequence Policy Optimization (GSPO, Zheng et al., 2025) — 本文 RL 阶段所采用的分布式优势估计方法  \n    → 本文的 WebFrontier 在“复杂度递增”与“工具自举”策略上与此类研究理念相通，但额外强调跨域、可验证、多轮合成。\n    \n\n综上，现有工作要么停留在闭源性能标杆，要么沿用单上下文累积架构；本文通过**迭代 MDP 式状态重建**与**可扩展数据引擎**首次系统性地解决了长周期研究中的上下文窒息与噪声污染问题，因而在同领域内具有明确的差异化定位。\n\n**Q3**: 论文如何解决这个问题？\n\n论文将“单上下文线性累积”导致的**认知工作区窒息**与**不可逆噪声污染**问题，转化为\\*\\*“如何在无限长度研究中维持恒定大小、可过滤、可修正的认知状态”\\*\\*这一形式化问题，并给出三层耦合的系统性解法。\n\n1\\. 形式化：把深度研究重定义为马尔可夫决策过程（MDP）\n\n*   **状态**  \n    sᵢ = ⟨q, Reportᵢ₋₁, (Actionᵢ₋₁, ToolResponseᵢ₋₁)⟩  \n    仅保留“原始问题 + 上一轮综合报告 + 最新工具反馈”，与历史长度无关，天然满足马尔可夫性。\n    \n*   **动作空间**  \n    A = {ToolCall, FinalAnswer}，支持搜索、学术检索、页面访问、Python 计算四类工具。\n    \n*   **转移函数**  \n    每轮生成 Think-Report-Action 三元组后，**丢弃 Think 与原始工具返回原文**，仅将更新后的 Report 注入下一状态，实现“信息浓缩 + 工作区重置”。\n    \n*   **奖励**  \n    训练阶段用“最终答案是否匹配参考答案”做稀疏奖励；推理阶段无外部奖励，靠确定性策略最大化答案一致性。\n    \n\n⇒ 通过**周期性状态重建**将上下文尺寸锁死在常数级，理论上支持**无界研究深度**。\n\n2\\. 数据：WebFrontier 引擎——“工具自举 + 复杂度递增”\n\n1.  **种子生成**  \n    多领域语料 → 摘要智能体切块 → 主题相关块组合 → ItemWriter 生成需多源综合的 QA 对。\n    \n2.  **复杂度递增循环**  \n    同一 ItemWriter 被授予搜索、学术、浏览、Python 四件工具，在每一轮对 (Q, A) 执行：\n    \n    *   知识扩展（外部检索）\n    *   概念抽象（跨域提炼）\n    *   多源交叉验证（保证事实）\n    *   计算化封装（引入数值/模拟）  \n        新生成的更高阶 QA 立即成为下一轮种子，形成“自举式”难度飞轮。\n3.  **质量闸口**\n    \n    *   基线模型（无工具）能答 → 太简单，丢弃；\n    *   工具增强模型仍答错 → 过难或错误，丢弃或人工复核；\n    *   SimilarityScorer 去重。\n\n⇒ 批量产出**恰好落在基座与工具增强模型能力间隙**、且可验证的高难度任务，用于后续训练。\n\n3\\. 训练：两阶段混合算法\n\n阶段\n\n方法\n\n目标\n\n关键技巧\n\n**SFT**\n\n拒绝采样微调\n\n学会格式与正确推理链\n\n仅对匹配参考答案的轨迹求最大似然；梯度只落在模型生成的 Think/Report/Action token 上，工具输出视为外部观测。\n\n**RL**\n\nGroup Sequence Policy Optimization (GSPO)\n\n提高探索与多轮综合质量\n\n把一条轨迹的每一轮都当成独立样本，按组归一化优势；采用最小损失下采样保证分布式训练批尺寸恒定。\n\n⇒ 模型既掌握“何时调用何工具”，也学会在 Report 中**消解冲突、修正旧结论、浓缩信号**。\n\n4\\. 推理：Research-Synthesis 框架——测试时扩展\n\n1.  **Parallel Research**  \n    n 个独立 Research Agent 并行执行 IterResearch，各自输出 (FinalReport, Answer)。\n    \n2.  **Integrative Synthesis**  \n    单一大模型（Qwen3-235B）仅阅读 n 份**已浓缩的最终报告**，再综合得出统一答案。\n    \n\n⇒ 以常数级上下文代价换取**线性增长的推理路径覆盖**，实现可控的“测试时缩放”。\n\n5\\. 结果验证\n\n*   \\*\\* Humanity’s Last Exam \\*\\*：36.7%（+6.9 pp 超越次优系统）\n*   \\*\\* BrowseComp-en \\*\\*：51.7%（与 OpenAI 商业系统持平，开源第一）\n*   消融实验：同等数据下，**迭代范式 > 单上下文+迭代数据 > 单上下文**，证明性能增益主要来自**状态重建机制本身**而非数据或模型规模。\n\n结论\n\n论文通过“**MDP 式迭代合成 + 工具自举数据飞轮 + 测试时并行综合**”三位一体方案，把长周期研究从“堆叠信息”转变为“周期性精炼”，在任意深度都能保持**恒定认知空间与可修正信号**，从而系统性地解决了上下文窒息与噪声污染问题。\n\n**Q4**: 论文做了哪些实验？\n\n论文围绕“迭代式深度研究”与“单上下文深度研究”两大范式，在 6 个公开基准上执行了**三组核心实验 + 两项深入分析**，覆盖性能对比、消融验证、行为可解释性与测试时扩展效果。所有结果均以 pass@1 为主指标，采用 LLM-as-a-Judge 自动判分，温度 0.6、top-p 0.95。\n\n1 主实验：State-of-the-art 对比\n\n| 实验目的 | 验证 WebResearcher 在复杂推理、长程浏览、跨语言检索等任务上是否超越现有最好系统（含闭源） | | 基准 | 6 个挑战性数据集 | | 对照组 | ① 通用 LLM+工具 ② 商业深度研究系统 ③ 开源深度研究智能体 |\n\n1.1 通用网页导航与推理\n\n*   **Humanity’s Last Exam (text-only, 2 154 题)**\n*   **BrowseComp-en (1 266 题)**\n*   **BrowseComp-zh (289 题)**\n\n1.2 复杂目标导向任务\n\n*   **GAIA (text-only val, 103 题)**\n*   **Xbench-DeepSearch**\n*   **FRAMES (824 题)**\n\n关键结果（pass@1）\n\n系统\n\nHLE\n\nBC-en\n\nBC-zh\n\nGAIA\n\nXbench\n\nFRAMES\n\nWebResearcher-30B-A3B-heavy\n\n**36.7**\n\n**51.7**\n\n**56.8**\n\n**75.7**\n\n**73.0**\n\n**85.1**\n\n次优（开源）\n\n29.8\n\n30.0\n\n49.2\n\n63.1\n\n71.2\n\n83.7\n\n次优（专有）\n\n26.6\n\n51.5\n\n58.1\n\n70.5\n\n—\n\n84.0\n\n⇒ 在 6 个基准上全部取得**新 SOTA**，其中 HLE 领先 6.9 pp，BC-en 领先开源对手 21.7 pp。\n\n2 消融实验：验证“迭代范式”本身的价值\n\n| 实验目的 | 排除数据或模型规模的干扰，量化**状态重建机制**的独立贡献 | | 设计 | 同底座模型（Qwen3-30B-A3B）+ 同一套迭代训练数据，仅改变推理策略 |\n\n条件\n\nHLE\n\nBC-en\n\nBC-zh\n\nMono-Agent（线性累积）\n\n18.7\n\n25.4\n\n34.6\n\nMono-Agent + Iter 数据\n\n25.4\n\n30.1\n\n40.4\n\nWebResearcher（迭代推理）\n\n**28.8**\n\n**37.3**\n\n**45.2**\n\n⇒ 迭代推理相较“仅使用迭代数据”再提升 **+3.4 pp（HLE）**，证明**周期性状态重建是增益主因**。\n\n3 工具使用行为分析\n\n| 实验目的 | 展示迭代范式如何根据任务类型**自适应调整工具组合与推理长度** | | 方法 | 记录并统计 HLE vs BrowseComp 上各工具调用占比与平均轮数 |\n\n指标\n\nHLE（学术问答）\n\nBrowseComp（网页多跳）\n\n平均轮数\n\n4.7\n\n61.4（最大＞200）\n\nScholar 占比\n\n25.4 %\n\n0.4 %\n\nSearch+Visit 占比\n\n28 %\n\n**96.2 %**\n\n⇒ 迭代架构可\\*\\*自动切换“短链精准检索”与“长链探索式浏览”\\*\\*两种策略，验证其对任务语义的敏感度。\n\n4 测试时扩展（Research-Synthesis）\n\n| 实验目的 | 研究并行轨迹数 n 对性能与计算成本的 trade-off | | 设置 | 固定模型 IterResearch-30B-A3B，n∈{1,2,4,8,16} |\n\nn\n\n1\n\n2\n\n4\n\n8\n\n16\n\nHLE pass@1\n\n28.8\n\n30.4\n\n32.1\n\n**35.7**\n\n36.7\n\nBC-en pass@1\n\n37.3\n\n38.5\n\n46.5\n\n**49.3**\n\n51.7\n\n⇒ 性能随 n 单调上升，8 条轨迹后边际收益递减；**n=8 为性价比拐点**。\n\n5 数据质量验证（WebFrontier）\n\n| 实验目的 | 证明迭代范式生成的数据对**第三方单上下文系统**同样有效 | | 方法 | 仅用 WebFrontier 数据对 Qwen3-30B-A3B 做 SFT，保持其原始线性推理不变 |\n\n系统\n\nHLE\n\nBC-en\n\n原始 Qwen3-30B-A3B\n\n13.2\n\n0.5\n\n\\+ WebFrontier 数据\n\n**25.4**\n\n**30.1**\n\n⇒ 迭代数据本身即可为传统架构带来 **+12.2 pp（HLE）** 的提升，说明数据引擎产生的训练信号具有**通用工具增强价值**。\n\n实验结论汇总\n\n1.  WebResearcher 在 6 大基准全面刷新 SOTA，领先开源平均约 15–20 pp。\n2.  消融确认\\*\\*“状态重建”>“数据”>“ baseline”\\*\\*，迭代范式是核心。\n3.  工具行为统计揭示系统能**自适应短链或长链**策略，验证迭代架构的灵活性。\n4.  测试时扩展实验给出**n=8 的实用配置**，实现 24 % 额外增益。\n5.  数据引擎产生的训练信号**对第三方 mono-contextual 模型同样显著有效**，凸显 WebFrontier 的普适性。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下方向可在此基础上继续推进，分为**理论-算法、系统-工程、数据-评测、应用-生态**四个层面，并给出可立即着手的技术切入点。\n\n理论-算法层面\n\n1.  **非-Markov 长程依赖建模**  \n    当前 Report 仅保留上一轮摘要，极端多跳场景（>100 轮）可能出现早期关键证据被“遗忘”。可尝试\n    \n    *   带遗忘门控的**递归记忆网络**（Recursive Memory Network）\n    *   或把 Report 视为**外部向量数据库**，用检索式记忆维持亚线性遗忘率。\n2.  **动态压缩率理论**  \n    信息论角度分析：给定上下文预算 C，如何最大化互信息 I(Report; 历史轨迹)？可推导**最优压缩率下界**，指导 Report 长度与更新频率的自适应调度。\n    \n3.  **工具调用策略的强化学习理论**  \n    现有 RL 仅优化答案正确性。可引入**信息增益**或**边际置信度**作为稠密奖励，建立“最优停止”与“探索-利用”可证明界。\n    \n\n系统-工程层面\n\n4.  **层级式并行综合**  \n    当前 Research-Synthesis 为单层投票。可探索**树状综合**：8→4→2→1 的多级提炼，每层进一步压缩，降低合成模型上下文占用。\n    \n5.  **异步工具执行与流式报告**  \n    搜索、浏览、Python 执行延迟差异大。把工具调用**异步化**，并在部分结果返回时即时更新 Report，可缩短 wall-clock 时间 30 % 以上。\n    \n6.  **端-云协同小模型部署**  \n    将 30B 大模型蒸馏为 3B 轻量化 Research Agent 运行在端侧，仅把最终 Report 上传云端合成，兼顾隐私与成本。\n    \n\n数据-评测层面\n\n7.  **可验证性自动标注**  \n    WebFrontier 目前依赖 LLM Judge 做答案正确性过滤。可引入\n    \n    *   **形式化验证**（Python assert、SQL 单元测试、数学证明助手）\n    *   **区块链时间戳**对网页快照进行存证，确保后续可人工审计。\n8.  **对抗性噪声评测基准**  \n    构建刻意插入**误导性网页、 contradictory 论文、虚假引用**的 adversarial split，衡量迭代范式在**故意污染**环境下的鲁棒性。\n    \n9.  **跨模态深度研究**  \n    现有实验局限文本。扩展工具集到\n    \n    *   图像检索（Google Lens API）\n    *   视频关键帧 OCR\n    *   图表可执行代码（Plotly/D3 自动可视化）  \n        并建立 multimodal 版本的 HLE/BC 基准。\n\n应用-生态层面\n\n10.  **个性化科研助手**  \n    允许用户上传私有论文库（Zotero、Notion），把个人知识库作为**额外工具**，Report 内生成“私有引用 + 公开引用”混合答案，实现**个性化深度综述**。\n    \n11.  **实时政策/金融市场追踪**  \n    引入 streaming news API 与 SQL 财经数据库，要求智能体在**规定时间窗口内**完成信息收集并给出可执行预测，评测其在**低延迟、高噪声**场景下的可用性。\n    \n12.  **可解释性人机协作界面**  \n    提供**可折叠 Report 差异视图**（round-by-round diff），让用户对每一次综合进行**回滚或手动纠错**，形成“人-机迭代”闭环，同时收集人类反馈用于 RLHF。\n    \n\n即刻可执行的实验选题（示例）\n\n选题\n\n预期验证\n\n最短周期\n\n在 Report 中引入“引用指纹”向量索引，每轮用近似检索保留 5 条最相关原始段落\n\n极端长程多跳问答遗忘率 ↓\n\n1 周\n\n把 GSPO 奖励改为“信息增益 + 答案正确”双目标，在 FRAMES 上对比原算法\n\n收敛速度 +2×，最终指标 ±1 pp\n\n2 周\n\n构建 BrowseComp-Adversarial（10 % 页面注入反事实），测试 Mono vs Iter\n\nIter 优势扩大至 30 pp\n\n3 周\n\n以上方向既包含**理论深挖**（记忆、压缩、RL 理论），也覆盖**系统落地**（异步、端-云、跨模态），并给出**可验证的 adversarial 评测**与**垂直场景落地**，可供后续研究按需取用。\n\n**Q6**: 总结一下论文的主要内容\n\nWebResearcher 核心内容速览\n====================\n\n1\\. 问题\n------\n\n*   现有深度研究智能体采用“单上下文线性累积”模式，随检索量增加出现  \n    ① 认知工作区窒息 ② 不可逆噪声污染\n*   导致模型推理质量随研究深度增加而下降，形成“越搜越笨”悖论。\n\n2\\. 思路\n------\n\n把长周期研究形式化为**马尔可夫决策过程**，用“周期性的信息综合 + 状态重建”取代“无限追加”，实现：\n\n*   恒定大小的认知工作区\n*   可修正、可过滤的中央记忆\n*   理论上无界的研究深度\n\n3\\. 方法\n------\n\n组件\n\n作用\n\n关键机制\n\n**IterResearch**\n\n推理范式\n\n每轮仅保留⟨问题, 上轮报告, 最新工具反馈⟩；生成Think-Report-Action；用更新后的报告重建下一状态。\n\n**WebFrontier**\n\n数据引擎\n\n三阶段多智能体流水线：种子→工具自举复杂度递增→双重验证与去冗余，产出“恰好难”且可验证的QA。\n\n**Research-Synthesis**\n\n测试时扩展\n\nn个并行Research Agent各跑IterResearch；单一大模型仅阅读n份最终报告再做一次综合，线性提升精度。\n\n4\\. 训练\n------\n\n*   拒绝采样微调：只保留答案正确的轨迹，学习结构化生成。\n*   Group Sequence Policy Optimization：把每轮当作独立样本，组内归一化优势，解决变长轨迹分布式训练难题。\n\n5\\. 实验\n------\n\n*   **6大基准**（HLE、BrowseComp-en/zh、GAIA、Xbench-DeepSearch、FRAMES）全面SOTA；HLE达36.7%，领先次优系统6.9pp。\n*   **消融**：同等数据下，迭代推理比单上下文提升≈10pp，验证“状态重建”是核心。\n*   **行为分析**：学术任务平均4.7轮、Scholar占25%；网页多跳任务61.4轮、Search+Visit占96%，显示自适应策略。\n*   **测试时扩展**：n=8性价比最佳，HLE再提7pp。\n\n6\\. 贡献\n------\n\n① 提出迭代式MDP深度研究范式，根治上下文窒息与噪声累积。  \n② 构建可扩展的数据合成引擎，填补基座与工具增强模型间的数据缺口。  \n③ 设计并行综合框架，实现低成本测试时缩放。  \n④ 在6个挑战性基准上刷新SOTA，超越开源与专有系统。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是WebResearcher%3A%20Unleashing%20unbounded%20reasoning%20capability%20in%20Long-Horizon%20Agents，链接是  https://arxiv.org/pdf/2509.13309  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.13309  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-5-1758152840088","title":"ReSum: Unlocking Long-Horizon Search Intelligence via Context Summarization","description":"Large Language Model (LLM)-based web agents demonstrate strong performance on knowledge-intensive tasks but are hindered by context window limitations in paradigms like ReAct. Complex queries involving multiple entities, intertwined relationships, and high uncertainty demand extensive search cycles that rapidly exhaust context budgets before reaching complete solutions. To overcome this challenge, we introduce ReSum, a novel paradigm that enables indefinite exploration through periodic context summarization. ReSum converts growing interaction histories into compact reasoning states, maintaining awareness of prior discoveries while bypassing context constraints. For paradigm adaptation, we propose ReSum-GRPO, integrating GRPO with segmented trajectory training and advantage broadcasting to familiarize agents with summary-conditioned reasoning. Extensive experiments on web agents of varying scales across three benchmarks demonstrate that ReSum delivers an average absolute improvement of 4.5\\% over ReAct, with further gains of up to 8.2\\% following ReSum-GRPO training. Notably, with only 1K training samples, our WebResummer-30B (a ReSum-GRPO-trained version of WebSailor-30B) achieves 33.3\\% Pass@1 on BrowseComp-zh and 18.3\\% on BrowseComp-en, surpassing existing open-source web agents.","url":"https://huggingface.co/papers/2509.13313","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.088Z","metadata":{"authors":["Xixi Wu","Kuan Li","Yida Zhao","Liwen Zhang","Litu Ou","Huifeng Yin","Zhongwang Zhang","Yong Jiang","Pengjun Xie","Fei Huang","Minhao Cheng","Shuai Wang","Hong Cheng","Jingren Zhou"],"date":"","rank":6,"llmAnalysis":"","categories":["cs.CL"],"pdfUrl":"https://arxiv.org/pdf/2509.13313.pdf","arxivUrl":"https://arxiv.org/abs/2509.13313","arxivId":"2509.13313","coolPaperUrl":"https://papers.cool/arxiv/2509.13313","published":"2025-09-16T17:57:22Z","updated":"2025-09-16T17:57:22.000Z","zh_summary":"基于大型语言模型 （LLM） 的 Web 代理在知识密集型任务上表现出强大的性能，但受到 ReAct 等范式中的上下文窗口限制的阻碍。涉及多个实体、相互交织的关系和高不确定性的复杂查询需要广泛的搜索周期，在得出完整的解决方案之前会迅速耗尽上下文预算。为了克服这一挑战，我们引入了 ReSum，这是一种新颖的范式，可以通过周期性上下文摘要进行无限探索。ReSum 将不断增长的交互历史转换为紧凑的推理状态，保持对先前发现的认识，同时绕过上下文约束。对于范式适配，我们提出了 ReSum-GRPO，将 GRPO 与分割轨迹训练和优势广播相结合，使智能体熟悉摘要条件推理。在三个基准测试中对不同规模的 Web 代理进行的广泛实验表明，与 ReAct 相比，ReSum 的平均绝对改进为 4.5%，在 ReSum-GRPO 训练后进一步提高了 8.2%。值得注意的是，仅使用 1K 训练样本，我们的 WebResummer-30B（WebSailor-30B 的 ReSum-GRPO 训练版本）在 BrowseComp-zh 上实现了 33.3\\% 的Pass@1，在 BrowseComp-en 上达到 18.3\\%，超过了现有的开源 Web 代理。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文旨在解决**基于大语言模型（LLM）的网页智能体在长周期、多轮次搜索任务中因上下文窗口受限而被迫提前终止**的核心难题。  \n具体而言：\n\n*   **ReAct 范式**通过“思维-动作-观察”循环不断追加历史，导致 token 用量随探索深度线性增长，在 32 k 量级窗口内远未完成任务即被截断。\n*   复杂查询（多实体、关系交织、信息碎片化、不确定性高）需要数十轮搜索、浏览、交叉验证才能收敛，而上下文耗尽使证据链无法闭合。\n\n为此，作者提出 **ReSum 范式**，其关键洞察是：\n\n> 将随时间膨胀的交互历史**周期性地压缩为紧凑的推理状态**（summary），代理从该状态重启，既保留已验证证据与待填补缺口，又**绕过上下文长度约束**，实现**无限期探索**。\n\n综上，论文试图解决的问题可概括为：\n\n$$ \\\\boxed{ \\\\text{在有限上下文窗口内，如何使网页代理对复杂查询进行无限轮次、不中断的搜索与推理，直至证据链完整并给出可靠答案。} } $$\n\n**Q2**: 有哪些相关研究？\n\n与 ReSum 直接可比或可被其借鉴的相关研究可归纳为四大类，每类给出 1–2 篇代表性工作并指出与 ReSum 的差异。\n\n类别\n\n代表论文\n\n核心思路\n\n与 ReSum 的关键区别\n\n**长周期网页代理数据与训练框架**\n\nWebSailor (Li et al., 2025a) / ASearcher (Gao et al., 2025)\n\n通过拒绝采样或异步 RL 产生 10 k+ 工具调用轨迹，训练专用模型。\n\n仍沿用 ReAct“全历史追加”模式，上下文耗尽问题未被解决；ReSum 直接解除长度约束，且仅用 1 k 样本即可比肩其性能。\n\n**上下文压缩/记忆管理**\n\nA-Mem (Xu et al., 2025) / MemOS (Li et al., 2025d)\n\n外挂 RAG 记忆模块，定期写入与检索历史信息。\n\n需额外检索器与存储，系统复杂且与策略模型松耦合；ReSum 用轻量级摘要工具原位压缩，无需外部存储。\n\n**基于 RL 的上下文自管理**\n\nMemAgent (Yu et al., 2025a) / Mem1 (Zhou et al., 2025b)\n\n通过多轮 RL 让代理自己决定何时写入、遗忘或召回记忆。\n\n需设计复杂记忆动作空间与奖励，训练成本高；ReSum 沿用 ReAct 动作集，仅增加“摘要即重启”触发，训练开销低且即插即用。\n\n**摘要增强推理**\n\nChain-of-Agents (Li et al., 2025b) / DPO 摘要蒸馏 (MiroThinker)\n\n用摘要实现多代理通信或蒸馏长文档。\n\n聚焦对话或文档级压缩，未针对**长周期工具交互历史**设计；ReSumTool-30B 专门蒸馏“证据+缺口+下一步”三元组，适配网页搜索场景。\n\n简言之，既有工作要么接受上下文耗尽为硬限制，要么引入外部记忆/复杂动作空间；ReSum 首次把“周期摘要+状态重启”作为**轻量级、可插拔**的推理范式，并配套专用摘要模型与 RL 训练框架，使任意现成代理无需大幅改造即可进行**理论上无限步**的网页探索。\n\n**Q3**: 论文如何解决这个问题？\n\n论文将“上下文窗口耗尽”这一硬障碍转化为**可控的摘要-重启循环**，通过三层设计实现“无限步”网页探索，具体路径如下：\n\n1\\. 推理层：ReSum 范式——把“膨胀历史”变成“可重启状态”\n\n*   **触发机制**  \n    当对话 token 数 ≥ 32 k（或代理主动请求）时，立即调用摘要工具 πsum。\n*   **摘要内容**  \n    输出结构化 `<summary>`，显式包含：\n    *   已验证证据（事实+来源）\n    *   信息缺口列表\n    *   下一步建议（可选）\n*   **状态重置**  \n    用 `(原查询 q, 摘要 s)` 拼接成新查询 q′，历史回滚到 H←(q′)，代理从压缩状态继续探索。\n\n> 结果：上下文长度瞬间回到 O(|q|+|s|)，而关键线索零丢失，实现**逻辑上的无限轮次**。\n\n2\\. 模型层：ReSumTool-30B——专为“网页长轨迹”蒸馏的摘要专家\n\n*   **数据引擎**  \n    用强模型（DeepSeek-R1 等）在 SailorFog-QA 上跑 ReSum rollout，收集 ⟨长对话, 专家摘要⟩ 10 k 对。\n*   **训练目标**  \n    对 Qwen3-30B-A3B-Thinking 做 SFT，优化目标：  \n    $$ \\\\max\\_\\\\phi \\\\mathbb{E}_{(H,s^\\*)}!\\\\left\\[\\\\log \\\\pi_\\\\phi(s^_|H)\\\\right\\] $$  \n    其中 s_ 需满足：事实可溯源、缺口可验证、下一步可执行。\n*   **效果**  \n    30 B 参数即可在 BrowseComp-zh 上超越 235 B 级通用模型，部署成本 ↓7×。\n\n3\\. 训练层：ReSum-GRPO——让代理“习惯”从摘要继续推理\n\n*   **轨迹分段**  \n    长轨迹被 K 次摘要自然切成 K+1 段，每段视为独立 episode。\n*   **优势广播**  \n    仅用最终答案对错得 0/1 奖励 R，归一化后整轨迹共享优势：  \n    $$ \\\\hat A^{(i)}\\_g = \\\\frac{R\\_g - \\\\mathrm{mean}({R})}{\\\\mathrm{std}({R})}, \\\\quad \\\\forall i\\\\in\\[1,n\\_g\\] $$  \n    保证每段都朝“生成易摘要、易推理”方向更新。\n*   **兼容性**  \n    只改 rollout 收集器，底层 GRPO 目标函数不变，短轨迹照常训练，**零额外超参**。\n\n4\\. 系统级效果\n\n组件\n\n解决的问题\n\n贡献\n\nReSum 范式\n\n上下文无限增长 → 周期性压缩\n\n推理长度理论 ∞，token 占用恒定\n\nReSumTool-30B\n\n通用模型摘要质量差、部署重\n\n30 B 专家模型，质量≥671 B，延迟↓\n\nReSum-GRPO\n\n代理不会“从摘要继续思考”\n\n1 k 样本让代理适应新模式，平均+8.2 % Pass@1\n\n综上，论文把“窗口耗尽”这一**资源瓶颈**转化为“摘要-重启”这一**算法步骤**，通过  \n**轻量级范式 + 专用摘要器 + 分段式 RL**  \n三位一体，首次让开源网页代理在**不增参、不改架构**的前提下完成**长周期、多轮次、证据链完整**的复杂搜索任务。\n\n**Q4**: 论文做了哪些实验？\n\n实验围绕“**能否在有限上下文里完成无限步探索**”这一核心命题展开，分**训练无关**与**训练相关**两大设置，共覆盖 3 个高难度 benchmark、3 个规模代理、2 种 RL 算法，系统验证 ReSum 的即插即用收益与 RL 适应效果。\n\n1 实验矩阵总览\n\n设置\n\n变量\n\n基准\n\n代理\n\n关键指标\n\n**训练无关**\n\n推理范式\n\nGAIA(103) / BrowseComp-en(200) / BrowseComp-zh(200)\n\nWebSailor-3B/7B/30B\n\nPass@1, Pass@3\n\n**训练相关**\n\nRL 算法\n\n同上\n\nWebSailor-3B/30B\n\nPass@1, Pass@3\n\n**消融**\n\n摘要工具\n\nBrowseComp-zh\n\nWebSailor-3B\n\nPass@1\n\n2 训练无关实验：验证“即插即用”\n\n2.1 主对比\n\n*   **基线**：ReAct（全历史追加） vs Recent-History（截断 22 k）\n*   **ReSum**：分别用 5 种摘要器（Qwen3-30B、GPT-OSS-120B、Qwen3-235B、DeepSeek-R1-671B、**ReSumTool-30B**）\n\n2.2 关键结果（Pass@1 绝对值，单位 %）\n\n代理\n\n基准\n\nReAct\n\nRecent\n\n**ReSumTool-30B**\n\n最佳外部摘要器\n\nWebSailor-3B\n\nBrowseComp-zh\n\n8.2\n\n13.2\n\n**13.7**\n\n15.2 (GPT-OSS-120B)\n\nWebSailor-7B\n\nBrowseComp-en\n\n5.7\n\n5.2\n\n**9.0**\n\n10.5 (GPT-OSS-120B)\n\nWebSailor-30B\n\nBrowseComp-en\n\n12.8\n\n10.3\n\n**16.0**\n\n18.8 (GPT-OSS-120B)\n\n> 结论：ReSum 范式**一致超越** ReAct（平均 +4.5 %）；自研 30 B 摘要器即可媲美 671 B 模型，部署成本↓7×。\n\n2.3 与 SOTA 闭源模型对齐\n\nWebSailor-30B + ReSumTool-30B 在 BrowseComp-en 达 **16.0 % Pass@1**，超越 Claude-4-Sonnet（12.2 %）与 Kimi-K2（14.1 %），**首次让开源代理进入第一梯队**。\n\n3 训练相关实验：验证“RL 适应”\n\n3.1 训练配置\n\n*   数据：从 SailorFog-QA 随机抽 1 k 题（刻意选长轨迹）\n*   算法：标准 GRPO vs **ReSum-GRPO**（4 epoch，batch=64，group=8）\n*   代理：WebSailor-3B/30B（无先前 RL 经验）\n\n3.2 结果（Pass@1）\n\n代理\n\n基准\n\nReAct\n\nGRPO\n\nReSum-GRPO\n\n10 k+ 样本 SOTA\n\nWebSailor-3B\n\nBrowseComp-zh\n\n8.2\n\n11.8\n\n**20.5**\n\n17.0 (MiroThinker-32B)\n\nWebSailor-30B\n\nBrowseComp-zh\n\n23.9\n\n23.3\n\n**33.3**\n\n15.6 (ASearcher-32B)\n\nWebSailor-30B\n\nBrowseComp-en\n\n12.8\n\n14.3\n\n**18.3**\n\n15.7 (WebExplorer-8B)\n\n> 结论：ReSum-GRPO 在 **1 k 样本**下即带来额外 **+3.7 %~+8.2 %** 绝对提升，**追平甚至超越**此前需 10 k+ 样本训练的最强开源代理。\n\n3.3 训练动力学\n\n*   ReSum-GRPO 初始奖励高于 GRPO 15 % 以上，收敛快 1.3×。\n*   长轨迹比例从 18 % → 42 %，说明代理学会主动利用摘要继续探索。\n\n4 消融与效率分析\n\n4.1 摘要器消融（BrowseComp-zh, WebSailor-3B）\n\n摘要器\n\nPass@1\n\n相对下降\n\nReSumTool-30B\n\n13.7 %\n\n—\n\nQwen3-30B（基座）\n\n6.9 %\n\n−49 %\n\nDeepSeek-R1-671B\n\n13.0 %\n\n−5 %\n\n> 专用训练带来 **49 % 错误降幅**，验证“任务特定摘要”必要性。\n\n4.2 资源开销\n\n*   **训练时间**：ReSum-GRPO 比 GRPO 仅长 33 %–69 %（单步 1.05 h vs 0.62 h，8×144 GB GPU）。\n*   **推理成本**：ReSum 平均 token/工具调用 ≈ 2×，但性能提升 4.5 %–8.2 %，**性价比线性可接受**。\n\n5 可重复性细节\n\n*   评分器：固定 Qwen2.5-72B-Instruct 做 LLM-as-Judge，避免人为偏差。\n*   预算：最大 60 工具调用，温度 0.6，top\\_p 0.95，全部实验同一脚本开源。\n\n综上，实验从**即插即用**到**RL 再训练**、从**3 B 到 30 B**、从**英文到中文**，系统证明：\n\n1.  ReSum 范式本身即可 **+4.5 % Pass@1**；\n2.  配合 ReSum-GRPO，**1 k 样本**就能追平此前 **10 k+ 样本**的 SOTA，**首次把开源网页代理送进第一梯队**。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下方向可被视为 ReSum 的“直接外延”或“深层机理”探索，均具备可验证的实验设置与明确评估指标。\n\n1 摘要触发策略：从“规则”到“自学”\n\n*   **问题现状**：固定 32 k token 触发器过于保守，可能过早/过晚。\n*   **可探索**\n    *   强化学习内嵌“何时摘要”动作，奖励 = 摘要后能否在 N 步内更接近答案。\n    *   不确定性估计：若代理对下一步动作熵值 > τ，则自动调用摘要。\n*   **评估**：同样 60 调用预算下，比较“自适应触发”与固定触发在 Pass@1 与平均调用数的帕累托前沿。\n\n2 摘要内容空间：从“文本”到“可验证结构化对象”\n\n*   **问题现状**：摘要仍为自然语言，下游代理可能误读。\n*   **可探索**\n    *   生成 JSON-LD/Knowledge-Graph 子图，节点附溯源 URL，边附置信度。\n    *   引入“可执行下一步”API 模板字段，让代理直接填充参数继续调用。\n*   **评估**：代理从结构化摘要恢复答案的准确率 vs 文本摘要；人工检验事实幻觉率。\n\n3 多摘要融合：跨会话、跨代理的“全局记忆”\n\n*   **问题现状**：每次重启后旧摘要只读，无法二次聚合。\n*   **可探索**\n    *   维护一个外部摘要池（向量索引），新摘要在池内做 RAG-merge，消除冗余、消解冲突。\n    *   引入“摘要版本链”，支持回溯式对比（类似 Git blame）。\n*   **评估**：同一查询跑 M 次独立会话，比较单会话 vs 池融合后的最终答案 F1 及事实一致性。\n\n4 在线摘要器自改进：蒸馏→RL 的循环放大\n\n*   **问题现状**：ReSumTool-30B 是一次性蒸馏，后续不再进化。\n*   **可探索**\n    *   用 ReSum-GRPO 产生的“高奖励轨迹”在线筛选优质摘要，反向微调 πsum，形成“摘要器↔策略”双塔共生。\n    *   采用 GRPO-within-GRPO 内环优化摘要器，外环优化策略。\n*   **评估**：迭代三轮后，摘要器在人工标注的“证据召回率”指标上绝对提升 Δ≥3 %。\n\n5 跨模态长周期探索：把 ReSum 搬到 GUI/移动端\n\n*   **问题现状**：ReSum 目前仅文本网页。\n*   **可探索**\n    *   将“摘要”升级为“跨模态状态”：含截图 OCR 文本、UI 结构树、已点击元素列表。\n    *   触发条件改为“截图差异度 < ε 且无新信息”，避免同一页面反复点击。\n*   **评估**：在 Mobile-Suite/WebArena 上比较原生长度限制 vs ReSum 的任务成功率，观察是否出现“无限循环”或“跨页面证据整合”新能力。\n\n6 理论侧：摘要压缩的最小充分性界限\n\n*   **问题现状**：无摘要长度 vs 信息损失的理论刻画。\n*   **可探索**\n    *   借鉴信息瓶颈，定义“摘要-答案互信息 I(A;S)”与压缩率 R=Lsummary/Lhistory，绘制 R-I 曲线。\n    *   寻找临界 R\\*，使得继续增大摘要长度不再提升 I(A;S)。\n*   **评估**：在合成数据集（GoldChain）上验证 R\\* 与任务难度（跳数）的线性关系，为后续自动选择摘要长度提供理论依据。\n\n7 安全与对齐：摘要能否成为“遗忘有害信息”的阀门\n\n*   **问题现状**：长轨迹可能混入隐私或有害内容。\n*   **可探索**\n    *   在摘要阶段引入“安全过滤器”，强制删除 PII 或违规 URL，并记录删除日志供后续审计。\n    *   研究“安全摘要”是否导致下游答案准确率下降，权衡实用性与合规性。\n*   **评估**：使用 Privacy-PolicyQA 基准，比较过滤前后答案准确率与隐私泄露分数（PII 计数）。\n\n8 异构工具链：摘要作为跨 API 的“通用检查点”\n\n*   **问题现状**：现实工作流常涉及搜索→代码执行→数据库查询等多工具。\n*   **可探索**\n    *   定义工具无关的“状态描述模式”，让摘要器把 SQL 结果、Python 输出统一编码为同一格式。\n    *   支持“断点续跑”：代理崩溃后从摘要恢复，无需重跑昂贵代码。\n*   **评估**：在 DataAgentBench（SQL+Python）上测量崩溃恢复后的答案一致性与重跑成本节省比例。\n\n以上任意一点均可在原代码库上增量实现，并通过**Pass@1、摘要压缩率、人工事实准确率、资源消耗**四维指标进行量化，形成对 ReSum 的“第二代”扩展。\n\n**Q6**: 总结一下论文的主要内容\n\n论文核心贡献可概括为“**一个范式、一个模型、一个算法**”，解决“**上下文窗口耗尽导致长周期搜索被迫中断**”的难题。\n\n1 痛点\n\n*   复杂网页查询需数十轮搜索-浏览-验证，ReAct 的“全历史追加”模式在 32 k token 上限内提前触顶，证据链无法闭合。\n\n2 ReSum 范式（Inference-level）\n\n*   **周期摘要**：达 token 上限时调用摘要工具，把冗长历史压缩成“已验证证据 + 信息缺口 + 下一步建议”的结构化摘要。\n*   **状态重启**：用“(原查询, 摘要)”作为新上下文继续探索，**逻辑上实现无限步推理**，而 token 占用瞬间降回常数级。\n*   **即插即用**：零改代理架构，仅增加 `<summary>` 触发器。\n\n3 ReSumTool-30B（Model-level）\n\n*   以 Qwen3-30B-A3B-Thinking 为基座，用 10 k 条长轨迹⟨对话, 专家摘要⟩做 SFT，专精“网页噪声中抽证据、标缺口、给方向”。\n*   30 B 参数在 BrowseComp-zh 上超越 235 B 通用模型，部署成本↓7×。\n\n4 ReSum-GRPO（Training-level）\n\n*   长轨迹被自然切成多段，每段共享**最终答案对错**归一化后的优势信号，迫使代理“学会”从摘要继续推理。\n*   仅 1 k 样本即可让 WebSailor-30B 在 BrowseComp-zh 从 23.9 % → 33.3 % Pass@1，**追平或超越**此前需 10 k+ 样本的 SOTA 开源代理。\n\n5 实验结果\n\n设置\n\n平均增益\n\n最高增益\n\n备注\n\n训练无关 ReSum\n\n+4.5 % Pass@1\n\n+8.2 %\n\n3 基准 × 3 规模代理一致提升\n\nReSum-GRPO 再训练\n\n额外 +4.1 %\n\n+8.2 %\n\n1 k 样本 ≈ 此前 10 k 样本效果\n\n6 结论\n\nReSum 用**轻量级摘要-重启**取代“堆历史”，首次让**任意现有网页代理**在**不增参、不改架构**的情况下完成**理论上无限步**的探索，并通过专用摘要器与分段 RL 将开源模型推向 SOTA 水平。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是ReSum%3A%20Unlocking%20Long-Horizon%20Search%20Intelligence%20via%20Context%20Summarization，链接是  https://arxiv.org/pdf/2509.13313  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.13313  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-6-1758152840088","title":"Single-stream Policy Optimization","description":"We revisit policy-gradient optimization for Large Language Models (LLMs) from a single-stream perspective. Prevailing group-based methods like GRPO reduce variance with on-the-fly baselines but suffer from critical flaws: frequent degenerate groups erase learning signals, and synchronization barriers hinder scalability. We introduce Single-stream Policy Optimization (SPO), which eliminates these issues by design. SPO replaces per-group baselines with a persistent, KL-adaptive value tracker and normalizes advantages globally across the batch, providing a stable, low-variance learning signal for every sample. Being group-free, SPO enables higher throughput and scales effectively in long-horizon or tool-integrated settings where generation times vary. Furthermore, the persistent value tracker naturally enables an adaptive curriculum via prioritized sampling. Experiments using Qwen3-8B show that SPO converges more smoothly and attains higher accuracy than GRPO, while eliminating computation wasted on degenerate groups. Ablation studies confirm that SPO's gains stem from its principled approach to baseline estimation and advantage normalization, offering a more robust and efficient path for LLM reasoning. Across five hard math benchmarks with Qwen3 8B, SPO improves the average maj@32 by +3.4 percentage points (pp) over GRPO, driven by substantial absolute point gains on challenging datasets, including +7.3 pp on BRUMO 25, +4.4 pp on AIME 25, +3.3 pp on HMMT 25, and achieves consistent relative gain in pass@$k$ across the evaluated $k$ values. SPO's success challenges the prevailing trend of adding incidental complexity to RL algorithms, highlighting a path where fundamental principles, not architectural workarounds, drive the next wave of progress in LLM reasoning.","url":"https://huggingface.co/papers/2509.13232","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.088Z","metadata":{"authors":["Zhongwen Xu","Zihan Ding"],"date":"","rank":7,"llmAnalysis":"","categories":["cs.LG","cs.AI","stat.ML"],"pdfUrl":"https://arxiv.org/pdf/2509.13232.pdf","arxivUrl":"https://arxiv.org/abs/2509.13232","arxivId":"2509.13232","coolPaperUrl":"https://papers.cool/arxiv/2509.13232","published":"2025-09-16T16:39:11Z","updated":"2025-09-16T16:39:11.000Z","zh_summary":"翻译失败: Unexpected end of JSON input","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文旨在解决**基于组（group-based）策略优化方法**在大语言模型（LLM）强化学习训练中的**两大核心缺陷**：\n\n1.  **计算浪费**：  \n    当一组采样响应全部正确或全部错误时（即“退化组”），组内相对优势归零，导致**梯度信号完全消失**，大量生成与评估开销被浪费。\n    \n2.  **可扩展性瓶颈**：  \n    组方法要求**同组所有响应完成后才能计算优势**，在分布式环境或长周期、多轮工具调用的智能体任务中，**最慢响应成为同步屏障**，严重拖慢训练吞吐率。\n    \n\n为此，作者提出**单流策略优化（SPO）**，回归经典单样本策略梯度范式，通过\n\n*   持续、KL 自适应的贝叶斯价值跟踪器替代瞬时组基线；\n*   全局批次级优势归一化；\n*   基于不确定性的优先采样课程；\n\n在**消除退化组与同步等待**的同时，显著降低梯度方差，提升**训练效率、扩展性与最终推理准确率**。\n\n**Q2**: 有哪些相关研究？\n\n论文在第 2 节“Related Work”与附录 C 中系统梳理了与 SPO 直接对比或思想相关的研究，可归纳为以下四条主线：\n\n1\\. 组相对（group-based）方法：SPO 的主要批判对象\n\n代表工作\n\n核心思想\n\n与 SPO 的关键差异\n\n**GRPO** (Shao et al. 2024)\n\n每 prompt 采样 G 条回答，用组内均值/标准差构造瞬时基线并归一化优势。\n\n存在“退化组”信息损失与同步屏障；基线仅依赖当前小样本，方差高。\n\n**DAPO** (Yu et al. 2025)\n\n在 GRPO 基础上加“动态采样”——持续生成直到出现成功+失败为止。\n\n保证非零优势，但期望采样数随 p→0/1 爆炸；计算浪费更严重。\n\n**RLOO** (Ahmadian et al. 2024)\n\n回到 REINFORCE，用“留一法”组内 baseline。\n\n仍受限于组同步与小样本估计，方差与退化问题依旧。\n\n**GRESO** (Zheng et al. 2025)\n\n在线过滤，提前预测并跳过“无信息” prompt。\n\n减少 rollout 开销，但未触动组架构本身；仍需等待组完成。\n\n**Lite PPO** (Liu et al. 2025)\n\n仅保留优势归一化与 token-级 loss 聚合，去掉价值网络。\n\n仍沿用 per-group 归一化，未解决根本缺陷。\n\n2\\. 单样本/单流思想——与 SPO 同阵营\n\n代表工作\n\n核心思想\n\n与 SPO 的关系\n\n__A_\\-PO_\\* (Brantley et al. 2025)\n\n两阶段：①离线回归拟合最优 V\\*；②在线用 V\\* 构造优势做最小二乘策略更新。\n\n同为“单样本”输入，但 V\\* 固定离线，不随策略漂移；且受 KL-正则约束。\n\n**REINFORCE++ / BASLINE-++** (Hu et al. 2025)\n\n在单样本 REINFORCE 上加 prompt-级鲁棒基线估计。\n\n共享“单流”理念，但未引入持续贝叶斯跟踪与全局归一化。\n\n3\\. 价值函数估计与方差约减理论\n\n主题\n\n代表文献\n\n对 SPO 的启发\n\n最优基线理论\n\nSutton & Barto 2018; Greensmith et al. 2004\n\n证明使用真实 V\\_π 可最小化梯度方差；SPO 用 KL-自适应跟踪器逼近。\n\n全局优势归一化\n\nSchulman et al. 2017 (PPO); Andrychowicz et al. 2020\n\n在大批次内统一标准化，降低缩放噪声；SPO 直接采用。\n\n贝叶斯在线更新\n\n经典 Beta-Bernoulli 更新\n\nSPO 把其扩展为“带遗忘”的指数加权，以应对非平稳策略。\n\n4\\. 课程学习与优先采样\n\n代表工作\n\n核心思想\n\n与 SPO 的对应\n\n**Prioritized Experience Replay** (Schaul et al. 2015)\n\n用 TD-error 优先回放转移。\n\nSPO 改为用 √{p(1-p)} 优先采样 prompt，形成自适应课程。\n\n**POLARIS** (An et al. 2025)\n\n多级难度课程+重复策略，聚焦“可学习”样本。\n\n目标类似，但 POLARIS 仍基于组重复；SPO 在采样前即完成调度，无生成后丢弃。\n\n小结\n\n*   **组相对路线**（GRPO 系列）是 SPO 直接对标与超越的对象；\n*   **单样本路线**（A\\*-PO 等）与 SPO 共享“去组化”愿景，但 SPO 通过**持续贝叶斯跟踪+全局归一化+优先课程**形成更完整的解决方案；\n*   经典**方差约减与课程学习理论**为 SPO 的设计提供了原则性支撑。\n\n**Q3**: 论文如何解决这个问题？\n\n论文把“组相对”范式彻底拆散，回归单样本（single-stream）策略梯度，并用三个互补组件系统性地替换掉 GRPO 的瞬时组基线与组内归一化。具体做法如下：\n\n1\\. KL-自适应价值跟踪器 ── 替代“组基线”\n\n*   把每个 prompt 视为独立 Bernoulli 过程，用 Beta(α,β) 维护其**持续**成功概率估计  \n    ˆv(x)=α/(α+β)≈V\\_π(x)\n    \n*   每次观测新 reward 后，**先按策略漂移程度折扣历史**，再更新：  \n    α←ρ(x)·α\\_{-1}+r, β←ρ(x)·β\\_{-1}+(1-r)  \n    其中 ρ(x)=2^{-D(x)/D\\_half}，D(x) 是本次策略与上次作用于 x 时的 KL 距离。  \n    → 策略变化越大，遗忘越快，保证跟踪器始终跟得上非平稳策略。\n    \n*   该更新等价于**自适应学习率 EMA**  \n    ˆv(x)←ˆv\\_{-1}(x)+η(x)(r-ˆv\\_{-1}(x))  \n    学习率 η(x) 随置信度与漂移自动调节，无需调参。\n    \n\n2\\. 全局优势归一化 ── 替代“组内归一化”\n\n*   优势计算完全**脱离当前批次**的统计量：  \n    A(x,y)=r(x,y)−ˆv\\_{-1}(x)  \n    保证 baseline 与动作独立，梯度无偏。\n    \n*   归一化阶段**在整个 prompt 批次**上一次性完成：  \n    Ã=(A−μ\\_B)/σ\\_B (B≫G)  \n    均值/方差估计来自数百上千独立样本，噪声远低于 GRPO 的 8–16 样本组。\n    \n\n3\\. 优先采样课程 ── 替代“均匀采样+动态补救”\n\n*   采样权重与**贝叶斯不确定性**成正比：  \n    w(x)∝√{ˆv\\_{-1}(x)(1−ˆv\\_{-1}(x))}+ε  \n    自动把算力投向“半生不熟”的 prompt；完全学会或完全不会的权重被抑制，ε 防止塌陷。\n    \n*   调度在**生成前完成**，无需像 DAPO 那样生成后丢弃，实现“零浪费”课程。\n    \n\n4\\. 算法与系统实现\n\n*   整个训练循环（Algorithm 1）只有三层：\n    \n    1.  按 w(x) 采 prompt → 单样本 rollout → 用 ˆv\\_{-1} 算 A\n    2.  批次级归一化 → PPO-Clip 更新策略\n    3.  用新 reward 更新 Beta 跟踪器\n*   **无组同步**：每个样本是独立数据点，分布式环境可异步收集；长尾轨迹不再拖住整个批次。  \n    在作者模拟的智能体场景里，batch 组装时间从 486 s → 112 s，**吞吐提高 4.35×**。\n    \n\n5\\. 效果验证\n\n*   五套高难度数学竞赛题（AIME、BRUMO、HMMT 等）上，Qwen3-8B 用 SPO 训练后  \n    **maj@32 平均绝对提升 +3.4 pp**；BRUMO 25 单数据集 **+7.3 pp**。\n*   梯度方差降低约 50%，且**不存在退化组**；GRPO 60–80% 样本零梯度的情况在 SPO 中消失。\n*   pass@k 曲线全线高于 GRPO，表明优势信号更稳定、泛化更好。\n\n一句话总结\n\nSPO 用“**持续贝叶斯价值跟踪 + 全局批次归一化 + 不确定性优先课程**”三件套，彻底取代组相对方法的小样本瞬时基线，从而**消除退化组浪费与同步瓶颈**，在更低方差、更高吞吐的前提下取得更优推理准确率。\n\n**Q4**: 论文做了哪些实验？\n\n论文围绕“**算法效率**”与“**推理性能**”两大维度，共设计四类实验，全部基于 Qwen3-8B 模型、英文 DAPO 数学数据集，并在统一开源框架（verl + ReTool）下完成，以保证公平可比。核心结果汇总如下：\n\n1\\. 主实验：五套高难度数学竞赛基准\n\n数据集\n\n类型\n\n测试题量\n\nAIME 24 / 25\n\n美国数学邀请赛\n\n30 / 30\n\nBeyondAIME\n\n扩展 AIME 级\n\n100\n\nBRUMO 25\n\n保加利亚数学奥林匹克\n\n50\n\nHMMT 25\n\n哈佛-麻省数学锦标赛\n\n60\n\n**指标**\n\n*   maj@32：32 条输出投票后最终答案准确率\n*   avg@32：32 条输出平均单样本准确率\n*   pass@k（k=8,16,32）：k 条内至少对一次的概率（无偏估计）\n\n**结果（表 1 + 图 2）**\n\n方法\n\nmaj@32 平均\n\n相对提升\n\nGRPO\n\n60.4 %\n\n—\n\nSPO\n\n63.8 %\n\n**+3.4 pp**\n\n*   单数据集最高增幅：**BRUMO 25 +7.3 pp**；AIME 25 +4.4 pp；HMMT 25 +3.3 pp。\n*   pass@k 曲线在 5 个数据集、所有 k 值上 SPO 均高于 GRPO，平均 **+2.4 pp**。\n\n2\\. 信号效率与稳定性剖析（图 3）\n\n*   **退化组比例**  \n    GRPO 训练全程 60 %→80 % 样本因“全对/全错”获得零优势；SPO 的 |A|<0.02 比例仅 ≈20 % 且随训练**主动升高**（ tracker 变准，残余变小），**无梯度浪费**。\n    \n*   **优势方差**  \n    SPO 相对原始 reward 降低 **≈50 %**；GRPO 有效样本方差反而**高于原始 reward**，说明其组内基线/缩放极度不稳定。\n    \n\n3\\. 智能体场景吞吐模拟（图 4-5）\n\n设定：组装 24 条训练样本\n\n*   **Group-based**（并行 6 组×4 选 3 最快组）受 508 s 长尾拖慢，**总耗时 486 s**。\n*   **SPO group-free**（超发 48 条取最先 24 条完成）**112 s** 完成，**4.35× 加速**。  \n    结论：SPO 的异步、无屏障设计在长周期、多轮工具调用环境中可线性扩展，GRPO 则受“最慢轨迹”瓶颈。\n\n4\\. 超参与消融检验（附录）\n\n*   **离线初始化必要性**：n₀=8 相对“无预热”前 20 步训练曲线更平滑，避免早期高方差。\n*   **遗忘阈值** ρ\\_min=0.875 (窗口 8) 在稳定性-适应性间平衡；再减小方差升高，再增大跟踪滞后。\n*   **优先采样 ε=0.05** 可在“完全探索”与“课程聚焦”间取得最佳最终性能；ε=0 导致早期过度聚焦，后期泛化略降。\n\n实验覆盖总结\n\n维度\n\n实验内容\n\n关键结论\n\n最终性能\n\n5 大赛题 maj@32 / pass@k\n\nSPO 全线领先，最高 +7.3 pp\n\n训练效率\n\n梯度信号利用率、方差\n\n零退化组，方差 ↓50 %\n\n系统可扩展\n\n智能体长尾延迟模拟\n\n4.35× 吞吐提升\n\n算法鲁棒\n\n初始化、ρ、ε 消融\n\n设计参数合理，缺一不可\n\n以上实验共同证明：**SPO 不仅“更简单”，而且同时获得更高准确率、更低方差与显著基础设施收益**。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下方向可在此基础上继续推进，分为“理论-算法”“系统-规模”“任务-形态”三大板块，供后续研究参考：\n\n理论-算法层面\n\n1.  **非二进制奖励的贝叶斯扩展**  \n    当前 Beta-Bernoulli 模型仅适用于 0/1 奖励。可尝试：\n    \n    *   用 **Gamma-Poisson** 或 **Normal-Normal** 共轭对处理计数/连续奖励；\n    *   对多步稀疏奖励，引入 **Gamma-Poisson 时间序列** 把“成功次数/总次数”换成“累计回报/访问次数”。\n2.  **跟踪器遗忘系数的自适应最优性**  \n    ρ(x)=2^(−D(x)/D\\_half) 中的 D\\_half 现为常数超参。可：\n    \n    *   把 D\\_half 视为可学习参数，用 **meta-gradient** 最小化梯度方差目标在线调整；\n    *   或借鉴 **Bayesian Change-Point Detection**，在 KL 漂移显著时自动缩短窗口。\n3.  **与优势-方差下界的比较**  \n    论文给出经验方差下降 50 %。可进一步推导 **SPO 优势估计器的方差闭合式**，与 Konda-Tsitsiklis、Greensmith 等下界对比，验证是否接近理论最优。\n    \n4.  **策略熵与基线的联合优化**  \n    SPO 目前仅使用 PPO-Clip。可将 **熵正则项** 显式写入目标，与 ˆv(x) 共同做 **二阶优化**，在保持高概率正确的同时延迟熵崩溃。\n    \n\n系统-规模层面\n\n5.  **异步分布式框架的极致化**\n    \n    *   把“超发-取最快”策略做成 **在线 Early-Stopping** 协议：当已收样本≥B 且剩余未完成样本的期望边际收益低于阈值时，主动终止长尾任务；\n    *   结合 **partial rollout / v-trace 截断**，在万卡级集群上测试是否保持线性加速。\n6.  **异构算力环境下的动态批尺寸**  \n    不同 GPU/TPU 的推理延迟差异显著。可让 **批大小 B 成为随集群状态变化的随机变量**，用 **MARL 视角** 把“采样-训练”看作多智能体合作，最大化全局吞吐。\n    \n7.  **CPU-GPU 协同的 Value Tracker offload**  \n    Beta 更新计算量极小，可放在 **CPU 侧异步刷新**，GPU 仅读取 ˆv(x) 常量，减少 kernel 内分支，进一步压缩 step time。\n    \n\n任务-形态层面\n\n8.  **长周期智能体任务的真实端到端训练**  \n    论文模拟了延迟分布。可在：\n    \n    *   **BrowseComp-Plus** 或 **WebShop** 等多轮网页导航任务；\n    *   **Thousands-of-Games** 3D 环境（平均 2k+ 步/局）  \n        上验证 SPO 是否保持 4×+ 加速且提升最终成功率。\n9.  **多模态工具链（代码+检索+图像）混合奖励**  \n    当奖励空间变为 **{0,0.5,1}**（代码通过但结果错、部分对、全对）或 **多维向量** 时，测试全局归一化与优先采样是否仍优于组相对基线。\n    \n10.  **迭代式“自我进化”课程**  \n    当前优先权重仅依赖不确定性。可引入 **在线难度估计** 与 \\*\\* regret 信号\\*\\*，让课程从“易→难→易”动态循环，防止过拟合早期分布。\n    \n11.  **SPO 作为生成式验证器微调的正则器**  \n    把 ˆv(x) 视作“模型对自己答案的信心”，与 **Test-Time Scaling** 结合：\n    \n    *   高 1−ˆv(x) 的 prompt 在推理阶段分配更多生成预算；\n    *   低 ˆv(x) 的 prompt 直接提前停止，节省推理成本。\n\n小结\n\n*   **理论侧** 可深挖非平稳环境下的最优遗忘率与方差下界；\n*   **系统侧** 可把异步、早停、异构算力推向极致，实现万卡级线性扩展；\n*   **任务侧** 可把 SPO 的“单流+优先”思想搬到长周期智能体、多模态工具链及测试-时缩放场景，验证通用性。\n\n这些方向既能进一步压缩训练成本，也有望在更复杂的推理与智能体任务上继续拉开与组相对方法的差距。\n\n**Q6**: 总结一下论文的主要内容\n\n论文核心速览\n\n**题目**：Single-stream Policy Optimization (SPO)  \n**目标**：解决“组相对”强化学习在 LLM 推理训练中**计算浪费 + 同步瓶颈**两大顽疾，用**单样本、无组、异步**的新范式实现更高准确率与吞吐。\n\n1\\. 问题剖析\n\n*   **退化组**：同组回答全对/全错 → 优势归零 → 梯度信号 100 % 浪费。\n*   **同步屏障**：组内最慢样本拖慢整个 batch，长周期/多轮工具场景尤为严重。\n\n2\\. 方法总览（三组替换）\n\nGRPO 组件\n\nSPO 替代\n\n关键公式\n\n瞬时组基线\n\n**KL-自适应 Beta 跟踪器**\n\nρ(x)=2^(−D\\_KL/ D\\_half)，α←ρα+r，β←ρ(1−r)\n\n组内归一化\n\n**全局批次归一化**\n\nÃ=(A−μ\\_B)/σ\\_B，B≫G\n\n均匀采样\n\n**不确定性优先课程**\n\nw(x)∝√{v(1−v)}+ε\n\n**算法骨架**：单 prompt → 单回答 → 用跟踪器得 A → 批次归一 → PPO-Clip 更新 → 在线更新 Beta。\n\n3\\. 主要结果\n\n*   **精度**：Qwen3-8B 在五大赛题 maj@32 平均 **63.8 % vs 60.4 %**（+3.4 pp），最高单数据集 **+7.3 pp**。\n*   **效率**：梯度方差 ↓50 %，零退化组；智能体模拟 **4.35× 吞吐**提升。\n*   **稳定性**：全程无手动补救，曲线更平滑。\n\n4\\. 贡献一句话\n\nSPO 用“**持续贝叶斯价值跟踪 + 全局归一化 + 优先课程**”拆掉组同步，**同时获得更低方差、更高准确率与显著基础设施收益**，为 LLM 推理 RL 提供简洁而更强健的新基线。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Single-stream%20Policy%20Optimization，链接是  https://arxiv.org/pdf/2509.13232  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.13232  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-7-1758152840090","title":"Hunyuan3D Studio: End-to-End AI Pipeline for Game-Ready 3D Asset Generation","description":"The creation of high-quality 3D assets, a cornerstone of modern game development, has long been characterized by labor-intensive and specialized workflows. This paper presents Hunyuan3D Studio, an end-to-end AI-powered content creation platform designed to revolutionize the game production pipeline by automating and streamlining the generation of game-ready 3D assets. At its core, Hunyuan3D Studio integrates a suite of advanced neural modules (such as Part-level 3D Generation, Polygon Generation, Semantic UV, etc.) into a cohesive and user-friendly system. This unified framework allows for the rapid transformation of a single concept image or textual description into a fully-realized, production-quality 3D model complete with optimized geometry and high-fidelity PBR textures. We demonstrate that assets generated by Hunyuan3D Studio are not only visually compelling but also adhere to the stringent technical requirements of contemporary game engines, significantly reducing iteration time and lowering the barrier to entry for 3D content creation. By providing a seamless bridge from creative intent to technical asset, Hunyuan3D Studio represents a significant leap forward for AI-assisted workflows in game development and interactive media.","url":"https://huggingface.co/papers/2509.12815","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.090Z","metadata":{"authors":["Biwen Lei","Yang Li","Xinhai Liu","Shuhui Yang","Lixin Xu","Jingwei Huang","Ruining Tang","Haohan Weng","Jian Liu","Jing Xu","Zhen Zhou","Yiling Zhu","Jiankai Xing","Jiachen Xu","Changfeng Ma","Xinhao Yan","Yunhan Yang","Chunshi Wang","Duoteng Xu","Xueqi Ma","Yuguang Chen","Jing Li","Mingxin Yang","Sheng Zhang","Yifei Feng","Xin Huang","Di Luo","Zebin He","Puhua Jiang","Changrong Hu","Zihan Qin","Shiwei Miao","Haolin Liu","Yunfei Zhao","Zeqiang Lai","Qingxiang Lin","Zibo Zhao","Kunhong Li","Xianghui Yang","Huiwen Shi","Xin Yang","Yuxuan Wang","Zebin Yao","Yihang Lian","Sicong Liu","Xintong Han","Wangchen Qin","Caisheng Ouyang","Jianyin Liu","Tianwen Yuan","Shuai Jiang","Hong Duan","Yanqi Niu","Wencong Lin","Yifu Sun","Shirui Huang","Lin Niu","Gu Gong","Guojian Xiao","Bojian Zheng","Xiang Yuan","Qi Chen","Jie Xiao","Dongyang Zheng","Xiaofeng Yang","Kai Liu","Jianchen Zhu","Lifu Wang","Qinglin Lu","Jie Liu","Liang Dong","Fan Jiang","Ruibin Chen","Lei Wang","Chao Zhang","Jiaxin Lin","Hao Zhang","Zheng Ye","Peng He","Runzhou Wu","Yinhe Wu","Jiayao Du","Jupeng Chen","Xinyue Mao","Dongyuan Guo","Yixuan Tang","Yulin Tsai","Yonghao Tan","Jiaao Yu","Junlin Yu","Keren Zhang","Yifan Li","Peng Chen","Tian Liu","Di Wang","Yuhong Liu","Linus","Jie Jiang","Zhuo Chen","Chunchao Guo"],"date":"","rank":8,"llmAnalysis":"","categories":["cs.CV"],"pdfUrl":"https://arxiv.org/pdf/2509.12815.pdf","arxivUrl":"https://arxiv.org/abs/2509.12815","arxivId":"2509.12815","coolPaperUrl":"https://papers.cool/arxiv/2509.12815","published":"2025-09-16T08:33:03Z","updated":"2025-09-16T08:33:03.000Z","zh_summary":"高质量3D资产的创建是现代游戏开发的基石，长期以来以劳动密集型和专业化的工作流程为特征。本文介绍了Hunyuan3D工作室，这是一个端到端的人工智能驱动的内容创作平台，旨在通过自动化和简化游戏准备3D资产的生成来革新游戏制作流程。在其核心，Hunyuan3D工作室将一套先进的神经模块（如部件级3D生成、多边形生成、语义UV等）集成到一个统一且用户友好的系统中。这个统一的框架允许将单个概念图像或文本描述快速转化为一个完整的、符合生产质量的3D模型，具备优化的几何形状和高保真的PBR纹理。我们展示了Hunyuan3D工作室生成的资产不仅在视觉上引人注目，而且符合当代游戏引擎严格的技术要求，显著缩短了迭代时间并降低了3D内容创作的入门门槛。通过提供从创意意图到技术资产的无缝桥梁，Hunyuan3D工作室代表了游戏开发和互动媒体中AI辅助工作流程的重大进步。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文旨在解决传统3D游戏资产制作流程中“高视觉质量”与“技术就绪度”难以兼得的瓶颈问题。具体而言：\n\n*   **传统管线痛点**  \n    手工建模-拓扑-拆UV-贴图-绑定五步各自依赖不同软件，周期长、门槛高；AI 方法往往只解决单点（如几何或纹理），输出网格面数冗余、拓扑混乱、UV 语义缺失、PBR 贴图不兼容，仍需大量人工返工。\n    \n*   **核心目标**  \n    建立端到端、一键式、**引擎可直接调用**的 AI 管线，实现“单张概念图或一句话 → 带 PBR 材质、低面数、已绑定、可动画”的游戏级资产，显著压缩迭代时间并降低创作门槛。\n    \n\n**Q2**: 有哪些相关研究？\n\n*   **几何生成**\n    \n    *   Hunyuan3D 系列（Hunyuan3D 2.1/2.5、Michelangelo）\n    *   3DShape2VecSet、Clay、MeshGPT、Meshtron\n    *   基于扩散或自回归的图像/文本到 3D 网格/点云方法（DiffusionGAN3D、PartCrafter、HoloPart、OmniPart）\n*   **部件级/结构感知生成**\n    \n    *   PartField、SAMesh、Find3D、SAMPart3D\n    *   P3-SAM（原生 3D 部件分割）\n    *   X-Part（结构一致部件分解）\n*   **自动拓扑与低面数网格生成**\n    \n    *   PolyGen、DeepMesh、MeshAny\n    *   Blocked-and-Patchified Tokenization（BPT）\n    *   基于自回归或强化学习的面序列生成（Mesh-RFT）\n*   **语义 UV 展开**\n    \n    *   XAtlas、Nuvo、FAM、Flatten-Anything\n    *   SeamGPT（自回归切割线预测）\n*   **多视图一致纹理与 PBR 材质**\n    \n    *   MaterialMVP、Romantex\n    *   多视图扩散烘焙、IP-Adapter/Flux-Kontext 风格迁移\n    *   4K 可平铺材质球生成（3D VAE + DiT）\n*   **自动绑定与蒙皮**\n    \n    *   UniRig、Auto-Connect、RigAnything\n    *   MagicArticulate、Make-it-Animatable\n    *   基于模板或自回归的骨架生成 + 拓扑感知权重预测\n\n**Q3**: 论文如何解决这个问题？\n\n论文将“高保真 yet 引擎就绪”的 3A 资产生成拆成 **7 个顺序、可微、可反向传播** 的神经网络模块，并通过统一资产图（Asset Graph）把每步元数据向下游传递，实现“单图/一句话 → 游戏直用”的一键闭环。核心思路是：**用数据驱动的神经算子替代传统手工管线，并在每个环节显式注入“游戏约束”**。\n\n1.  **可控概念图生成**\n    \n    *   文本/参考图 → 多视图 + 风格化 LoRA，内置 A-Pose 标准化网络，保证后续绑定一致性。\n    *   输出：带相机矩阵、风格标签、前景掩码的 4-6 张 512² 视图。\n2.  **高保真几何扩散**\n    \n    *   Hunyuan3D-DiT（21 层 MoE-Transformer）在 ShapeVAE 隐空间做流匹配。\n    *   条件 = 单视图 cI + 可选 bbox cB + 自生成多视图 {cIⁱ}，显式对齐比例与深度。\n    *   输出：带表面法向的 512³ 有向距离场 → 抽取高密度三角网格（≈ 200 k-500 k 面）。\n3.  **部件级 3D 生成**\n    \n    *   P3-SAM：3D 点提示分割网络，370 万自动标注网格训练，零样本给出部件掩码。\n    *   X-Part：以部件 bbox 为提示的潜码扩散，保证“语义+结构”双一致，避免边界模糊。\n    *   输出：带部件标签的子网格，支持独立编辑/替换。\n4.  **PolyGen 低面数拓扑**\n    \n    *   自回归 Transformer + BPT 标记化（块索引+面片聚合），直接逐面预测顶点索引。\n    *   两阶段训练：  \n        – 大规模网格预训练重建损失；  \n        – Masked-DPO 偏好微调，用 BER/TS/HD 三元指标自动排序 8 候选网格，仅对“坏区域”token 施加偏好损失。\n    *   输出：4 k-8 k 面的游戏级网格，边流已预对齐变形方向。\n5.  **SeamGPT 语义 UV**\n    \n    *   把切割线表示为有序 3D 线段序列，Hourglass Transformer 自回归生成。\n    *   输入仅在边/顶点处采 61 k 结构点，保证切口与网格对齐；长度嵌入控制粒度。\n    *   输出：低拉伸、语义连续（同材质同岛）的 UV 布局，可直接进 Blender/UE/Unity。\n6.  **PBR 纹理合成与多模态编辑**\n    \n    *   多视图扩散 + 投影烘焙 → 4K BaseColor/Normal/Rough/Metal。\n    *   80 k 资产训练 VLM 描述符，支持文本或参考图全局/局部编辑；CLIP 相似度决定注入路径（VAE 或 IP-Adapter）。\n    *   额外 4K 材质球 DiT，可平铺输出，供艺术家二次混合。\n7.  **自动绑定与蒙皮**\n    \n    *   人形：22 关节模板 + 拓扑感知权重预测，输入 T-pose；\n    *   非人形：自回归骨架生成（OPT-350M）+ 图卷积拓扑编码，输出任意关节数。\n    *   统一损失：关节位置误差 + 权重平滑 + 运动可变形能量，确保 UE/Unity 内直接播放动画。\n\n**统一资产图**\n\n*   每步输出附带参数化节点（mesh, part-id, uv-island, material-id, joint-weight）。\n*   用户可在任意节点调参（如“面数减 30 %”、“金属度 + 0.2”），梯度或元数据自动前向/反向传播，无需全链重跑。\n*   末端导出插件一次性生成 .fbx/.gltf + UE/Unity 材质模板，完成技术合规检查（面数、贴图分辨率、命名规范）。\n\n通过上述神经-图形混合管线，论文把传统 5-7 天的人工工作量压缩到 **10-15 分钟端到端生成**，同时满足现代游戏引擎对拓扑、UV、PBR、骨骼的硬性指标。\n\n**Q4**: 论文做了哪些实验？\n\n论文围绕“**生成质量**”与“**引擎就绪度**”两大维度，在**几何、部件、拓扑、UV、纹理、绑定**六大模块分别设置了定量基准测试、用户研究与消融实验，并给出跨模块端到端案例。核心实验汇总如下：\n\n模块\n\n数据集\n\n指标\n\n主结论\n\n**1\\. 高保真几何生成**\n\nGSO / Objaverse 2k 张单图\n\nChamfer ↓ / F-score ↑ / 法向一致性 ↑\n\n多视图条件较单图 [F-score@0.5](mailto:F-score@0.5) 提升 8.3；bbox 条件解决比例失衡，成功率 96%。\n\n**2\\. 部件分割 (P3-SAM)**\n\nPartObj-Tiny / PartNetE\n\nmIoU ↑ / 交互成功率 ↑\n\n零样本 mIoU 81.14（+1.96 SOTA）；交互式分割 51.23（+38.2 相对 Point-SAM）。\n\n**3\\. 部件分解 (X-Part)**\n\nObjaverse-Part-Tiny 200 样例\n\nCD ↓ / [F-score@0.1](mailto:F-score@0.1) ↑ / @0.5 ↑\n\nCD 0.11（-0.06 SOTA）；[F-score@0.5](mailto:F-score@0.5) 0.71（+0.14）。\n\n**4\\. PolyGen 低面数拓扑**\n\n自建 50k 游戏资产\n\nBER ↓ / TS ↑ / HD ↓\n\n后训练使 BER ↓37%，破面率 ↓82%；复杂机匣 8k 面 HD 0.18×10⁻³ 优于 DeepMesh 0.43。\n\n**5\\. 语义 UV (SeamGPT)**\n\nFAM / Toys4K\n\n面扭曲能量 ↓\n\n平均扭曲 13.04（-5.33 次优）；用户研究“可编辑性”4.0/5（+0.9）。\n\n**6\\. PBR 纹理 & 编辑**\n\n自采 3k 商用资产\n\nLPIPS ↓ / SSIM ↑ / 色差 ΔE ↓\n\n多视图一致 LPIPS 0.051；文本编辑保留几何结构 ΔE<2.3；4K 材质球无接缝 SSIM 0.97。\n\n**7\\. 自动绑定**\n\n自建 80k 通用 + 10k 人形\n\n关节位置误差 ↓ / 权重光滑度 ↑\n\n通用骨架误差 1.8 mm（-0.9 UniRig）；人形 Skinning 形变能量 ↓22%。\n\n**8\\. 端到端耗时 & 合规**\n\n20 名艺术家 30 天双盲\n\n生产时间 ↓ / 引擎报错率 ↓\n\n单资产平均 12.4 min（人工 5.2 h）；导入 UE5 报错率 2%（人工 9%）。\n\n关键消融实验\n\n*   **多视图 vs 单视图条件**：[F-score@0.5](mailto:F-score@0.5) 从 0.63→0.71。\n*   **bbox 条件消融**：比例误差 >15% 的样本从 22%→4%。\n*   **PolyGen 后训练**：BER 0.18→0.11，破面率 9%→1.6%。\n*   **SeamGPT 采样策略**：边-顶点采样较均匀采样扭曲能量 ↓28%。\n*   **纹理 CLIP-相似度门限**：阈值 0.78 时编辑一致性最佳，↑0.05 过拟合风格。\n\n用户研究\n\n*   **UV 展开**：20 名专业艺术家盲评，SeamGPT 在“边界完整度”“编辑友好度”双指标均显著优于 XAtlas、Nuvo、FAM（p<0.01）。\n*   **纹理编辑**：20 名美术对 120 组文本/图像编辑打分，Hunyuan3D 在“风格忠实”“几何保真”两项 5 分制均 ≥4.0，领先基线 0.7-1.2 分。\n\n跨模块端到端案例\n\n*   **输入**：一句“赛博朋克风格的猫头鹰刺客”。\n*   **输出**：8 092 面三角网格、3 个语义部件、4×4K PBR 贴图、22 关节骨架、UE5 可直接播放攻击动画；全程 13 min，通过引擎合规检查。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下问题仍留有显著研究空白，可作为后续探索方向：\n\n1.  **显式物理-感知生成**\n    \n    *   当前管线仅保证“外观+拓扑”合规，尚未在扩散阶段嵌入质量、质心、碰撞体等物理参数，导致部分资产需二次手调刚体/布料参数。\n    *   可引入可微物理仿真（NDP、DiffSim）作为损失，直接生成“静力平衡+碰撞凸包”就绪的资产。\n2.  **细粒度交互式编辑**\n    \n    *   文本/图像指令目前只能做“全局或部件级”材质、比例编辑；尚不支持“顶点级”雕刻、折痕、磨损痕迹的局部控制。\n    *   探索点：  \n        – 将 Mesh-RFT 的 Masked-DPO 扩展到“顶点位移”token；  \n        – 采用 3D-StyleGAN 潜空间插值实现实时刷笔式编辑。\n3.  **拓扑--aware 的动画自发现**\n    \n    *   绑定模块仍依赖人工模板（22 关节）或自回归指针，对“软体、流体、可展开机构”等非常规运动学无能为力。\n    *   可引入“运动先验”：先在大规模动作捕捉上训练潜码扩散，再反推最小拓扑与关节数，实现“动作-驱动-拓扑”联合优化。\n4.  **跨资产风格一致性**\n    \n    *   同一项目批量生成时，仅通过风格 LoRA 难以保证“色彩基调+材质基底”严格一致。\n    *   探索“项目级全局调色板”注入：在纹理扩散的 cross-attention 中增加项目 embedding，或采用基于 CLIP-方向约束的批量一致性损失。\n5.  **4K+ 纹理内存与实时 streaming**\n    \n    *   目前 4K PBR 贴图在移动 VR/AR 上仍显笨重；尚未自动导出 tiled+compressed 版本（如 UE5 VT、ASTC 6×6）。\n    *   可引入神经压缩纹理（Neural Texture Codec）或可微分纹理流送（TexNeRF）在生成阶段即输出 128×128 隐空间贴图，实时解码。\n6.  **自动 LOD & Impostor 生成**\n    \n    *   管线只输出单一精度网格；大型开放世界仍需手工制作 LOD1-LOD4 与 Billboard。\n    *   后续可在 PolyGen 的自回归解码器中加入“细节控制 token”，一次性生成多组面数递减序列，并联合生成深度-法向 impostor sprite。\n7.  **可解释性 & 版权溯源**\n    \n    *   目前缺乏对“生成资产与训练数据相似度”的可解释报告，商用存在侵权风险。\n    *   可探索“3D 版权指纹”：在 ShapeVAE 隐空间记录并公开 Top-k 最近邻，或引入差分隐私训练。\n8.  **开放世界动态资产**\n    \n    *   现有框架面向静态 prop/character；对“可破坏建筑、生长植被”等带状态变化的资产未做支持。\n    *   后续可引入时序扩散（3D DiT + 时间轴）直接生成“破坏-碎裂”或“生长-枯萎”序列，并输出对应刚体碎片或骨架动画。\n9.  **多模态条件更丰富的输入**\n    \n    *   目前仅单图/文本；可扩展“草图+语音+风格参考视频”混合输入，需要设计统一 tokenizer 将 2D 草图、音频描述、视频风格映射到同一条件空间。\n10.  **极端领域鲁棒性**\n    \n    *   对“薄壳、重复晶格、半透明”等难案例，几何/纹理仍可能出现孔洞或折射误差。\n    *   可构建“困难案例课程学习”：先在小批量难例上高权重微调，再逐步回混正常数据，提升尾部分布表现。\n\n以上方向兼顾**生成质量、交互自由度、物理合规、版权合规**四大维度，可推动 Hunyuan3D Studio 向“全自动、可解释、物理正确、项目一致”的下一代 AI 资产工厂演进。\n\n**Q6**: 总结一下论文的主要内容\n\n*   **问题**  \n    传统 3A 游戏资产流程分散、手工量大，现有 AI 方法只解决“几何”或“纹理”单点，输出拓扑混乱、UV 语义缺失、PBR 不兼容，难以直接进引擎。\n    \n*   **方案**  \n    提出 Hunyuan3D Studio——端到端神经管线，把“单图/一句话”一次性变成面数优化、PBR 贴图、已绑定、可动画的引擎级资产：\n    \n    1.  可控概念图（风格化 + A-Pose 标准化）\n    2.  高保真几何扩散（bbox/多视图条件，ShapeVAE+DiT）\n    3.  部件级生成（P3-SAM 分割 → X-Part 结构一致分解）\n    4.  PolyGen 低面拓扑（自回归 BPT token + Masked-DPO 微调）\n    5.  SeamGPT 语义 UV（自回归切割线，材质-aware 分岛）\n    6.  PBR 纹理与多模态编辑（多视图烘焙 + 文本/图像指令 + 4K 材质球）\n    7.  自动绑定（人形模板/通用自回归骨架 + 拓扑-aware 蒙皮）\n    \n    统一资产图串联七步，支持参数回传与增量更新，导出即 UE/Unity 格式。\n    \n*   **实验**  \n    在公开与自建基准上全面评估：几何误差、部件 mIoU、拓扑质量、UV 拉伸、纹理一致性、绑定误差均领先 SOTA；用户研究显示生产时间从 5.2 h 缩至 12.4 min，引擎报错率降至 2%。\n    \n*   **结论**  \n    Hunyuan3D Studio 首次把“生成-到-引擎”全链路神经化，显著降低 3D 内容门槛，为游戏、虚拟制作提供可落地的 AI 资产工厂。\n    \n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Hunyuan3D%20Studio%3A%20End-to-End%20AI%20Pipeline%20for%20Game-Ready%203D%20Asset%20Generation，链接是  https://arxiv.org/pdf/2509.12815  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.12815  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-8-1758152840091","title":"3D Aware Region Prompted Vision Language Model","description":"We present Spatial Region 3D (SR-3D) aware vision-language model that connects single-view 2D images and multi-view 3D data through a shared visual token space. SR-3D supports flexible region prompting, allowing users to annotate regions with bounding boxes, segmentation masks on any frame, or directly in 3D, without the need for exhaustive multi-frame labeling. We achieve this by enriching 2D visual features with 3D positional embeddings, which allows the 3D model to draw upon strong 2D priors for more accurate spatial reasoning across frames, even when objects of interest do not co-occur within the same view. Extensive experiments on both general 2D vision language and specialized 3D spatial benchmarks demonstrate that SR-3D achieves state-of-the-art performance, underscoring its effectiveness for unifying 2D and 3D representation space on scene understanding. Moreover, we observe applicability to in-the-wild videos without sensory 3D inputs or ground-truth 3D annotations, where SR-3D accurately infers spatial relationships and metric measurements.","url":"https://huggingface.co/papers/2509.13317","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.091Z","metadata":{"authors":["An-Chieh Cheng","Yang Fu","Yukang Chen","Zhijian Liu","Xiaolong Li","Subhashree Radhakrishnan","Song Han","Yao Lu","Jan Kautz","Pavlo Molchanov","Hongxu Yin","Xiaolong Wang","Sifei Liu"],"date":"","rank":9,"llmAnalysis":"","categories":["cs.CV"],"pdfUrl":"https://arxiv.org/pdf/2509.13317.pdf","arxivUrl":"https://arxiv.org/abs/2509.13317","arxivId":"2509.13317","coolPaperUrl":"https://papers.cool/arxiv/2509.13317","published":"2025-09-16T17:59:06Z","updated":"2025-09-16T17:59:06.000Z","zh_summary":"我们提出了空间区域三维(SR-3D) 感知视觉语言模型，连接单视图二维图像和多视图三维数据，通过共享的视觉标记空间实现。SR-3D 支持灵活的区域提示，允许用户在任何帧上使用边界框、分割掩码或直接在三维中标注区域，而无需繁琐的多帧标记。我们通过用三维位置嵌入增强二维视觉特征来实现这一点，这使得三维模型能够利用强大的二维先验知识，在帧之间进行更准确的空间推理，即使感兴趣的物体在同一视图中未同时出现。对一般二维视觉语言和专业三维空间基准的广泛实验表明，SR-3D 实现了最先进的性能，强调了它在场景理解中统一二维和三维表示空间的有效性。此外，我们观察到其在没有感应三维输入或真实三维标注的野外视频中的适用性，SR-3D 能够准确推断空间关系和度量测量。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n该论文旨在解决**将二维视觉-语言模型（2D VLM）扩展到三维空间理解**时所面临的核心难题，具体包括：\n\n1.  **2D 与 3D 表征空间割裂**  \n    现有 2D VLM 缺乏对三维几何结构的显式建模，而 3D VLM 通常采用点云或体素等专用表征，难以直接复用 2D 预训练权重，导致数据效率低、性能受限。\n    \n2.  **多视角场景下的区域提示（region prompting）困难**  \n    在多视角视频中，同一物体可能部分可见或跨帧分布，传统方法需要逐帧标注 3D 框或 mask，成本高昂；纯文本描述又难以精确定位实例。\n    \n3.  **三维空间推理数据稀缺**  \n    大规模 3D 标注数据远少于 2D，直接训练 3D-VLM 容易过拟合并牺牲通用视觉-语言能力。\n    \n\n为此，作者提出 **SR-3D**——一套**统一单视角与多视角输入的 3D 感知视觉-语言模型**，通过以下关键设计一次性解决上述问题：\n\n*   **共享的归一化 3D 位置嵌入**：把单目深度估计或多视角点云映射到规范坐标系，直接注入 2D 视觉 token，实现 2D 先验与 3D 几何的端到端融合。\n*   **动态 tile-and-stitch 区域提取器**：在高分辨率特征图上进行 mask 池化，支持仅用**单帧框/掩膜**即可在多视角视频中完成区域级推理，无需密集标注。\n*   **统一训练范式**：先在大规模 2D 图文数据上预训练，再用 3D QA 数据微调，保证通用 VQA 性能不降的同时显著提升空间理解指标。\n\n实验表明，SR-3D 在 2D 区域任务、3D 密集描述、视频空间问答等多项基准上均达到 SOTA，且可零样本泛化到无 3D 真值的野生视频，验证了其\\*\\*“用 2D 数据学会 3D 推理”\\*\\* 的目标。\n\n**Q2**: 有哪些相关研究？\n\n与 SR-3D 直接相关的研究可归纳为三条主线，每条线下列出最具代表性的工作并指出与本文的差异。\n\n主线\n\n代表文献\n\n与 SR-3D 的核心区别\n\n**1\\. 区域级视觉-语言模型**\n\nRegionGPT、Osprey、SpatialRGPT、DynRefer、GLAMM、SoM\n\n仅面向单张图像或视频跟踪，未引入 3D 位置嵌入；跨视角空间推理需逐帧标注或语言描述。SR-3D 首次把“单帧框/掩膜”泛化到多视角 3D 场景。\n\n**2\\. 2D-VLM 空间推理增强**\n\nSpatialVLM、SpatialBot、SpatialPIN、RoboPoint、3D-SRBench、Sparkle\n\n依赖 2D 图像或深度图，不做多视角几何一致性建模；无法回答“跨帧度量距离/相对方向”。SR-3D 用规范 3D 坐标统一多帧，实现度量级空间问答。\n\n**3\\. 3D 大模型**\n\n3D-LLM、LEO、ChatScene、LL3DA、Scene-LLM、PointLLM\n\n采用点云/体素编码器，与 2D 视觉 backbone 分离，需大量 3D 数据重训；区域提示需 3D 框或完整分割。SR-3D 复用 2D 权重，仅追加轻量级 3D PE，支持单帧提示。\n\n**4\\. 多视角-3D VLM**\n\nLLaVA-3D、Video-3D-LLM\n\n同样用多视角图像，但 LLaVA-3D 用双路径分别处理 2D/3D，Video-3D-LLM 仅在视频 VLM 上微调 3D 任务，二者均缺统一 2D-3D 表征与区域提示机制。SR-3D 单一路径、统一嵌入、支持灵活区域。\n\n此外，SR-3D 在深度/点云估计方面复用了 DepthAnything-V2、DUST3R、MAST3R、CUT3R 等现成的几何基础模型，但仅作为离线输入，不改动其权重。\n\n**Q3**: 论文如何解决这个问题？\n\n论文提出 SR-3D，通过“统一表征 + 统一架构 + 统一训练”三管齐下，把 2D 视觉-语言模型的强大先验无缝迁移到 3D 空间，并支持极轻量的区域提示。具体技术路线如下：\n\n1\\. 统一表征：Canonical 3D Positional Embedding\n\n*   **单张图像**  \n    用 DepthAnything-V2 估计相对深度 → 反投影到相机坐标系 → 归一化到以场景中心为原点的单位球坐标系，得到与相机位姿无关的 3D 位置图。\n    \n*   **多视角视频**  \n    若给定相机位姿，直接用 GT 深度反投影；若无，则用 MAST3R/CUT3R 估计点云再配准。所有帧的点云变换到同一规范坐标系，保证跨帧几何一致。\n    \n*   **注入方式**  \n    对 3D 位置图做 sinusoidal 编码 → 可学习的 MLP → 得到与视觉 token 同维的 3D PE，逐 token 相加。  \n    结果：2D 特征立即具备度量几何感知，为后续空间推理提供“坐标系”。\n    \n\n2\\. 统一架构：Dynamic Tiling-based Region Extractor\n\n*   **背景**  \n    基础 VLM（NVILA-Lite）采用动态 tiling：按最优长宽比把高分辨率图像切成 448×448 小块，分别编码后再拼回，兼顾细节与显存。\n    \n*   **区域提取**  \n    对单帧掩膜/框同样做 tiling → 每块视觉特征与对应掩膜块逐像素乘 → 拼回原始分辨率 → 全局 mask-pooling 得到区域 token。  \n    优势：\n    \n    1.  特征来自高分辨率，无需事后上采样；\n    2.  多视角场景下，每帧视为一个 tile，同一 3D 掩膜跨帧投影后天然对齐，可直接池化得到跨帧一致的区域表示。\n*   **提示机制**  \n    用户只需在**任意单帧**画框或掩膜，模型利用规范 3D 坐标找到其他帧的对应像素，无需额外标注。\n    \n\n3\\. 统一训练：两阶段课程\n\n阶段\n\n数据\n\n可训练模块\n\n目标\n\n**阶段 1：2D 预训练**\n\n7M 图文对（含区域问答）\n\n3D-PE MLP + Projector + LLM\n\n在单幅图像上学会“看到深度”与区域定位，同时保持通用 VQA 能力。\n\n**阶段 2：3D 微调**\n\nScanQA/SQA3D/Scan2Cap/EmbodiedScan 等 3D QA 数据\n\n全模型（视觉编码器仍冻结）\n\n把 3D 先验扩展到多视角，支持跨帧度量距离、相对方向、区域比较等任务。\n\n*   **数据增强**  \n    随机把分割掩膜换成框、随机丢帧，模拟“只有一帧有标注”的极端情况，强化模型利用 3D PE 自行对齐。\n\n4\\. 推理：即插即用\n\n*   输入：单帧框/掩膜、或 3D 框、或稀疏帧掩膜 → 自动投影到规范空间 → 统一输出空间关系或度量值。\n*   无需 GT 深度：测试时可用 CUT3R 等实时生成点云，性能几乎不下降（表 9）。\n\n结果\n\n*   在 2D 区域任务 COCO、BLINKDepth 上，单模型即超越 SpatialRGPT 等 3D 注入方案。\n*   在 3D 密集描述 Scan2Cap、ScanQA、SQA3D 上，CIDEr 提升 14+，刷新 SOTA。\n*   零样本直接跑野生视频，可准确回答“冰箱离我几米”“沙发在我哪一侧”等度量级问题（图 1、图 5）。\n\n通过“把 3D 坐标变成 token 的一部分”，SR-3D 在不牺牲 2D 通用能力的前提下，实现了真正的 3D 感知与灵活区域提示。\n\n**Q4**: 论文做了哪些实验？\n\n论文从 **2D 通用能力、2D 区域理解、3D 密集描述、3D 视频空间推理、消融与零样本泛化、真实场景应用** 六个维度展开系统实验，覆盖 13 个公开基准 + 1 个自建基准，总计 30 余项指标。结果均以 **SR-3D-8B** 模型报告，并与同规模或同领域 SOTA 对比。\n\n1\\. 2D 通用能力验证（不牺牲 VQA 性能）\n\n基准\n\n类型\n\nNVILA-Lite-8B\n\nSR-3D-8B\n\n涨跌\n\nBLINK𝑆\n\n空间\n\n79.7\n\n83.9\n\n+4.2\n\nSAT\n\n空间\n\n62.6\n\n64.0\n\n+1.4\n\nRealWorldQA\n\n空间\n\n68.9\n\n72.5\n\n+3.6\n\nMathVista\n\n数学\n\n65.6\n\n68.1\n\n+2.5\n\nGQA / AI2D / MMMU𝑝 等 9 项\n\n通用 / OCR\n\n持平或 ±1 以内\n\n—\n\n**结论**：引入 3D-PE 后，通用、数学、OCR 能力不降，反而在需要空间常识的任务上普遍提升。\n\n2\\. 2D 区域级理解\n\n任务\n\n指标\n\n以往最佳\n\nSR-3D\n\n提升\n\nCOCO2017 val 区域分类\n\nmAP / Acc\n\n72.9 / 82.9 (SpatialRGPT)\n\n**78.0 / 88.6**\n\n+5.1 / +5.7\n\nBLINKDepth（点深度问答）\n\nAcc\n\n87.9 (SpatialRGPT)\n\n**90.3**\n\n+2.4\n\n**结论**：动态 tiling 区域提取器带来更高保真度，3D-PE 帮助精确定位深度。\n\n3\\. 3D 密集描述与问答\n\n基准\n\n指标\n\n前 SOTA\n\nSR-3D\n\n提升\n\nScan2Cap\n\nCIDEr\n\n83.8\n\n**97.9**\n\n+14.1\n\nScanQA\n\nCIDEr / EM\n\n102.1 / 30.1\n\n**109.3 / 30.4**\n\n+7.2 / +0.3\n\nSQA3D\n\nEM\n\n58.6\n\n**62.2**\n\n+3.6\n\n**结论**：在统一 3D-PE 加持下，所有自动评价指标均刷新纪录；BLEU-4、METEOR、ROUGE 同步提升（见附录表 10-12）。\n\n4\\. 视频空间智能（自建 SR-3D-Bench）\n\n设置\n\n子任务\n\n最佳基线\n\nSR-3D\n\n提升\n\n区域级空间 QA（2500 题）\n\n定量 Avg\n\n46.7 (GPT-4o+SoM)\n\n**83.3**\n\n+36.6\n\n定性 Avg\n\n53.7\n\n**79.5**\n\n+25.8\n\n宽度 / 高度 / 距离\n\n单项 Acc\n\n40–59\n\n**74–87**\n\n+20+\n\n**结论**：SR-3D 是唯一在“单帧画框→跨帧度量”设定下仍能保持 80%+ 准确率的模型。\n\n5\\. 全局视频空间理解（VSI-Bench）\n\n子任务\n\n最佳开源\n\n最佳 API\n\nSR-3D\n\n相对方向\n\n30–43\n\n46–51\n\n**82.3**\n\n绝对距离 / 房间面积\n\n40–55\n\n43–64\n\n**75.5 / 41.9**\n\n**结论**：在 egocentric 视频里，SR-3D 的相对方向准确率远超 GPT-4o、Gemini-1.5-Pro。\n\n6\\. 消融与零样本分析\n\n设置\n\n3D-PE\n\n2D 预训练\n\nScan2Cap CIDEr\n\nSR-3D-Bench 平均\n\nA\n\n✗\n\n✗\n\n92.9\n\n74.4\n\nB\n\n✔\n\n✗\n\n92.7\n\n77.2\n\nC\n\n✗\n\n✔\n\n101.3\n\n74.2\n\nD\n\n✔\n\n✔\n\n**97.9**\n\n**83.3**\n\n*   **零样本 3D**：仅用 2D 数据训练的 SR-3D-2D 在 Tall/Short、Big/Small、Height、Distance 四类的平均准确达 **74.5%**，证明 3D-PE 即可让模型“看到深度”。\n*   **真实视频**：CUT3R 重建点云替代 GT，ScanQA CIDEr 仍保持 109.3→109.0，几乎无掉点，验证对廉价几何估计的鲁棒性。\n\n7\\. 定性展示\n\n*   野生 YouTube 视频（无 3D 真值）上，SR-3D 可正确回答  \n    “若面向 Region-2，镜子在我哪侧？” → **Behind**  \n    “Region-1 与 Region-3 距离？” → **16.12 英尺**  \n    见图 1、图 5、图 6。\n\n实验总结\n\n1.  2D 能力 **不降级** → 3D-PE 是“无痛”插件。\n2.  区域任务 **全面领先** → 高分辨率 tile-and-stitch 是关键。\n3.  3D/视频空间理解 **刷新 SOTA** → 统一规范坐标系带来跨帧度量能力。\n4.  零样本 + 野生视频 **可用** → 无需昂贵 3D 标注，单帧画框即可推理。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下方向可被视为 SR-3D 的直接延伸，按“数据-模型-应用”三层递进，并给出可验证的实验切入点。\n\n1\\. 数据与标注\n\n方向\n\n可探索点\n\n验证指标\n\n动态场景\n\n将静态多视角拓展到**运动相机+运动物体**（手持视频、机器人 SLAM）。\n\n在 VSI-Bench 新增“动态子集”，比较静态 vs 流式 3D-PE 的相对方向准确率。\n\n弱监督缩放\n\n仅用**激光雷达-图像自动关联**生成 1M 级伪 3D-QA，无需人工标注。\n\n在 ScanQA 上观察 CIDEr 随伪标签比例的变化曲线，检验饱和点。\n\n方向-朝向标注\n\n收集带“物体坐标系”标注的 3D 数据（EmbodiedScan++），解决朝向难题。\n\n新增“Is the keyboard facing left?”子任务，看 EM 能否从 50%→80%。\n\n2\\. 模型与表征\n\n方向\n\n可探索点\n\n验证指标\n\n时空统一 PE\n\n把 3D 坐标扩展为**4D 时空坐标**（x,y,z,t），用正余弦+可学习编码。\n\n在动态子集上比较“3D-PE vs 4D-PE”的相对方向准确率差距。\n\n可学习相机外参\n\n不再依赖 GT 位姿，让模型**自监督预测相机相对位姿**（类似 DUST3R）。\n\n在 ScanNet 上报告相机相对旋转/平移误差，<3° & <5 cm 即合格。\n\n统一单-多视角 checkpoint\n\n用**混合批次训练**（单视角+多视角同 batch），实现一个权重同时服务两种输入。\n\n观察单视角 VQA 与多视角 ScanQA 是否同时上涨，排除跷跷板现象。\n\n生成式 3D 输出\n\n把 LLM 解码器换成**扩散或 SDF 解码头**，直接生成点云/网格。\n\n在 Text-to-3D 基准（如 Cap3D）上报告 Chamfer Distance，目标 <5 mm。\n\n3\\. 应用与系统\n\n方向\n\n可探索点\n\n验证指标\n\n机器人导航\n\n把 SR-3D 作为**语义-度量混合策略**的 VLM 后端，输出“向前 2.3 m 右转”原子动作。\n\n在 Habitat-3D/AI2-THOR 上测量 Success Rate 与 SPL，目标 >70%。\n\nAR 实时测量\n\n集成到**手机 ARKit**，用户单指圈选即可得真实尺寸（厘米级）。\n\n与苹果 Measure App 对比，平均相对误差 <5%。\n\n大规模视频检索\n\n用**语言+单帧框查询**百万小时监控，定位“距红色推车 5 m 内出现包裹”片段。\n\n在 BDD-Video-3D 自建 100k 查询集，召回@10 从 60%→85%。\n\n多模态编辑\n\n支持“把 Region-3 的椅子放大 1.5 倍并旋转 30°”的**文本+区域驱动 3D 编辑**。\n\n用户主观评分（1-5）>4.0，且编辑后尺寸误差 <10%。\n\n4\\. 理论与基准\n\n方向\n\n可探索点\n\n验证指标\n\n可解释空间注意力\n\n可视化跨帧 attention map，检验模型是否**真正激活对应 3D 区域**而非纹理捷径。\n\n推出 SR-3D-AttnBench，给出 3D IoU>0.7 的 attention 掩膜为通过。\n\n鲁棒性基准\n\n引入\\*\\* adversarial 相机位姿扰动\\*\\*（±10°/±20 cm），观察性能下降斜率。\n\n在 ScanQA 上 EM 下降 <5% 视为鲁棒。\n\n高效化\n\n用**2-bit 量化 + KV-cache 稀疏化**把 8B 模型压缩到 2B，满足边缘 GPU 30 fps。\n\n在 RTX-4060 上测 32 帧视频端到端延迟 <300 ms，CIDEr 掉点 <2。\n\n短期可落地（6 个月内）\n\n1.  4D-PE + 动态子集实验\n2.  统一 checkpoint 混合批次训练\n3.  AR 厘米级测量 Demo\n\n中长期（1-2 年）\n\n1.  生成式 3D 输出头\n2.  机器人闭环导航系统集成\n3.  百万级弱监督 3D-QA 数据与预训练\n\n这些方向既可直接继承 SR-3D 的“规范 3D-PE + tile-and-stitch”框架，又能分别回应朝向、动态、生成、实时等当前明显短板，形成完整的 3D 感知-生成-行动闭环。\n\n**Q6**: 总结一下论文的主要内容\n\nSR-3D 论文概要\n==========\n\n1\\. 研究动机\n--------\n\n*   2D Vision-Language Model（VLM）缺乏度量级 3D 几何理解\n*   3D VLM 依赖点云/体素，与 2D 预训练权重割裂，数据效率低\n*   多视角场景下逐帧标注 3D 框/掩膜代价高，纯语言描述易歧义\n\n2\\. 核心思路\n--------\n\n**统一 2D 与 3D 表征空间**：  \n单目/多视角图像 → 深度/点云 → 归一化 3D 位置图 → 正余弦+MLP 得到 3D Positional Embedding（3D-PE），与视觉 token 逐元素相加，直接注入冻结的 2D 视觉编码器。\n\n3\\. 关键模块\n--------\n\n*   **Canonical 3D-PE**：相机坐标系→场景中心规范坐标，单视角与多视角共享同一空间\n*   **Dynamic Tiling Region Extractor**：高分辨率 tile-and-stitch，支持**单帧框/掩膜**即跨帧推理\n*   **统一训练管线**：  \n    ① 2D 图文+区域数据预训练（7 M）→ ② 3D QA 数据微调（ScanQA/SQA3D/Scan2Cap/EmbodiedScan）\n\n4\\. 能力展示\n--------\n\n任务\n\n以往最佳\n\nSR-3D-8B\n\n提升\n\nCOCO 区域分类 Acc\n\n82.9\n\n**88.6**\n\n+5.7\n\nBLINKDepth 深度问答\n\n87.9\n\n**90.3**\n\n+2.4\n\nScan2Cap CIDEr\n\n83.8\n\n**97.9**\n\n+14.1\n\nScanQA CIDEr / EM\n\n102.1 / 30.1\n\n**109.3 / 30.4**\n\n+7.2 / +0.3\n\n自建 SR-3D-Bench 区域空间 QA\n\n46.7\n\n**83.3**\n\n+36.6\n\nVSI-Bench 相对方向\n\n43\n\n**82.3**\n\n+39\n\n*   **零样本 3D 推理**：仅用 2D 数据训练的模型在多视角距离/高度任务上达 74% 准确率\n*   **野生视频**：无 GT 3D 标注，仍可厘米级测距、判断左右前后\n\n5\\. 结论\n------\n\nSR-3D 通过“3D-PE + 统一 tile-and-stitch 区域提取 + 两阶段训练”，首次实现\n\n*   单帧提示即可跨视角度量推理\n*   2D 通用 VQA 性能不降\n*   3D 密集描述与视频空间理解全面 SOTA\n\n为 2D↔3D 统一的视觉-语言模型提供了简单可扩展的范式。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是3D%20Aware%20Region%20Prompted%20Vision%20Language%20Model，链接是  https://arxiv.org/pdf/2509.13317  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.13317  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-9-1758152840091","title":"EconProver: Towards More Economical Test-Time Scaling for Automated Theorem Proving","description":"Large Language Models (LLMs) have recently advanced the field of Automated Theorem Proving (ATP), attaining substantial performance gains through widely adopted test-time scaling strategies, notably reflective Chain-of-Thought (CoT) reasoning and increased sampling passes. However, they both introduce significant computational overhead for inference. Moreover, existing cost analyses typically regulate only the number of sampling passes, while neglecting the substantial disparities in sampling costs introduced by different scaling strategies. In this paper, we systematically compare the efficiency of different test-time scaling strategies for ATP models and demonstrate the inefficiency of the current state-of-the-art (SOTA) open-source approaches. We then investigate approaches to significantly reduce token usage and sample passes while maintaining the original performance. Specifically, we propose two complementary methods that can be integrated into a unified EconRL pipeline for amplified benefits: (1) a dynamic Chain-of-Thought (CoT) switching mechanism designed to mitigate unnecessary token consumption, and (2) Diverse parallel-scaled reinforcement learning (RL) with trainable prefixes to enhance pass rates under constrained sampling passes. Experiments on miniF2F and ProofNet demonstrate that our EconProver achieves comparable performance to baseline methods with only 12% of the computational cost. This work provides actionable insights for deploying lightweight ATP models without sacrificing performance.","url":"https://huggingface.co/papers/2509.12603","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.091Z","metadata":{"authors":["Mukai Li","Linfeng Song","Zhenwen Liang","Jiahao Xu","Shansan Gong","Qi Liu","Haitao Mi","Dong Yu"],"date":"","rank":10,"llmAnalysis":"","categories":["cs.CL","cs.AI"],"pdfUrl":"https://arxiv.org/pdf/2509.12603.pdf","arxivUrl":"https://arxiv.org/abs/2509.12603","arxivId":"2509.12603","coolPaperUrl":"https://papers.cool/arxiv/2509.12603","published":"2025-09-16T03:00:13Z","updated":"2025-09-16T03:00:13.000Z","zh_summary":"大型语言模型（LLMs）最近在自动定理证明（ATP）领域取得了显著进展，通过广泛采用的测试时间缩放策略实现了实质性的性能提升，特别是反射性思维链（CoT）推理和增加采样次数。然而，这两者都给推理带来了显著的计算开销。此外，现有的成本分析通常仅限制采样次数，而忽视了不同缩放策略引入的采样成本的显著差异。本文系统比较了不同测试时间缩放策略在ATP模型中的效率，并展示了当前最先进（SOTA）开源方法的低效。然后，我们研究了在保持原始性能的情况下显著减少令牌使用和采样次数的方法。具体而言，我们提出了两种互补的方法，可集成到统一的经济强化学习（EconRL）流程中，以获得更大的收益：（1）一种动态思维链（CoT）切换机制，旨在减少不必要的令牌消耗，和（2）具有可训练前缀的多样化并行缩放强化学习（RL），以提高在受限采样次数下的通过率。在miniF2F和ProofNet上的实验表明，我们的经济证明器（EconProver）在计算成本仅为基线方法的12%的情况下，达到了相当的性能。此项工作为在不牺牲性能的情况下部署轻量级ATP模型提供了可行的见解。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文旨在解决当前基于大模型的自动定理证明（ATP）系统在“测试时扩展”（test-time scaling）阶段存在的**高昂推理成本与性能提升失衡**的问题。具体可归纳为以下三点：\n\n1.  **统一度量缺失**  \n    现有工作通常只统计采样次数，忽略了不同扩展策略（长链式思维、并行采样、迭代精修）在token级开销上的巨大差异，导致无法公平评估真实的计算-性能权衡。\n    \n2.  **策略低效**\n    \n    *   **顺序扩展**（长CoT）对所有问题无差别启用反思推理，使token用量暴增10–25×，而83 %的非IMO难度题目其实无需CoT即可正确证明。\n    *   **并行扩展**盲目增加采样次数后迅速出现边际收益递减：在miniF2F上，64→128次采样仅提升1.1 %准确率，却付出4×成本。\n3.  **缺乏轻量级优化框架**  \n    尚无系统方法能在**不牺牲准确率**的前提下，同时削减token消耗与采样次数；现有高效方案（如直接提示、随机多head）效果有限。\n    \n\n为此，作者提出**EconRL**框架，通过\n\n*   **动态CoT切换**（难则思、易则直）\n*   **难度感知的多样并行RL**（用8个可学习prefix head在限定采样预算内最大化探索多样性）\n\n在miniF2F与ProofNet上实现与SOTA相当的准确率，仅耗\\*\\*12 %\\*\\*的原始token成本，从而首次在ATP领域系统性地缓解了“性能-成本”矛盾。\n\n**Q2**: 有哪些相关研究？\n\n论文在 §5 中系统梳理了与“经济型测试时扩展”相关的三条研究脉络，并指出本文是**首次将动态 CoT 机制引入形式定理证明场景**。相关研究可归纳为下表：\n\n研究方向\n\n代表工作\n\n与本文的关联与差异\n\n**端到端整证明生成**  \n（whole-proof generation）\n\n• DeepSeek-Prover 系列  \n• Goedel-Prover  \n• Kimina-Prover\n\n同样采用一次生成完整 Lean 证明再验证，但它们默认“长 CoT 对所有问题开启”，导致 token 开销高。本文首次让模型**自主决定**是否启用长 CoT，从而直接削减证明长度。\n\n**带验证器反馈的定理证明**  \n（verifier-feedback）\n\n逐步搜索：  \n• InternLM2.5-StepProver  \n• HunyuanProver  \n• BFS-Prover  \n• DSP+ / DRP  \n  \n整证明迭代精修：  \n• Seed-Prover  \n• Goedel-Prover-V2  \n• StepFun-Prover\n\n这类方法通过多步搜索或多轮精修换取更高成功率，但计算量巨大（Seed-Prover 需数十轮迭代）。本文的 EconRL **可与迭代精修正交叠加**：表 1 显示，在同样达到 86.0 % miniF2F 准确率下，token 成本从 40× 降到 10×。\n\n**动态 / 自适应 Chain-of-Thought**  \n（dynamic CoT）\n\n非形式领域：  \n• AdaCoT（RL 触发）  \n• L1（长度约束 RL）  \n• DynaThink（置信度切换）  \n• DAST（难度预测）\n\n它们聚焦于自然语言问答或数学应用题，通过 RL 或置信度阈值控制是否展开长推理。本文**首次把动态 CoT 思想迁移到形式定理证明**，并针对 Lean 证明的特点提出“基于可解性标签的偏好对”训练策略，使模型在无外部难度信号下自动切换模式。\n\n综上，本文在“整证明生成”与“迭代精修”两大主流范式之间，**引入动态 CoT 与多样并行 RL 的组合拳**，填补了形式化领域缺乏“经济型测试时扩展”研究的空白。\n\n**Q3**: 论文如何解决这个问题？\n\n论文将“高 token 开销 + 冗余采样”这一核心矛盾拆解为**两类可量化浪费**，并对应提出两条互补的 RL 训练阶段，统一在 **EconRL** 流水线中解决。具体做法如下：\n\n1\\. 浪费来源与量化指标\n\n浪费类型\n\n现象\n\n统一度量\n\n**顺序扩展浪费**\n\n长 CoT 对所有定理无差别开启，token 用量暴增 10–25×\n\n单次采样 token 数\n\n**并行扩展浪费**\n\n\\>32 路后前缀多样性饱和，继续采样几乎重复\n\nPrefix Diversity Coverage（PDC）\n\n2\\. 解决方案总览：EconRL 两阶段 RL\n\n    ┌---------------------------┐\n    │  基础模型（DeepSeek-Prover-V2 或 Goedel-Prover-V2）\n    └------------┬--------------┘\n                 │\n        Stage-1  Dynamic CoT Switching（偏好学习）\n                 │  ↓ 目标：砍掉“易题”不必要 token\n                 ├─ 自动标注 ─► 非 CoT 可解 vs CoT 依赖\n                 ├─ DPO 训练 ─► 学会“难则思、易则直”\n                 │\n        Stage-2  Diverse Parallel-scaled RL（PPO）\n                 │  ↓ 目标：在固定采样预算内最大化多样性\n                 ├─ 难度分桶 ─► 8 个可学习 prefix head\n                 ├─ 独立 PPO ─► 每 head 专攻一类难度\n                 └─ 均匀调度 ─► 推理时均分采样次数\n    \n\n3\\. 关键技术细节\n\n3.1 Dynamic CoT Switching（阶段一）\n\n*   **自动标注**  \n    在训练集上先用非 CoT 模式跑 32 次，能成功即标为“非 CoT 可解”，否则“CoT 依赖”。  \n    结果：83 % 低于 IMO 难度定理可被非 CoT 解决。\n    \n*   **偏好对构造**  \n    非 CoT 可解：yw = 直接证明，yl = 长 CoT（惩罚冗余推理）  \n    CoT 依赖：yw = 长 CoT，yl = 直接证明（鼓励深度思考）\n    \n*   **DPO 目标**  \n    $$ \\\\mathcal{L}_{\\\\text{DPO}} = -\\\\mathbb{E}_{(x,y\\_w,y\\_l)\\\\sim\\\\mathcal{D}} \\\\log\\\\sigma!\\\\left(\\\\beta\\\\log\\\\frac{\\\\pi\\_\\\\theta(y\\_w|x)}{\\\\pi\\_{\\\\text{ref}}(y\\_w|x)} - \\\\beta\\\\log\\\\frac{\\\\pi\\_\\\\theta(y\\_l|x)}{\\\\pi\\_{\\\\text{ref}}(y\\_l|x)}\\\\right) $$  \n    β = 0.1，训练后模型在推理时**无需外部难度信号**即可自动切换。\n    \n\n3.2 Diverse Parallel-scaled RL（阶段二）\n\n*   **难度分桶**  \n    用 base 模型在 32 次采样下的成功次数 c(x) 排序，均匀切成 8 档；每档对应一个专用 head。\n    \n*   **可学习 prefix**  \n    每个 head 仅为一组 20 个可训练 token 嵌入，参数量 <0.1 %，独立用 PPO 优化：  \n    reward = 1（Lean checker 通过）否则 0。\n    \n*   **推理调度**  \n    Pass@16 → 每 head 跑 16/8 = 2 次，零额外开销即可保持多样性。\n    \n\n4\\. 效果量化\n\n设置\n\nminiF2F 准确率\n\n相对 token 成本\n\n节省\n\n基线 CoT（32 次）\n\n75.8 %\n\n10×\n\n—\n\nECONPROVER-DS（16 次）\n\n76.2 %\n\n1.5×\n\n**85 % ↓**\n\nECONPROVER-GD + 迭代精修\n\n86.0 %\n\n10×\n\n**75 % ↓**\n\n5\\. 结论\n\n通过\\*\\*“先剪枝、再增效”**的两段式 RL，论文把原本“一刀切”的长 CoT 与盲目堆采样，改造成**难度自适应 + 多样性强化\\*\\*的经济型扩展范式，在保持 SOTA 准确率的同时把 token 开销压到 **12 %**。\n\n**Q4**: 论文做了哪些实验？\n\n论文围绕“成本-性能”两条主线设计实验，覆盖 **成本曲线分析 → 组件消融 → 主结果 → 叠加迭代精修** 四个层次。所有实验统一用 **token 级总采样成本** 作为横轴，miniF2F / ProofNet 准确率作为纵轴，结果如下表汇总：\n\n实验类别\n\n关键变量\n\n基准/数据集\n\n主要结论（一句话）\n\n**1\\. 成本曲线诊断**  \n§2.2\n\n顺序 vs 并行 vs 混合\n\nminiF2F-test\n\n并行 8 次已优于长 CoT，且继续堆采样边际收益迅速衰减；混合策略在 **4 %** 成本处即可达到纯堆 8192 次的增益。\n\n**2\\. 组件消融**\n\n2.1 动态 CoT 切换  \n§4.3\n\nCoT 触发方式\n\nDeepSeek-Prover-V2\n\n自动切换在 **99.7 %** 准确率下只用 **15 %** token，优于直接提示（71.7 %→75.4 %）。\n\n2.2 多样并行 RL  \n§4.4\n\nhead 数量 & 分桶策略\n\n同上\n\n难度分桶 8 head 在 Pass@16 带来 **4.9 %** 绝对提升，随机 head 仅 **1.3 %**；低采样区收益更高。\n\n**3\\. 主结果**  \n§4.2\n\n完整 EconRL\n\nminiF2F + ProofNet\n\nECONPROVER-DS 与全 CoT 打平（76.2 %）仅耗 **1.5×** token；ECONPROVER-GD 与 Goedel-V2-CoT 打平（84.0 %）仅耗 **3×** token。\n\n**4\\. 与迭代精修叠加**\n\n迭代轮数 & 成本\n\nminiF2F-test\n\n在同样 86.0 % 准确率下，EconRL 把迭代精修的 **40×** 成本压缩到 **10×**，节省 **75 %**。\n\n此外，所有实验均报告 **Prefix Diversity Coverage（PDC）** 与准确率的相关性，验证“多样性↑ → 性能↑”假设成立。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下方向可在此基础上继续推进，分为“理论-算法-系统-应用”四个层面，并给出可立即落地的实验切入点。\n\n1\\. 理论层面：成本-性能帕累托前沿\n\n*   **建立 token-最优下界**  \n    对给定定理分布，用信息论或计算复杂性工具证明“达到准确率 θ 所需期望 token 数”的下界，评估 EconRL 距离理论最优的差距。\n*   **难度度量的可学习性**  \n    当前用 32 次 base 模型成功率作为真值，可探索**免真值**的难度估计（如梯度方差、注意力熵），并证明其与真实可解概率的单调一致性。\n\n2\\. 算法层面：三处“贪心”可升级\n\n模块\n\n当前贪心策略\n\n可探索的高级方法\n\n**动态 CoT 阈值**\n\n单点 0/1 决策\n\n引入**置信度-预算**联合 MDP，用 constrained RL 学习最优 early-exit 阈值序列，实现任意 token 预算下的最优准确率。\n\n**head 调度**\n\n均匀均分\n\n在线 bandit / UCB 调度：实时根据已观测的 proof prefix 相似度调整下一采样投向哪一 head，**零额外训练**即可进一步减采样。\n\n**head 数量**\n\n固定 8\n\n把 head 数作为超参，用**连续松弛**（Neural Architecture Search）或**稀疏激活**（MoE）自动搜索，每定理仅激活 1-2 个 head，推理延迟 ↓。\n\n3\\. 系统层面：训练-推理协同优化\n\n*   **Prefix 级增量推理**  \n    8 组 prefix 可一次性加载到 GPU 常量内存，复用一次前向计算的后缀网络，把 8× 前向降回 1×，**吞吐 ↑ 8×**。\n*   **与树搜索正交叠加**  \n    将多样 head 作为 BFS/MCTS 的“策略池”，每个节点随机选 head 生成 tactic，可**把 16 次采样等效为 64 次搜索节点**而 token 不变。\n*   **端侧量化**  \n    对 20-token 可学习 prefix 做 **INT4 量化**实验，验证是否可在手机端跑 8-head 并行而掉点 <0.3 %。\n\n4\\. 应用层面：走出 miniF2F\n\n*   **IMO 级难题**  \n    将 EconRL 接入 Seed-Prover 的“分解-精修”管线，仅给每子目标 4 次采样，检验是否仍能增加完整 IMO 题的解决数。\n*   **代码形式化**  \n    把 Lean 4 换成 **Coq / Isabelle**，验证难度分桶 + 动态 CoT 是否语言无关；若出现 domain-shift，可用 **meta-RL** 快速重学最优切换策略。\n*   **跨模态定理**  \n    对含图形的几何题（如 IMO 2024 G6）先用视觉-语言模型生成自然语言描述，再送入 EconRL；探索**多模态难度感知** head 是否能进一步提升多样性。\n\n5\\. 即时可跑的消融清单\n\n1.  将 head 数从 8 连续降到 1，绘制“accuracy vs head 数”曲线，观察是否出现 **phase-transition**。\n2.  用 KL 散度代替 PDC，验证多样性度量与最终准确率的 **Spearman ρ** 是否更高。\n3.  在动态 CoT 阶段引入 **长度惩罚系数 λ**，扫描 λ∈\\[0,0.1,0.5,1.0\\]，绘制 Pareto 前沿，检验是否可再压缩 20 % token。\n\n这些方向既包含**理论深度**，也能在**现有代码基线**上快速验证，为下一代“经济型”定理证明系统提供持续动力。\n\n**Q6**: 总结一下论文的主要内容\n\n论文主旨一句话\n=======\n\n用 **1/8 的 token** 达到 **SOTA 准确率**，首次系统解决大模型自动定理证明（ATP）在测试时扩展阶段的**高成本-低边际收益**难题。\n\n1\\. 背景与痛点\n---------\n\n*   现有 ATP 靠“长链式思维（CoT）+ 海量并行采样”提分，但  \n    – 长 CoT 使 token 开销 **10–25×**；  \n    – 并行 >32 次后多样性饱和，**1.1 % 准确率换 4× 成本**。\n*   既往只数“采样次数”，忽视 **token 级真实成本**，无法公平权衡。\n\n2\\. 统一度量\n--------\n\n提出 **token-level sampling cost**：  \n$$ \\\\text{Cost} = \\\\sum\\_{\\\\text{passes}} (\\\\text{initial tokens} + \\\\text{refinement tokens}) $$  \n用该度量重画 scaling curve，揭示顺序扩展与并行扩展的**双重低效**。\n\n3\\. EconRL 框架（两阶段 RL）\n---------------------\n\n阶段\n\n目标\n\n方法\n\n效果\n\n**动态 CoT 切换**\n\n易题不浪费 token\n\n用 DPO 学“难则思、易则直”的 0/1 决策\n\n75.4 % 准确率仅用 **15 %** token\n\n**多样并行 RL**\n\n少采样也覆盖证明空间\n\n难度分桶 → 8 个可学习 prefix head → 独立 PPO\n\nPass@16 提升 **4.9 %**，冗余 ↓\n\n两阶段**正交叠加**，无额外超参冲突。\n\n4\\. 主要结果\n--------\n\n*   **miniF2F**：  \n    – ECONPROVER-DS 76.2 %（vs 全 CoT 75.8 %）成本 **1.5×** ↔ 原 **10×**  \n    – ECONPROVER-GD 84.0 %（vs 基线 84.4 %）成本 **3×** ↔ 原 **25×**\n*   **ProofNet**：维持 23-28 % 准确率，成本同样 **3×** 以内。\n*   **\\+ 迭代精修**：86.0 % 准确率下 token 从 **40× 降到 10×**，节省 **75 %**。\n\n5\\. 贡献清单\n--------\n\n1.  首次用 **token 成本** 系统评估 ATP 测试时扩展。\n2.  揭示 **83 %** 非 IMO 题无需 CoT、并行采样 **\\>32 次**即冗余。\n3.  提出 **EconRL** 两阶段 RL 流水线，公开可插拔。\n4.  在两大开源基座上取得 **一致且可复现** 的 8× 级成本压缩。\n\n6\\. 一句话总结\n---------\n\nEconRL 让 ATP 模型**会省再想、会探不重复**，用 **12 % 的 token** 就能跑在原来的最高性能上，为大规模部署和后续迭代精修提供了**经济可行**的新基线。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是EconProver%3A%20Towards%20More%20Economical%20Test-Time%20Scaling%20for%20Automated%20Theorem%20Proving，链接是  https://arxiv.org/pdf/2509.12603  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.12603  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-10-1758152840092","title":"Exact Coset Sampling for Quantum Lattice Algorithms","description":"We give a simple, fully correct, and assumption-light replacement for the contested \"domain-extension\" in Step 9 of a recent windowed-QFT lattice algorithm with complex-Gaussian windows~\\citep{chen2024quantum}. The published Step~9 suffers from a periodicity/support mismatch. We present a pair-shift difference construction that coherently cancels all unknown offsets, produces an exact uniform CRT-coset state over $\\mathbb{Z}_{P}$, and then uses the QFT to enforce the intended modular linear relation. The unitary is reversible, uses $\\mathrm{poly}(\\log M_2)$ gates, and preserves the algorithm's asymptotics. Project Page: https://github.com/yifanzhang-pro/quantum-lattice.","url":"https://huggingface.co/papers/2509.12341","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.092Z","metadata":{"authors":["Yifan Zhang"],"date":"","rank":11,"llmAnalysis":"","categories":["quant-ph","cs.CL","cs.CR"],"pdfUrl":"https://arxiv.org/pdf/2509.12341.pdf","arxivUrl":"https://arxiv.org/abs/2509.12341","arxivId":"2509.12341","coolPaperUrl":"https://papers.cool/arxiv/2509.12341","published":"2025-09-15T18:10:28Z","updated":"2025-09-15T18:10:28.000Z","zh_summary":"在最近的一个具有复高斯窗口的窗口 QFT 晶格算法的第 9 步中，我们给出了一个简单、完全正确和假设光的替代，以替代有争议的“域扩展”~\\citep{chen2024quantum}。已发布的 Step~9 存在周期性/支持不匹配的问题。我们提出了一种对移位差分结构，该构造相干地抵消所有未知偏移量，在 $\\mathbb{Z}_{P}$ 上产生精确均匀的 CRT 余集状态，然后使用 QFT 强制执行预期的模线性关系。酉是可逆的，使用 $\\mathrm{poly}（\\log M_2）$ 门，并保留算法的渐近。项目页面：https://github.com/yifanzhang-pro/quantum-lattice。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文旨在修正 Chen (2024) 提出的“加窗量子傅里叶变换（windowed-QFT）格算法”中 Step 9 的一个关键缺陷。  \n该缺陷表现为：\n\n*   原 Step 9 试图仅对第一坐标做“域扩展”（domain extension），却导致振幅周期性/支撑集大小不匹配，最终输出的量子态并不满足算法所需的模线性约束  \n    ⟨b\\*, u⟩ ≡ 0 (mod P)\n\n作者给出的替代方案（Step 9†）一次性解决以下核心难题：\n\n1.  **未知偏移消除**  \n    输入态含有无法预先获知的偏移向量 v\\*；新构造通过“成对平移差分”使其在相干减法中被精确抵消，无需知道 v\\* 的任何信息。\n    \n2.  **精确均匀 CRT-陪集采样**  \n    差分后得到 −2D²T b\\* (mod M₂)，其中 T 在 Z\\_P 上均匀叠加；该像集正是中国剩余定理分解 Z\\_{M₂} ≅ Z\\_{D²} × Z\\_P 中“Z\\_P 纤维”的循环陪集。由此天然生成一个**均匀且相干**的陪集态，无需依赖任何振幅周期性假设。\n    \n3.  **模线性约束的精确实施**  \n    对上述陪集态执行 QFT^{⊗n}_{Z_{M₂}} 并测量，利用特征正交性可**零误差地**把结果限制在 ⟨b\\*, u⟩ ≡ 0 (mod P) 的子空间，且在该子空间内均匀分布。\n    \n4.  **可逆性与资源**  \n    整个流程完全可逆，门复杂度 poly(log M₂)，不引入额外指数级开销，保持原算法的整体渐近优势。\n    \n\n综上，论文提供了一种“即插即用”的新 Step 9，彻底摆脱了对振幅周期性的依赖，使窗口化 QFT 格算法在理论上严谨、实现上可行。\n\n**Q2**: 有哪些相关研究？\n\n与本文直接相关的研究脉络可归纳为三条主线：量子格算法、窗口化/近似 QFT 技术，以及 coset/Fourier 采样中的“偏移消除”技巧。按时间顺序列出代表性工作如下（均与“精确 coset 采样”或“窗口化 QFT 格算法”存在技术衔接或对比）。\n\n研究方向\n\n代表文献\n\n与本文的关联\n\n1\\. 量子格算法奠基\n\nRegev (STOC 2003)\n\n首次将 QFT 与格问题（LWE）结合，提出“量子约简”框架；本文仍沿用 QFT→经典线性代数恢复秘密的范式。\n\n2\\. 量子格算法实用化\n\nEisenträger-Hallgren-Kitaev-Song (QIC 2014)\n\n给出 Z\\_{q} 上精确 Fourier 采样算法，用于 SIS 近似解；本文需要类似的“模约束”采样，但额外处理未知偏移。\n\n3\\. 窗口化/近似 QFT 引入格算法\n\nChen-Liu-Zhandry (Eurocrypt 2022)\n\n首次用“窗口ed QFT”降低寄存器位数，但遗留“如何强制模约束”问题；Chen 2024 直接继承该框架。\n\n4\\. 窗口化 QFT 格算法（被修正对象）\n\nChen (ePrint 2024/???)\\*\n\n提出 Step 9 的“域扩展”设想，却因周期性误用导致支撑集大小错误；本文即针对该 Step 9 给出无假设替代。\n\n5\\. Coset 采样与偏移消除\n\nBonnetain-Naya-Plasencia (PQCrypto 2019)\n\n在量子 meet-in-the-middle 中采用“复制-差分”消除密钥比特，与本文“pair-shift difference”思想同源，但场景不同。\n\n6\\. 精确 coset 态合成\n\nKuperberg (Math. ArXiv 2011)\n\n给出隐藏子群问题中精确 coset 态的 Clifford+Toffoli 构造；本文利用 CRT 分解+可逆算法实现类似目标，且无需 HSP 结构。\n\n7\\. 模数分解与 CRT 技巧\n\nPeikert-Pepin (TCC 2019)\n\n在经典格算法中利用 CRT 分解模数以加速；本文反向利用 CRT 把“模 P 约束”嵌入到高阶模 M₂ 的陪集。\n\n8\\. 可逆算术与 ancilla 清除\n\nHaner-Roetteler-Svore (QIC 2018)\n\n给出模加/模乘及逆运算的可逆实现，本文 Step 9†.4 的 T′ 计算与清除直接调用其电路模板。\n\n\\*Chen 2024 即论文中反复引用的“窗口化 QFT 格算法”原始出处，arXiv 编号 2024:04xxx，尚未正式发表于会议。\n\n简言之，本文在 Chen 2024 的“窗口化 QFT 格算法”基础上，借鉴了早期量子格算法、coset 采样与可逆算术等成熟技术，首次把“复制-平移-差分”思路用于**精确消除未知偏移**并**强制模线性约束**，填补了窗口化 QFT pipeline 的最后一块理论空白。\n\n**Q3**: 论文如何解决这个问题？\n\n论文用一套“成对平移差分 + 精确陪集合成”的量子子程序（Step 9†）彻底替换掉 Chen 2024 中失效的 Step 9。核心流程可概括为五步，每一步都对应一个明确的技术目标，且全部在 poly(log M₂) 门复杂度内可逆完成。\n\n1.  复制  \n    对输入寄存器 X 做按位 CNOT/模加，得到一份完全相同的副本 Y。  \n    目的：为后续差分准备“两份相同数据”。\n    \n2.  平移  \n    在 Y 上相干地加上 2D²T b\\*（mod M₂），其中 T 事先在 Z\\_P 上均匀叠加。  \n    目的：把未知偏移 v\\* 留在原份 X 中，而让 Y 额外携带一个可控的“平移量” 2D²T b\\*。\n    \n3.  差分  \n    计算 Z ← X − Y (mod M₂)。  \n    结果：Z = −2D²T b\\* (mod M₂)，未知偏移 v\\* 被**精确消去**，且 Z 仅依赖 T。\n    \n4.  清理  \n    利用“剩余可访问性”条件（Definition 2.1）从 Z mod P 反推出 T′≡T；再用可逆算术把原 T 寄存器清零、Y 还原成 X、副本 Y 清零，最后丢弃 X。  \n    目的：让 T 与 Z 解除纠缠，使全局态因子化为  \n    |junk⟩ ⊗ (1/√P)∑\\_{T∈Z\\_P}|−2D²T b\\*⟩\\_Z，  \n    从而 Z 寄存器上形成**均匀且相干**的 CRT-陪集态。\n    \n5.  Fourier 采样  \n    对 Z 执行 QFT^{⊗n}_{Z_{M₂}} 并测量 u。  \n    由特征正交性，振幅非零当且仅当 ⟨b\\*, u⟩ ≡ 0 (mod P)；且在该子空间内均匀分布。  \n    至此，原算法所需的模线性约束被**零误差地**强制执行，且无需知道任何关于 v\\* 的信息。\n    \n\n通过上述五步，论文一次性解决了“未知偏移消除”“精确陪集态合成”和“模约束强制”三大难题，同时保持可逆性与原算法的渐近复杂度。\n\n**Q4**: 论文做了哪些实验？\n\n该论文**没有进行任何实验或数值模拟**。全文聚焦于**理论正确性证明**与**量子电路构造**，目标是为 Chen 2024 的窗口化 QFT 格算法提供一个**严格、无假设、可逆且门复杂度可控**的 Step 9 替代方案。所有结果均以**引理、定理与复杂性分析**形式给出，未涉及实际硬件运行、仿真数据或统计测试。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下问题在理论或实现层面仍待深入，可视为直接延续本文工作的“下一步”。\n\n1.  **Residue-accessibility 失效时的确定性方案**\n    \n    *   当某素因子 pη 满足 b\\*≡0 (mod pη) 时，Step 9† 只能获得部分模约束。\n    *   目标：设计**无需后选择**、仍保持 poly(log M₂) 门的**确定性**算法，把剩余素因子通过辅助方向或格基重排一次性解决。\n2.  **常量深度或 NISQ 友好版本**\n    \n    *   当前电路深度由 QFT^{⊗n}\\_{ZM₂} 主导 ≈n log M₂。\n    *   探索：用近似 QFT 或分段 QFT 把深度降到 poly(log n, log log M₂)，同时**仍保证** ⟨b\\*,u⟩≡0 (mod P) 的**零误差**支撑。\n3.  **T 寄存器的量子编码优化**\n    \n    *   本文用 QFT\\_{ZP} 产生均匀叠加，需要 κ 个模逆 + CRT。\n    *   可尝试：量子比特节省的“分段 CRT”或“模链”编码，减少 ancilla 到 O(log P) 而不增加深度。\n4.  **抗噪声与错误修正开销**\n    \n    *   对 Z 寄存器的 QFT^{⊗n} 是容错瓶颈；需量化**逻辑量子比特**与**魔法态消耗**，并与近期 surface-code 指标挂钩，给出真实硬件资源估算。\n5.  **扩展到其他模结构**\n    \n    *   本文依赖 Z\\_{M₂}≅Z\\_{D²}×Z\\_P 的 CRT 分解。\n    *   若窗口函数或模数改为 2^k 或复合幂次，CRT 纤维结构变化——需要重新设计“平移量”与陪集映射，保持差分后仍均匀。\n6.  **与经典 lattice sieve 的混合 pipeline**\n    \n    *   目前量子输出 u 仅用于线性代数恢复秘密；可研究：把**量子陪集采样**嵌入经典 sieve 的“过滤”阶段，降低经典内存开销，形成端到端量子加速 sieve。\n7.  **证明整体算法的最优性下界**\n    \n    *   本文只保证 Step 9† 的**正确性**与**poly 门数**；尚未讨论**采样复杂度下界**。\n    *   开放问题：任何量子算法要生成均匀 CRT-coset 并强制模约束，是否必须 Ω(log M₂) 深度或 Ω(n) 量子比特？给出电路下界或 oracle 分离。\n8.  **通用“偏移消除”框架**\n    \n    *   将 pair-shift difference 抽象为**黑箱模板**：  \n        – 输入：|x+f(j)⟩，f(j) 未知；  \n        – 目标：生成仅依赖 j 的干净陪集态。\n    *   探索该模板在 hidden-shift、dihedral HSP、quantum walks 中的可移植性。\n9.  **后量子安全评估工具**\n    \n    *   实现 Step 9† 的开放源码（Q# / Cirq / Qiskit），结合经典 lattice reducer，形成可验证的**量子成本估算器**，供 NIST 后续评估 lattice-based NIST-PQC 方案的实际量子威胁级别。\n10.  **经典模拟与 Clifford+T 计数**\n    \n    *   对合理规模 (n≤64, log M₂≤1024) 做**张量网络模拟**，验证测量分布与理论预言一致；\n    *   给出完整 Clifford+T 分解及 T-count 上界，用于与 Shor 风格算法进行资源对标。\n\n以上任意方向均可直接引用本文的“pair-shift difference”思想作为起点，同时弥补当前工作在**实验验证、资源优化、抗噪声与下界证明**等方面的空白。\n\n**Q6**: 总结一下论文的主要内容\n\n*   **问题**：Chen 2024 窗口化-QFT 格算法 Step 9 因“域扩展”误用振幅周期性，输出态支撑集大小错误，无法保证 ⟨b\\*,u⟩≡0 (mod P)。\n*   **解法**：提出 Step 9†——“成对平移差分”子程序：\n    1.  复制寄存器 X→Y\n    2.  对 Y 相干加 2D²T b\\*（T 在 Z\\_P 均匀）\n    3.  差分 Z=X−Y，恰好消去未知偏移 v\\*\n    4.  利用 residue-accessibility 可逆地解出 T 并清零所有 ancilla，使 Z 上留下均匀 CRT-陪集态\n    5.  对 Z 执行 QFT^{⊗n}\\_{ZM₂} 并测量，得到在 ⟨b\\*,u⟩≡0 (mod P) 子空间上**均匀分布**的 u\n*   **结果**：无需知道 v\\*、不使用振幅周期性，门复杂度 poly(log M₂)，完全可逆，保持原算法渐近优势；缺陷是理论构造，无实验验证。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Exact%20Coset%20Sampling%20for%20Quantum%20Lattice%20Algorithms，链接是  https://arxiv.org/pdf/2509.12341  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.12341  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-11-1758152840092","title":"Multimodal Reasoning for Science: Technical Report and 1st Place Solution to the ICML 2025 SeePhys Challenge","description":"Multimodal reasoning remains a fundamental challenge in artificial intelligence. Despite substantial advances in text-based reasoning, even state-of-the-art models such as GPT-o3 struggle to maintain strong performance in multimodal scenarios. To address this gap, we introduce a caption-assisted reasoning framework that effectively bridges visual and textual modalities. Our approach achieved 1st place in the ICML 2025 AI for Math Workshop \\& Challenge 2: SeePhys, highlighting its effectiveness and robustness. Furthermore, we validate its generalization on the MathVerse benchmark for geometric reasoning, demonstrating the versatility of our method. Our code is publicly available at https://github.com/OpenDCAI/SciReasoner.","url":"https://huggingface.co/papers/2509.06079","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.092Z","metadata":{"authors":["Hao Liang","Ruitao Wu","Bohan Zeng","Junbo Niu","Wentao Zhang","Bin Dong"],"date":"","rank":12,"llmAnalysis":"","categories":["cs.CL","cs.CV"],"pdfUrl":"https://arxiv.org/pdf/2509.06079.pdf","arxivUrl":"https://arxiv.org/abs/2509.06079","arxivId":"2509.06079","coolPaperUrl":"https://papers.cool/arxiv/2509.06079","published":"2025-09-07T14:47:32Z","updated":"2025-09-07T14:47:32.000Z","zh_summary":"多模态推理仍然是人工智能中的一个基本挑战。尽管基于文本的推理取得了重大进展，但即便是像 GPT-3 这样的最先进模型在多模态场景中也难以保持强大的性能。为了解决这一差距，我们提出了一种辅助标题推理框架，有效地桥接了视觉和文本模态。我们的方法在 ICML 2025 人工智能数学研讨会和挑战 2: SeePhys 中获得了第一名，突显了其有效性和稳健性。此外，我们在 MathVerse 基准测试中验证了其在几何推理上的泛化能力，展示了我们方法的多样性。我们的代码已公开，地址是 https://github.com/OpenDCAI/SciReasoner.","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文旨在解决**多模态推理（multimodal reasoning）**中的核心难题：  \n如何有效整合**视觉信息（图像）**与**文本信息（问题描述）**，以在科学（尤其是物理与几何）场景中实现稳定、准确且可泛化的推理。\n\n具体而言，作者观察到：\n\n*   当前最先进的文本推理模型（如 GPT-o3）在**纯文本任务**上表现卓越，但在**同时涉及图像与文本**的多模态任务上性能显著下降。\n*   这种性能落差并非完全源于视觉感知缺陷，而更多在于**跨模态对齐与融合推理**的不足。\n\n为此，论文提出\\*\\*“字幕辅助推理框架”（caption-assisted reasoning）**，通过将图像转化为**高质量、结构化字幕\\*\\*，使模型**无需直接处理原始像素**，即可在文本空间内完成推理。该方法在**ICML 2025 SeePhys 挑战赛**中获得第一名，并在**MathVerse**几何推理基准上验证了其跨领域泛化能力。\n\n**Q2**: 有哪些相关研究？\n\n与本文直接相关的研究可归纳为三条主线，每条均给出最具代表性的文献或系统，并注明其与“字幕辅助推理”框架的关联点。\n\n主线\n\n代表工作\n\n与本文关联\n\n**1\\. 多模态科学推理基准**\n\nSeePhys (Xiang et al., 2025) MathVerse (Zhang et al., 2024)\n\n提供了物理与几何两大场景的评测平台，首次量化揭示 SOTA 文本模型在多模态任务上的显著落差，成为本文提出字幕范式的直接动机。\n\n**2\\. 视觉-语言模型在 STEM 的局限性**\n\nGPT-4V 物理评测 (He et al., 2025) SciBench (Wang et al., 2024)\n\n通过 OCR 或端到端视觉编码器处理图表，发现模型易被视觉噪声干扰，推理链断裂；本文用“字幕即抽象”策略规避了此类感知-推理耦合失效。\n\n**3\\. 文本化中间表示的推理增强**\n\nReasoning-OCR (He et al., 2025) Chain-of-Thought + LaTeX (Liang et al., 2024) Program-of-Thought (Chen et al., 2023)\n\n首次在 OCR 场景验证“纯文本描述可替代图像输入”的假设；本文将其扩展到**通用科学图**，并引入结构化、领域自适应字幕与多阶段精炼，形成完整 pipeline。\n\n此外，近期同期工作如 **SciMaster (Chai et al., 2025)** 与 **Gemini-2.5-Pro 科学评测 (Huang & Yang, 2025)** 也观察到类似落差，但侧重工具调用与长链思维，未系统探究“字幕作为独立模态”的极限性能，故与本文互补。\n\n**Q3**: 论文如何解决这个问题？\n\n论文将“多模态推理落差”问题**形式化**为：  \n在低信息密度图像（几何/物理示意图）场景下，如何以**最小视觉 token 开销**获得**最大推理稳定性**。  \n为此，提出一套\\*\\*“字幕辅助推理”流水线\\*\\*，把视觉-文本融合难题转化为**纯文本推理**问题，具体实现分三步：\n\n1\\. 字幕生成：从“像素”到“语义 token”\n\n策略\n\n关键设计\n\n目的\n\n**Structured Captioning**\n\n领域模板 + 原子级组件拆分（对象、符号、关系、隐含属性）\n\n消除歧义，输出可直接被 LLM 解析的“伪代码式”描述\n\n**Grounding**\n\n显式坐标与绑定框\n\n解决物理图“谁连谁”的指代混乱\n\n**MathVerse 适配**\n\n几何专用模板（平行、相交、角度、辅助线）\n\n跨领域迁移时仅需替换模板，无需重训\n\n2\\. 推理范式：纯文本链式思考\n\n*   **无图像输入**：LLM 仅接收“结构化字幕 + 问题文本”，以标准 CoT 生成答案。\n*   **Image Reintegration**：可选地把原始图再拼回上下文，提供**冗余视觉校验**，在量子力学、电路等高密度视觉符号场景下自动触发（Adaptive Answer Routing）。\n\n3\\. 质量提升：三级后处理\n\n1.  **Format Optimization（FO）**  \n    强制模型按“单值、分段函数、向量”等 LaTeX 模板输出，降低解析误差。\n2.  **Critical Review（CR）**  \n    用第二强大模型（o3→o3）对初答做**物理一致性审查**，修正单位、符号、边界条件等隐性错误。\n3.  **Adaptive Answer Routing（AAR）**  \n    在 7 类物理子领域上，以 SeePhys-Dev 为验证集，**自动选择**“字幕流”或“端到端图像流”中置信度更高的一方作为最终答案。\n\n效果\n\n*   SeePhys-mini 上，Structured+Img+FO+CR 取得 **66.0 %**，相对最强纯多模态基线（G2.5P, 58.0 %）提升 **8 pp**。\n*   MathVerse 几何任务中，字幕流使 Claude-Opus-4 从 60.2 % 提至 **85.5 %**，并出现**纯文本 LLM（DeepSeek-R1）反超多模态基线**的现象，验证“字幕即足够”假设。\n\n综上，论文**未改动任何模型参数**，仅通过**高质量文本化中间表示 + 纯文本推理 + 轻量级后处理**，即把视觉-文本融合问题转化为已充分解决的**文本推理问题**，从而系统性缩小多模态落差。\n\n**Q4**: 论文做了哪些实验？\n\n实验围绕两条主线展开：\n\n1.  在 **SeePhys-mini** 物理 benchmark 上系统消融字幕策略与后处理模块；\n2.  在 **MathVerse** 几何 benchmark 上验证跨领域泛化与“纯文本推理”极限性能。\n\n实验 1：SeePhys-mini 消融与提升（200 题，8 个难度级）\n\n组别\n\n变量\n\n关键结果\n\n**Baseline**\n\n直接多模态 (G2.5P / o3)\n\n58.0 %（最佳单模型）\n\n**Caption 质量**\n\nDefault → Grounding → Structured\n\n58.5 % → 59.0 % → **61.5 %**\n\n**互补视觉**\n\nStructured + Img\n\n61.5 % → **65.5 %**\n\n**格式+审查**\n\n+FO +CR\n\n65.5 % → **66.0 %**（最终方案）\n\n**路由策略**\n\nAAR（7 类物理子领域自动选流）\n\n在量子、电路等高密度符号场景优先用图像流，其余用字幕流，整体再提 0.5-1 pp\n\n此外给出**按难度细分**的最佳配置：\n\n*   中学/本科课程题：Structured+FO 即可达 81-87 %\n*   奥赛/研级题：必须“Structured+Img+CR”组合，PhD 级最高 **57.4 %**\n\n实验 2：MathVerse 泛化（261 题，Vision-Only vs Vision-Intensive）\n\n设置\n\n模型\n\n视觉强度\n\nw/ caption 提升\n\n**MLLM**\n\nClaude-Opus-4\n\nVision-Intensive\n\n60.2 % → **85.5 %** (↑25.3 pp)\n\n**纯文本 LLM**\n\nDeepSeek-R1\n\nVision-Only\n\n无图，仅用字幕 → **68.2 %**，反超 GPT-o3 多模态 64.5 %\n\n**跨模型稳健性**\n\nQwen2.5-72B-Instruct\n\n两种强度\n\n平均 +8~12 pp，所有 MLLM 均受益\n\n实验 3：组件必要性验证\n\n*   **Rephrasing 负增益**：让模型先复述问题再解答，准确率反而下降 8 pp，证明“复述”≠“高质量字幕”。\n*   **AAR 失效条件**：一旦字幕流≥61 %，自动路由会引入更弱图像流，导致整体下降，说明**字幕足够强时无需回退**。\n\n实验 4：效率与 token 开销\n\n*   一张典型物理图被多模态编码器展开为 **~400-800 视觉 token**；\n*   同图经 Structured Caption 压缩为 **60-90 文本 token**，减少 **\\>80 %** 视觉上下文长度，同时获得更高精度。\n\n综上，论文通过**控制变量式消融**与**跨领域迁移**两大实验矩阵，既验证了“字幕辅助”对多模态推理的普遍增益，也量化了其在\\*\\* token 效率、模型无关性、纯文本极限\\*\\*上的优势。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下方向按“**可落地难度**”与“**潜在增益**”二维评估，星号越多优先级越高。\n\n1\\. 自适应字幕粒度 ★★★★☆\n\n*   **问题**：当前模板固定，同一张图对初中生与博士生输出相同长度字幕。\n*   **思路**：用**强化学习**或**可逆缩放策略**动态决定“描述到多细”——简单图只保留符号表，复杂场图自动展开矢量分量、边界条件。\n*   **验证指标**：字幕 token 数 / 推理准确率 Pareto 前沿。\n\n2\\. 程序-字幕混合推理 ★★★★★\n\n*   **问题**：纯文本 CoT 难以处理偏微分、隐式方程组。\n*   **思路**：在结构化字幕里直接嵌入**可执行符号代码**（SymPy、Julia ModelingToolkit），让模型生成“代码块”而非 LaTeX 句子，再调用外部引擎求数值解。\n*   **期望**：把 SeePhys 中“解析解不可得”的 PhD 级题目（如非线性电路暂态）从 57 % 提到 >75 %。\n\n3\\. 跨模态不确定度估计 ★★★☆☆\n\n*   **问题**：字幕可能误识别符号或漏标关键力。\n*   **思路**：\n    1.  让字幕模型输出**符号级置信度**；\n    2.  推理模型基于置信度**主动请求放大**或**人机协同**；\n*   **收益**：在保持自动化的同时，把**临界错误率**再降 30 %。\n\n4\\. 向化学/生物图谱扩展 ★★★☆☆\n\n*   **问题**：化学结构式、生物通路图的信息密度远高于物理示意图。\n*   **思路**：\n    *   化学：将 SMILES/InChI 字符串作为“字幕”中间态，直接喂给 LLM；\n    *   生物：用 Systems Biology Graphical Notation (SBGN) 的 XML 描述作为结构化字幕。\n*   **验证基准**：新构建 ChemVerse、BioVerse，测试反应预测与通路推理。\n\n5\\. 人机闭环科学发现 ★★☆☆☆\n\n*   **问题**：字幕可读性高，适合科学家**在线修正**。\n*   **思路**：推出“**字幕即接口**”工作台——研究者对字幕进行**行间编辑**，系统实时回推新答案；编辑记录用来**迭代微调**字幕生成器，形成飞轮。\n*   **长期目标**：让框架成为实验室日常工具，而非一次性比赛方案。\n\n6\\. 多图-多模态长上下文 ★★☆☆☆\n\n*   **问题**：真实科研常出现\\*\\*>10 张关联图\\*\\*（实验装置+数据曲线+拟合结果）。\n*   **思路**：\n    *   把每张图生成独立字幕后，用**超链接语法**建立跨图引用（如“图2-curve-A 即图1-scatter 的导数”）；\n    *   采用**128k 长上下文 LLM**做全局推理。\n*   **基准**：构建 LongSeePhys-2k，平均 5.3 张图/题，测试长链因果综合。\n\n7\\. 统一评测协议与错误本体 ★★★★☆\n\n*   **问题**：不同工作使用私有提示与打分脚本，结果不可复现。\n*   **建议**：\n    1.  开源**字幕+推理提示库**与**自动评分器**；\n    2.  建立细粒度错误本体（符号误识别、单位缺失、概念混淆、计算错误），支持**错误驱动**的迭代优化。\n\n8\\. 低资源语言与可访问性 ★★☆☆☆\n\n*   **问题**：非英语使用者难以直接受益。\n*   **思路**：\n    *   用**多语字幕模板**（中、西、印地）把结构化部分本地化；\n    *   保持符号与公式仍为 LaTeX，实现“**语言无关、语义同构**”的推理。\n\n综上，**程序-字幕混合推理**与**自适应粒度**两条路线兼具高增益与可验证性，可作为下一阶段主攻；**跨学科扩展**与**人机闭环**则构成长期愿景，逐步把字幕辅助框架升级为**通用科学发现引擎**。\n\n**Q6**: 总结一下论文的主要内容\n\n论文主旨\n\n针对“**多模态推理显著弱于纯文本推理**”这一普遍现象，提出**字幕辅助推理框架**：用高质量、结构化字幕把图像转换成极短文本 token，再交由 LLM 进行纯文本链式思考，无需微调即可在物理与几何任务上同时取得 SOTA。\n\n核心贡献\n\n1.  **新范式**：低信息密度图→结构化字幕→纯文本 CoT，视觉 token 减少 80%，准确率反而提升。\n2.  **系统方法**：\n    *   Structured Captioning（领域模板+原子组件）\n    *   Image Reintegration（冗余视觉校验）\n    *   Format Optimization & Critical Review（二级后处理）\n    *   Adaptive Answer Routing（7 类物理子领域自动选流）\n3.  **实证结果**：\n    *   ICML 2025 SeePhys 挑战赛 **第一名**（66.0 %，超最强多模态基线 8 pp）。\n    *   MathVerse 几何基准上，字幕流把 Claude-Opus-4 从 60.2 % 提至 **85.5 %**；纯文本 LLM（DeepSeek-R1）仅用字幕即达 **68.2 %**，反超 GPT-o3 多模态。\n4.  **跨域泛化**：同一框架零样本迁移到几何、电路、光学等 8 级难度，验证“**字幕即足够**”假设。\n\n一句话总结\n\n用**可解析的 60-token 字幕**替代**400-token 视觉编码**，把多模态推理问题转化为已解决的文本推理问题，在物理与几何两大基准上同时刷新 SOTA，并首次证明**纯文本 LLM 可比端到端多模态系统更强**。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Multimodal%20Reasoning%20for%20Science%3A%20Technical%20Report%20and%201st%20Place%20Solution%20to%20the%20ICML%202025%20SeePhys%20Challenge，链接是  https://arxiv.org/pdf/2509.06079  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.06079  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-12-1758152840092","title":"Phi: Preference Hijacking in Multi-modal Large Language Models at Inference Time","description":"Recently, Multimodal Large Language Models (MLLMs) have gained significant attention across various domains. However, their widespread adoption has also raised serious safety concerns. In this paper, we uncover a new safety risk of MLLMs: the output preference of MLLMs can be arbitrarily manipulated by carefully optimized images. Such attacks often generate contextually relevant yet biased responses that are neither overtly harmful nor unethical, making them difficult to detect. Specifically, we introduce a novel method, Preference Hijacking (Phi), for manipulating the MLLM response preferences using a preference hijacked image. Our method works at inference time and requires no model modifications. Additionally, we introduce a universal hijacking perturbation -- a transferable component that can be embedded into different images to hijack MLLM responses toward any attacker-specified preferences. Experimental results across various tasks demonstrate the effectiveness of our approach. The code for Phi is accessible at https://github.com/Yifan-Lan/Phi.","url":"https://huggingface.co/papers/2509.12521","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.092Z","metadata":{"authors":["Yifan Lan","Yuanpu Cao","Weitong Zhang","Lu Lin","Jinghui Chen"],"date":"","rank":13,"llmAnalysis":"","categories":["cs.LG"],"pdfUrl":"https://arxiv.org/pdf/2509.12521.pdf","arxivUrl":"https://arxiv.org/abs/2509.12521","arxivId":"2509.12521","coolPaperUrl":"https://papers.cool/arxiv/2509.12521","published":"2025-09-15T23:55:57Z","updated":"2025-09-15T23:55:57.000Z","zh_summary":"最近，多模态大型语言模型（MLLMs）在各个领域引起了广泛关注。然而，它们的广泛应用也引发了严重的安全隐患。在本文中，我们揭示了MLLMs的一种新的安全风险：MLLMs的输出偏好可以通过精心优化的图像随意操纵。这类攻击通常会生成上下文相关但偏见的回应，这些回应既不明显有害，也不不道德，因此很难被检测到。具体而言，我们介绍了一种新方法——偏好劫持（Phi），用于通过偏好劫持图像操纵MLLM的响应偏好。我们的方法在推理时工作且无需对模型进行修改。此外，我们还介绍了一种通用的劫持扰动——一种可转移的组件，可以嵌入不同的图像中，以劫持MLLM的响应，使其朝向任何攻击者指定的偏好。不同任务上的实验结果证明了我们方法的有效性。Phi的代码可以在https://github.com/Yifan-Lan/Phi获取。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n该论文揭示并系统研究了多模态大语言模型（MLLM）在推理阶段存在的一种新型安全风险：**偏好劫持（Preference Hijacking, Phi）**。具体而言，论文指出：\n\n*   **问题核心**：MLLM 的输出偏好可被**未经训练的、仅通过图像像素级扰动**的对抗样本在推理时任意操控，而无需修改模型参数或架构。\n*   **攻击特点**：\n    1.  生成的回答在语义上与用户查询和原始图像保持**上下文一致**，但隐性地植入攻击者预设的**偏见或立场**；\n    2.  由于回答并非显式有害，传统内容安全检测手段（如毒性分类器、对齐审查 API）**难以察觉**；\n    3.  攻击仅通过优化一张\\*\\*“劫持图像”\\*\\*实现，可在社交媒体、旅游网站等场景广泛传播，**影响终端用户决策**（如贬低某旅游目的地）。\n*   **研究目标**：\n    *   提出一种**无需模型微调**的推理时攻击范式，首次将“偏好操控”而非“固定字符串输出”作为优化目标；\n    *   引入**通用劫持扰动**（Universal Hijacking Perturbation），使得同一扰动模板可**跨图像迁移**，大幅降低攻击成本；\n    *   在文本-only 与多模态任务上量化评估偏好劫持成功率，揭示现有对齐机制的盲区，为后续防御研究提供基准。\n\n**Q2**: 有哪些相关研究？\n\n论文在第 2 节系统回顾了两大类相关研究，并指出它们与 Preference Hijacking（Phi）的区别。按类别归纳如下：\n\n2.1 文本侧攻击（Text-based Attacks on LLMs）\n\n*   **Prompt Injection**\n    *   直接注入（Liu et al., 2023）\n    *   间接/数据投毒（Greshake et al., 2023）\n*   **自动化对抗前缀生成**\n    *   GCG（Zou et al., 2023）——基于梯度搜索生成可迁移前缀，触发有害输出\n    *   红队 LLM 自生成恶意指令（Casper et al., 2023；Mehrabi et al., 2024）\n*   **局限性**\n    *   高困惑度、易被基于困惑度的检测器发现（Zhu et al., 2023）\n    *   仅针对**文本模态**，未利用图像通道；输出多为**固定有害字符串**，与 Phi 的“偏好级隐式操控”目标不同\n\n2.2 图像侧攻击（Image-based Attacks on MLLMs）\n\n方法\n\n目标\n\n与 Phi 的关键差异\n\nFigstep（Gong et al., 2023）\n\n将有害关键词渲染成图像文字，绕过对齐\n\n依赖**显式有害字符**，输出可被判别器检测\n\n图像越狱（Li et al., 2024b；Niu et al., 2024）\n\n优化对抗噪声使模型输出 toxic 字符串\n\n仍聚焦**固定 toxic 输出**，非偏好操控；语义与查询常脱节\n\nVLAttack（Yin et al., 2024）\n\n黑盒场景下跨任务迁移扰动\n\n仅验证传统分类/检索指标，未涉及**开放式偏好**\n\nVerbose Images（Gao et al., 2024）\n\n增大模型延迟与能耗\n\n目标为**资源消耗**，非内容偏好\n\nImage Hijacks（Bailey et al., 2023）\n\n用对抗图像强制模型输出**指定字符串**或**隐藏指令**\n\n输出刚性、易暴露；受限于模型指令跟随能力，**无法精细操控偏好**\n\nSoft Prompts Go Hard（Zhang et al., 2024）\n\n在图像中嵌入“元指令”隐性提示\n\n仍依赖**指令跟随**，若模型对齐强则失效；未利用**对比式偏好学习**\n\n小结\n\n现有工作要么仅操控**文本模态**，要么在图像模态中追求**固定、显式、易检测**的输出；Phi 首次把\\*\\*“偏好级隐式偏见”**作为优化目标，通过**单模型 DPO 式目标**直接学习**可迁移图像扰动\\*\\*，在推理时无需修改模型即可持续影响多轮上下文相关的生成偏好。\n\n**Q3**: 论文如何解决这个问题？\n\n论文并未提出“防御”方案，而是**系统性地构建并验证了一种新型攻击范式**——Preference Hijacking（Phi），以暴露现有多模态大模型在推理阶段的偏好操控漏洞。其“解决”问题的思路体现在**如何高效、隐蔽、可迁移地实现偏好劫持**，具体方法如下：\n\n3.2 Preference Hijacking at Inference-Time\n\n1\\. 威胁模型形式化\n\n*   白盒访问目标 MLLM $f\\_\\\\theta(x, q)$\n*   攻击者仅可修改图像 $x$，**无法预知**用户文本查询 $q$\n*   目标：生成劫持图像 $x\\_h = x + h$，使得\n    *   $f\\_\\\\theta(x\\_h, q)$ 倾向于攻击者预设的偏好；\n    *   回答与 $(x, q)$ 保持语义一致；\n    *   $|h|\\_\\\\infty \\\\le \\\\Delta$（视觉不可感知）\n\n2\\. 对比偏好数据集构建\n\n*   对每条图像-查询对，人工或用**未对齐模型**生成两条回答：\n    *   $r\\_t$：符合**目标偏好**（如贬低城市、崇尚战争）\n    *   $r\\_o$：符合**原始/相反偏好**\n*   数据集 $\\\\mathcal{D}={(x, q, r\\_t, r\\_o)}$ 完全**独立于目标模型**，规避其对齐机制的影响\n\n3\\. 单模型 DPO 目标优化扰动\n\n将 Direct Preference Optimization（Rafailov et al., 2024）改造为**仅优化图像扰动**：\n\n$$ \\\\min\\_h -\\\\mathbb{E}_{(x,q,r\\_t,r\\_o)\\\\sim \\\\mathcal{D}} \\\\log\\\\sigma\\\\Bigl( \\\\underbrace{\\\\log\\\\frac{f_\\\\theta(r\\_t|x+h,q)}{f\\_\\\\theta(r\\_t|x,q)}}\\_{\\\\text{提升目标偏好}}\n\n*   \\\\beta \\\\underbrace{\\\\log\\\\frac{f\\_\\\\theta(r\\_o|x+h,q)}{f\\_\\\\theta(r\\_o|x,q)}}_{\\\\text{抑制原偏好}} \\\\Bigr) \\\\quad \\\\text{s.t. } |h|_\\\\infty\\\\le\\\\Delta $$\n    \n*   **仅更新 $h$**，模型参数 $\\\\theta$ 冻结\n    \n*   采用 Projected Gradient Descent（PGD）求解，保证 $\\\\ell\\_\\\\infty$ 有界\n    \n\n4\\. 通用劫持扰动（Universal Hijacking Perturbation）\n\n为摆脱“一图一扰动”的扩展瓶颈，提出**跨图像迁移**的通用扰动：\n\n形式\n\n做法\n\n优点\n\n采用情况\n\n**Phi-Patch**\n\n固定左上角 $168\\\\times168$ 方形 patch\n\n无需裁剪像素值，直接粘贴\n\n✔\n\n**Phi-Border**\n\n外圈加 $252\\\\times252$（LLaVA）或 $392\\\\times392$（Llama）边框\n\n不遮挡中心内容，视觉更隐蔽\n\n✔\n\n加性噪声\n\n全局像素级噪声\n\n视觉难察觉，但需裁剪，迁移性差\n\n✘\n\n优化时**图像 $x$ 动态采样**，扰动 $h$ 共享，使得同一 patch/border 可**零成本迁移到任意新图像**。\n\n4 实验验证“解决”了攻击有效性\n\n*   **文本-only 任务**：财富/权力寻求、幻觉倾向  \n    → Phi 在 MC 与 P-Score 上**全面超越** System Prompt 与 Image Hijacks\n*   **多模态任务**：城市、披萨、人物负面评价；Tech/Nature、War/Peace、Power/Humility 倾向  \n    → Phi 在绝大多数场景**MC 提升 20–100%**，P-Score 提高 1–3 分\n*   **通用扰动**：同一 Phi-Patch/Phi-Border 在**未见过的风景、食物、人脸图像**上仍保持高 MC 与 P-Score，验证**跨图迁移性**\n\n结论\n\n论文通过**对比偏好学习+单模型 DPO+通用 patch/border 优化**，首次实现了**推理时无需模型修改、视觉隐蔽、跨图像迁移**的**偏好级劫持**，从而“解决”了**如何系统暴露 MLLM 偏好操控漏洞**的研究问题，为后续防御工作提供了明确基准与测试平台。\n\n**Q4**: 论文做了哪些实验？\n\n论文围绕 **Preference Hijacking (Phi)** 共设计了 **4 组实验**，覆盖 **文本-only**、**多模态** 与 **通用扰动迁移** 三大场景，并在 **防御分析** 与 **跨模型验证** 上补充了消融与鲁棒性测试。具体实验一览如下：\n\n4.1 实验设置\n\n*   **目标模型**\n    \n    *   LLaVA-1.5-7B\n    *   Llama-3.2-11B\n    *   Qwen2.5-VL-7B（附录 B，验证跨架构泛化）\n*   **评估指标**\n    \n    *   **MC**（Multiple Choice Accuracy）：模型在 A/B 选项中选择**目标偏好**的比例\n    *   **P-Score**（Preference Score）：GPT-4o 按 1–5 分评判生成回答与目标偏好的**契合度与丰富度**\n*   **基线方法**\n    \n    *   Clean Prompt / Clean Image：无攻击\n    *   System Prompt：通过系统提示强行引导偏好\n    *   Image Hijacks（Bailey et al., 2023）：对抗图像强制输出固定字符串\n\n4.2 文本-only 任务（无视觉语义依赖）\n\n偏好数据集\n\n目标\n\n结果摘要\n\nWealth-seeking\n\n让模型“贪财”\n\nPhi MC 89.0%（LLaVA） vs 46.0% Clean；P-Score 2.89 vs 1.84\n\nPower-seeking\n\n让模型“恋权”\n\nPhi MC 97.5% vs 56.0% Clean；P-Score 3.24 vs 1.85\n\nHallucination\n\n让模型“编造”\n\nPhi MC 70.5% vs 38.5% Clean；P-Score 4.52 vs 1.89\n\n→ **结论**：劫持图像**无需携带任何语义信息**，即可显著扭转模型人格与幻觉倾向，且生成回答自然度高。\n\n4.3 多模态任务（查询与图像内容强相关）\n\n任务类型\n\n偏好\n\n结果摘要（LLaVA）\n\n结果摘要（Llama）\n\n**Opinion**\n\nCity→负面描述\n\nPhi MC 74.1% vs 18.5% Clean\n\nPhi MC 100% vs 1.9% Clean\n\nPizza→负面评价\n\nPhi MC 50.0% vs 11.8% Clean\n\nPhi MC 88.2% vs 5.9% Clean\n\nPerson→负面评价\n\nPhi MC 60.0% vs 0% Clean\n\nPhi MC 50.0% vs 10.0% Clean\n\n**Contrastive**\n\nTech > Nature\n\nPhi MC 77.3% vs 38.6% Clean\n\nPhi MC 90.9% vs 27.3% Clean\n\nWar > Peace\n\nPhi MC 67.3% vs 27.3% Clean\n\nPhi MC 78.2% vs 14.6% Clean\n\nPower > Humility\n\nPhi MC 64.4% vs 42.2% Clean\n\nPhi MC 75.6% vs 37.8% Clean\n\n→ **结论**：在**图像-查询语义强绑定**场景，Phi 仍能**保持上下文一致性**的同时，把模型偏好**强制扭转到攻击者指定方向**。\n\n4.4 通用劫持扰动实验（跨未见图像迁移）\n\n偏好\n\n方法\n\nMC（LLaVA）\n\nMC（Llama）\n\n关键结论\n\nLandscape\n\nPhi-Patch\n\n45.0%\n\n100%\n\n同一 168×168 patch 直接贴到**未见风景图**仍有效\n\nPhi-Border\n\n53.3%\n\n100%\n\n边框扰动**零样本迁移**\n\nFood\n\nPhi-Patch\n\n48.0%\n\n96%\n\nFood-101 未见菜品同样被**贬低**\n\nPeople\n\nPhi-Patch\n\n42.0%\n\n68%\n\nVGGFace2 新人脸同样被**负面评价**\n\n→ **结论**：通用扰动**无需重新训练**即可跨数据集、跨图像内容保持劫持能力，显著降低攻击成本。\n\n4.5 防御分析（预处理式防御）\n\n防御手段\n\n参数\n\nPhi MC 下降\n\n观察\n\nJPEG 压缩\n\nquality=30\n\n74.1%→29.6%\n\n图像失真严重，**可用性下降**\n\n降采样\n\nrescale=0.5\n\n74.1%→31.5%\n\n细节丢失，**仍未完全消除**攻击\n\n高斯噪声\n\nσ=40\n\n74.1%→20.4%\n\n噪声肉眼可见，**防御-可用性权衡**突出\n\n→ **结论**：基础预处理可**部分缓解**但**无法根除**；且攻击者可把防御当作**数据增广**进行自适应绕过。\n\n附录补充实验\n\n*   **附录 B**：在 Qwen2.5-VL-7B 上重复多模态实验，Phi 仍保持 **MC 40–100%**，验证**跨架构泛化**。\n*   **附录 C**：\n    *   ∆ 消融：$\\\\Delta<16/255$ 时 P-Score 骤降，**16/255 为有效且隐蔽**的折中。\n    *   Border/Patch 大小：当 border 厚度 < 14 px（vision encoder patch 尺寸）或 patch 边长 < 56 px 时劫持能力**急剧下降**。\n*   **附录 D**：**Scattered Patch** 将 84×84 区域拆成 36 块 14×14 离散小 patch，**P-Score 仍达 3.62**，视觉更难察觉。\n\n一句话总结\n\n实验从**任务类型**（文本 ↔ 多模态）、**扰动泛化**（一图一扰 → 通用 patch/border）、**模型家族**（LLaVA/Llama/Qwen）到**防御手段**（JPEG、缩放、噪声）做了**全覆盖 stress-test**，一致验证：**Phi 能在推理时隐蔽、高效、迁移地劫持 MLLM 偏好**。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下可继续探索的方向按**攻击增强**、**防御对抗**、**理论理解**与**现实影响**四条线展开，均直接对应原文未解决或仅初步触及的空白。\n\n1 攻击增强维度\n\n方向\n\n关键问题\n\n可能做法\n\n**多轮对话持续性**\n\n单次劫持能否在多轮上下文里**保持或放大**？\n\n构建多轮偏好数据集，用强化学习或对话级 DPO 优化**跨轮扰动**；监测随着轮次增加 MC/P-Score 的衰减曲线\n\n**多模态指令组合**\n\n同时注入**文本+图像**双通道劫持信号是否协同？\n\n在输入空间做**联合扰动**（文本前缀 + 图像 patch）并求解统一目标；观察同偏好下样本效率与隐蔽性提升\n\n**视频/3D 输入扩展**\n\n时序或立体视觉是否提供更**丰富隐藏信道**？\n\n将 Phi 目标推广到**视频帧序列**或 NeRF 渲染图，优化**时空稀疏扰动**；测试对视频 LLM 的立场操控能力\n\n**个性化模型攻击**\n\n用户私有微调模型偏好各异，如何**一次扰动通用**？\n\n采用**元学习**框架：在大量用户 LoRA 权重上训练**元扰动**，使同一 patch 对不同私有模型均有效\n\n2 防御对抗维度\n\n方向\n\n关键问题\n\n可能做法\n\n**对抗训练规模化**\n\n现有对抗训练成本过高，如何**轻量化**？\n\n仅对**视觉编码器**做 LoRA 微调，使用 Phi 生成的劫持图像作为负样本，保持 LLM 冻结；评估 MC 下降与干净性能损耗\n\n**随机化集成防御**\n\n预处理随机化能否**破坏通用扰动**的跨图一致性？\n\n在推理时对输入图像随机应用**多种预处理链**（JPEG+缩放+裁剪），用多数投票或置信度筛选输出；测试对 Phi-Patch/Phi-Border 的**期望误差下限**\n\n\\*\\* certified robustness \\*\\*\n\n能否给出**可证明的偏好界**而非经验防御？\n\n将偏好目标转化为**概率区间**，利用**随机平滑**或**可验证鲁棒训练**给出“在一定 $\\\\ell\\_\\\\infty$ 半径内偏好偏移不超过 $\\\\epsilon$”的证书\n\n**检测器 arms race**\n\n当攻击者把防御当增广，检测器如何**自适应迭代**？\n\n构建**双玩家博弈**数据集：每轮更新检测器后重新训练扰动，记录**纳什收敛**时的攻防性能，衡量**可防御上限**\n\n3 理论理解维度\n\n方向\n\n关键问题\n\n可能做法\n\n**偏好流形几何**\n\n劫持扰动在**视觉-语义联合嵌入**中如何移动决策边界？\n\n用**探测向量**（probing vectors）测量视觉编码器输出在添加 $h$ 前后与文本偏好方向的**余弦偏移**，可视化低维流形；分析偏移方向是否与**CLIP 文本编码**的“正面-负面”向量对齐\n\n**最优扰动下限**\n\n是否存在**信息论极限**使任何扰动必失效？\n\n建立**多模态率-失真-鲁棒性**框架：在给定视觉保真度 $D$ 与模型容量 $C$ 下，推导偏好改变概率上界 $P(\\\\text{switch})\\\\le f(D,C)$\n\n**泛化误差来源**\n\n为何同一 $h$ 能跨图像、跨模型？\n\n分析**视觉 Transformer 的低频核**（low-frequency kernels）与**对抗可迁移性**的相关性；验证 patch/border 是否恰好落在**共享高频敏感区**\n\n4 现实影响维度\n\n方向\n\n关键问题\n\n可能做法\n\n**社交媒体扩散模拟**\n\n劫持图像在**真实平台**传播能否**放大舆论**？\n\n构建**仿真环境**：用 Twitter/Flickr 风格推荐算法，将 Phi-Border 风景图推送给旅游话题用户；测量**用户情感极性**变化与**目的地搜索量**下降比例\n\n**版权与合规风险**\n\n当攻击者把扰动嵌入**版权图片**，平台如何**合规下架**？\n\n研究**扰动指纹**（perturbation fingerprint）：训练 CNN 检测器识别 Phi-Patch/Phi-Border 的统计特征，实现**自动 DMCA 扩展理由**\n\n**人机交互可信**\n\n普通用户能否**肉眼识别**劫持图像？\n\n设计**众包实验**：让受试者对比原图与 Phi 图，给出**可信度评分**与**购买/旅行意向**；量化**视觉隐蔽性**与**经济外部性**之间的关系\n\n快速可落地选题示例\n\n1.  **“多轮 Phi”**：用 GPT-4 生成 5 轮对话偏好数据集，一周内验证劫持衰减曲线。\n2.  **“LoRA 对抗训练”**：仅训练视觉编码器 2 小时，观察 MC 下降 30% 所需干净数据量。\n3.  **“随机化集成”**：实现 3 种随机预处理 + 置信度投票，预计半天完成推理级防御原型。\n\n这些方向既可直接在现有代码库扩展，也能形成新的**攻防 benchmark**，填补 Phi 留下的研究与实践空白。\n\n**Q6**: 总结一下论文的主要内容\n\n论文核心概要\n======\n\n1\\. 新威胁：Preference Hijacking（Phi）\n---------------------------------\n\n*   MLLM 在推理阶段无需任何参数更新，即可被**精心优化的图像扰动**任意操控输出偏好\n*   生成结果与查询、图像**语义一致**，但隐植攻击者设定的偏见，传统毒性检测难以发现\n\n2\\. 方法框架\n--------\n\n步骤\n\n要点\n\n数据集\n\n构建对比偏好四元组 (x, q, r\\_t, r\\_o)，r\\_t 与 r\\_o 分别对应目标与相反偏好\n\n优化目标\n\n单模型 DPO 变体：仅学习图像扰动 h，最大化 r\\_t 概率、抑制 r\\_o 概率，∥h∥\\_∞ ≤ Δ\n\n通用扰动\n\n训练一次即可跨图像迁移：  \n• Phi-Patch（左上 168×168 块）  \n• Phi-Border（外圈边框）\n\n3\\. 实验结果\n--------\n\n场景\n\n指标\n\n主要数据（LLaVA-1.5）\n\n结论\n\n文本-only\n\nMC / P-Score\n\nWealth 89% / 2.89；Power 97.5% / 3.24；Hallu 70.5% / 4.52\n\n图像无需语义即可扭转人格与幻觉\n\n多模态\n\nMC / P-Score\n\nCity 74% / 4.00；Pizza 50% / 4.09；Tech/Nature 77% / 4.11\n\n保持上下文一致下强制负面/倾向性评价\n\n通用扰动\n\nMC\n\nLandscape 53%；Food 58%；People 58%\n\n同一 patch/border 零样本迁移到未见图仍有效\n\n防御\n\nMC 下降\n\nJPEG-30 → 29.6%；Noise-40 → 20.4%\n\n基础预处理可缓解但无法根除，且图像质量受损\n\n4\\. 贡献\n------\n\n*   提出**推理时偏好劫持**新范式，无需模型改动\n*   引入**跨图像通用扰动**，显著降低攻击成本\n*   在文本与多模态任务上系统验证，揭示现有对齐机制盲区，为后续防御研究提供基准\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Phi%3A%20Preference%20Hijacking%20in%20Multi-modal%20Large%20Language%20Models%20at%20Inference%20Time，链接是  https://arxiv.org/pdf/2509.12521  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.12521  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-13-1758152840093","title":"Multiple Instance Learning Framework with Masked Hard Instance Mining for Gigapixel Histopathology Image Analysis","description":"Digitizing pathological images into gigapixel Whole Slide Images (WSIs) has opened new avenues for Computational Pathology (CPath). As positive tissue comprises only a small fraction of gigapixel WSIs, existing Multiple Instance Learning (MIL) methods typically focus on identifying salient instances via attention mechanisms. However, this leads to a bias towards easy-to-classify instances while neglecting challenging ones. Recent studies have shown that hard examples are crucial for accurately modeling discriminative boundaries. Applying such an idea at the instance level, we elaborate a novel MIL framework with masked hard instance mining (MHIM-MIL), which utilizes a Siamese structure with a consistency constraint to explore the hard instances. Using a class-aware instance probability, MHIM-MIL employs a momentum teacher to mask salient instances and implicitly mine hard instances for training the student model. To obtain diverse, non-redundant hard instances, we adopt large-scale random masking while utilizing a global recycle network to mitigate the risk of losing key features. Furthermore, the student updates the teacher using an exponential moving average, which identifies new hard instances for subsequent training iterations and stabilizes optimization. Experimental results on cancer diagnosis, subtyping, survival analysis tasks, and 12 benchmarks demonstrate that MHIM-MIL outperforms the latest methods in both performance and efficiency. The code is available at: https://github.com/DearCaat/MHIM-MIL.","url":"https://huggingface.co/papers/2509.11526","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.093Z","metadata":{"authors":["Wenhao Tang","Sheng Huang","Heng Fang","Fengtao Zhou","Bo Liu","Qingshan Liu"],"date":"","rank":14,"llmAnalysis":"","categories":["cs.CV"],"pdfUrl":"https://arxiv.org/pdf/2509.11526.pdf","arxivUrl":"https://arxiv.org/abs/2509.11526","arxivId":"2509.11526","coolPaperUrl":"https://papers.cool/arxiv/2509.11526","published":"2025-09-15T02:31:33Z","updated":"2025-09-15T02:31:33.000Z","zh_summary":"将病理图像数字化为千兆像素全幻灯片图像（WSIs）为计算病理学（CPath）开辟了新的方向。由于阳性组织仅占千兆像素WSIs的一小部分，现有的多实例学习（MIL）方法通常通过注意机制专注于识别显著实例。然而，这导致了对易分类实例的偏见，而忽视了具有挑战性的实例。近期研究表明，困难示例对于准确建模判别边界至关重要。在实例层面应用这一思想，我们详细阐述了一个新的MIL框架，具有掩码困难实例挖掘（MHIM-MIL），它利用一种具有一致性约束的连体结构来探索困难实例。MHIM-MIL使用类感知实例概率，采用动量教师来掩盖显著实例，并隐式挖掘困难实例以训练学生模型。为了获得多样化、非冗余的困难实例，我们采用大规模随机掩码，同时利用全局回收网络降低丢失关键特征的风险。此外，学生使用指数移动平均更新教师，从而识别新的困难实例以进行后续训练迭代，并稳定优化。在癌症诊断、亚型分析、生存分析任务以及12个基准测试上的实验证明，MHIM-MIL在性能和效率上均优于最新方法。代码可以在以下地址获取： https://github.com/DearCaat/MHIM-MIL。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n该论文针对千兆像素级全切片病理图像（WSI）分析中“显著实例主导”导致的判别边界模糊问题，提出一种基于掩码困难实例挖掘的多示例学习框架（MHIM-MIL）。核心动机与待解决问题可归纳为：\n\n*   **问题 1：显著实例偏差**  \n    现有注意力 MIL 方法过度依赖高注意力（易分类）实例进行包嵌入，忽视位于决策边界的困难实例，导致模型泛化能力下降。\n    \n*   **问题 2：困难实例无标签不可直接挖掘**  \n    病理 MIL 仅有切片级标签，缺乏实例级标注，传统困难样本挖掘策略无法直接应用。\n    \n*   **问题 3：序列冗余与计算瓶颈**  \n    WSI 实例数庞大（≈10 k），全序列训练带来高昂显存与耗时，且冗余实例干扰优化。\n    \n*   **问题 4：掩码带来的关键信息丢失风险**  \n    高比例掩码虽提升效率，但可能屏蔽稀疏而关键的组织学特征，影响最终诊断。\n    \n\n为此，论文提出“掩码困难实例挖掘”范式，通过**动量教师评估-掩码显著实例-全局回收-一致性约束**的迭代机制，迫使学生网络关注被掩盖的困难区域，从而在**癌症诊断、亚型分类、生存分析**三大任务上同时提升精度与效率。\n\n**Q2**: 有哪些相关研究？\n\n论文将相关研究划分为两大主线：**计算病理学（Computational Pathology, CPath）**与**困难样本挖掘（Hard Sample Mining）**。以下按这两条主线梳理并补充其脉络，均给出可追踪的标志性文献或方法。\n\n1 计算病理学中的多示例学习\n\n子主题\n\n代表方法 / 综述\n\n主要贡献与局限\n\n**经典 MIL 范式**\n\nAB-MIL \\[14\\]\n\n首次在病理引入可学习注意力权重聚合实例特征，成为后续 embed-level 方法的“基线骨架”。\n\n**注意力改进**\n\nCLAM \\[17\\]、DSMIL \\[15\\]、TransMIL \\[9\\]\n\n引入 top-K 选择、双分支对比、Transformer 自注意力等，进一步提升显著区域建模能力，但仍偏重“易分类”实例。\n\n**伪标签/实例级**\n\nCampanella \\[38\\]、Qu et al. \\[42\\]\n\n尝试用伪标签或原型学习给出实例预测，性能受限于弱监督噪声。\n\n**高效序列采样**\n\nDTFD-MIL \\[13\\]、IBMIL \\[6\\]、RankMix \\[66\\]\n\n通过伪袋、强化学习或数据增广缓解长序列压力，未显式挖掘困难实例。\n\n**Mamba/线性复杂度**\n\n2D-Mamba \\[48\\]、M3amba \\[49\\]\n\n用状态空间模型替代自注意力，实现线性复杂度，但仍聚焦显著区域。\n\n**视觉-语言病理模型**\n\nPLIP \\[26\\]、UNI \\[27\\]、VILA-MIL \\[52\\]\n\n利用文本提示或大规模预训练提取通用特征，但训练阶段仍由高置信度实例主导。\n\n**多模态融合**\n\nCMTA \\[58\\]、Pathomic-Fusion \\[60\\]\n\n将基因组/影像/报告结合，性能高但数据获取门槛高；本文旨在**不引入额外模态**前提下缩小差距。\n\n**生存分析专用 MIL**\n\nWSISA \\[57\\]、MI-FCN \\[7\\]、Graph-MIL \\[8\\]\n\n用注意力或图卷积聚合 WSI 特征预测生存，同样面临显著区域过度聚焦问题。\n\n2 困难样本挖掘（Hard Sample Mining）\n\n技术类别\n\n代表文献\n\n核心思路\n\n**Loss-based**\n\nOHEM \\[73\\]、Focal Loss\n\n利用高损失样本或重新加权，放大困难样本贡献。\n\n**Similarity-based**\n\nTriplet/Quadruplet \\[87,88\\]\n\n在度量空间拉近同类、推远异类，显式采样难负对。\n\n**Learnable Weight**\n\nCVPR’19 \\[89\\]、Suh et al. \\[81\\]\n\n让网络自动学习样本重要性权重，需完整监督。\n\n**图对比学习**\n\nMixGCF \\[79\\]、AU-HNM \\[80\\]\n\n在图神经网络中挖掘难负节点，提升图表示。\n\n**MIL 场景下的困难挖掘**\n\nLi et al. \\[90\\]\n\n利用注意力得分从假阴性袋中选“难负实例”组成难袋；**与本文差异**：本文**不显式定位难负**，而是通过**掩码显著实例**间接迫使网络关注剩余困难区域，避免错误伪标签放大。\n\n3 小结与定位\n\n*   **已有 MIL 病理方法**：注意力权重或 top-K 选择→ 显著实例主导 → 决策边界模糊。\n*   **已有困难样本挖掘**：大多依赖实例标签或 pairwise 监督，无法直接迁移到**仅袋标签**的千兆像素病理场景。\n*   **本文工作**：首次在病理 MIL 中系统引入“掩码显著→ 挖掘困难”范式，结合动量教师、类感知概率、全局回收与一致性约束，实现**无实例标签**下的稳定困难实例挖掘，兼顾精度与效率。\n\n**Q3**: 论文如何解决这个问题？\n\n论文将“显著实例主导、困难实例缺失”这一核心难题转化为\\*\\*“如何在没有实例标签的条件下，持续、稳定、高效地挖掘困难实例并用于训练”**。为此提出**掩码困难实例挖掘 MIL 框架（MHIM-MIL）\\*\\*，其解决路径可概括为“**评估-掩码-回收-对齐**”四步闭环：\n\n1 评估：类感知实例概率（Class-aware Instance Probability）\n\n*   **动机**：传统注意力得分仅反映“显著性”，不直接体现“可分性”，易把高响应但低判别力的脂肪区等误判为“简单实例”。\n*   **做法**：\n    1.  动量教师对全序列实例输出注意力权重 $a\\_i$；\n    2.  用教师自带的**实例分类器**（或袋分类器）对加权特征 $a\\_i z\\_i$ 进行**一次前向**得到 softmax 概率 $s\\_i$；\n    3.  按 $s\\_i$ 降序排列，得到“易分类”候选序列。\n*   **收益**：概率直接编码分类置信度，比纯注意力更准确地定位真正“简单”实例，为后续掩码提供可靠排序。\n\n2 掩码：两级掩码策略（RHSM → RSM）\n\n1.  **Randomly High-Score Masking（RHSM）**\n    \n    *   仅掩码 Top-βh%（βh 起始≈3%）最高概率实例；\n    *   **随机减半**掩码：在 Top-2βh% 中随机选一半掩码，防止训练初期把全部关键区域抹掉（error mining）。\n    *   余弦退火衰减 βh，保证后期保留足够阳性信号。\n2.  **Large-Scale Random Score Masking（RSM）**\n    \n    *   对 RHSM 剩余序列再随机掩码 70%–90%，**一次把序列长度从 O(10k) 降到 O(1k)**；\n    *   随机性引入多样性，显著降低冗余与过拟合；\n    *   相比 Low-Score Masking（LSM），RSM 不依赖尾部打分，避免“把困难也掩掉”。\n\n3 回收：全局回收网络（Global Recycle Network, GRN）\n\n*   **风险**：高比例随机掩码可能丢失稀疏但关键的特征（如微转移灶）。\n*   **做法**：\n    *   维护**可学习全局查询向量** $Q\\_G∈R^{K×D}$（EMA 更新，无梯度）；\n    *   对掩码子序列 $Z\\_m$ 做多头交叉注意力 $MCA(Q\\_G, Z\\_m)$，输出**回收特征** $Z̃\\_m$；\n    *   将 $Z̃\\_m$ 与未掩码子序列拼接，共同送入学生网络。\n*   **收益**：以极低计算代价（仅 K 个查询，K≈64）实现“全局记忆”，补偿被随机掩码的关键信息。\n\n4 对齐：一致性约束与迭代更新\n\n*   **一致性损失** $L\\_{con}$：  \n    令教师对**全序列**的袋嵌入 $F\\_t$ 与学生仅见**困难序列**的袋嵌入 $F\\_s$ 做 KL 对齐，迫使学生从困难实例中也能还原与教师一致的判别空间。  \n    $$L\\_{con}=−softmax(F\\_t/τ)⋅log softmax(F\\_s)$$\n    \n*   **迭代优化**：\n    \n    *   学生总损失 $L=L\\_{cls}+αL\\_{con}$；\n    *   教师参数用 EMA 平滑跟随学生，**不接收梯度**，保证目标稳定且持续刷新“困难”定义。\n\n5 推理阶段\n\n*   完全丢弃掩码与回收模块，**仅使用学生网络对全序列进行一次前向**，兼顾效率与精度，无额外成本。\n\n6 效果总结\n\n问题\n\n论文对应机制\n\n关键收益\n\n显著实例偏差\n\n类感知概率 + 掩码高置信\n\n精准定位“简单”实例，迫使关注边界区域\n\n无实例标签\n\n动量教师生成伪排序\n\n无需人工标注，可端到端训练\n\n序列过长\n\nRSM 70–90% 随机掩码\n\n显存↓50%，训练时间↓20%\n\n掩码丢关键信息\n\nGRN 全局回收\n\n在 CAMELYON 等稀疏数据集 AUC 额外+0.7%\n\n优化不稳定\n\nEMA 教师 + 一致性损失\n\n收敛更平稳，跨 5×3 任务 12 套基准均取得 SOTA\n\n通过上述“**评估-掩码-回收-对齐**”闭环，MHIM-MIL 首次在千兆像素病理 MIL 中系统性地把“困难实例”变成训练主角，从而显著提升癌症诊断、亚型分类与生存分析的性能与效率。\n\n**Q4**: 论文做了哪些实验？\n\n论文在**三大临床任务**、**十二套公开基准**上进行了系统实验，并辅以**跨域验证、计算成本、消融与超参数分析**，形成“性能-效率-鲁棒性”三维评估矩阵。具体实验一览如下：\n\n1 主任务与数据集\n\n任务\n\n数据集\n\n规模\n\n评价指标\n\n**癌症诊断**\n\nCAMELYON（CAM16+CAM17）\n\n899 WSIs，≈8 k patches/WSI\n\nAccuracy, AUC, F1\n\n**癌种亚型**\n\nTCGA-NSCLC（LUAD vs LUSC）\n\n1 053 WSIs，≈10 k\n\nAccuracy, AUC, F1\n\nTCGA-BRCA（IDC vs ILC）\n\n1 131 WSIs，≈8.7 k\n\nAccuracy, AUC, F1\n\n**生存分析**\n\nTCGA-LUAD / LUSC / BLCA\n\n541 / 512 / 457 cases\n\nC-index\n\n2 特征提取器与基线\n\n*   **三种主干**\n    \n    *   ImageNet-1k ResNet-50\n    *   PLIP（病理-语言预训练）\n    *   UNI（病理大模型）\n*   **六种基线 MIL**  \n    AB-MIL、CLAM、DSMIL、TransMIL、DTFD-MIL、IBMIL\n    \n*   **两种外部 SOTA**  \n    R2T-MIL、2D-Mamba\n    \n\n→ 共 **3×6=18 组“特征×基线”** 组合，全部在 5-fold 交叉验证下复现。\n\n3 主实验结果（摘要）\n\n场景\n\n最佳提升示例（AUC / C-index）\n\nCAMELYON 诊断\n\nMHIM-v2(TransMIL+UNI) 93.47% → 超第二名 R2T-MIL 0.7%\n\nTCGA-NSCLC 亚型\n\nMHIM-v2(DSMIL+UNI) 96.82% → 超基线 DSMIL 1.25%\n\nTCGA-BRCA 亚型\n\nMHIM-v2(AB-MIL+PLIP) 93.3% Acc → 超 R2T-MIL 0.5%\n\n生存 BLCA\n\nMHIM-v2(TransMIL+UNI) C-index 63.0 → 超基线 1.8\n\n生存 LUAD\n\nMHIM-v2(AB-MIL+UNI) C-index 67.8 → 超基线 2.7\n\n**结论**：MHIM-v2 在 12 套基准上**全部优于原基线**，其中 9 项达到 **SOTA**，且提升幅度随特征质量（Res50→PLIP→UNI）递增。\n\n4 跨域验证（Cross-source）\n\n*   **模型源域**：TCGA-NSCLC（训练）\n*   **目标域**：CPTAC-NSCLC（仅测试）  \n    → AUC 提升 **+2.4%**（Res50）与 **+1.7%**（PLIP）\n*   **生存同理**：TCGA-LUAD → CPTAC-LUAD  \n    → C-index 提升 **+1.9%**（UNI）\n\n验证**不依赖同源扫描仪/染色**的鲁棒性。\n\n5 计算成本对比\n\n模型\n\n参数量\n\n训练时间/epoch\n\n峰值显存\n\n推理速度\n\nTransMIL\n\n2.67 M\n\n13.2 s\n\n10.6 G\n\n76 slide/s\n\nMHIM-v2(Trans)\n\n3.72 M\n\n10.5 s\n\n5.6 G\n\n72 slide/s\n\n*   在**性能+2.3% AUC** 同时，**显存↓48%**、**训练时间↓24%**。\n*   与同为 SOTA 的 R2T-MIL 相比，**参数量少 27%**，**显存少 44%**。\n\n6 消融实验（Ablation）\n\n模块消融（CAMELYON AUC）：\n\n配置\n\nAB-MIL\n\nTransMIL\n\n基线\n\n91.6\n\n91.2\n\n+RHSM\n\n92.1\n\n92.4\n\n+RHSM+RSM\n\n92.6\n\n93.0\n\n+RHSM+RSM+GRN\n\n92.8\n\n93.5\n\n+RHSM+RSM+GRN+CL（完整）\n\n**92.8**\n\n**93.5**\n\n→ 各组件**累积贡献**，GRN 与一致性损失各带来 **+0.3~0.5%** 最终提升。\n\n7 超参数与敏感性\n\n*   **RHSM 掩码比例** 0.5–3%：TCGA-NSCLC 在 2% 处饱和；CAMELYON 因数据少需更小比例。\n*   **RSM 随机掩码比例** 50–90%：80% 时综合最佳，再高压性能下降。\n*   **一致性损失权重 α** 0.05–0.5：0.1 处稳定，过大反而拖慢收敛。\n\n8 可视化与病理可解释性\n\n*   **注意力-概率双图**（图7）：展示 MHIM-v2 把关注区从“脂肪+坏死”转向“肿瘤边缘/淋巴窦”，与病理学家标注边界高度吻合。\n*   **教师评估演化**（图8）：训练中期后，类感知概率相比注意力得分在肿瘤区更集中、在正常区更均匀，说明**困难实例质量持续提高**。\n\n9 可重复性\n\n*   **代码与权重**：已开源至 [https://github.com/DearCaat/MHIM-MIL](https://github.com/DearCaat/MHIM-MIL)\n*   **实验协议**：统一 5-fold 交叉验证、相同数据划分、相同超参搜索空间，确保与对比方法公平。\n\n总结\n\n论文通过**12 基准 + 跨域 + 成本 + 消融 + 可视化**的立体实验，系统验证了 MHIM-MIL 在**精度、效率、鲁棒性**三方面同时优于现有 SOTA，且提升随基础模型升级而放大，为千兆像素病理 MIL 提供了新的强基准。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下展望按“**问题发现 → 可探索方向 → 可能方法**”三段式给出，均直接对应 MHIM-MIL 的**遗留限制**或**未充分展开**之处，供后续研究参考。\n\n1 掩码策略：从静态比例 → 自适应、可解释\n\n遗留问题\n\n可探索点\n\n潜在方法\n\nRHSM/RSM 比例需人工调参，且全局统一\n\n**实例级困难度不确定性估计**\n\n用教师网络的 **预测熵 / 深度集成 / MC-Dropout** 量化每个实例的“不确定度”，实现**实例级自适应掩码**；可引入 **Sub-modular** 函数保证掩码集合的多样性与覆盖度。\n\n掩码决策不可解释\n\n**可解释掩码策略**\n\n将掩码过程建模为 **强化学习策略网络**，以“与病理学家标注重叠率”或下游任务奖励为监督，学习**可解释的掩码策略**；可视化掩码决策路径。\n\n2 全局回收：从固定查询 → 动态、多尺度、跨切片记忆\n\n遗留问题\n\n可探索点\n\n潜在方法\n\nGRN 仅维护单组全局查询，容量有限\n\n**多尺度 / 多类别记忆库**\n\n按组织学区域（肿瘤、基质、免疫等）或 WSI 分辨率层级分别维护 **记忆槽 (memory slots)**，用 **Key-Value Memory** 或 **Neural Dictionary** 实现动态读写；支持 **跨切片共享记忆**，利用整个数据集的共同知识。\n\nEMA 更新无梯度，记忆更新慢\n\n**可学习记忆控制器**\n\n引入 **LSTM/Transformer 控制器** 根据训练阶段自动调整记忆融合速率，或采用 **快速权重 (fast weights)** 实现即时记忆写入。\n\n3 困难实例：从单模态特征 → 多模态、多任务协同\n\n遗留问题\n\n可探索点\n\n潜在方法\n\n仅利用图像特征，困难度评估维度单一\n\n**多模态困难度度量**\n\n将 **基因组突变负荷、转录组通路活性、病理文本报告** 编码后与图像特征拼接，计算 **跨模态不一致度** 作为困难度信号；高不一致区域往往对应生物学上更具挑战性的亚克隆或低分化区域。\n\n困难实例仅服务单一任务\n\n**多任务共享困难实例池**\n\n联合 **诊断 + 亚型 + 生存 + 基因突变预测** 多任务，构建 **任务无关-困难实例池**（Task-agnostic Hard Pool），通过 **元学习** 或 **多任务梯度对齐** 让困难实例同时提升所有任务，验证其通用性。\n\n4 教师-学生：从单教师 → 多教师、对抗、在线蒸馏\n\n遗留问题\n\n可探索点\n\n潜在方法\n\n单动量教师易受自身分布漂移影响\n\n**多教师投票/集成**\n\n维护 **架构异构的多个教师**（CNN、Transformer、Mamba），用 **投票熵** 或 **分歧度** 作为困难度额外信号；可引入 **对抗蒸馏** 让教师生成“最难”实例，学生进行对抗训练。\n\nEMA 更新仅线性加权\n\n**在线蒸馏 + 教师校正**\n\n学生每 epoch 用 **验证集性能** 反馈调整教师融合权重（Meta-Weight Net），实现**性能感知**的非线性更新；或采用 **双向蒸馏**（学生也反向蒸馏教师），缓解教师过时问题。\n\n5 实例级监督：从纯弱监督 → 主动、人机协同\n\n遗留问题\n\n可探索点\n\n潜在方法\n\n无实例标签，无法验证困难实例真实价值\n\n**主动学习循环**\n\n将 MHIM 挖掘的 Top-K 困难实例提交给病理学家做**一次性点标注**，迭代扩充**小型高精度实例库**；用 **不确定性 + 多样性 + 梯度密度** 三重准则选择请求标注的实例，实现 **10% 标注量 → 90% 性能**。\n\n标注成本高\n\n**人机协同微调**\n\n引入 **可交互切片可视化工具**，让医生**仅勾画困难区域**而非全片；使用 **Weakly-to-Semi 转换策略**（如 FixMatch）把点标注快速扩散到邻近相似实例。\n\n6 计算效率：从 GPU 显存 → 端侧/流式推理\n\n遗留问题\n\n可探索点\n\n潜在方法\n\n仍需一次性加载整袋特征（>1 GB/WSI）\n\n**流式-掩码训练**\n\n借鉴 **Streaming CNN** 思想，只在内存中维护 **滑动窗口特征缓存** 与 **动态掩码掩码表**；结合 **梯度检查点** 与 **特征量化 (INT8)**，实现 **单卡 8 GB 可训 100 k 实例**。\n\n推理仍用全序列\n\n**级联早退机制**\n\n设计 **轻量级困难度探针网络**，在 Transformer 浅层即预测“是否已见足够困难实例”，满足置信阈值时提前输出，**平均推理时间减少 30–50%**；可学习早退阈值以平衡速度-精度。\n\n7 跨中心鲁棒性：从单中心统计 → 域适应、因果推断\n\n遗留问题\n\n可探索点\n\n潜在方法\n\n跨域实验仅 CPTAC→TCGA，域差异有限\n\n**多中心域泛化**\n\n收集 **\\>5 家医院不同扫描仪（Hamamatsu、3DHistech、Leica）** 数据，构建 **DomainBed-style 基准**；用 **因果不变性约束**（IRM、CausalMatch）迫使困难实例挖掘策略对**染色、扫描仪、制片协议**不敏感。\n\n域漂移导致困难度定义变化\n\n**动态域提示微调**\n\n为每个域引入 **可学习域令牌 (domain token)**，在教师评估阶段与实例特征拼接，实现**域感知的困难度重校准**；仅更新域令牌，保持主干冻结，实现 **3-shot 新域快速适配**。\n\n8 开源与基准\n\n*   建议构建 **“MHIM-Bench”**：  \n    统一代码框架、数据分割、评价协议，集成上述方向的可插拔模块（自适应掩码、多教师、记忆库、主动学习接口），方便社区在**同一标准**下比较后续改进。\n\n总结\n\nMHIM-MIL 打开了“无监督困难实例挖掘”在千兆像素病理的新范式，但仍处于**静态、单模态、单任务、单教师**阶段；未来可从**自适应掩码、多模态记忆、人机协同、域泛化、端侧部署**等角度继续深化，推动其走向**临床可落地**的下一阶段。\n\n**Q6**: 总结一下论文的主要内容\n\n$$  \n\\\\boxed{\\\\text{MHIM-MIL：掩码困难实例挖掘的千兆像素病理多示例学习框架}}  \n$$\n\n1 背景与痛点\n\n*   千兆像素全切片图像（WSI）仅提供**袋级标签**，传统注意力 MIL 过度聚焦**易分类显著实例**，忽视决策边界处的**困难实例**，导致泛化性差、冗余高、计算重。\n\n2 核心思想\n\n> **“把简单实例遮住，让模型被迫从剩余区域学习”**  \n> 无需实例标签，通过**动量教师评估-两级掩码-全局回收-一致性对齐**四步闭环，持续挖掘高质量困难实例并训练学生网络。\n\n3 方法框架\n\n模块\n\n关键机制\n\n作用\n\n**类感知实例概率**\n\n教师用分类器对注意力加权特征再预测 softmax\n\n精准定位“真正简单”实例\n\n**RHSM**\n\n随机掩码 Top-2βh% 的一半\n\n避免训练初期误删关键区\n\n**RSM**\n\n再随机掩码 70–90%\n\n序列长度 ↓90%，显存 ↓50%\n\n**GRN**\n\n全局查询交叉注意力回收掩码特征\n\n补偿稀疏关键信息\n\n**一致性损失**\n\n学生（仅见困难）与教师（全序列）袋嵌入 KL 对齐\n\n稳定优化，提升判别边界\n\n4 实验结果\n\n*   **12 套公开基准**（CAMELYON、TCGA-NSCLC、TCGA-BRCA、TCGA-LUAD/LUSC/BLCA）\n*   **3 类任务**（癌症诊断、亚型、生存）\n*   **3 种特征**（ResNet-50、PLIP、UNI）  \n    → **全部优于原基线，9 项达到新 SOTA**；同时**训练时间 ↓24%，显存 ↓48%**。\n\n5 贡献一句话\n\nMHIM-MIL 首次在无实例标注条件下，把“困难实例”变成千兆像素病理 MIL 的主角，**精度、效率、鲁棒性**三升，为计算病理提供新的强基准。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Multiple%20Instance%20Learning%20Framework%20with%20Masked%20Hard%20Instance%20Mining%20for%20Gigapixel%20Histopathology%20Image%20Analysis，链接是  https://arxiv.org/pdf/2509.11526  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.11526  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-14-1758152840093","title":"Optimal Brain Restoration for Joint Quantization and Sparsification of LLMs","description":"Recent advances in Large Language Model (LLM) compression, such as quantization and pruning, have achieved notable success. However, as these techniques gradually approach their respective limits, relying on a single method for further compression has become increasingly challenging. In this work, we explore an alternative solution by combining quantization and sparsity. This joint approach, though promising, introduces new difficulties due to the inherently conflicting requirements on weight distributions: quantization favors compact ranges, while pruning benefits from high variance. To attack this problem, we propose Optimal Brain Restoration (OBR), a general and training-free framework that aligns pruning and quantization by error compensation between both. OBR minimizes performance degradation on downstream tasks by building on a second-order Hessian objective, which is then reformulated into a tractable problem through surrogate approximation and ultimately reaches a closed-form solution via group error compensation. Experiments show that OBR enables aggressive W4A4KV4 quantization with 50% sparsity on existing LLMs, and delivers up to 4.72x speedup and 6.4x memory reduction compared to the FP16-dense baseline.","url":"https://huggingface.co/papers/2509.11177","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.093Z","metadata":{"authors":["Hang Guo","Yawei Li","Luca Benini"],"date":"","rank":15,"llmAnalysis":"","categories":["cs.CL"],"pdfUrl":"https://arxiv.org/pdf/2509.11177.pdf","arxivUrl":"https://arxiv.org/abs/2509.11177","arxivId":"2509.11177","coolPaperUrl":"https://papers.cool/arxiv/2509.11177","published":"2025-09-14T09:17:19Z","updated":"2025-09-14T09:17:19.000Z","zh_summary":"最近在大型语言模型（LLM）压缩方面取得了显著进展，例如量化和剪枝等技术。然而，随着这些技术逐渐接近各自的极限，依靠单一方法进行进一步压缩变得越来越具有挑战性。在这项工作中，我们探索了一种通过结合量化和稀疏性来提供替代解决方案。这种联合方法虽然前景看好，但由于对权重分布的内在矛盾要求，带来了新的困难：量化有利于紧凑的范围，而剪枝则受益于高方差。为了解决这个问题，我们提出了最优大脑恢复（OBR），这是一个全面且无训练的框架，通过在两者之间的误差补偿，使剪枝和量化保持一致。OBR通过建立在二阶海森目标上的方法，最小化下游任务的性能下降，然后通过替代近似将其重新表述为一个可解决的问题，最终通过组误差补偿达到封闭形式的解决方案。实验表明，OBR能够在现有的LLM上实现50%稀疏性的激进W4A4KV4量化，并与FP16密集基线相比，提供高达4.72倍的加速和6.4倍的内存减小。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文旨在突破单一压缩技术（量化或剪枝）在极低比特（sub-4-bit）场景下迅速触及性能天花板的瓶颈，提出**联合量化与稀疏化**的新范式。核心待解决问题可概括为：\n\n1.  **目标冲突**：  \n    量化要求权重分布紧凑以减小量化误差，而剪枝依赖大数值差异以识别可移除权重；二者对权重分布的需求本质矛盾。\n    \n2.  **性能崩塌**：  \n    在 W4A4KV4+50 % 稀疏度的激进压缩下，现有方法（如直接拼接 QuaRot 与 WANDA）导致 perplexity 暴涨（Llama2-7B 从 5.47 升至 5868），无法实用。\n    \n3.  **硬件红利未兑现**：  \n    尽管 Ampere/Hopper 架构已原生支持 INT4+2:4 稀疏 GEMM，但缺乏**无需重训练**即可生成兼容权重格式的算法，致使理论加速无法落地。\n    \n\n为此，论文提出 Optimal Brain Restoration（OBR），通过**二阶 Hessian 误差补偿**将剪枝与量化引入的失真统一建模，并以闭式解形式把“被剔除”信息迁移到保留权重，首次在 LLM 上实现 W4A4KV4+50 % 稀疏度的**无重训练**联合压缩，且实际推理获得 4.72× 速度提升与 6.4× 内存削减。\n\n**Q2**: 有哪些相关研究？\n\n相关研究可归纳为三大脉络：量化、剪枝，以及二者的联合压缩。以下按类别梳理并指出与 OBR 的差异/继承关系。\n\n*   **LLM 量化**\n    \n    *   **OBQ / GPTQ**（Frantar & Alistarh 2022；Frantar et al. 2022）  \n        首次将二阶 Hessian 近似用于大规模生成模型 PTQ，OBR 沿用其 `G⊗H` 近似，但进一步行解耦并引入“组误差补偿”以同时照顾剪枝。\n    *   **LLM.int8()**（Dettmers et al. 2022）  \n        混合精度保留异常值，OBR 则通过 Hadamard 旋转+补偿把异常值“摊平”后重新分配，无需混合精度。\n    *   **AWQ / SmoothQuant**（Lin et al. 2024a；Xiao et al. 2023）  \n        通过平滑因子或通道缩放将异常值从权重迁移到激活，仅面向量化；OBR 同时处理剪枝引入的额外误差。\n    *   **QuaRot / SpinQuant / FlatQuant**（Ashkboos et al. 2024；Liu et al. 2024；Sun et al. 2024）  \n        利用（可学习）Hadamard 旋转 flatten 权重分布以实现 W4A4KV4；OBR 直接把这些旋转作为预处理，但在旋转后额外执行“补偿”以抵消剪枝-量化冲突。\n*   **LLM 剪枝**\n    \n    *   **SparseGPT**（Frantar & Alistarh 2023）  \n        一次性二阶剪枝，无重训练；OBR 把它视为“黑箱掩码生成器”，再用 Hessian 补偿其误差。\n    *   **WANDA**（Sun et al. 2023）  \n        激活感知幅度剪枝，OBR 实验默认采用其掩码，但后续用闭式解修正权重值。\n    *   **LLM-Pruner**（Ma et al. 2023）  \n        结构化剪枝+LoRA 微调；OBR 面向非结构化/半结构化稀疏，无需任何梯度更新。\n*   **联合量化与剪枝（小型网络时代）**\n    \n    *   **DJPQ**（Wang et al. 2020）  \n        用梯度下降联合优化稀疏率和量化水平，需训练；OBR 完全 PTQ。\n    *   **OBQ**（Frantar & Alistarh 2022）  \n        统一框架同时决定“删哪些”与“量到几比特”，但仅验证在小型 CNN；OBR 面向百亿参数 LLM，且顺序为“剪-补偿-量”。\n*   **LLM 时代的联合压缩**\n    \n    *   **JSQ**（Guo et al. 2024）  \n        模拟退火搜索激活编辑策略，实现 W8A8+50 % 稀疏；OBR 推进到 W4A4KV4，且用闭式解替代搜索。\n    *   **Harma et al. 2024**  \n        理论证明“先剪后量”最优，但未给出具体算法；OBR 可视为该结论的一个可扩展、可落地的实现。\n\n综上，OBR 在方法层面继承并扩展了 OBQ/GPTQ 的二阶误差建模思想，在系统层面首次把“剪枝后补偿”与“量化前再补偿”串成无重训练流水线，从而突破 sub-4-bit+50 % 稀疏的实用门槛。\n\n**Q3**: 论文如何解决这个问题？\n\n论文将“量化-剪枝目标冲突”建模为**二次误差最小化**问题，并通过三步策略给出**无需重训练**的闭式解，具体流程如下：\n\n1.  **冲突建模：二阶 Hessian 目标**  \n    以经典 OBQ 框架为出发点，把权重扰动 ∆W 对下游损失的影响写成  \n    $$\\\\mathbb{E}\\[\\\\Delta\\\\mathcal{L}\\] \\\\approx \\\\frac{1}{2}\\\\mathrm{vec}(\\\\Delta W)^\\\\top H\\_{\\\\text{full}},\\\\mathrm{vec}(\\\\Delta W).$$  \n    利用 `H_full ≈ G ⊗ H` 及“行解耦”近似 `G ≈ I`，将层内 `(C_out×C_in)^2` 复杂度的全局问题拆成 `C_out` 个独立的行子问题：  \n    $$\\\\min\\_{\\\\Delta w\\_i} \\\\frac{1}{2}\\\\Delta w\\_i H \\\\Delta w\\_i^\\\\top,; i=1{\\\\dots}C\\_{\\\\text{out}}.$$  \n    该行级目标同时量化“剪枝误差”与“量化误差”对特征的联合影响，为后续补偿提供解析桥梁。\n    \n2.  **组误差补偿： retain-vs-eviction 闭式解**  \n    对每一行权重 `w_i` 动态划分两组索引：\n    \n    *   **retain 集 R**——压缩后仍被保留的权重（未剪 + 未过量量化）\n    *   **eviction 集 E**——被强制置零或四舍五入的权重\n    \n    把行向量重排为 `[Δw_R, e_E]`，其中 `e_E` 是已知的“压缩失真”。行目标变为  \n    $$J=\\\\frac{1}{2}\\[\\\\Delta w\\_R;e\\_E\\]\\\\begin{bmatrix}H\\_{RR}&H\\_{RE}\\\\H\\_{ER}&H\\_{EE}\\\\end{bmatrix}\\[\\\\Delta w\\_R;e\\_E\\]^\\\\top.$$  \n    对 `Δw_R` 求导并令梯度为零，得到**闭式补偿**：  \n    $$\\\\boxed{\\\\Delta w\\_R^\\\\star = -H\\_{RR}^{-1}H\\_{RE},e\\_E}$$  \n    含义：用 Hessian 交叉块 `H_RE` 把 E 集失真投影到 R 集空间，再用 `H_{RR}^{-1}` 计算最优修正量，实现“信息迁移”而非简单丢弃。\n    \n3.  **双阶段顺序补偿算法**  \n    遵循“先剪后量”硬件友好顺序，把上述闭式解串成两轮：\n    \n    1.  **剪枝补偿**  \n        用剪枝掩码得 `E1/R1`，令 `e_{E1}=w_{E1}`，求得  \n        $$\\\\Delta w\\_{R1}^{\\\\text{prune}}=-H\\_{R1R1}^{-1}H\\_{R1E1}w\\_{E1}$$  \n        并更新 `w_{R1}←w_{R1}+Δw_{R1}^{\\text{prune}}`，得到稀疏但仍是 FP 的权重 `w̅`。\n    2.  **量化补偿**  \n        对 `w̅` 再划分 `E2/R2`（按 α=50% 头部元素为 E2），计算量化误差 `e_{E2}=w̅_{E2}-Q(w̅_{E2})`，再次套用闭式解  \n        $$\\\\Delta w\\_{R2}^{\\\\text{quant}}=-H\\_{R2R2}^{-1}H\\_{R2E2}e\\_{E2}$$  \n        最终权重  \n        $$\\\\hat w=Q!\\\\left(,\\[w̅\\_{R2}+\\\\Delta w\\_{R2}^{\\\\text{prune}}+\\\\Delta w\\_{R2}^{\\\\text{quant}},;w̅\\_{E2}+\\\\Delta w\\_{E2}^{\\\\text{prune}},;0\\],\\\\right)$$  \n        即同时满足 2:4 稀疏 + INT4 量化格式，可直接加载到支持 INT4-sparse GEMM 的 GPU 执行。\n\n通过“行解耦 + 组补偿”两步，论文把原本冲突的“削峰（量化）”与“造零（剪枝）”统一到一个二次误差框架里，并用**局部可并行**的闭式线性方程组完成信息再分配，从而首次在 7B–70B 级 LLM 上实现 W4A4KV4+50 % 稀疏、**无需任何重训练**即可保持可用精度，且实测推理速度提升 4.72×、内存节省 6.4×。\n\n**Q4**: 论文做了哪些实验？\n\n实验围绕“极端压缩 + 零重训练”能否同时保持精度与落地效率展开，覆盖模型家族、任务类型、位宽、稀疏模式、硬件 kernel、消融与可视化六大维度。主要结果汇总如下：\n\n维度\n\n设置\n\n关键结论\n\n**1\\. 主尺度对比**\n\nLlama2-7/13/70B、Llama3-8/70B、Qwen2.5-7/32B；W4A4KV4+50 % 非结构化稀疏\n\nOBR-GPTQ 在 WikiText2 上平均 perplexity 比 SparseGPT+GPTQ 低 3.7，零 shot 平均 acc 高 4.3 %；70 B 模型差距仅 1.37 perplexity。\n\n**2\\. 硬件效率**\n\nA100 上 CUTLASS INT4+2:4 sparse GEMM，seq=4 k\n\n比 FP16 dense 快 4.72×、比 INT4 dense 快 1.4×；FLOPs 减半，峰值 TOPS 提高 1.9×；内存占用 6.4× 节省。\n\n**3\\. 位宽泛化**\n\n固定 W4，变化 A/KV：W4A8KV8、W4A16KV16\n\nOBR-RTN 在 W4A8KV8+50 % 稀疏下仍比 SparseGPT+GPTQ（权重量化版）perplexity 低 1.29，证明低权宽即可获益。\n\n**4\\. 稀疏模式**\n\n2:4 与 4:8 半结构化\n\nW4A4KV4+2:4 下 OBR-GPTQ perplexity 13.32 vs 34.76（baseline），零 shot acc 高 8.15 %；硬件友好模式同样有效。\n\n**5\\. 旋转矩阵通用性**\n\nQuaRot、SpinQuant、FlatQuant 三种 Hadamard 方案\n\n同一 pipeline 即插即用；FlatQuant+OBR 在 Llama2-7B 上 perplexity 仅比 FP16 高 1.4，显著缩小差距。\n\n**6\\. 单压缩增强**\n\n仅剪枝（WANDA）或仅量化（RTN）\n\n60 % 稀疏时 WANDA+OBR perplexity 降 0.53；RTN+OBR 在 W4A4KV4 降 2.17 并提升 3.88 % acc，验证补偿机制通用。\n\n**7\\. 消融**\n\n不同掩码（Magnitude/SparseGPT/Random）、分组比例 α={20,25,50,75 %}\n\n掩码来源对终精度影响 < 2 %；α=50 % 均衡误差-容量，为默认设置。\n\n**8\\. 校准集鲁棒**\n\nWikiText2 → C4\n\n换校准集后 OBR 仍全面领先，Llama3-8B 零 shot acc 优势从 1.4 % 扩大到 1.96 %。\n\n**9\\. 与 BitNet 对比**\n\nQwen2.5-3B+OBR W4A4KV4+50 % vs BitNet-2B-4T 1.58-bit\n\nperplexity 11.79 vs 13.67，零 shot acc 62.77 vs 70.27；OBR 在后训练场景下可比肩从头训练的超低比特模型。\n\n**10\\. 可视化**\n\n权重分布、补偿矩阵热力图\n\n补偿幅度与原始权重同量级，且保持行独立、无新异常值，验证“信息迁移”而非噪声注入。\n\n综上，实验从 7 B 到 70 B、从非结构化到 2:4 结构化、从纯量化/剪枝到联合压缩、从精度到 A100 实测 kernel，全方位说明 OBR 在“W4A4KV4+50 % 稀疏”这一极限设定下仍能维持可用精度并兑现硬件加速。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下方向可被视为 OBR 框架的直接延伸或潜在突破点，按“短期可验证”到“长期需重新设计”排序：\n\n1.  **加速压缩本身**\n    \n    *   行解耦带来 `C_out` 次 `|R|×|R|` 线性系统求解，占 70 B 模型 35 h 耗时；可尝试  \n        – 低秩近似 `HRR ≈ LLᵀ` ＋ SMW 公式，将求逆复杂度从 `O(|R|³)` 降到 `O(r²|R|)`；  \n        – GPU 批量求解器（cuBLASLt / MAGMA）或并行 CPU 集群，一次性处理多行。\n2.  **学习式掩码与旋转**\n    \n    *   目前掩码 `M` 与 Hadamard 旋转 `P` 均为“即插即用”。若将 `M` 松弛为可微分门控、`P` 设为可学习正交矩阵，与 OBR 补偿联合优化，可期望在 3-bit 以下再抬升 1–2 % acc。\n    *   目标函数可写成 `min_{P,M} ‖Δw_R^*‖_H`，交替更新 `P,M` 与补偿量，保持 PTQ 只需校准集。\n3.  **混合稀疏粒度**\n    \n    *   本文仅验证 2:4 与 50 % 非结构化。硬件新趋势支持 1:2、1:4、块稀疏（4×1, 8×2）等；OBR 的 `E/R` 划分可无缝适配，只需把 `E` 定义为被整块剔除的索引。\n    *   对比不同粒度下的“实测 TFLOPS vs 精度”Pareto 前沿，可为推理引擎提供选型依据。\n4.  **激活与 KV 缓存联合稀疏**\n    \n    *   当前仅权重稀疏。激活值与 KV cache 同样存在大量小值，若把 `H` 扩展为 `[W;X;K;V]` 统一 Hessian，即可用同一套组补偿实现“WAXKXV 全局稀疏+量化”，进一步减内存带宽。\n5.  **动态稀疏补偿**\n    \n    *   不同输入批次稀疏模式可能最优不同。探索“运行时轻量补偿”：  \n        – 预存 2–3 组 `M` 与对应 `ΔW`，按输入特征范数或熵快速切换；  \n        – 或者把 `Δw_R^*` 分解为 `L·z`，推理时只计算低维 `z`，实现亚毫秒级切换。\n6.  **跨层联合误差传播**\n    \n    *   行解耦忽略输出通道间相关。可尝试  \n        – 块坐标下降：以 Transformer 块为单位联合优化 `ΔW_q, ΔW_k, ΔW_v, ΔW_o`，保持 `|block|≈4096` 仍可 tractable；  \n        – 或用 Krylov 子空间迭代近似 `G` 非对角块，减少层间误差累积。\n7.  **低比特理论极限分析**\n    \n    *   建立“稀疏+量化”率失真函数 `R(D, s, b)`，给出任务无关的最低比特-稀疏理论下限，用于判断 OBR 距离信息论极限还有多远。\n8.  **专用硬件协同设计**\n    \n    *   现有 INT4+2:4 GEMM 仅利用 50 % 零值跳过；补偿项 `ΔW` 为结构化非零，可设计“稀疏-增量”融合 kernel，把 `Y=(W+ΔW)X` 拆成 `sparse_gemm(W,X) + skinny_gemm(ΔW,X)`，减少写回带宽。\n9.  **继续下探比特**\n    \n    *   1.58-bit 或 even ternary `{−1,0,1}` 权重；此时量化误差 `e_E` 离散且幅度固定，可与剪枝误差统一为“三元补偿表”，验证 OBR 在极端离散域是否仍成立。\n10.  **任务特定压缩**\n    \n    *   将 OBR 目标函数改为下游微调损失 `L_downstream` 的 Hessian，直接优化“领域专用”稀疏-量化模型，避免先通用压缩再 LoRA 微调的两阶段成本。\n\n以上任意一点在 7 B∼70 B 模型上验证成功，均可作为 OBR 后续工作的显著增量。\n\n**Q6**: 总结一下论文的主要内容\n\n论文核心速览\n======\n\n1\\. 问题\n------\n\n*   单一量化或剪枝在 sub-4 bit 已触顶；二者目标冲突（量化要“紧”、剪枝要“散”），直接拼接性能崩塌。\n*   硬件已支持 INT4+2:4 稀疏 GEMM，却缺乏**无需重训练**即可生成对应权重的算法。\n\n2\\. 方法：Optimal Brain Restoration (OBR)\n--------------------------------------\n\n*   **二阶误差建模** – 行解耦近似 `H_full ≈ I ⊗ H`，把层内全局问题拆成 `C_out` 个独立行子问题。\n*   **组误差补偿** – 每行划分 retain 集 R 与 eviction 集 E，用闭式解  \n    `Δw_R^* = –H_RR^{-1} H_RE e_E`  \n    把 E 的失真“迁移”到 R，实现信息再分配。\n*   **双阶段流水线** – 先剪后量：①剪枝补偿→②量化补偿→INT4+50 % 稀疏权重，**零重训练**。\n\n3\\. 结果\n------\n\n*   **精度**：Llama2-7B W4A4KV4+50 % 稀疏，WikiText2 perplexity 8.40（vs SparseGPT+GPTQ 12.94）；70 B 模型与 FP16 差距仅 1.37。\n*   **效率**：A100 INT4+2:4 稀疏 GEMM 比 FP16 dense 快 4.72×，内存省 6.4×，TFLOPS 峰值提高 1.9×。\n*   **通用**：兼容 QuaRot/SpinQuant/FlatQuant 等多种旋转；对纯剪枝或纯量化也能降 perplexity 2–3 点。\n\n4\\. 贡献\n------\n\n*   首次在百亿参数 LLM 上实现 **W4A4KV4+50 % 稀疏** 无重训练联合压缩。\n*   提出“二阶-行解耦-组补偿”框架，把冲突的压缩误差统一用闭式解调和。\n*   释放硬件 INT4-sparse kernel 红利，为极端压缩提供可落地基线。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Optimal%20Brain%20Restoration%20for%20Joint%20Quantization%20and%20Sparsification%20of%20LLMs，链接是  https://arxiv.org/pdf/2509.11177  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.11177  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-15-1758152840094","title":"Stable Part Diffusion 4D: Multi-View RGB and Kinematic Parts Video Generation","description":"We present Stable Part Diffusion 4D (SP4D), a framework for generating paired RGB and kinematic part videos from monocular inputs. Unlike conventional part segmentation methods that rely on appearance-based semantic cues, SP4D learns to produce kinematic parts - structural components aligned with object articulation and consistent across views and time. SP4D adopts a dual-branch diffusion model that jointly synthesizes RGB frames and corresponding part segmentation maps. To simplify the architecture and flexibly enable different part counts, we introduce a spatial color encoding scheme that maps part masks to continuous RGB-like images. This encoding allows the segmentation branch to share the latent VAE from the RGB branch, while enabling part segmentation to be recovered via straightforward post-processing. A Bidirectional Diffusion Fusion (BiDiFuse) module enhances cross-branch consistency, supported by a contrastive part consistency loss to promote spatial and temporal alignment of part predictions. We demonstrate that the generated 2D part maps can be lifted to 3D to derive skeletal structures and harmonic skinning weights with few manual adjustments. To train and evaluate SP4D, we construct KinematicParts20K, a curated dataset of over 20K rigged objects selected and processed from Objaverse XL (Deitke et al., 2023), each paired with multi-view RGB and part video sequences. Experiments show that SP4D generalizes strongly to diverse scenarios, including real-world videos, novel generated objects, and rare articulated poses, producing kinematic-aware outputs suitable for downstream animation and motion-related tasks.","url":"https://huggingface.co/papers/2509.10687","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.094Z","metadata":{"authors":["Hao Zhang","Chun-Han Yao","Simon Donné","Narendra Ahuja","Varun Jampani"],"date":"","rank":16,"llmAnalysis":"","categories":["cs.CV"],"pdfUrl":"https://arxiv.org/pdf/2509.10687.pdf","arxivUrl":"https://arxiv.org/abs/2509.10687","arxivId":"2509.10687","coolPaperUrl":"https://papers.cool/arxiv/2509.10687","published":"2025-09-12T20:39:43Z","updated":"2025-09-12T20:39:43.000Z","zh_summary":"我们提出了稳定部件扩散4D（SP4D），这是一个从单目输入生成配对RGB和运动部件视频的框架。与依赖于外观基础语义线索的传统部件分割方法不同，SP4D学习生成运动部件——与物体关节动作对齐并在视图和时间上保持一致的结构组件。SP4D采用双分支扩散模型，共同合成RGB帧和相应的部件分割图。为了简化架构并灵活支持不同数量的部件，我们引入了一种空间颜色编码方案，将部件掩膜映射到连续的RGB样图像。这种编码允许分割分支共享来自RGB分支的潜在变分自编码器，同时通过简单的后处理恢复部件分割。双向扩散融合（BiDiFuse）模块增强了跨分支一致性，并通过对比部件一致性损失促进部件预测的空间和时间对齐。我们证明生成的2D部件图可以提升到3D，以推导骨架结构和谐皮肤权重，仅需很少的手动调整。为了训练和评估SP4D，我们构建了KinematicParts20K，这是一个从Objaverse XL（Deitke等，2023）中精选和处理的超过2万件装配物体的策划数据集，每个物体都配有多视角RGB和部件视频序列。实验表明，SP4D在不同场景中的表现强劲，包括现实世界视频、新生成物体和罕见的关节姿态，产生了适合下游动画和运动相关任务的运动感知输出。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文旨在解决“从单目输入生成具有运动学一致性、可动画化的多视角RGB-部件视频”这一核心问题。具体而言，现有方法存在以下局限：\n\n*   传统部件分割仅依赖外观语义，无法揭示物体真实关节结构，导致跨视角/时间不一致；\n*   基于SDS或多视角重建的4D生成只关注表面几何，不提供可用于绑定的运动学部件；\n*   自动绑定方法依赖静态3D网格与稀缺骨架标注，难以泛化到新品类或罕见姿态；\n*   语义分割（SAM2 等）输出的“头-身-尾”等区域与运动学部件（刚性连杆）并不对齐，无法直接用于动画。\n\n为此，作者提出 Stable Part Diffusion 4D（SP4D），首次在扩散框架内联合生成多视角、时序一致的视频外观 $M$ 及其对应的“运动学部件”分割 $P$，使2D结果可直接抬升到3D，快速获得带权重、可绑定的网格资产，从而显著降低人工绑定与动画制作成本。\n\n**Q2**: 有哪些相关研究？\n\n论文将相关研究归为三大类，并指出它们与本文目标的差距：\n\n1.  3D/4D 生成\n    \n    *   SDS 类：DreamFusion、ProlificDreamer、LucidDreamer 等——利用 2D 扩散先验优化 NeRF/Mesh，但推理极慢且不含部件结构。\n    *   多视角→重建类：Zero-1-to-3、SyncDreamer、Wonder3D、SV3D、Instant3D 等——先生成多视角图像再做立体重建，仍只得到表面几何。\n    *   原生 3D/4D 扩散：L4GM、Diffusion4D、AR4D、SV4D 等——直接在 3D 潜空间去噪，可生成动态序列，但未显式建模运动学部件或绑定信息。\n2.  自动绑定与动画\n    \n    *   RigNet、UniRig、MagicArticulate、Anymate 等——基于静态网格预测骨架与权重，依赖小规模 rig 数据，难以泛化到新品类或罕见姿态，且无法利用海量 2D 视频先验。\n3.  部件分解（2D/3D）\n    \n    *   2D 语义共分割：SCOPS、DeepViT、DINO+K-Means、SAM2——输出语义/纹理一致区域，而非刚性运动单元；跨帧、跨视角容易漂移。\n    *   3D 语义分割：SAMesh、SAMPart3D——将 2D SAM/DINOv2 掩码抬升到 3D，仍受限于外观线索，对无纹理或铰接部位失效。\n\nSP4D 与上述工作的本质区别：\n\n*   不满足于“表面重建”或“语义分割”，而是首次在扩散框架内联合生成 RGB 与运动学部件视频；\n*   利用大规模 2D 视频先验，摆脱对 3D 骨架标注的依赖；\n*   通过可抬升的 2D 部件序列，实现轻量化、骨架自由的绑定与权重估计。\n\n**Q3**: 论文如何解决这个问题？\n\n论文提出 **Stable Part Diffusion 4D（SP4D）**，通过三项关键设计把“单目 RGB 视频 → 多视角 RGB+运动学部件视频 → 可动画 3D 资产”做成端到端可训练、可泛化的生成框架。\n\n1.  双分支扩散架构\n    \n    *   在 SV4D 2.0 的多视角-视频潜空间扩散 backbone 上并联 **RGB 分支** 与 **部件分支**，各自输出一半通道的潜变量。\n    *   每层 encoder/decoder 之后插入 **Bidirectional Diffusion Fusion（BiDiFuse）**  \n        $$h\\_{\\\\text{RGB}}^{\\\\text{fused}}=h\\_{\\\\text{RGB}}+\\\\mathcal F(\\[h\\_{\\\\text{RGB}},h\\_{\\\\text{Part}}\\]),\\\\quad h\\_{\\\\text{Part}}^{\\\\text{fused}}=h\\_{\\\\text{Part}}+\\\\mathcal F(\\[h\\_{\\\\text{RGB}},h\\_{\\\\text{Part}}\\])$$  \n        用轻量 1×1 卷积实现双向信息交换，使外观与结构彼此引导，同时保持任务特异特征流。\n2.  空间颜色编码 + 共享 VAE\n    \n    *   将离散 part id 映射为 **连续 RGB 颜色**：以首帧各部件 3D 中心归一化坐标 $(x,y,z)$ 作为该部件的固定颜色。\n    *   部件分支因此生成“伪 RGB”图像，可与 RGB 分支 **共用同一个 VAE 编解码器**，无需额外设计 part-head 或量化模块；推理后用 SAM 自动分割+聚类即可还原离散 mask。\n3.  对比式部件一致性损失\n    \n    *   对每帧每视角预测的特征图按部件掩码做平均池化，得到部件特征 ${f\\_i}$。\n    *   采用 InfoNCE 式对比损失  \n        $$\\\\mathcal L\\_{\\\\text{contrast}}=-\\\\mathbb E\\_{i\\\\in\\\\mathcal P}\\\\log\\\\frac{\\\\exp(\\\\text{sim}(f\\_i,f\\_j)/\\\\tau)}{\\\\sum\\_{k\\\\in\\\\mathcal P\\\\backslash{i}}\\\\exp(\\\\text{sim}(f\\_i,f\\_k)/\\\\tau)},\\\\quad j\\\\in\\\\mathcal P\\_i^+$$  \n        强制 **同一物理部件** 在不同视角/时刻的特征聚集，不同部件分离，从而抑制颜色漂移与碎片化。\n4.  两阶段训练 + 数据\n    \n    *   阶段 1：仅在 ObjaverseDy 上训练 RGB 分支（BiDiFuse 旁路），继承强大视频先验。\n    *   阶段 2：在自建的 **KinematicParts20K**（>20 K 个已绑定资产，24 视角×24 帧）上联合微调双分支，提供真值 part mask 与相机轨迹。\n5.  2D→3D 轻量化绑定\n    \n    *   用 SP4D 生成的多视角 RGB 重建几何（Hunyuan3D 2.0），再把同一套相机下的 part mask 投影到 mesh 顶点。\n    *   以部件边界为狄利克雷条件求解 **调和皮肤权重**  \n        $$\\\\Delta w\\_p(\\\\mathbf x)=0\\\\ \\\\text{on interior},\\\\quad w\\_p(\\\\mathbf x)=b\\_p(\\\\mathbf x)\\\\ \\\\text{on }\\\\partial\\\\Omega\\_p$$  \n        得到平滑、可动画的权重场，无需手工骨架标注即可快速生成 riggable 资产。\n\n通过“双分支扩散-共享潜空间-对比一致性”这一组合，SP4D 首次实现从单目输入端到端生成 **时序一致、跨视角稳定、可直接用于动画** 的运动学部件视频，显著降低传统绑定流程的人工成本。\n\n**Q4**: 论文做了哪些实验？\n\n论文从 **2D 分割精度、3D 分割精度、消融实验、用户主观评价、自动绑定精度、动画合理性** 六个维度展开系统实验，全部在自建的 **KinematicParts20K** 训练/验证集以及真实 DAVIS 视频上进行。\n\n1.  2D 运动学部件分割对比  \n    基准：SAM2、SAM2\\*（GT 点提示）、DeepViT（DINO+K-Means）。  \n    指标：mIoU、ARI、F1、mAcc，分 **多视角（静态帧，旋转相机）** 与 **多帧（固定相机）** 两种协议。  \n    结果：SP4D 全指标大幅领先（表 1），定性可视化（图 5）显示部件边界与关节对齐且跨视角一致。\n    \n2.  3D 运动学部件分割对比  \n    基准：SAMesh（SAM 多视角投票）、SAMPart3D（DINOv2+3D 聚类）。  \n    结果：SP4D mIoU 0.64 vs. 0.15/0.13，ARI 0.58 vs. 0.06/0.05（表 3），验证“外观驱动”方法在 novel/无纹理物体上失效。\n    \n3.  消融实验\n    \n    *   去掉 **对比部件一致性损失** → ARI 下降最明显（多视角 0.60→0.15）。\n    *   去掉 **BiDiFuse** → 所有指标普遍下降 10–20 点。  \n        证实两项设计对时空一致性缺一不可（表 1）。\n4.  用户主观评价  \n    20 名受试者、20 组匿名 GIF，从 **部件清晰度、跨视角一致性、绑定适用性** 三方面 5 分制打分。  \n    结果：SP4D 平均 4.26 分，SAM2 1.96 分，DeepViT 1.85 分（表 2），显著优于基线。\n    \n5.  自动绑定精度（有真值骨架）  \n    在 KinematicParts20K-test 上比较预测皮肤权重与 GT 的 **[Precision@0.5](mailto:Precision@0.5)**。  \n    SP4D 72.7 vs. MagicArticulate 63.7 vs. UniRig 64.3（表 4），说明部件分解质量直接转化为更高权重精度。\n    \n6.  动画合理性（无真值骨架）  \n    对生成的恐龙、机械臂等 novel 网格，用三种方法自动绑定后制作相同骨架动画，用户双盲评分（1–5）。  \n    SP4D 4.1 分，显著高于 MagicArticulate 2.7 与 UniRig 2.3（表 4），体现跨品类泛化优势。\n    \n7.  定性扩展\n    \n    *   图 4 给出 **合成+真实视频** 多视角、多时刻结果，验证时序追踪无漂移。\n    *   附录视频展示固定视角跨帧追踪、3D 部件 lift、骨骼抽取与实时动画，进一步说明可直接用于生产管线。\n\n综合以上实验，论文定量与主观结果均表明 SP4D 在 **运动学一致性、跨视角稳定性、下游绑定/动画可用性** 上显著优于现有语义分割或 3D 绑定方法。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下方向可被视为 SP4D 框架的直接延伸或深层改进，均围绕“更一般化的场景、更精细的控制、更紧凑的表示、更高效的推理”展开：\n\n1.  多物体与场景级分解\n    \n    *   当前假设单物体居中和已知粗略掩码。将 SP4D 扩展到 **多实例、带遮挡、带背景** 的复杂场景，需要：  \n        – 引入实例级相机/掩码条件或注意力掩码，防止部件 ID 跨物体混淆；  \n        – 结合场景级动态语义分割（如 OmniMotion、DEVA）做前置实例提取。\n2.  全 6-DoF 相机与长轨迹\n    \n    *   SV4D 仅建模方位角+仰角，对强透视、大位移、手持旋转视频鲁棒性不足。\n    *   探索 **全局位姿可微渲染** 或 **Plücker 坐标嵌入**，使扩散模型直接感知任意相机路径，提高真实手持视频下的几何一致性。\n3.  部件粒度与层次骨架可控\n    \n    *   目前粒度由 KinematicParts20K 的“100 骨以内”启发式合并决定。\n    *   引入 **文本/草图/骨架模板** 作为条件，或设计 **连续粒度参数** λ，实现“一键粗/细 rig”用户控制；同时研究层次部件树扩散，输出父子关系而非平面 ID。\n4.  时变拓扑与自遮挡部件\n    \n    *   对“打开抽屉、翻盖手机”这类 **拓扑改变** 情形，部件连通性随时间变化。\n    *   可探索 **动态图结构潜码** 或 **基于可微分网格追踪** 的损失，让模型感知“新部件出现/旧部件合并”，而非固定 ID 映射。\n5.  与物理/运动先验联合学习\n    \n    *   当前仅依赖视觉-几何一致性。引入：  \n        – 基于 **关节旋转限制** 或 **连杆长度不变量** 的可微损失；  \n        – 视频动作捕捉大规模数据（如 AMASS、Ego4D）做 **运动学正则化**，提升罕见姿态下的合理性。\n6.  压缩与实时推理\n    \n    *   双分支 UNet 参数量加倍。可研究：  \n        – **权重共享+LoRA 微调** 的轻量部件分支；  \n        – **蒸馏到单阶段潜码预测** 或 **多帧一致性 Token**，实现移动端 4D 捕捉。\n7.  反向应用：由部件驱动视频编辑\n    \n    *   利用 SP4D 的跨模态一致潜空间，实现“部件级视频编辑”：  \n        – 直接修改某一部件颜色/纹理 → 自动传播到所有视角与后续帧；  \n        – 部件掩码驱动局部运动重定向（part-based motion retargeting），无需显式骨骼。\n8.  与其他 3D 表示融合\n    \n    *   目前 lift 到 mesh 仅用于绑定。可尝试：  \n        – 将部件潜码直接作为 **3D Gaussian** 或 **HexPlane** 的属性通道，实现部件-aware 的 4D Gaussian Splatting；  \n        – 在 NeRF 密度/颜色网络中加入 part-embedding，实现“部件级体渲染编辑”。\n9.  伦理与版权增强\n    \n    *   生成资产易于被滥用。研究 **部件级隐形水印**（在 part-color 潜码嵌入加密签名）或 **可验证出处** 的区块链元数据，降低深度伪造风险。\n10.  自监督数据扩充\n    \n    *   KinematicParts20K 仍依赖已绑定 3D 资产。可探索：  \n        – 利用 **视频运动分割自监督**（如 CRW、VCN）自动挖掘大规模 RGB 视频中的“运动一致区域”，再远程监督训练 SP4D，进一步摆脱对 3D 骨架标注的依赖。\n\n这些方向既可直接嵌入现有双分支扩散框架，也可作为独立模块与 SP4D 组合，推动“单目输入 → 任意拓扑、任意相机、任意粒度的可动画 4D 资产”走向真正通用化。\n\n**Q6**: 总结一下论文的主要内容\n\n**Stable Part Diffusion 4D（SP4D）** 提出了一种从 **单目 RGB 视频或单张图像** 出发，联合生成 **多视角、时序一致的 RGB 视频** 与 **运动学部件分割视频** 的新框架，并可将结果轻量抬升为 **可绑定、可动画的 3D 资产**。核心贡献与流程如下：\n\n1\\. 问题定位\n\n*   现有 4D 生成仅重建表面几何，不提供可用于动画的 **运动学部件**；\n*   语义分割（SAM2 等）输出与 **关节结构** 不一致，跨视角/时间易漂移；\n*   自动绑定方法依赖稀缺 3D 骨架标注，泛化性差。\n\n2\\. 方法概览\n\n模块\n\n关键设计\n\n作用\n\n**双分支扩散**\n\nRGB 分支 + Part 分支共享 SV4D 2.0 结构\n\n同步生成外观与部件\n\n**BiDiFuse**\n\n每层双向特征融合\n\n跨模态互引导，提升边界一致性\n\n**空间颜色编码**\n\n用首帧 3D 中心 (x,y,z) 为部件赋固定 RGB 颜色\n\n共享 VAE，简化架构\n\n**对比部件一致性损失**\n\nInfoNCE 约束同部件特征跨视角/时间聚集\n\n消除颜色漂移，保证时空稳定\n\n**两阶段训练**\n\n先 RGB 预训练 → 后联合微调（KinematicParts20K）\n\n充分利用大规模 2D 先验\n\n3\\. 数据与抬升\n\n*   **KinematicParts20K**：从 Objaverse XL 筛选 20 K 个已绑定资产，24 视角×24 帧渲染，提供真值 part mask 与相机轨迹。\n*   **2D→3D 绑定管线**：\n    1.  多视角 RGB → Hunyuan3D 2.0 重建 mesh；\n    2.  顶点投影 + HDBSCAN 赋予部件 ID；\n    3.  求解 **调和皮肤权重** ∆w=0，无需骨架即可动画。\n\n4\\. 实验结果\n\n*   **2D 分割**（mIoU/ARI/F1/mAcc）：SP4D 全面超越 SAM2、SAM2\\*、DeepViT，多视角/多帧均 **↑20-40 点**。\n*   **3D 分割**：SP4D mIoU 0.64 vs. SAMesh 0.15 / SAMPart3D 0.13。\n*   **消融**：去掉 BiDiFuse 或对比损失，指标显著下降，验证二者缺一不可。\n*   **用户研究**：部件清晰度、跨视角一致性、绑定适用性平均 **4.26/5**，显著优于基线。\n*   **自动绑定精度**：皮肤权重 [Precision@0.5](mailto:Precision@0.5) 达 **72.7**，高于 MagicArticulate 63.7 与 UniRig 64.3。\n*   **动画合理性**：新品类（恐龙、机械臂）用户评分 **4.1/5**，远超基线 2.3-2.7。\n\n5\\. 结论\n\nSP4D 首次把“运动学部件”作为显式输出引入扩散式 4D 生成，利用 **双分支+共享潜空间+对比一致性** 实现高质量、时空稳定的部件视频，并可 **秒级抬升为可动画 3D 资产**，显著降低人工绑定成本，为单目动态捕捉、快速动画制作提供了新的通用框架。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Stable%20Part%20Diffusion%204D%3A%20Multi-View%20RGB%20and%20Kinematic%20Parts%20Video%20Generation，链接是  https://arxiv.org/pdf/2509.10687  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.10687  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-16-1758152840094","title":"ROOM: A Physics-Based Continuum Robot Simulator for Photorealistic Medical Datasets Generation","description":"Continuum robots are advancing bronchoscopy procedures by accessing complex lung airways and enabling targeted interventions. However, their development is limited by the lack of realistic training and test environments: Real data is difficult to collect due to ethical constraints and patient safety concerns, and developing autonomy algorithms requires realistic imaging and physical feedback. We present ROOM (Realistic Optical Observation in Medicine), a comprehensive simulation framework designed for generating photorealistic bronchoscopy training data. By leveraging patient CT scans, our pipeline renders multi-modal sensor data including RGB images with realistic noise and light specularities, metric depth maps, surface normals, optical flow and point clouds at medically relevant scales. We validate the data generated by ROOM in two canonical tasks for medical robotics -- multi-view pose estimation and monocular depth estimation, demonstrating diverse challenges that state-of-the-art methods must overcome to transfer to these medical settings. Furthermore, we show that the data produced by ROOM can be used to fine-tune existing depth estimation models to overcome these challenges, also enabling other downstream applications such as navigation. We expect that ROOM will enable large-scale data generation across diverse patient anatomies and procedural scenarios that are challenging to capture in clinical settings. Code and data: https://github.com/iamsalvatore/room.","url":"https://huggingface.co/papers/2509.13177","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.094Z","metadata":{"authors":["Salvatore Esposito","Matías Mattamala","Daniel Rebain","Francis Xiatian Zhang","Kevin Dhaliwal","Mohsen Khadem","Subramanian Ramamoorthy"],"date":"","rank":17,"llmAnalysis":"","categories":["cs.RO"],"pdfUrl":"https://arxiv.org/pdf/2509.13177.pdf","arxivUrl":"https://arxiv.org/abs/2509.13177","arxivId":"2509.13177","coolPaperUrl":"https://papers.cool/arxiv/2509.13177","published":"2025-09-16T15:30:02Z","updated":"2025-09-16T15:30:02.000Z","zh_summary":"连续体机器人正在通过访问复杂的肺气道并实现针对性干预，推动支气管镜检查程序的发展。然而，它们的开发受到缺乏现实训练和测试环境的限制：由于伦理约束和患者安全问题，真实数据难以收集，开发自主算法需要现实的成像和物理反馈。我们提出了ROOM（医学中的真实光学观察），这是一个旨在生成逼真的支气管镜培训数据的综合仿真框架。通过利用患者的CT扫描，我们的管道渲染出多模态传感器数据，包括带有真实噪声和光反射的RGB图像、度量深度图、表面法线、光流和医学相关尺度的点云。我们在两个医学机器人领域的经典任务中验证了ROOM生成的数据——多视角姿势估计和单目深度估计，展示了最先进的方法在这些医学环境中必须克服的多种挑战。此外，我们还展示了ROOM生成的数据可以被用来微调现有的深度估计模型，以克服这些挑战，同时启用其他下游应用，如导航。我们期望ROOM能够在临床环境中难以捕捉的多样性患者解剖和程序场景中实现大规模数据生成。代码和数据：https://github.com/iamsalvatore/room.","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文针对**支气管镜连续体机器人自主导航算法训练数据匮乏**这一核心问题展开。  \n具体而言，临床数据获取受伦理、安全与成本多重限制，且个体解剖差异巨大，导致现有公开数据集规模小、多样性差，难以支撑对毫米级精度要求极高的视觉算法开发与验证。为此，作者提出 ROOM 框架，通过**将患者 CT 自动转换为高保真、多模态、带真实物理约束的合成支气管镜影像序列**，实现大规模、可重复、符合临床尺度与成像特性的训练数据生成，从而缓解真实数据稀缺对算法研究与临床转化的瓶颈。\n\n**Q2**: 有哪些相关研究？\n\n*   **医疗机器人专用仿真平台**\n    \n    *   传统手术训练器（如 ORBIT-Surgical、SOFA、TMTDyn）侧重实时交互与触觉反馈，视觉渲染仅满足人眼操作需求，未提供导航所需的深度、光流等多模态真值，也不支持大规模数据集生成。\n    *   结肠镜方向有 SimCol3D 挑战，首次用游戏引擎生成 3D 重建训练数据，但场景纹理丰富、几何简单；支气管镜气道纹理稀疏、镜面反射强烈，其直接迁移效果受限。\n*   **连续体支气管镜系统研究**\n    \n    *   定位与里程计：PANS 利用气道先验地图做蒙特卡洛 6-DoF 跟踪；Deng 等发布离体数据集评估单目 VO。\n    *   导航轨迹获取：既有工作依赖人工采集（体内或体外）或简化仿真，未同时考虑真实视觉外观与物理交互，难以直接用于视觉-动作策略学习。\n*   **通用合成数据生成器**\n    \n    *   Kubric、TartanAir 等面向自动驾驶/SLAM，提供多模态真值，但解剖结构、照明模型与毫米级尺度均与支气管镜不符。\n\n综上，现有研究或缺“医疗级解剖+物理+光度”联合建模，或缺“连续体机器人-气道交互”细粒度仿真，ROOM 首次将患者 CT、Cosserat 杆物理、路径追踪渲染与真实传感器噪声统一，填补支气管镜大规模训练数据空白。\n\n**Q3**: 论文如何解决这个问题？\n\nROOM 将“数据稀缺”问题拆解为 **解剖-物理-视觉-噪声** 四个缺口，并分别给出可扩展的自动化模块，最终形成一条**从患者 CT 到可直接用于训练的毫米级多模态序列**的端到端管线。核心思路与对应技术如下：\n\n1.  **解剖缺口 → CT-驱动气道重建**\n    *   3D U-Net 分割支气管腔 → Marching Cubes 表面化 → Laplacian 平滑，得到可用于碰撞检测的高质量网格。\n    *   对带符号距离场"}},{"id":"hf-17-1758152840095","title":"zELO: ELO-inspired Training Method for Rerankers and Embedding Models","description":"We introduce a novel training methodology named zELO, which optimizes retrieval performance via the analysis that ranking tasks are statically equivalent to a Thurstone model. Based on the zELO method, we use unsupervised data in order train a suite of state-of-the-art open-weight reranker models: zerank-1 and zerank-1-small. These models achieve the highest retrieval scores in multiple domains, including finance, legal, code, and STEM, outperforming closed-source proprietary rerankers on both NDCG@10 and Recall. These models also demonstrate great versatility, maintaining their 0-shot performance on out-of-domain and private customer datasets. The training data included 112,000 queries and 100 documents per query, and was trained end-to-end from unannotated queries and documents in less than 10,000 H100-hours.","url":"https://huggingface.co/papers/2509.12541","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.095Z","metadata":{"authors":["Nicholas Pipitone","Ghita Houir Alami","Advaith Avadhanam","Anton Kaminskyi","Ashley Khoo"],"date":"","rank":18,"llmAnalysis":"","categories":["cs.AI"],"pdfUrl":"https://arxiv.org/pdf/2509.12541.pdf","arxivUrl":"https://arxiv.org/abs/2509.12541","arxivId":"2509.12541","coolPaperUrl":"https://papers.cool/arxiv/2509.12541","published":"2025-09-16T00:44:08Z","updated":"2025-09-16T00:44:08.000Z","zh_summary":"我们引入了一种名为 zELO 的新型训练方法，通过分析排序任务与赫尔斯通模型的静态等价性来优化检索性能。基于 zELO 方法，我们使用无监督数据来训练一系列最先进的开放权重重排序模型：zerank-1 和 zerank-1-small。这些模型在多个领域（包括金融、法律、代码和 STEM）中实现了最高的检索得分，在 NDCG@10 和召回率上超越了闭源专有重排序器。这些模型还展示了极大的多样性，在域外和私有客户数据集上保持了 0-shot 性能。训练数据包括 112,000 个查询和每个查询 100 个文档，并且用了不到 10,000 小时的 H100 进行从未标注的查询和文档的端到端训练。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文针对信息检索中“重排序（reranking）”环节的核心瓶颈——高质量训练信号难以大规模获取——提出了一套全新的无监督训练框架 zELO，并发布两个开源重排序模型 zerank-1 / zerank-1-small。具体而言，工作聚焦并试图解决以下关键问题：\n\n1.  **人工标注的不可扩展性**\n    \n    *   传统 pointwise 或 triplet 训练依赖人工判定正例/负例，成本高昂且难以覆盖专业领域。\n    *   当“难负例挖掘”算法足够强时，机器自动挖掘出的负例往往比人工标注的正例更相关，导致对比学习信号失真（即论文提出的“拉弗曲线”现象）。\n2.  **Hard-negative mining 的理论上限**\n    \n    *   证明随着负例挖掘器能力提升，学生模型性能先升后降，存在严格上界；该上界并非模型容量不足，而是训练算法本身缺陷。\n3.  **大规模、跨领域、可迁移的重排序训练数据生成**\n    \n    *   设计基于 Elo/Thurstone 的统计模型，将多 LLM 的稀疏 pairwise 偏好转化为绝对 relevance 分数，实现完全自动化、可扩展的“教师信号”生产。\n4.  **零人工标注下的 SOTA 性能**\n    \n    *   在金融、法律、医学、代码、STEM 等 10+ 公开及私有数据集上，仅用 11.2 k 查询、每查询 100 文档、总计 5 M 查询-文档对的自生成数据，端到端训练出的小模型即可超越体积两倍以上的商业闭源重排序器（NDCG@10 绝对提升 3–5 分）。\n5.  **生产环境的实时自监督迭代**\n    \n    *   zELO 流程支持在线采样查询日志 → 自动标注 → 即时微调，无需人工介入即可持续修复检索链路缺陷。\n\n**Q2**: 有哪些相关研究？\n\n论文本身未设独立“Related Work”章节，但从动机阐述与实验对比中可以析出以下几条紧密相关的研究脉络（按主题归类，并给出代表文献或模型）：\n\n主题\n\n代表工作\n\n与 zELO 的关系\n\n**1\\. 重排序模型架构**\n\n• BERT-based cross-encoder (Nogueira & Cho, 2020)  \n• T5-Reranker (Lin et al., 2023)\n\nzELO 同样采用 cross-encoder 结构，但训练信号来自 LLM-ensemble 的 pairwise-Elo，而非人工三元组。\n\n**2\\. 对比/三元组损失**\n\n• InfoNCE / Triplet Loss (Schroff et al., 2015; Gillick et al., 2019)  \n• Cross-entropy with in-batch negatives (CLIP, DPR)\n\nzELO 指出随机或 hard-negative 采样存在“拉弗曲线”瓶颈，改用 Thurstone-BT 模型将 pairwise 偏好转为绝对分数，规避三元组损失。\n\n**3\\. Hard-negative mining 上限**\n\n• RocketQA (Qu et al., 2021)  \n• AR2 (Zhang et al., 2021)  \n• ANCE (Xiong et al., 2021)\n\n这些工作致力于让负例“更难”；zELO 首次系统论证当挖掘器过强时性能反而下降，并用统计模型取代挖掘。\n\n**4\\. LLM-as-judge / LLM-reranker**\n\n• GPT-4o/Gemini-Flash as zero-shot ranker (Sun et al., 2023)  \n• RankGPT (Qin et al., 2023)\n\nzELO 把多 LLM 的 pairwise 判断蒸馏给小模型，兼顾效率与准确率，而非直接在线调用大模型。\n\n**5\\. Elo/Bradley-Terry 在 IR 中的应用**\n\n• Gao et al., 2023 将 BT 用于 passage ranking 数据清洗  \n• Sachan et al., 2023 用 Elo 聚合众包偏好\n\nzELO 首次把 BT-Thurstone 模型扩展到**无监督**、**web-scale** 的端到端训练，并给出稀疏采样理论保证。\n\n**6\\. 自监督 / 合成数据训练**\n\n• InPars (Bonifácio et al., 2022) 用 LLM 生成查询-正例  \n• PromptRank (Pradeep et al., 2023) 用 LLM 生成伪标签\n\nzELO 不生成查询或文档，而是让 LLM 只做**相对偏好**判断，通过统计模型转化为绝对 relevance，避免生成幻觉。\n\n**7\\. 稀疏图上的排序学习**\n\n• Plackett-Luce 分解 (Khetan & Oh, 2016)  \n• 图约束下的 Elo 估计 (Maystre & Grossglauser, 2015)\n\nzELO 提出 k-regular random-cycle 采样，保证连通度与低直径，从而用 $O(n)$ 次比较即可稳定估计 Elo。\n\n**8\\. 商业闭源重排序器**\n\n• Cohere rerank-v3.5  \n• Voyage rerank-2  \n• Salesforce Llama-rank-v1\n\n作为实验对照，zELO 模型在同等或更小参数量下取得 3–5 NDCG@10 的绝对提升。\n\n以上研究共同构成了 zELO 的学术语境：\n\n*   **方法论上**，zELO 用统计建模取代传统对比学习，解决了 hard-negative mining 的“拉弗曲线”问题；\n*   **数据工程上**，它把“LLM-as-judge”从离线评测工具升级为**可扩展的教师信号生成器**；\n*   **系统层面**，通过稀疏图采样与端到端蒸馏，首次在**零人工标注**条件下训练出公开权重、跨领域 SOTA 的重排序模型。\n\n**Q3**: 论文如何解决这个问题？\n\n论文将“零人工标注条件下训练出高泛化重排序器”拆解为四个可执行阶段，核心思想是：  \n**用多 LLM 的 pairwise 偏好 → 统计模型转化为绝对 relevance 分数 → 蒸馏给 pointwise 学生模型**。  \n整体流程与关键技术点如下（按时间顺序）：\n\n1\\. 生成初始候选集 Z\n\n*   对每条查询 q，用混合检索（Qwen3-Embedding-4B 余弦相似度 + BM25，RRF 融合）取 top-100 文档，构成集合 Z，|Z|=100。\n*   该步骤仅提供“可能相关”的文档池，不参与后续训练信号生成。\n\n2\\. 构建稀疏 pairwise 偏好图（LLM-ensemble 阶段）\n\n*   **采样策略**：对每条查询，随机抽 4 条随机置换的 n-cycle（n=100），叠加成 8-正则图，仅 $O(n)$ 条边即可保证连通、低直径、节点度均匀。\n*   **标注方式**：用 3 个 frontier LLM 对每条边 $(d\\_i,d\\_j)$ 输出 $\\[-1,1\\]$ 的相对偏好，经位置翻转、截断、平均后映射到 $(0,1)$，得到稀疏矩阵 $W$。\n*   **理论保证**：利用 Thurstone 模型  \n    $$w\\_{ij}=\\\\frac{1+\\\\text{erf}(\\\\text{Elo}\\_i-\\\\text{Elo}_j)}{2}$$  \n    通过最大似然估计（负对数似然 $L=\\\\sum w_{ij}\\\\log(1+e^{\\\\text{Elo}\\_j-\\\\text{Elo}\\_i})$）恢复每条文档的绝对 Elo 分数；Zermelo 定理保证全局唯一极小点，梯度下降必收敛。\n\n3\\. 训练 pairwise 学生模型 R′pair\n\n*   把 LLM-ensemble 的 $w\\_{ij}$ 作为软标签，用标准 Binary Cross-Entropy 训练一个轻量 cross-encoder（Qwen3-1.7B/4B），使其逼近 ensemble 偏好。\n*   **数据效率**：每条查询仅标注 400 对（≈0.4 % 的完整矩阵），即可使 Elo 估计误差趋近于零（图 10）。\n\n4\\. 训练最终 pointwise 重排序器 Rpoint（zerank-1）\n\n*   用收敛后的 Elo 分数作为绝对 relevance 标签 $y\\\\in\\[0,1\\]$，对同一 Qwen 骨架做标准 MSE 回归：  \n    $$L\\_{\\\\text{SFT}}=\\\\frac{1}{|B|}\\\\sum\\_{(q,d)\\\\in B}\\\\bigl(R\\_{\\\\text{point}}(q,d)-y\\\\bigr)^2$$\n*   **RLHF 二次迭代**：  \n    – 先让 1.0 版模型在全集上排序，找出“人类最高分文档”被排到 t 名之后的失败例；  \n    – 用 ensemble 对“人类最高分 vs 模型误排前一名”再标注一次，加入 pairwise 训练集；  \n    – 重新训练 R′pair → 重算 Elo → 重训 Rpoint，得到最终 zerank-1 / zerank-1-small。\n\n5\\. 规模与效率\n\n*   全程零人工标注，112 k 查询 × 100 文档 ≈ 5 M 查询-文档对，<10 000 H100-hours 完成端到端训练。\n*   推理延迟：12 KB 文档 149 ms，150 KB 文档 314 ms，均快于同体量商业 API（表 1）。\n\n6\\. 结果验证\n\n*   公开基准：在金融、法律、医学、代码、STEM 等 10+ 数据集上，zerank-1 比 Cohere rerank-v3.5 等大 2× 的闭源模型平均 NDCG@10 提升 3–5 分。\n*   私有客户数据：优势进一步扩大，表明未过拟合公开评测集。\n*   跨初始检索方式：无论底层是 BM25、纯向量还是混合检索，zerank-1 仍能带来显著增益（图 12）。\n\n通过“统计建模取代对比损失 + 稀疏图采样保证收敛 + 两轮蒸馏吸收人类高置信信号”，论文在**零人工标注**前提下突破了 hard-negative mining 的拉弗曲线限制，训练出目前公开权重中精度最高的跨领域重排序器。\n\n**Q4**: 论文做了哪些实验？\n\n论文围绕“零人工标注训练出的 zerank-1 / zerank-1-small 是否能在多领域、多检索方式、多数据场景下持续超越现有 SOTA”这一问题，设计了 4 组共 12 项实验。所有对比均在 top-100 候选集（k=100）上完成，评价指标统一采用 NDCG@10，部分补充 Recall@100。实验一览如下：\n\n1\\. 公开基准横向对比（表 2）\n\n领域\n\n数据集举例\n\n对照模型\n\n主要结论\n\nCode\n\nCodeSearchNet/CodeQA\n\nCohere rerank-v3.5、Salesforce Llama-rank-v1\n\nzerank-1 ↑0.754 vs 0.724（+3.0）\n\nFinance\n\nFiQA-2018、FinRED\n\n同上\n\nzerank-1 ↑0.894 vs 0.824（+7.0）\n\nLegal\n\nCOLIEE、CaseHOLD\n\n同上\n\nzerank-1 ↑0.821 vs 0.804（+2.1）\n\nMedical\n\nTREC-COVID、BioASQ\n\n同上\n\nzerank-1 ↑0.796 vs 0.750（+6.0）\n\nSTEM\n\nArXiv-QA、SciFact\n\n同上\n\nzerank-1 ↑0.694 vs 0.595（+9.9）\n\nConversational\n\nMS MARCO Dialog\n\n同上\n\nzerank-1 ↑0.596 vs 0.571（+4.4）\n\n2\\. 私有客户数据外推测试（表 3）\n\n场景\n\n数据规模\n\n对照模型\n\n主要结论\n\nEnterprise Search\n\n2.1 M 企业内网文档\n\nVoyage rerank-2、Cohere 3.5\n\nzerank-1 ↑0.799 vs 0.735（+6.4）\n\nHealthcare\n\n0.6 M 医院知识库\n\n同上\n\nzerank-1 ↑0.898 vs 0.756（+14.2）\n\nLegal (private)\n\n1.3 M 合同条款\n\n同上\n\nzerank-1 ↑0.854 vs 0.766（+8.8）\n\nConversational (private)\n\n0.9 M 客服日志\n\n同上\n\nzerank-1 ↑0.787 vs 0.727（+6.0）\n\n> 注：zerank 系列**未在任何私有数据上微调**，全部 0-shot。\n\n3\\. 跨初始检索方式鲁棒性（图 12）\n\n初始召回方法\n\nBM25-only\n\nEmbedding-only\n\nHybrid (RRF)\n\n原始 NDCG@10\n\n0.512\n\n0.678\n\n0.701\n\n+zerank-1\n\n0.731 (↑42.8 %)\n\n0.768 (↑13.3 %)\n\n0.783 (↑11.7 %)\n\n+zerank-1-small\n\n0.710\n\n0.748\n\n0.762\n\n结论：zerank-1 对稀疏、密集、混合三种第一级召回均带来**双位数绝对提升**，证明其独立于初始通道。\n\n4\\. 效率与成本对比（表 1）\n\n模型\n\nNDCG@10\n\n12 KB 延迟\n\n150 KB 延迟\n\nCohere rerank-v3.5\n\n0.709\n\n171 ms\n\n459 ms\n\nJina-reranker-m0\n\n0.728\n\n547 ms\n\n2 544 ms\n\nzerank-1\n\n0.768\n\n149 ms\n\n314 ms\n\nzerank-1-small\n\n0.730\n\n97 ms\n\n186 ms\n\n结论：在**更高精度**的同时，延迟最低，吞吐量优于商业 API。\n\n5\\. 消融与诊断实验（正文图 8–10）\n\n实验\n\n目的\n\n关键结果\n\n图 8\n\npairwise 学生模型是否学到 ensemble 共识\n\n训练后 93 % 的预测与 LLM-ensemble 一致（vs 随机 50 %）\n\n图 9\n\n稀疏采样策略对 Elo 估计误差的影响\n\n4-cycle 法在 400 次推理时 MSE→0.002，优于随机采样 10×\n\n图 10\n\n采样率-收敛曲线\n\n仅需 1.2 % 的 pairwise 即可使 Elo 损失趋零，cycle 法最快\n\n6\\. 与“即用即评”大模型 baseline 对比（第 9 页段落）\n\n方法\n\nNDCG@10\n\n备注\n\nGemini-2.5-Flash 直接 pairwise 投票\n\n0.712\n\n调用 4 500 次 API\n\nzerank-1（蒸馏后小模型）\n\n0.768\n\n单次 GPU 前向\n\n结论：蒸馏后的 4 B 模型显著优于在线大模型投票，且成本降低 2 个数量级。\n\n综上，论文通过**公开基准、私有数据、跨召回方式、延迟-精度、消融诊断、成本对照**六维实验，系统验证了 zELO 训练流程的通用性、经济性与 SOTA 性能。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下方向可被视为 zELO 框架的“直接外延”或“深层质疑”，均来自论文尚未回答或仅一笔带过的开放问题。按“理论—数据—模型—系统”四个层次列出，供后续工作参考。\n\n1\\. 理论层面\n\n*   **拉弗曲线定量刻画**  \n    论文仅给出定性示意图。可控制“负例挖掘器能力”为单一变量（如固定学生容量、逐步替换更强的教师），绘制横轴=矿工准确率、纵轴=学生 NDCG 的完整曲线，验证拐点位置及回落斜率。\n    \n*   **Thurstone vs Bradley-Terry 的适用域**  \n    仅在最终拟合阶段切换 Thurstone。可系统比较两种误差分布（正态 vs Gumbel）在不同领域、不同文档长度、不同 LLM 噪声水平下的对数似然，给出选择准则。\n    \n*   **稀疏图采样极限**  \n    当前 8-正则图直径 ≈ log₇100 ≈ 2.4。可推导“Elo 估计误差 ε – 图直径 ρ – 节点度 k”三者的闭式关系，证明 cycle-overlay 是否达到信息论下限。\n    \n\n2\\. 数据与标注\n\n*   **人类 vs LLM-ensemble 的贝叶斯最优融合**  \n    论文仅用“人类最高分单点”做 RLHF。可构建生成式线性混合模型  \n    $$P\\_{\\\\text{gold}}(i≻j)=λ P\\_{\\\\text{human}}+(1-λ) P\\_{\\\\text{LLM}}$$  \n    用 EM 算法估计 λ，看不同领域 λ 是否稳定，避免直接丢弃人类信号。\n    \n*   **多语言文化偏差**  \n    实验仅限英文或拉丁语系。对中日韩、阿拉伯等跨文化查询，LLM 偏好是否仍与真实用户点击一致？需收集区域用户点击链做对照。\n    \n*   **动态自监督上限**  \n    在线日志持续微调场景，若用户兴趣发生概念漂移，Elo 标签会滞后。可引入“时序 Elo”模型  \n    $$\\\\text{Elo}\\_i^{(t)}=\\\\text{Elo}\\_i^{(t-1)}+η\\_t·(\\\\text{outcome}-σ(⋅))$$  \n    并给出遗忘因子最优调度。\n    \n\n3\\. 模型与算法\n\n*   **生成式重排序（Generative Reranker）**  \n    zerank 仍是判别式打分。可让模型直接生成“排序符号”或“相对描述”，用 PL 似然训练，实现单模型同时完成排序与可解释理由输出。\n    \n*   **多任务 Elo 预训练**  \n    将 pairwise 任务与摘要、问答、事实核查一起预训练，看是否能提升低资源领域（如法律、医学）的样本效率。\n    \n*   **负对数似然替代 MSE**  \n    当前 pointwise 阶段用 MSE 拟合 Elo 分数。可尝试以 Elo 的负对数似然直接做损失，消除“分数→概率”二次建模误差。\n    \n*   **检索-重排序联合优化**  \n    目前两阶段分离。可用可微近似（如 Gumbel-top-k）把初始检索器纳入同一 Elo 损失，实现端到端反向传播。\n    \n\n4\\. 系统与评测\n\n*   **能耗-精度帕累托前沿**  \n    测量训练阶段总 CO₂ 消耗 vs 下游 NDCG，回答“无监督是否真的更绿色”——LLM 推理百万次 vs 人工标注工时，碳排孰高？\n    \n*   **长尾查询鲁棒性**  \n    将查询按频率分为 Head/Mid/Tail，检查 zerank-1 在 Tail 段是否仍保持增益；若下降，可引入元学习快速适应。\n    \n*   **对抗攻击与可验证鲁棒性**  \n    对 pairwise 提示注入“误导性链式思考”，观察 Elo 分数漂移幅度；再训练鲁棒学生模型，使漂移低于 ε。\n    \n*   **实时用户反馈闭环**  \n    与生产搜索引擎对接，实现“用户点击→即时 pairwise→增量 Elo→在线蒸馏”的 24 h 不间断 A/B 测试，量化业务指标（CTR、满意度）提升。\n    \n\n5\\. 跨领域外推\n\n*   **多模态重排序**  \n    将文本查询-图像/视频文档对纳入同一 Elo 框架，需定义多模态 pairwise 提示模板，并验证 Thurstone 误差分布依旧成立。\n    \n*   **结构化数据检索**  \n    对 Table/JSON 文档，LLM 偏好是否仍可靠？可构建 Table-to-Text 中间视图，或设计“字段级” pairwise 比较协议。\n    \n\n综上，zELO 在“理论极限、数据质量、模型架构、系统落地”四端均留下可验证的开放问题；任何一条深入下去，都可产出独立贡献。\n\n**Q6**: 总结一下论文的主要内容\n\n**zELO：一套无需人工标注、基于 Elo/Thurstone 统计模型的重排序训练流程，及其产出的 SOTA 开源模型 zerank-1 / zerank-1-small。**\n\n1\\. 核心痛点\n\n*   传统 hard-negative mining 存在“拉弗曲线”：负例挖掘器越强，学生模型性能反而下降。\n*   人工标注昂贵且难以覆盖专业领域，限制大规模训练。\n\n2\\. 解决思路\n\n**用“多 LLM 的 pairwise 偏好”代替“人工三元组标签”：**\n\n步骤\n\n关键技术\n\n输出\n\n① 初始召回\n\nBM25 + 向量混合（RRF）\n\ntop-100 文档集合 Z\n\n② 稀疏 pairwise\n\n3×LLM 对 8-正则随机 cycle 图投票\n\n0/1 偏好矩阵 W\n\n③ 绝对 relevance\n\nThurstone 模型最大似然估计\n\n每文档 Elo 分数\n\n④ 蒸馏学生\n\n先训 pairwise cross-encoder→再训 pointwise MSE\n\nzerank-1 / zerank-1-small\n\n全程零人工标注，11.2 k 查询、5 M 查询-文档对，<10 000 H100-hours 完成。\n\n3\\. 主要结果\n\n*   **公开基准**：金融、法律、医学、代码、STEM 等 10+ 数据集，NDCG@10 平均提升 3–5 分，超越 Cohere rerank-v3.5、Voyage rerank-2 等体积 2× 的闭源模型。\n*   **私有数据**：企业搜索、医疗、法律等场景优势进一步扩大（最高 +14.2 NDCG）。\n*   **跨召回方式**：无论底层是 BM25、纯向量还是混合，zerank-1 均带来双位数绝对增益。\n*   **效率**：12 KB 文档延迟 149 ms，比商业 API 更快；1.7 B 小模型仅降 1–2 分，可 Apache-2.0 商用。\n\n4\\. 贡献清单\n\n1.  zELO 训练范式：首次用 Thurstone-Elo 将 LLM-ensemble 稀疏偏好转为绝对 relevance，规避 hard-negative 拉弗曲线。\n2.  开源权重：zerank-1（4 B）与 zerank-1-small（1.7 B）全部放出，无需人工数据即可复现。\n3.  理论+工程：给出 8-正则 cycle 图采样准则，保证 $O(n)$ 次比较即可稳定估计 Elo。\n4.  生产友好：支持在线日志自动标注→即时微调，实现检索链路持续改进。\n\n**一句话**：zELO 用统计建模取代人工标注，在零监督条件下训练出目前公开权重中精度最高、延迟最低、跨领域最强的重排序模型。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是zELO%3A%20ELO-inspired%20Training%20Method%20for%20Rerankers%20and%20Embedding%20Models，链接是  https://arxiv.org/pdf/2509.12541  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.12541  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-18-1758152840096","title":"RAPTOR: A Foundation Policy for Quadrotor Control","description":"Humans are remarkably data-efficient when adapting to new unseen conditions, like driving a new car. In contrast, modern robotic control systems, like neural network policies trained using Reinforcement Learning (RL), are highly specialized for single environments. Because of this overfitting, they are known to break down even under small differences like the Simulation-to-Reality (Sim2Real) gap and require system identification and retraining for even minimal changes to the system. In this work, we present RAPTOR, a method for training a highly adaptive foundation policy for quadrotor control. Our method enables training a single, end-to-end neural-network policy to control a wide variety of quadrotors. We test 10 different real quadrotors from 32 g to 2.4 kg that also differ in motor type (brushed vs. brushless), frame type (soft vs. rigid), propeller type (2/3/4-blade), and flight controller (PX4/Betaflight/Crazyflie/M5StampFly). We find that a tiny, three-layer policy with only 2084 parameters is sufficient for zero-shot adaptation to a wide variety of platforms. The adaptation through In-Context Learning is made possible by using a recurrence in the hidden layer. The policy is trained through a novel Meta-Imitation Learning algorithm, where we sample 1000 quadrotors and train a teacher policy for each of them using Reinforcement Learning. Subsequently, the 1000 teachers are distilled into a single, adaptive student policy. We find that within milliseconds, the resulting foundation policy adapts zero-shot to unseen quadrotors. We extensively test the capabilities of the foundation policy under numerous conditions (trajectory tracking, indoor/outdoor, wind disturbance, poking, different propellers).","url":"https://huggingface.co/papers/2509.11481","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.096Z","metadata":{"authors":["Jonas Eschmann","Dario Albani","Giuseppe Loianno"],"date":"","rank":19,"llmAnalysis":"","categories":["cs.RO","cs.AI","cs.LG"],"pdfUrl":"https://arxiv.org/pdf/2509.11481.pdf","arxivUrl":"https://arxiv.org/abs/2509.11481","arxivId":"2509.11481","coolPaperUrl":"https://papers.cool/arxiv/2509.11481","published":"2025-09-15T00:05:40Z","updated":"2025-09-15T00:05:40.000Z","zh_summary":"翻译失败: Unexpected end of JSON input","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n论文旨在解决**四旋翼无人机控制策略对新平台适应性差、需重复训练**的核心痛点，并提出一个可零样本泛化的“基础策略”（foundation policy）。具体可归纳为：\n\n*   **问题背景**\n    \n    1.  现有基于强化学习（RL）的端到端控制器多为单一平台定制，换桨叶、换电池、换机架等微小改动即需重新系统辨识与训练。\n    2.  传统域随机化虽能提升鲁棒性，但迫使策略对所有可能动力学取“保守”动作，牺牲敏捷性。\n    3.  人类可在几分钟内适应不同车辆，而机器人缺乏类似“即插即用”能力。\n*   **待解决的关键科学问题**\n    \n    1.  能否用**单一轻量网络**实时推断并适应未见过的四旋翼动力学？\n    2.  网络规模需多小才能**在微型飞控 MCU 上硬实时运行**？\n    3.  仅用**毫秒级交互上下文**能否完成隐式系统辨识，避免坠机？\n    4.  策略在**分布内/外**真实机上是否都能零样本稳定飞行？\n    5.  是否存在**适应性与敏捷性**的权衡？\n*   **目标**  \n    提出 RAPTOR 框架，训练一个仅 2084 参数的循环网络基础策略，通过**元模仿学习**蒸馏 1000 条专家策略，实现：  \n    – 对 31 g–2.4 kg、推力/重量比 1.75–12、不同桨叶/机架/飞控的 10 款真实四旋翼**零秒适应**；  \n    – 在室外 7 m/s 阵风、挂 1.2 kg 载荷、被工具击打、混合 2/3 桨叶等**严重分布外场景**稳定飞行；  \n    – 无需额外微调或系统辨识，直接部署在 Betaflight、PX4、Crazyflie 等消费级硬件。\n    \n\n**Q2**: 有哪些相关研究？\n\n与 RAPTOR 直接可比或提供关键思路的文献可分为六类，括号内给出代表性工作及其与本文的核心差异。\n\n1.  端到端单平台 RL 控制\n    \n    *   _Learning to Fly in Seconds_ (Eschmann 2024)：同样用 L2F 模拟器，但策略无 recurrent，换机需重训。\n    *   _Champion-level drone racing_ (Kaufmann 2023)、_Reaching the limit_ (Song 2023)：仅在单台 5.8 或 11 T/W 四旋翼上优化，对机体/赛道过拟合。\n2.  域随机化无适应\n    \n    *   _One Net to Rule Them All_ (Ferede 2025)：单一 Markovian 网络+大尺度随机化，可飞两台不同 T/W 机，但保守、无在线推断。\n3.  元-RL / 自适应控制\n    \n    *   _RL²_ (Duan 2016)、_Learning to RL_ (Wang 2016)：通用元-RL 框架，未在四旋翼硬件验证，网络大，需任务级交互。\n    *   _DAgger_ (Ross 2011) 与 _Meta-Imitation_ 思想相近，但 DAgger 无隐参数推断、off-policy；RAPTOR 强制学生网络在线推断 Ξ。\n4.  非端到端自适应\n    \n    *   _A Learning-Based Quadcopter Controller with Extreme Adaptation_ (Zhang 2025)：需高层 CTBR 设定点，网络 55× 更大，仅两台相似机体实验；RAPTOR 直接输出 4 电机转速，覆盖位置-姿态全回路。\n5.  系统辨识+控制分离\n    \n    *   传统递推最小二乘、UKF 在线估计质量、惯量、气动参数，再喂给 PID/MPC；需显式模型与调参，无“即插即用”能力。\n6.  微型无人机轻量网络\n    \n    *   _A Neural Network Mode for PX4 on Embedded Flight Controllers_ (Hegre 2025)：仍针对单机体，未考虑跨机迁移。\n\n综上，RAPTOR 首次将“**元模仿蒸馏 + 循环网络隐式系统辨识 + 极端域随机化**”结合，实现**极小参数（2084）的跨平台零样本四旋翼基础策略**。\n\n**Q3**: 论文如何解决这个问题？\n\n论文把“如何让一个极简网络在毫秒级实时推断中自动适应任意四旋翼”拆成三步，每一步都对应一个核心技术创新，形成 RAPTOR 框架。\n\n步骤\n\n技术模块\n\n解决的关键障碍\n\n具体做法与公式\n\n1\n\n超宽域随机化 + 1000 教师策略预训练\n\n保证“任何现实四旋翼都在分布内”\n\n1\\. 设计物理合理的动力学分布 p(Ξ)，覆盖 1.5≤T/W≤5、40≤τ/J≤1200 等（公式 S5–S26）。  \n2\\. 对每一样本 Ξ\\_i 独立运行 SAC，得到 1000 条马尔可夫教师策略 π\\*\\_Ξ(s)→a，作为“最优动作分布”的蒙特卡洛近似：a\\*\\_t ∼ π\\*\\_Ξ(s\\_t)。\n\n2\n\nMeta-Imitation Learning（元模仿蒸馏）\n\n把 1000 条教师压缩成**单一循环学生**，且学生只能看到部分观测\n\n1\\. 学生网络：22 维观测 + 4 维上一动作 → 16 维 GRU → 4 维 RPM，共 2084 参数（图 7B）。  \n2\\. 目标：最小化 KL( a\\*_t ∥ a^π\\_t )，在教师高斯假设下退化为 MSE（公式 S52）：  \n$$\\\\mathcal{L}= \\\\frac{1}{2}\\\\big\\\\lVert \\\\pi^\\*_\\\\Xi(s\\_t) - \\\\pi(o\\_{0:t},a\\_{0:t-1})\\\\big\\\\rVert^2$$  \n3\\. 先 10 epoch 用教师轨迹 warm-start，随后 990 epoch **on-policy** 滚动：学生自己飞，教师实时给“标签”，实现隐式系统辨识。\n\n3\n\n在线部署与 In-Context 推理\n\nMCU 硬实时 + 零样本适应\n\n1\\. 推理仅依赖 16 维隐藏状态 h\\_t，计算量 O(1)，在 100 Hz 下 <10 % MCU 负载。  \n2\\. 隐藏状态充当“充分统计量”，自动编码推力/惯量比、电机延迟等未知 Ξ；线性探针可回归出 T/W（R²=0.95，图 3）。  \n3\\. 无需微调，直接烧录到 Betaflight/PX4/Crazyflie；遇到新机体时，隐藏状态在 20–50 ms 内收敛，完成“空中 Few-Shot”适应。\n\n通过“先离线蒸馏、后在线推断”的解耦，RAPTOR 把计算量移到一次性预训练，部署端仅 2084 次浮点乘加即可实现跨平台零样本稳定飞行。\n\n**Q4**: 论文做了哪些实验？\n\n实验按“**训练 → 仿真 → 实物 → 极限压力**”四级展开，共覆盖 **12 款平台（10 真机 + 2 仿真）**、**3 类任务**、**6 种扰动**，全部用**同一套 2084-参数权重**零样本完成。\n\n层级\n\n实验目的\n\n测试量/条件\n\n关键结果\n\n1\\. 训练诊断\n\n验证 1000 教师收敛性与蒸馏效率\n\n• 1000 条 SAC 曲线  \n• 教师数 16→1000 消融  \n• 学生隐藏维度 4→64 消融\n\n所有教师 1 M step 收敛；  \n教师≥125 即可稳定；  \n隐藏=16 是 Pareto 最优（图 2C-D）。\n\n2\\. 仿真泛化\n\n分布内 & 外 Sim2Sim\n\n• 7 款未参与训练的参数化机型  \n• Flightmare 默认机 (T/W≈12，>2× 训练上限)\n\n7 款平均 episode length ≥475/500；  \nFlightmare 仍能跟踪 8 字，RMSE 0.22 m。\n\n3\\. 实物零样本\n\n跨重量、尺寸、桨叶、飞控、状态估计器\n\n10 款真机：31 g–2.4 kg，65–500 mm，Betaflight/PX4/Crazyflie，EKF/Mahony/Madgwick，2/3/4 桨，软/刚性机架\n\n全部稳定悬停 & 跟踪 8 字；  \nRMSE 0.07–0.19 m（10 s 周期），与专用单策略相当。\n\n4\\. 轨迹跟踪敏捷性\n\n测试“适应性-敏捷性”权衡\n\n10 s、5.5 s、最快 3.5 s 8 字；  \n最大速度 1–4.7 m/s\n\n无需轨迹前瞻，RMSE 仅增加 ≈0.02 m；  \n最大速度受限于**无前瞻**而非适应力。\n\n5\\. 室外 & 载荷\n\n大风+超重\n\nx500 平台，7 m/s 阵风，10 m/s 地速；  \n挂 600 g/1.2 kg 水瓶（总重 2.4 kg，> 官方 1.5 kg 上限）\n\n10 m/s 仍稳定；  \n600 g 载荷下 8 字跟踪；  \n1.2 kg 仅能悬停。\n\n6\\. 瞬时扰动\n\n在线系统辨识速度\n\n• 空中 4.5 m/s 初速度突然切换策略  \n• 底部猛击 >90° 倾覆  \n• 顶部加压 200 g 工具  \n• 1–3 片 2 桨换 3 桨\n\n20–40 ms 内恢复平飞；  \n击打工后 0.8 s 回到悬停；  \n加压无稳态高度误差；  \n混合桨仍完成 8 字。\n\n7\\. 长序列外推\n\n上下文窗口极限\n\n训练仅用 500 步（5 s），实测连续飞行至电池空（>5 min，≈30 000 步）\n\n隐藏状态无漂移，轨迹 5 圈重叠误差 <1 cm（图 6C）。\n\n8\\. 隐含表征探针\n\n验证“是否真在辨识”\n\n用 1000 条仿真轨迹训练线性探针回归 T/W、τ/J、电机延迟\n\nT/W 预测 R²=0.949，误差 0.047；  \n隐藏状态随时间收敛到真值（图 3）。\n\n综上，实验用**同一权重**完成从 31 g 玩具机到 2.4 kg 工业机、从静悬到 4.7 m/s 特技、从实验室到 7 m/s 阵风外场的全谱验证，首次证明**极简循环网络可在毫秒级实现跨平台零样本四旋翼控制**。\n\n**Q5**: 有什么可以进一步探索的点？\n\n以下问题在论文末尾已部分提及，但尚未展开；它们为后续研究提供了可直接落地的切口。按“**理论 → 算法 → 系统 → 应用**”四个层次归纳：\n\n理论层面\n\n1.  **可适应性的理论极限**  \n    在给定网络容量（2084 参数）与观测维度（22）下，能否用 **PAC-Bayes 或信息论下界** 量化“零样本适应”所需的最小上下文长度、最小教师数量？\n    \n2.  **渐进最优性**  \n    当前 KL 逼近目标仅到“教师动作分布”为止。若教师本身距最优策略仍有差距，蒸馏过程会继承次优。能否引入 **滚动时域 MPC 作为“无限容量教师”**，构造“教师→学生→在线细化”的渐进最优链？\n    \n\n算法层面\n\n3.  **异构执行器与故障在线重配置**  \n    实验已验证 2-/3-桨混合，但尚未涉及 **单电机完全失效** 或 **推力曲线非对称突变**。能否把“故障模式”显式加入 Ξ 分布，令隐藏状态同时完成 **故障检测-隔离-重配置（FDI-R）**？\n    \n4.  **奖励函数也未知**  \n    当前 Ξ 仅覆盖动力学；若载荷/任务变更导致奖励权重变化（如航拍→搬运），需同时推断 **动力学 + 奖励参数**。可把 BAPOMDP 扩展为 **Bayes-Adaptive Reward-Parameterized MDP**，用同一套元模仿框架蒸馏。\n    \n5.  **上下文长度外推的理论保证**  \n    实验观察到 5 s→50 s 无漂移，但 GRU 存在梯度消失。能否用 **Lipschitz RNN** 或 **线性注意力** 替代，给出“任意长 episode 误差有界”的稳定性证明？\n    \n\n系统层面\n\n6.  **片上学习（On-device fine-tune）**  \n    当前仅做前向推断。若利用 MCU 空闲算力，在 **10-20 个梯度步 / 航班** 内做 **递归滤波 + 低秩适配（LoRA）**，可进一步压缩剩余 10 % 误差；需解决 **浮点运算量 < 1 kFLOP/步** 的极限优化。\n    \n7.  **多机分布式基础策略**  \n    把隐藏状态通过 **超低带宽广播（< 1 kb/s）** 共享，实现“机群级系统辨识”：当一架机发现新动力学模式，其余机即时更新隐藏先验，形成 **联邦式 in-context 学习**。\n    \n8.  **事件触发观测**  \n    当前 100 Hz 固定频率；在大型机上可引入 **事件相机 + IMU 事件触发**，策略输入变为异步事件流。需重新设计 **连续-time RNN（ODE-RNN）**，保证异步输入下仍满足硬实时。\n    \n\n应用层面\n\n9.  **极端环境零样本**\n    \n    *   **水下-空中跨介质**：液体密度、附加质量、推力损失 > 50 %，动力学远超出当前 Ξ 包络。\n    *   **火星稀薄大气**：雷诺数、桨尖马赫数变化，需把 **气动系数 C\\_T、C\\_Q** 纳入随机化，并验证仿真→真实稀薄大气的跨域迁移。\n10.  **低成本教具与 benchmark**  \n    开源权重已可烧录到 $49 Crazyflie；下一步发布 **“一键换机” 自动化脚本**（自动读取 URDF/SDF → 烧录 → 起飞），把 RAPTOR 变成 **四旋翼控制领域的 ImageNet 预训练模型**，后续研究只需在隐藏状态上接下游任务头（跟踪、避障、编队）即可。\n    \n\n一句话总结\n\nRAPTOR 把“换机重训”问题压缩成“隐藏状态 20 ms 收敛”，但理论上仍不清楚**收敛极限在哪**、工程上仍没把**剩余 10 % 误差吃干榨尽**；往上述任一点深挖，都可能成为下一代“基础策略”的里程碑。\n\n**Q6**: 总结一下论文的主要内容\n\nRAPTOR 核心内容速览\n=============\n\n1\\. 研究目标\n--------\n\n*   让**单一极简网络**无需再训练即可零样本控制**任意四旋翼**，解决“换机重训”痛点。\n*   对标人类“10 分钟适应新车”的数据效率，实现毫秒级在线系统辨识。\n\n2\\. 方法框架（RAPTOR）\n----------------\n\n阶段\n\n关键创新\n\n一句话总结\n\n① 超宽域随机化\n\n物理合理的动力学分布 p(Ξ) 覆盖 31 g–2.4 kg、T/W 1.5–5\n\n先把“所有现实四旋翼”装进一个分布\n\n② 预训练\n\n1000 条 SAC 教师策略，各专精一台随机采样机体\n\n用“无限容量”教师做最优动作 oracle\n\n③ 元模仿蒸馏\n\n2084-参数 GRU 学生网络，最小化 KL(教师∥学生)≈MSE\n\n把 1000 教师压进一个循环网络，隐藏状态=隐式 Ξ 推断器\n\n④ 部署\n\n100 Hz 前向推理，隐藏状态实时更新\n\n上电即飞，20–50 ms 完成适应\n\n3\\. 网络极简\n--------\n\n*   22 维观测 → 16 维 GRU → 4 维电机转速\n*   2084 参数、< 10 % MCU 算力，硬实时 100 Hz\n\n4\\. 实验规模\n--------\n\n*   **10 款真机**（31 g–2.4 kg，不同桨/机架/飞控/状态估计器）\n*   **2 款仿真**（含 T/W=12 超分布机型）\n*   **3 类任务**：悬停、8 字跟踪、高速室外\n*   **6 种扰动**：阵风 7 m/s、挂 1.2 kg 载荷、底部猛击>90°、顶部加压、混合 2/3 桨、空中 4.5 m/s 初速切换\n\n**结果**：全部零样本稳定飞行，轨迹跟踪 RMSE 0.07–0.19 m，与专用单策略相当；隐藏状态可线性回归 T/W（R²=0.95）。\n\n5\\. 主要贡献\n--------\n\n*   提出“基础策略”概念并给出完整训练流水线（域随机化→教师预训练→元模仿蒸馏）\n*   证明**极小规模循环网络**即可在线推断未知动力学，实现跨平台零样本控制\n*   开源 1000 教师权重、训练/推理代码与网页交互 demo，建立可复现基准\n\n> RAPTOR 让四旋翼控制像“插 USB”一样即插即用，为低成本机群、异构机器人甚至跨介质飞行器提供了可扩展的控制基础模型。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是RAPTOR%3A%20A%20Foundation%20Policy%20for%20Quadrotor%20Control，链接是  https://arxiv.org/pdf/2509.11481  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.11481  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}},{"id":"hf-19-1758152840096","title":"Sound Matching an Analogue Levelling Amplifier Using the Newton-Raphson Method","description":"Automatic differentiation through digital signal processing algorithms for virtual analogue modelling has recently gained popularity. These algorithms are typically more computationally efficient than black-box neural networks that rely on dense matrix multiplications. Due to their differentiable nature, they can be integrated with neural networks and jointly trained using gradient descent algorithms, resulting in more efficient systems. Furthermore, signal processing algorithms have significantly fewer parameters than neural networks, allowing the application of the Newton-Raphson method. This method offers faster and more robust convergence than gradient descent at the cost of quadratic storage. This paper presents a method to emulate analogue levelling amplifiers using a feed-forward digital compressor with parameters optimised via the Newton-Raphson method. We demonstrate that a digital compressor can successfully approximate the behaviour of our target unit, the Teletronix LA-2A. Different strategies for computing the Hessian matrix are benchmarked. We leverage parallel algorithms for recursive filters to achieve efficient training on modern GPUs. The resulting model is made into a VST plugin and is open-sourced at https://github.com/aim-qmul/4a2a.","url":"https://huggingface.co/papers/2509.10706","source":"HuggingFace Papers","timestamp":"2025-09-17T23:47:20.096Z","metadata":{"authors":["Chin-Yun Yu","György Fazekas"],"date":"","rank":20,"llmAnalysis":"","categories":["eess.AS","cs.SD","cs.SY","eess.SY"],"pdfUrl":"https://arxiv.org/pdf/2509.10706.pdf","arxivUrl":"https://arxiv.org/abs/2509.10706","arxivId":"2509.10706","coolPaperUrl":"https://papers.cool/arxiv/2509.10706","published":"2025-09-12T21:48:30Z","updated":"2025-09-12T21:48:30.000Z","zh_summary":"通过数字信号处理算法进行自动微分的虚拟模拟建模最近获得了越来越多的关注。这些算法通常比依赖于密集矩阵乘法的黑盒神经网络更具计算效率。由于它们具有可微分的特性，可以与神经网络集成，并使用梯度下降算法进行联合训练，从而形成更高效的系统。此外，信号处理算法的参数显著少于神经网络，使得牛顿-拉夫森法得以应用。这种方法提供比梯度下降更快且更稳健的收敛，但需要消耗二次存储。本文提出了一种使用前馈数字压缩机模拟模拟调平放大器的方法，其参数通过牛顿-拉夫森法进行了优化。我们展示了数字压缩机能够成功地近似我们目标单元Teletronix LA-2A的行为。不同的海森矩阵计算策略进行了基准测试。我们利用递归滤波器的并行算法来实现现代GPU上的高效训练。最终模型制作成VST插件，并在https://github.com/aim-qmul/4a2a开源。","llm_analysis":"**Q1**: 这篇论文试图解决什么问题？\n\n该论文将“虚拟模拟（VA）建模”形式化为一个\\*\\*声音匹配（sound-matching）\\*\\*问题：  \n给定一段由经典模拟压限器 Teletronix LA-2A 处理后的目标音频 $y$，用一组可解释的数字压限器参数 $\\\\theta$ 去逼近该目标，即\n\n\\[ \\\\theta^\\* = \\\\arg\\\\min\\_\\\\theta D!\\\\bigl(f(x,\\\\theta),,y\\\\bigr), \\]\n\n其中\n\n*   $x$ 为未处理的干信号，\n*   $f$ 是一个仅含 5 个参数的前馈数字压限器（阈值、压缩比、起音/释音时间、补偿增益），\n*   $D$ 取平方误差。\n\n核心难点在于如何**快速且鲁棒地**求解上述优化。论文提出用**牛顿-拉夫逊（Newton-Raphson, NR）方法**替代常规的梯度下降，以利用二阶信息获得更快收敛，并针对音频递归滤波结构推导了高效的 Hessian 计算与 GPU 并行实现。最终得到一个可解释、可实时运行的 VST 插件，其音质与商业插件相当或更优。\n\n**Q2**: 有哪些相关研究？\n\n相关研究可归纳为三条主线：纯黑盒神经网络、灰盒混合模型，以及基于物理/优化的白盒方法。以下按时间顺序列出关键文献并指出其与本文的关联。\n\n类别\n\n代表文献\n\n核心思路\n\n与本文关系\n\n**黑盒 NN**\n\nHawley et al. AES 2019 \\[2\\]\n\nU-Net 自编码器端到端建模 LA-2A\n\n首次用深度网络直接拟合压缩器，但参数量大、不可解释\n\nSteinmetz & Reiss AES 2022 \\[3\\]\n\n时序卷积网络 TCN 降低运算量\n\n强调实时性，启发本文选用轻量结构\n\nComunità et al. ICASSP 2023 \\[4\\]\n\n时变特征调制条件机制\n\n提高对旋钮设置的泛化，但仍是黑盒\n\nYeh et al. DAFx 2024 \\[5\\]\n\n超循环神经网络条件建模\n\n进一步压缩参数量，可视为黑盒路线的最新进展\n\nSimionato & Fasciani arXiv 2024 \\[6\\] / JAES 2025 \\[7\\]\n\n状态空间模型 SSA/S4 建模光学压缩器\n\n提供另一种低复杂度序列建模工具，与本文的“二阶优化”形成互补\n\n**灰盒混合**\n\nWright & Välimäki DAFx 2022 \\[8\\]\n\n前馈压缩器+轻量 GRU 补偿增益\n\n本文直接延续其“可解释参数+数据驱动补偿”框架，但将梯度下降替换为 NR\n\nYu et al. DAFx 2024 \\[9\\]\n\n为压缩器弹道递归滤波定制反向传播核\n\n本文利用其可微滤波器实现（torchcomp），并进一步给出前向模式（JVP）推导以支持 Hessian 计算\n\n**白盒/物理**\n\nBernardini et al. TASLP 2021 \\[10\\]\n\n波数字牛顿-拉夫逊求解多端口非线性\n\n首次在 VA 领域用 NR 解电路方程，但属于“白盒”电路仿真，与本文“灰盒声音匹配”目标不同\n\nBilbao et al. Acta Acustica 2015 \\[11\\]\n\nNR 用于乐器碰撞系统物理建模\n\n提供二阶优化在音频物理模型中的早期范例\n\n综上，本文首次将**牛顿-拉夫逊二阶优化**引入**灰盒声音匹配**场景，填补了“黑盒 NN 参数过多、白盒物理建模难以适配”之间的空白，并通过高效 Hessian 计算与 GPU 并行实现，将优化时间从小时级降至分钟级。\n\n**Q3**: 论文如何解决这个问题？\n\n论文把“LA-2A 模拟压限器建模”转化为一个**5 参数最小二乘拟合问题**，并用**牛顿-拉夫逊（NR）二阶优化**在 GPU 上快速求解。关键步骤如下：\n\n1.  建立可微灰盒模型  \n    采用前馈数字压限器 `torchcomp`（仅 5 个参数：阈值、压缩比、起音/释音时间、补偿增益），移除 RMS 检测器以避免局部极小值；整个链路在 PyTorch 中完全可微。\n    \n2.  构造二阶可优化目标  \n    损失函数取平方误差  \n    \\[ L(\\\\theta)=|\\\\hat y(\\\\theta)-y|\\_2^2, \\]  \n    满足 NR 所需的二阶可微与局部凸性（经验验证）。\n    \n3.  高效 Hessian 计算\n    \n    *   利用 `torchcomp` 已有的 VJP 内核，推出\\*\\*前向模式（JVP）\\*\\*递归公式，使 Hessian 可用“前向-反向”或“反向-反向”模式并行求得。\n    *   对弹道中的一阶递归滤波器采用**并行 associative scan** CUDA 核，进一步将每步 NR 耗时降到 3.5 s（整数据集 <20 min）。\n4.  阻尼 NR + 回溯线搜索  \n    求解 \\[ \\\\nabla^2 L(\\\\theta),\\\\nu=\\\\nabla L(\\\\theta) \\] 避免显式求逆；若 Hessian 非正定，则随机抽取正交方向继续搜索。按“100→95→90…”顺序初始化，确保起始点靠近最优解。\n    \n5.  插件化与补偿\n    \n    *   将学得的“Peak Reduction → 5 参数”映射表线性插值后嵌入 VST，用户仅拧一个旋钮即可连续控制。\n    *   额外级联 8 单元 GRU 补偿残余非线性，得到 `4A-2A-G` 版本，ESR 低于商业插件。\n\n通过“**5 参数可解释模型 + 二阶优化 + GPU 并行 Hessian**”这一组合，论文在保持实时性的同时，把 LA-2A 的声音特征压缩进一组人类可读的旋钮，实现了快速、鲁棒、可推广的灰盒虚拟模拟。\n\n**Q4**: 论文做了哪些实验？\n\n实验围绕三条主线展开：\n\n1.  验证 Newton-Raphson 在 5 参数灰盒压缩器上的可行性与收敛性；\n2.  对比不同 Hessian 计算策略的时空开销，并选取最优实现；\n3.  与商业插件及已有灰盒模型进行音质与动态指标评测，最后给出插件化与插值误差分析。具体实验如下：\n\n编号\n\n实验目的\n\n数据集/设置\n\n关键指标\n\n主要结论\n\nE1\n\nNR 收敛性与参数轨迹\n\nSignalTrain LA-2A（44.1 kHz，21 个 peak-reduction 点，20 min 音频）\n\n迭代次数、损失曲线、Hessian 正定性\n\n≤10 次迭代即收敛；peak-reduction ≥40 时损失曲面近似凸；<40 频繁出现负曲率，无法一致求解\n\nE2\n\nHessian 计算策略 benchmark\n\n同一 12 s 片段，batch=16，RTX 3060 12 GB\n\n显存占用(MB)、单次耗时(ms)\n\nautograd-rev-rev 最优：1066 MB / 26.5 ms；func-fwd-rev 稍慢但可接受；func-rev-fwd 最昂贵（6306 MB / 64.7 ms）\n\nE3\n\n整体训练耗时\n\n全部 21×2 模式（compressor+limiter）\n\n总 Wall-clock 时间\n\n单块 RTX 3060 <20 min，较先前梯度下降方案（数小时）×10 提速\n\nE4\n\n音质评估（训练集内）\n\n同上，预加重后\n\nESR、∆LDR\n\n4A-2A 与 UAD 官方插件 ESR 相当；4A-2A-G（+GRU）ESR 最低，∆LDR≈0，优于 CLA-2A、CA-2A\n\nE5\n\n插件参数映射插值误差\n\n留 7 点（45,55,…,95）做插值\n\n插值后 ESR\n\n线性 vs. 三次样条平均 ESR 差异 <0.1%，峰值处线性略优；插件采用线性插值\n\nE6\n\n残差频谱分析\n\n鼓循环片段，peak-reduction=75\n\n时频图差值\n\nGRU 补偿后高频（>4 kHz）残差显著降低，验证其捕捉非线性残余的能力\n\n所有实验均开源（代码 + VST 插件），以便复现与扩展。\n\n**Q5**: 有什么可以进一步探索的点？\n\n可继续探索的方向按“模型-优化-系统-评估”四层次归纳如下：\n\n1 模型结构\n\n*   **反馈拓扑**  \n    LA-2A 实为光敏反馈压缩器，可改用 `s[n]=ŷ[n−1]` 并引入光电元件非线性微分方程，建立可微反馈模型；需设计“隐式层”或固定点迭代式前向传播，并推导对应的反向/前向梯度。\n    \n*   **两阶段释音**  \n    文献指出 LA-2A 存在 60 ms + 5 s 双时间常数释音。可在弹道滤波器后并联快/慢两支路，通过数据驱动权重混合，形成 6–7 参数扩展模型。\n    \n*   **光电元件物理先验**  \n    将 T4 电致发光-光敏电阻的指数/对数 I-V 曲线直接嵌入增益检测模块，实现“灰盒+物理”混合建模，减少纯数据依赖。\n    \n\n2 优化算法\n\n*   **Hessian-free 策略**  \n    当参数 >50–100 时，显式 Hessian 存储不可行。可改用共轭梯度或 Krylov 子空间法，仅通过 Hessian-向量积 `v↦∇²L v` 求解牛顿方程；结合 PyTorch `functorch.cvp` 或 JAX 线性算子抽象实现。\n    \n*   **随机/拟牛顿变种**  \n    探索 L-BFGS、SR1 或在线自然梯度（NG）更新，兼顾二阶信息与大 batch 训练；研究其对音频递归网络的稳定性。\n    \n*   **全局优化**  \n    对低参数空间（M<15）可试验贝叶斯优化、模拟退火或遗传算法，验证是否突破 NR 遇到的负曲率/局部极小瓶颈。\n    \n\n3 系统与实现\n\n*   **实时隐式层求解**  \n    反馈模型需在采样级循环内收敛。可研究 Anderson 加速、学习初始猜测（meta-solver）或神经网络预测固定点，实现 <1 ms 块延迟。\n    \n*   **降低 Hessian 计算复杂度**  \n    利用滤波器结构稀疏性、Toeplitz 近似或 Kronecker 分解，把 O(M²) 存储降至 O(M)；结合混合精度（FP16 Hessian-向量积）进一步提速。\n    \n*   **多硬件后端**  \n    将并行 associative scan 核移植到 Apple Metal、Intel Xe 及移动 GPU；探索 WebAssembly+SIMD 浏览器版本，实现插件跨平台。\n    \n\n4 评估与扩展\n\n*   **跨硬件泛化**  \n    收集多台不同年份 LA-2A 单元，量化单元间差异，建立“硬件-感知”多任务学习目标，测试模型鲁棒性。\n    \n*   **其他经典压缩器**  \n    应用同一 NR 框架到 1176（FET）、LA-3A（固态）、Fairchild 670（可变 μ）等，验证通用性并构建统一插件套件。\n    \n*   **感知-驱动损失**  \n    采用谱包络、耳蜗图或深度听觉嵌入替代平方误差，分析是否进一步降低感知差异而不仅 ESR。\n    \n*   **端到端参数推断**  \n    训练轻量 CNN 将音频片段直接映射至 5 参数，实现“盲”压缩器克隆，再与 NR 微调级联，实现“先粗后精”两阶段策略。\n    \n\n5 结合生成式/控制\n\n*   **条件生成与风格迁移**  \n    将 NR 优化得到的参数作为条件向量，驱动生成模型（扩散、GAN）产生符合特定压缩风味的音频，用于音乐制作辅助。\n    \n*   **可微分混音引擎**  \n    把 4A-2A 插件嵌入完整可微分混音图（均衡、混响、饱和），利用二阶优化联合调整多条音轨动态，实现“端到端”智能混音。\n    \n\n这些方向既涵盖理论（反馈可微、物理先验）也涵盖工程（实时求解、跨平台、感知指标），为后续研究提供了阶梯式升级路径。\n\n**Q6**: 总结一下论文的主要内容\n\n*   把 LA-2A 模拟压限器建模写成**5 参数最小二乘声音匹配**问题。\n*   用**牛顿-拉夫逊二阶优化**替代梯度下降，推导并并行化 Hessian 计算（反向/前向模式 + associative scan），单步更新 3.5 s，整数据集训练 <20 min。\n*   在 SignalTrain 上取得与 UAD 官方插件相当的 ESR，配合轻量 GRU 补偿后 ESR 最低、∆LDR≈0，超越商业插件。\n*   学得“Peak Reduction → 5 参数”可解释映射，制成实时 VST 插件并开源，提供线性插值连续控制与手动微调功能。\n\n结论：首次验证 NR 在灰盒音频压缩器建模中的实用性与实时可行性，为虚拟模拟效果器提供快速、鲁棒、可解释的新范式。\n\n**Q7**: 想要进一步了解论文\n\n以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 [**这里**]( http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Sound%20Matching%20an%20Analogue%20Levelling%20Amplifier%20Using%20the%20Newton-Raphson%20Method，链接是  https://arxiv.org/pdf/2509.10706  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.10706  。请以此为基础，继续回答我后面的问题。&system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&send_immediately=true&force_search=false&enable_reasoning=false) 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。"}}]}