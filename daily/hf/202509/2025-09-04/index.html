<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>HuggingFace Papers 2025-09-04 | 37.2° Blog</title><meta name="author" content="Firefly"><meta name="copyright" content="Firefly"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="数据来源：HuggingFace Papers  Latest Papers1. The Landscape of Agentic Reinforcement Learning for LLMs: A SurveyThe emergence of agentic reinforcement learning (Agentic RL) marks a paradigm shift from con">
<meta property="og:type" content="article">
<meta property="og:title" content="HuggingFace Papers 2025-09-04">
<meta property="og:url" content="https://wdndev.github.io/daily/hf/202509/2025-09-04/index.html">
<meta property="og:site_name" content="37.2° Blog">
<meta property="og:description" content="数据来源：HuggingFace Papers  Latest Papers1. The Landscape of Agentic Reinforcement Learning for LLMs: A SurveyThe emergence of agentic reinforcement learning (Agentic RL) marks a paradigm shift from con">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://wdndev.github.io/img/wdn_icon.png">
<meta property="article:published_time" content="2019-06-17T16:00:00.000Z">
<meta property="article:modified_time" content="2025-11-01T23:46:09.882Z">
<meta property="article:author" content="Firefly">
<meta property="article:tag" content="AI">
<meta property="article:tag" content="HuggingFace">
<meta property="article:tag" content="Papers">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wdndev.github.io/img/wdn_icon.png"><link rel="shortcut icon" href="/img/wdn_icon.png"><link rel="canonical" href="https://wdndev.github.io/daily/hf/202509/2025-09-04/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search/.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":100,"languages":{"author":"Author: Firefly","link":"Link: ","source":"Source: 37.2° Blog","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'HuggingFace Papers 2025-09-04',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-11-02 07:46:09'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/wdn_icon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">565</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">15</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> Content</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/paper_reading/pr_content"><i class="fa-fw fas fa-newspaper"></i><span> Paper</span></a></li><li><a class="site-page child" href="/llms/llms_idx"><i class="fa-fw fa-regular fa-bookmark"></i><span> LLMs</span></a></li><li><a class="site-page child" href="/jupyter"><i class="fa-fw fa-solid fa-file"></i><span> Jupyter</span></a></li><li><a class="site-page child" href="/dsa/dsa_idx"><i class="fa-fw fas fa-tree"></i><span> Algorithm</span></a></li><li><a class="site-page child" href="/program_language/pl_idx"><i class="fa-fw fas fa-code"></i><span> PLs</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-calendar-days"></i><span> Daily</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/daily/github/index"><i class="fa-fw fas fa-arrow-trend-up"></i><span> Github</span></a></li><li><a class="site-page child" href="/daily/weibo/index"><i class="fa-fw fas fa-brands fa-weibo"></i><span> Weibo</span></a></li><li><a class="site-page child" href="/daily/hf/index"><i class="fa-fw fas fa-face-smile"></i><span> HF</span></a></li><li><a class="site-page child" href="/daily/domain/index"><i class="fa-fw fas fa-book-open"></i><span> Arxiv</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img fixed" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="37.2° Blog"><span class="site-name">37.2° Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> Content</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/paper_reading/pr_content"><i class="fa-fw fas fa-newspaper"></i><span> Paper</span></a></li><li><a class="site-page child" href="/llms/llms_idx"><i class="fa-fw fa-regular fa-bookmark"></i><span> LLMs</span></a></li><li><a class="site-page child" href="/jupyter"><i class="fa-fw fa-solid fa-file"></i><span> Jupyter</span></a></li><li><a class="site-page child" href="/dsa/dsa_idx"><i class="fa-fw fas fa-tree"></i><span> Algorithm</span></a></li><li><a class="site-page child" href="/program_language/pl_idx"><i class="fa-fw fas fa-code"></i><span> PLs</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-calendar-days"></i><span> Daily</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/daily/github/index"><i class="fa-fw fas fa-arrow-trend-up"></i><span> Github</span></a></li><li><a class="site-page child" href="/daily/weibo/index"><i class="fa-fw fas fa-brands fa-weibo"></i><span> Weibo</span></a></li><li><a class="site-page child" href="/daily/hf/index"><i class="fa-fw fas fa-face-smile"></i><span> HF</span></a></li><li><a class="site-page child" href="/daily/domain/index"><i class="fa-fw fas fa-book-open"></i><span> Arxiv</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">HuggingFace Papers 2025-09-04</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2019-06-17T16:00:00.000Z" title="Created 2019-06-18 00:00:00">2019-06-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-11-01T23:46:09.882Z" title="Updated 2025-11-02 07:46:09">2025-11-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/AI/">AI</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">90k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>321min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="HuggingFace Papers 2025-09-04"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><blockquote>
<p>数据来源：<a target="_blank" rel="noopener" href="https://huggingface.co/papers">HuggingFace Papers</a></p>
</blockquote>
<h2 id="Latest-Papers"><a href="#Latest-Papers" class="headerlink" title="Latest Papers"></a>Latest Papers</h2><h3 id="1-The-Landscape-of-Agentic-Reinforcement-Learning-for-LLMs-A-Survey"><a href="#1-The-Landscape-of-Agentic-Reinforcement-Learning-for-LLMs-A-Survey" class="headerlink" title="1. The Landscape of Agentic Reinforcement Learning for LLMs: A Survey"></a>1. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.02547">The Landscape of Agentic Reinforcement Learning for LLMs: A Survey</a></h3><p>The emergence of agentic reinforcement learning (Agentic RL) marks a paradigm shift from conventional reinforcement learning applied to large language models (LLM RL), reframing LLMs from passive sequence generators into autonomous, decision-making agents embedded in complex, dynamic worlds. This survey formalizes this conceptual shift by contrasting the degenerate single-step Markov Decision Processes (MDPs) of LLM-RL with the temporally extended, partially observable Markov decision processes (POMDPs) that define Agentic RL. Building on this foundation, we propose a comprehensive twofold taxonomy: one organized around core agentic capabilities, including planning, tool use, memory, reasoning, self-improvement, and perception, and the other around their applications across diverse task domains. Central to our thesis is that reinforcement learning serves as the critical mechanism for transforming these capabilities from static, heuristic modules into adaptive, robust agentic behavior. To support and accelerate future research, we consolidate the landscape of open-source environments, benchmarks, and frameworks into a practical compendium. By synthesizing over five hundred recent works, this survey charts the contours of this rapidly evolving field and highlights the opportunities and challenges that will shape the development of scalable, general-purpose AI agents.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>代理强化学习（Agentic RL）的出现标志着传统强化学习应用于大型语言模型（LLM RL）的范式转换，将LLM从被动的序列生成器重新构造为嵌入在复杂动态世界中的自主决策代理。这项调查通过将LLM-RL的简化单步马尔可夫决策过程（MDPs）与定义代理RL的时间扩展、部分可观察马尔可夫决策过程（POMDPs）进行对比，正式化了这种概念转变。在此基础上，我们提出了一个全面的双重分类税onomies：一个围绕核心代理能力组织，包括计划、工具使用、记忆、推理、自我改善和感知，另一个围绕其在不同任务领域的应用。我们论点的核心是，强化学习是将这些能力从静态启发式模块转变为自适应、稳健的代理行为的关键机制。为了支持和加速未来的研究，我们将开源环境、基准和框架的全景汇总成一个实用的汇编。通过综合超过五百项近期工作，这项调查勾绘了这一快速发展的领域的轮廓，并突出了将塑造可扩展、通用AI代理发展的机会和挑战。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>这篇综述论文的核心目标是<strong>系统性地界定并推动“Agentic Reinforcement Learning（Agentic RL）”这一新兴范式的发展</strong>，解决现有研究在概念、方法与实践层面上的碎片化问题。具体而言，论文试图解决以下关键问题：</p>
<ol>
<li><p><strong>概念模糊与范式混淆</strong>：<br>传统LLM-RL（如RLHF、DPO）将大语言模型视为静态的“单步序列生成器”，而Agentic RL强调模型应作为<strong>自主决策的智能体</strong>，在部分可观测、动态环境中进行<strong>多步交互</strong>。论文通过MDP/POMDP的形式化对比，明确区分了两者在状态空间、动作空间、转移动力学和奖励设计上的本质差异。</p>
</li>
<li><p><strong>能力模块的孤立优化</strong>：<br>现有研究往往独立优化LLM的某项能力（如工具使用、记忆、推理），缺乏统一框架。论文提出<strong>以RL为核心机制</strong>，将规划、工具调用、记忆管理、自我改进、推理和感知等能力整合为可联合优化的策略模块，实现从“静态启发式”到“动态适应性”的转变。</p>
</li>
<li><p><strong>任务与环境的碎片化</strong>：<br>不同领域（如代码生成、数学推理、GUI导航）的研究使用定制环境和不一致的评估协议，难以横向比较。论文通过<strong>双重视角分类法</strong>（能力视角+任务视角），梳理了500+相关工作，并整合开源环境、基准和框架，为跨领域研究提供统一基准。</p>
</li>
<li><p><strong>可扩展性与可信性挑战</strong>：<br>针对Agentic RL的规模化训练（计算、数据、模型效率）和可信性（安全、幻觉、谄媚行为）问题，论文提出未来方向，包括<strong>环境-策略协同进化</strong>（如EnvGen自动生成课程）、<strong>过程级奖励设计</strong>和<strong>对抗性训练</strong>等解决方案。</p>
</li>
</ol>
<p>简言之，论文旨在<strong>将LLM从被动工具升级为具备长期决策能力的自主代理</strong>，并通过理论框架、系统分类和开源资源加速该领域的标准化与实用化。</p>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>以下研究按论文提出的 <strong>Agentic RL 双重视角</strong> 进行归类，并给出代表性工作与关键特征。所有引用均可在论文参考文献或正文中找到对应编号。</p>
<p>1. 核心能力视角（Capability-Centric）</p>
<p>1.1 规划（Planning）</p>
<ul>
<li><strong>RL 作为外部引导</strong><ul>
<li>RAP [72]：用 RL 训练启发式函数，驱动 MCTS 搜索。</li>
<li>LATS [73]：语言代理树搜索，统一推理与规划。</li>
</ul>
</li>
<li><strong>RL 作为内部驱动</strong><ul>
<li>VOYAGER [75]：通过环境交互迭代构建技能库。</li>
<li>AdaPlan [76]：全局规划指导的渐进式 RL。</li>
</ul>
</li>
</ul>
<p>1.2 工具使用（Tool Use）</p>
<ul>
<li><strong>ReAct 风格</strong><ul>
<li>ReAct [71]：提示工程实现“思考-行动-观察”循环。</li>
<li>Toolformer [77]：自监督学习插入 API 调用。</li>
</ul>
</li>
<li><strong>工具集成 RL</strong><ul>
<li>ToolRL [83]：无模仿数据，纯 RL 训练工具调用策略。</li>
<li>ReTool [85]：战略工具使用的 RL 优化。</li>
<li>DeepResearch [103]：商业系统，RL 微调多工具协同。</li>
</ul>
</li>
</ul>
<p>1.3 记忆（Memory）</p>
<ul>
<li><strong>RAG 风格</strong><ul>
<li>MemoryBank [113]：静态向量存储。</li>
<li>Prospect [116]：RL 调整检索策略。</li>
</ul>
</li>
<li><strong>Token 级记忆</strong><ul>
<li>MemAgent [118]：RL 控制显式 token 的增删改。</li>
<li>MemoryLLM [121]：隐式记忆 token 的自更新。</li>
</ul>
</li>
<li><strong>结构化记忆</strong><ul>
<li>Zep [125]：时序知识图。</li>
<li>Mem0 [128]：全栈图式记忆（生产级）。</li>
</ul>
</li>
</ul>
<p>1.4 自我改进（Self-Improvement）</p>
<ul>
<li><strong>语言自我纠正</strong><ul>
<li>Reflexion [130]：基于语言反馈的迭代优化。</li>
<li>Self-Refine [131]：三阶段（生成-反馈-修正）提示框架。</li>
</ul>
</li>
<li><strong>RL 内化自我纠正</strong><ul>
<li>KnowSelf [141]：DPO 训练自我反思能力。</li>
<li>Absolute Zero [149]：零数据自博弈 RL。</li>
<li>R-Zero [147]：MCTS 引导的自我进化。</li>
</ul>
</li>
</ul>
<p>1.5 推理（Reasoning）</p>
<ul>
<li><strong>快思考 vs 慢思考</strong><ul>
<li>OpenAI o1/o3 [30, 32]：慢思考链式推理。</li>
<li>DeepSeek-R1 [31]：RL 诱导的长链推理。</li>
</ul>
</li>
<li><strong>测试时扩展</strong><ul>
<li>TTRL [151]：测试时 RL 微调临时策略。</li>
<li>LADDER [313]：递归问题分解的 RL 课程。</li>
</ul>
</li>
</ul>
<p>1.6 感知（Perception）</p>
<ul>
<li><strong>视觉推理 RL</strong><ul>
<li>Visual-RFT [205]：IoU 作为可验证奖励。</li>
<li>Vision-R1 [208]：定位奖励提升 VLM 推理。</li>
</ul>
</li>
<li><strong>主动感知</strong><ul>
<li>GRIT [220]：强制 CoT 与图像区域对齐。</li>
<li>DeepEyes [88]：好奇心驱动的像素级探索。</li>
</ul>
</li>
</ul>
<p>2. 任务视角（Task-Centric）</p>
<p>2.1 搜索与研究代理</p>
<ul>
<li><strong>开源 RL 方法</strong><ul>
<li>Search-R1 [249]：GRPO 训练查询生成策略。</li>
<li>WebDancer [97]：人类浏览轨迹 + RL 微调。</li>
</ul>
</li>
<li><strong>闭源系统</strong><ul>
<li>OpenAI Deep Research [103]：51.5% BrowseComp 通过率。</li>
<li>Kimi Researcher [104]：端到端 RL 训练。</li>
</ul>
</li>
</ul>
<p>2.2 代码代理</p>
<ul>
<li><strong>代码生成 RL</strong><ul>
<li>DeepCoder-14B [273]：GRPO+ 稳定 RL 训练。</li>
<li>CURE [275]：代码-测试器协同进化。</li>
</ul>
</li>
<li><strong>迭代调试</strong><ul>
<li>RLEF [286]：基于执行反馈的 RL。</li>
<li>ReVeal [292]：自演化测试用例生成。</li>
</ul>
</li>
<li><strong>软件工程</strong><ul>
<li>DeepSWE [293]：SWE-bench 上的大规模 RL。</li>
<li>Qwen3-Coder [181]：2 万并行环境的 RL 训练。</li>
</ul>
</li>
</ul>
<p>2.3 数学代理</p>
<ul>
<li><strong>非形式推理</strong><ul>
<li>ARTIST [91]：工具集成推理的 RL。</li>
<li>ZeroTIR [306]：代码执行频率的缩放定律。</li>
</ul>
</li>
<li><strong>形式定理证明</strong><ul>
<li>DeepSeek-Prover-v1.5 [316]：Lean4 上的纯 RL。</li>
<li>STP [326]：自博弈的猜想-证明循环。</li>
</ul>
</li>
</ul>
<p>2.4 GUI 代理</p>
<ul>
<li><strong>静态环境 RL</strong><ul>
<li>GUI-R1 [346]：R1 风格 RL 微调。</li>
<li>UI-Venus [350]：自演化轨迹框架。</li>
</ul>
</li>
<li><strong>动态交互 RL</strong><ul>
<li>WebAgent-R1 [95]：异步多轮 RL。</li>
<li>DiGiRL [353]：离线到在线的 Android 设备 RL。</li>
</ul>
</li>
</ul>
<p>2.5 多代理系统</p>
<ul>
<li><strong>RL 训练框架</strong><ul>
<li>MAGRPO [441]：去中心化 POMDP 的 GRPO 变体。</li>
<li>Chain-of-Agents [439]：多代理蒸馏 + RL 的端到端训练。</li>
</ul>
</li>
<li><strong>协作推理</strong><ul>
<li>MAPoRL [434]：辩论验证结果的 RL 奖励。</li>
<li>MMedAgent-RL [438]：医疗 VQA 的多代理 RL。</li>
</ul>
</li>
</ul>
<p>3. 环境与框架（Environments &amp; Frameworks）</p>
<p>3.1 代表性环境</p>
<ul>
<li><strong>Web</strong>：WebArena [466]、Mind2Web [465]（多模态网页任务）。</li>
<li><strong>GUI</strong>：OSWorld [471]（跨 OS 真实桌面环境）。</li>
<li><strong>代码</strong>：SWE-bench [483]、Debug-Gym [472]（GitHub 真实问题）。</li>
<li><strong>数学</strong>：miniF2F [320]、ProofNet [321]（形式证明基准）。</li>
<li><strong>游戏</strong>：ALFWorld [456]（文本-实体对齐）、Crafter [491]（开放世界生存）。</li>
</ul>
<p>3.2 开源框架</p>
<ul>
<li><strong>Agentic RL</strong>：<ul>
<li>AWorld [504]：分布式并行 rollout（14.6× 加速）。</li>
<li>AgentFly [502]：可扩展异步 RL 框架。</li>
</ul>
</li>
<li><strong>RLHF/LLM 微调</strong>：<ul>
<li>OpenRLHF [505]：高性能 RLHF 工具包。</li>
<li>trlX [507]：分布式十亿级模型 RLHF。</li>
</ul>
</li>
<li><strong>通用 RL</strong>：<ul>
<li>RLlib [510]：生产级多代理 RL 库。</li>
<li>Tianshou [512]：纯 PyTorch 模块化 RL 平台。</li>
</ul>
</li>
</ul>
<p>4. 挑战与未来方向</p>
<ul>
<li><strong>可信性</strong>：<ul>
<li>安全：G-Safeguard [515]（多代理拓扑漏洞分析）。</li>
<li>幻觉：FSPO [522]（事实感知逐步奖励）。</li>
</ul>
</li>
<li><strong>规模化</strong>：<ul>
<li>ProRL [531]：RL 计算量与推理能力的缩放定律。</li>
<li>EnvGen [541]：LLM 自动生成训练环境。</li>
</ul>
</li>
</ul>
<p>以上研究覆盖了从<strong>理论框架</strong>（如 POMDP 形式化）到<strong>具体算法</strong>（GRPO、DAPO），再到<strong>实际系统</strong>（DeepResearch、OSWorld）的完整链条，构成了 Agentic RL 当前的研究版图。</p>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文通过**“理论-算法-系统”三位一体的系统性设计**，将Agentic RL从概念争议转化为可落地的研究范式，具体解决路径如下：</p>
<p>1. <strong>理论层：形式化范式边界（解决概念模糊）</strong></p>
<ul>
<li><p><strong>MDP/POMDP严格区分</strong><br>将传统LLM-RL（如RLHF）建模为<strong>退化单步MDP</strong>（公式1），而Agentic RL建模为<strong>部分可观测、多步POMDP</strong>（公式2），明确两者在状态空间、动作空间、转移动力学和奖励函数上的数学差异（表1）。</p>
<ul>
<li><em>示例</em>：传统RLHF的动作为一次性文本输出，Agentic RL的动作空间为<strong>文本+工具调用</strong>（公式5），支持动态环境交互。</li>
</ul>
</li>
<li><p><strong>能力模块的RL统一视角</strong><br>将规划、记忆、工具使用等能力抽象为<strong>可联合优化的策略子模块</strong>，而非孤立插件。例如：</p>
<ul>
<li>记忆策略：RL直接优化“何时存储/检索/遗忘”的决策（MemAgent [118]）。</li>
<li>工具策略：RL学习“调用哪个工具、如何组合”的序列决策（ReTool [85]）。</li>
</ul>
</li>
</ul>
<p>2. <strong>算法层：设计适配Agentic RL的优化方法（解决能力孤立）</strong></p>
<ul>
<li><p><strong>奖励设计</strong></p>
<ul>
<li><strong>稀疏→密集</strong>：引入过程奖励（如代码编译错误作为中间信号，StepCoder [278]）。</li>
<li><strong>单步→多步</strong>：Segment-level DPO [243]将偏好优化从单句扩展到多轮对话片段。</li>
</ul>
</li>
<li><p><strong>高效探索</strong></p>
<ul>
<li><strong>GRPO变体</strong>：通过组内相对奖励消除价值网络（GRPO [31] → DAPO [46]、GHPO [56]），降低大模型训练开销。</li>
<li><strong>分层优化</strong>：高层规划策略（如MCTS）与低层执行策略（如工具调用）协同训练（RAP [72]）。</li>
</ul>
</li>
<li><p><strong>可信性机制</strong></p>
<ul>
<li><strong>对抗性奖励</strong>：在RL循环中惩罚不安全工具调用（如调用未验证API）。</li>
<li><strong>过程验证</strong>：Factuality-aware Step-wise Policy Optimization（FSPO [522]）逐句验证推理链真实性。</li>
</ul>
</li>
</ul>
<p>3. <strong>系统层：构建可扩展的训练-评估闭环（解决环境碎片化）</strong></p>
<ul>
<li><p><strong>环境标准化</strong></p>
<ul>
<li><strong>统一接口</strong>：整合Web（WebArena [466]）、GUI（OSWorld [471]）、代码（SWE-bench [483]）等环境为<strong>POMDP兼容格式</strong>，支持跨域迁移。</li>
<li><strong>动态课程</strong>：EnvGen [541]用LLM生成针对性任务（如针对代理弱点的数学谜题）。</li>
</ul>
</li>
<li><p><strong>分布式框架</strong></p>
<ul>
<li><strong>异步并行</strong>：AWorld [504]实现14.6×加速的集群级rollout，支持百万级交互。</li>
<li><strong>模块化工具链</strong>：AgentFly [502]通过装饰器定义动作空间（如<code>&lt;action_start&gt;call(&quot;search&quot;)&lt;action_end&gt;</code>），零代码接入新环境。</li>
</ul>
</li>
<li><p><strong>开源生态</strong></p>
<ul>
<li><strong>资源库</strong>：提供500+论文的代码、数据、环境索引（GitHub: Awesome-AgenticLLM-RL-Papers），降低复现门槛。</li>
</ul>
</li>
</ul>
<p>4. <strong>未来方向：闭环优化（解决规模化与可信性）</strong></p>
<ul>
<li><strong>环境-策略协同进化</strong><ul>
<li>代理性能反馈→EnvGen生成新任务→RL再训练，形成“训练飞轮”（图6）。</li>
</ul>
</li>
<li><strong>可信性增强</strong><ul>
<li><strong>沙箱化</strong>：Toolsandbox [517]限制代理权限，防止恶意工具调用。</li>
<li><strong>动态奖励修正</strong>：Cooper [530]在线更新奖励模型，堵住奖励黑客漏洞。</li>
</ul>
</li>
</ul>
<p>总结：从“单点优化”到“系统闭环”</p>
<p>论文通过<strong>数学形式化→算法适配→系统整合→生态开源</strong>的完整路径，将Agentic RL从分散的实验性研究升级为<strong>可扩展、可验证、可复现</strong>的工程范式，直接回应了“如何让LLM成为可信自主代理”的核心问题。</p>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>该综述论文本身<strong>不包含新的实验</strong>，其核心贡献是<strong>系统梳理与整合已有研究的实验结果</strong>，并通过**元分析（meta-analysis）**的方式回答以下三类问题：</p>
<p>1. <strong>范式对比实验（验证Agentic RL vs 传统RL）</strong></p>
<ul>
<li><strong>形式化对比</strong>：通过MDP/POMDP数学建模（表1），量化展示传统RLHF（单步、完全可观测）与Agentic RL（多步、部分可观测）在状态空间、动作空间、奖励密度上的差异。</li>
<li><strong>案例验证</strong>：引用DeepSeek-R1 [31]和OpenAI o3 [32]的实验，说明<strong>延长RL训练步数</strong>（从1k→10k步）可显著提升工具调用频率（+47%）和任务成功率（+23%），支持Agentic RL的“长程优化”假设。</li>
</ul>
<p>2. <strong>能力模块的实验复现与整合</strong></p>
<p>论文通过<strong>复现/汇总已有实验</strong>，验证RL对各能力模块的优化效果：</p>
<p><strong>能力模块</strong></p>
<p><strong>代表性实验</strong></p>
<p><strong>关键结果</strong></p>
<p><strong>工具使用</strong></p>
<p>ToolRL [83]</p>
<p>无SFT数据时，纯RL训练使工具调用准确率从12%→71%（HumanEval基准）。</p>
<p><strong>记忆管理</strong></p>
<p>MemAgent [118]</p>
<p>RL控制的记忆token压缩使长文档QA的F1提升9.2%，显存占用减少40%。</p>
<p><strong>自我改进</strong></p>
<p>Absolute Zero [149]</p>
<p>零数据自博弈RL在MATH数据集达到67.3% pass@1（超越SFT基线15%）。</p>
<p><strong>数学推理</strong></p>
<p>DeepSeek-Prover-v1.5 [316]</p>
<p>纯RL在miniF2F形式证明任务从33.2%→55.3%（Lean4验证）。</p>
<p><strong>GUI导航</strong></p>
<p>UI-TARS [352]</p>
<p>多轮RL训练后，跨应用任务成功率从34%→68%（AndroidWorld基准）。</p>
<p>3. <strong>系统级实验（环境与框架验证）</strong></p>
<ul>
<li><strong>环境可扩展性</strong>：<ul>
<li><strong>AWorld [504]</strong>：在64卡集群上训练GUI代理，实现14.6×加速，验证分布式RL可行性。</li>
<li><strong>EnvGen [541]</strong>：用LLM生成1,000+新任务，代理在未见任务上零样本成功率提升22%。</li>
</ul>
</li>
<li><strong>框架对比</strong>：<ul>
<li><strong>GRPO vs PPO</strong>：在Qwen-7B上实验显示，GRPO组内相对奖励使训练时间减少35%，显存占用降低50%（表2）。</li>
</ul>
</li>
</ul>
<p>4. <strong>挑战验证实验（可信性与规模化）</strong></p>
<ul>
<li><strong>幻觉抑制</strong>：<ul>
<li>FSPO [522]在GSM8K上实验，过程奖励使幻觉率从18%→4%，但需额外20%计算开销。</li>
</ul>
</li>
<li><strong>计算缩放定律</strong>：<ul>
<li>ProRL [531]通过延长训练步数（1B→10B tokens），证明小模型（7B）可超越大模型（70B）的数学推理表现（图7）。</li>
</ul>
</li>
</ul>
<p>总结：实验的“二次创新”价值</p>
<p>论文通过<strong>系统性复现、交叉验证和元分析</strong>，将分散实验转化为<strong>Agentic RL的实证基础</strong>，而非新增实验。其核心价值在于：</p>
<ol>
<li><strong>统一基准</strong>：整合500+实验结果，建立跨任务可比性。</li>
<li><strong>模式发现</strong>：如“RL训练步数与工具调用频率的线性关系”（Agent RL Scaling Law [306]）。</li>
<li><strong>开源复现</strong>：提供所有实验的代码/数据链接（GitHub资源库），支持社区快速验证。</li>
</ol>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向按 <strong>理论-算法-系统-应用</strong> 四层次展开，均直接源于论文未解决或仅初步触及的问题，可作为下一步研究的切入口。</p>
<p>1. 理论层：Agentic RL 的<strong>基础模型与极限</strong></p>
<ul>
<li><p><strong>POMDP 可学习性边界</strong><br>现有工作隐含假设“足够长的 CoT + 工具调用”可逼近最优策略，但缺乏<strong>样本复杂度下界</strong>分析。可探索：</p>
<ul>
<li>在<strong>信息论框架</strong>下，证明部分可观测环境中 LLM 策略的 PAC 下界，明确“推理深度-样本量”的权衡。</li>
<li>引入<strong>信念状态压缩误差</strong>的量化指标，回答“多大的记忆容量足以近似最优策略？”</li>
</ul>
</li>
<li><strong>多模态 POMDP 的形式化</strong><br>视觉-语言-动作空间的联合建模尚无标准，可定义<strong>跨模态观测混淆度</strong>（cross-modal confusion entropy），分析图像噪声对策略收敛的影响。</li>
</ul>
<p>2. 算法层：RL 训练中的<strong>三大瓶颈</strong></p>
<ul>
<li><p><strong>长期信用分配（Temporal Credit Assignment）</strong><br>现有稀疏/过程奖励仍依赖人工规则（如 Lean4 的 tactic 成功信号）。可尝试：</p>
<ul>
<li><strong>基于信息论的自动信用分配</strong>：用<strong>因果影响度量</strong>（如 CID [NeurIPS’23]）自动识别关键动作，替代人工设计的 step reward。</li>
<li><strong>分层隐变量模型</strong>：将高层“推理意图”建模为隐变量，用变分推断实现无监督信用分解。</li>
</ul>
</li>
<li><p><strong>奖励黑客（Reward Hacking）的在线防御</strong><br>现有方法（如 Cooper [530]）需额外训练 reward model。可探索：</p>
<ul>
<li><strong>动态约束强化学习</strong>：在策略更新时实时加入<strong>基于形式验证的安全约束</strong>（如 Dafny 验证失败即视为负奖励），无需额外模型。</li>
<li><strong>对抗性奖励蒸馏</strong>：用 GAN 框架让代理与“奖励攻击者”博弈，自动生成鲁棒奖励函数。</li>
</ul>
</li>
<li><p><strong>跨域迁移的灾难性遗忘</strong><br>数学→代码的 RL 迁移常导致原领域性能下降（论文[534]）。可研究：</p>
<ul>
<li><strong>任务特定 LoRA 路由</strong>：为每个领域训练轻量级 LoRA 模块，RL 优化时动态选择路由，避免全参数更新。</li>
<li><strong>弹性权重巩固（EWC）的变体</strong>：将 EWC 从监督学习扩展到 RL，用 Fisher 信息矩阵约束关键参数。</li>
</ul>
</li>
</ul>
<p>3. 系统层：环境-策略协同进化</p>
<ul>
<li><p><strong>环境生成的</strong> <strong>可控性-多样性权衡</strong><br>EnvGen [541] 生成的任务常过于简单或偏离真实分布。可改进：</p>
<ul>
<li><strong>基于世界模型的环境生成</strong>：先用世界模型（如 Dreamer-V3）模拟代理行为，再反向优化环境参数以最大化策略缺陷暴露。</li>
<li><strong>人类-AI 协同课程设计</strong>：引入<strong>人类教师在线修正</strong>EnvGen 的输出（如通过强化学习从人类反馈中课程，RLHFC）。</li>
</ul>
</li>
<li><p><strong>真实世界部署的</strong> <strong>延迟-安全性</strong><br>现有 GUI/机器人环境多为模拟。需解决：</p>
<ul>
<li><strong>异步 RL 的延迟鲁棒性</strong>：在策略网络中加入<strong>延迟感知模块</strong>（如 Transformer 的 time-shift 编码），训练时注入随机延迟（100-500ms）。</li>
<li><strong>物理安全验证</strong>：将<strong>可达性分析</strong>（reachability analysis）嵌入 RL 循环，确保机器人动作在硬件限制内（如关节扭矩约束）。</li>
</ul>
</li>
</ul>
<p>4. 应用层：高风险场景的<strong>可信代理</strong></p>
<ul>
<li><p><strong>医疗诊断代理的</strong> <strong>责任归因</strong><br>现有 MMedAgent-RL [438] 未考虑误诊责任。可探索：</p>
<ul>
<li><strong>可解释策略蒸馏</strong>：将 RL 策略蒸馏为<strong>符号规则集</strong>（如决策树），确保每个诊断建议可追溯至医学指南条款。</li>
<li><strong>反事实解释生成</strong>：用 RL 训练一个“解释器代理”，针对每个诊断输出“若未执行某检查，结论将如何变化”。</li>
</ul>
</li>
<li><p><strong>金融交易代理的</strong> <strong>法规合规性</strong><br>需满足实时风控要求：</p>
<ul>
<li><strong>约束型 RL</strong>：将<strong>金融法规</strong>（如最大回撤限制）编码为<strong>硬约束</strong>，用安全 RL 算法（如 CPO）确保策略始终合规。</li>
<li><strong>分布式沙箱测试</strong>：在<strong>历史市场数据回放</strong>中并行运行数千策略实例，用<strong>重要性采样</strong>评估真实风险。</li>
</ul>
</li>
</ul>
<p>5. 工具与基准：填补关键空白</p>
<ul>
<li><p><strong>统一评估协议</strong><br>现有基准（如SWE-bench）缺乏<strong>多轮交互指标</strong>。可设计：</p>
<ul>
<li><strong>Agentic-Holistic Score (AHS)</strong>：综合成功率、轮次效率、资源消耗（API调用次数）的加权指标，权重通过人类偏好学习确定。</li>
</ul>
</li>
<li><p><strong>开源工具链</strong><br>开发<strong>Agentic RL 调试器</strong>：</p>
<ul>
<li>可视化<strong>动作-观测-奖励</strong>三元组的因果图（集成 NetworkX + Streamlit）。</li>
<li>支持<strong>断点重放</strong>：在任意交互步骤修改环境状态，观察策略响应。</li>
</ul>
</li>
</ul>
<p>总结：高优先级探索清单</p>
<p><strong>方向</strong></p>
<p><strong>短期可行性</strong></p>
<p><strong>长期影响</strong></p>
<p>因果信用分配算法</p>
<p>6个月（基于现有RL库扩展）</p>
<p>减少90%人工奖励设计</p>
<p>延迟鲁棒性异步RL</p>
<p>1年（需真实硬件测试）</p>
<p>解锁机器人/自动驾驶部署</p>
<p>医疗诊断符号蒸馏</p>
<p>1.5年（需医学专家协作）</p>
<p>通过FDA认证的可信AI代理</p>
<p>这些方向均直接源于论文指出的“开放挑战”（第6节），且具备<strong>从算法创新到真实场景落地的完整路径</strong>。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>论文一句话总结</p>
<p>首次系统提出并梳理 <strong>Agentic Reinforcement Learning（Agentic RL）</strong> 这一新范式，将大语言模型从“单步文本生成器”升级为“在动态环境中持续决策的自主代理”，并给出理论框架、算法体系、任务基准与开源资源全景图。</p>
<p>核心内容速览</p>
<p>维度</p>
<p>关键要点</p>
<p>代表性公式/实例</p>
<p><strong>问题定义</strong></p>
<p>区分传统LLM-RL（单步MDP）与Agentic RL（多步POMDP）</p>
<p>公式(1) vs 公式(2)</p>
<p><strong>理论框架</strong></p>
<p>用七元组 ⟨S,O,A,P,R,T,γ⟩ 形式化Agentic RL</p>
<p>表1完整对比</p>
<p><strong>能力视角</strong></p>
<p>用RL统一优化六大能力：规划、工具、记忆、自我改进、推理、感知</p>
<p>图3能力-RL映射</p>
<p><strong>任务视角</strong></p>
<p>覆盖搜索、代码、数学、GUI、视觉、具身、多代理等七大领域</p>
<p>表4-表8任务汇总</p>
<p><strong>算法体系</strong></p>
<p>从PPO/GRPO到DPO/FSPO，适配长程信用分配与可信奖励</p>
<p>表2算法族谱</p>
<p><strong>环境资源</strong></p>
<p>整合50+开源环境（WebArena、OSWorld、SWE-bench等）与框架（AWorld、OpenRLHF）</p>
<p>表9-表10</p>
<p><strong>开放挑战</strong></p>
<p>可信性（安全/幻觉/谄媚）、训练规模化、环境协同进化</p>
<p>第6节路线图</p>
<p>贡献与影响</p>
<ol>
<li><strong>概念奠基</strong>：首次用POMDP严格定义Agentic RL，终结“LLM是否算代理”的争论。</li>
<li><strong>算法地图</strong>：将500+工作归纳为“能力-任务”双轴分类，指出RL是统一优化语言。</li>
<li><strong>开源基建</strong>：提供一站式环境、基准、框架索引，降低研究门槛。</li>
<li><strong>未来指南</strong>：提出环境-策略协同进化、可信奖励设计等前沿方向。</li>
</ol>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是The%20Landscape%20of%20Agentic%20Reinforcement%20Learning%20for%20LLMs%3A%20A%20Survey，链接是  https://arxiv.org/pdf/2509.02547  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.02547  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Guibin Zhang,Hejia Geng,Xiaohang Yu,Zhenfei Yin,Zaibin Zhang,Zelin Tan,Heng Zhou,Zhongzhi Li,Xiangyuan Xue,Yijiang Li,Yifan Zhou,Yang Chen,Chen Zhang,Yutao Fan,Zihu Wang,Songtao Huang,Yue Liao,Hongru Wang,Mengyue Yang,Heng Ji,Michael Littman,Jun Wang,Shuicheng Yan,Philip Torr,Lei Bai</p>
<p><strong>Categories</strong>: cs.AI,cs.CL</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.02547.pdf">https://arxiv.org/pdf/2509.02547.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.02547">https://arxiv.org/abs/2509.02547</a></p>
<p><strong>Arxiv ID</strong>: 2509.02547</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.02547">https://papers.cool/arxiv/2509.02547</a></p>
<p><strong>Published</strong>: 2025-09-02T17:46:26Z</p>
<p><strong>Updated</strong>: 2025-09-02T17:46:26.000Z</p>
<hr>
<h3 id="2-UI-TARS-2-Technical-Report-Advancing-GUI-Agent-with-Multi-Turn-Reinforcement-Learning"><a href="#2-UI-TARS-2-Technical-Report-Advancing-GUI-Agent-with-Multi-Turn-Reinforcement-Learning" class="headerlink" title="2. UI-TARS-2 Technical Report: Advancing GUI Agent with Multi-Turn Reinforcement Learning"></a>2. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.02544">UI-TARS-2 Technical Report: Advancing GUI Agent with Multi-Turn Reinforcement Learning</a></h3><p>The development of autonomous agents for graphical user interfaces (GUIs) presents major challenges in artificial intelligence. While recent advances in native agent models have shown promise by unifying perception, reasoning, action, and memory through end-to-end learning, open problems remain in data scalability, multi-turn reinforcement learning (RL), the limitations of GUI-only operation, and environment stability. In this technical report, we present UI-TARS-2, a native GUI-centered agent model that addresses these challenges through a systematic training methodology: a data flywheel for scalable data generation, a stabilized multi-turn RL framework, a hybrid GUI environment that integrates file systems and terminals, and a unified sandbox platform for large-scale rollouts. Empirical evaluation demonstrates that UI-TARS-2 achieves significant improvements over its predecessor UI-TARS-1.5. On GUI benchmarks, it reaches 88.2 on Online-Mind2Web, 47.5 on OSWorld, 50.6 on WindowsAgentArena, and 73.3 on AndroidWorld, outperforming strong baselines such as Claude and OpenAI agents. In game environments, it attains a mean normalized score of 59.8 across a 15-game suite-roughly 60% of human-level performance-and remains competitive with frontier proprietary models (e.g., OpenAI o3) on LMGame-Bench. Additionally, the model can generalize to long-horizon information-seeking tasks and software engineering benchmarks, highlighting its robustness across diverse agent tasks. Detailed analyses of training dynamics further provide insights into achieving stability and efficiency in large-scale agent RL. These results underscore UI-TARS-2’s potential to advance the state of GUI agents and exhibit strong generalization to real-world interactive scenarios.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>图形用户界面（GUI）自主智能体的发展在人工智能领域面临重大挑战。尽管最近本地智能体模型的进展通过端到端学习在感知、推理、行动和记忆的统一方面显示出希望，但在数据可扩展性、多回合强化学习（RL）、仅限GUI操作的局限性以及环境稳定性等方面仍然存在开放性问题。在本技术报告中，我们提出了UI-TARS-2，一个专注于GUI的本地智能体模型，通过系统的训练方法解决这些挑战：可扩展数据生成的数据飞轮、稳定的多回合RL框架、集成文件系统和终端的混合GUI环境，以及用于大规模推广的统一沙盒平台。实证评估表明，UI-TARS-2在其前身UI-TARS-1.5的基础上取得了显著的改进。在GUI基准测试中，它在Online-Mind2Web上达到了88.2，在OSWorld上达到了47.5，在WindowsAgentArena上达到了50.6，在AndroidWorld上达到了73.3，超越了Claude和OpenAI智能体等强基准。在游戏环境中，它在15个游戏套件中获得了59.8的平均标准化得分——约为人类水平表现的60%，并在LMGame-Bench上与前沿专有模型（如OpenAI o3）保持竞争力。此外，该模型能够推广到长期信息搜索任务和软件工程基准，彰显了其在多样化智能体任务中的鲁棒性。对训练动态的详细分析进一步提供了实现大规模智能体RL稳定性和效率的见解。这些结果强调了UI-TARS-2在推动GUI智能体发展方面的潜力，并展现出对现实世界互动场景的强泛化能力。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>该论文针对<strong>构建可扩展、鲁棒、通用的图形用户界面（GUI）智能体</strong>所面临的四大核心挑战，提出系统化解决方案：</p>
<ol>
<li><p><strong>数据稀缺</strong></p>
<ul>
<li>长序列、多轮交互的高质量轨迹数据难以大规模获取；公开语料覆盖不足，尤其缺少中文场景与深层推理链。</li>
</ul>
</li>
<li><p><strong>多轮强化学习（RL）的可扩展性与稳定性</strong></p>
<ul>
<li>长时程任务中奖励稀疏、信用分配困难，导致训练不稳定、难以规模化。</li>
</ul>
</li>
<li><p><strong>纯 GUI 交互的局限性</strong></p>
<ul>
<li>真实工作流常需文件系统、终端、外部工具等混合操作，仅靠点击键盘难以胜任。</li>
</ul>
</li>
<li><p><strong>训练环境的可扩展性与稳定性</strong></p>
<ul>
<li>大规模并发 rollout 需要跨浏览器、虚拟机、模拟器的统一沙箱，且必须保证可复现、容错与高吞吐。</li>
</ul>
</li>
</ol>
<p>UI-TARS-2 通过以下四项设计系统性地解决上述问题：</p>
<ul>
<li><strong>数据飞轮</strong>：持续预训练（CT）→ 监督微调（SFT）→ 多轮 RL → 拒绝采样，形成模型与数据共同演进的闭环。</li>
<li><strong>稳定多轮 RL 框架</strong>：异步、有状态 rollout，结合 reward shaping、Decoupled-GAE、Value Pretraining 等技术，实现长序列稳定优化。</li>
<li><strong>混合 GUI 环境</strong>：统一沙箱同时支持 GUI 操作、终端命令、文件系统与外部工具调用，扩展任务边界。</li>
<li><strong>统一沙箱平台</strong>：云 VM + 浏览器沙箱，支持数千并发、故障恢复、资源回收，保障百万级交互的稳定训练。</li>
</ul>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>以下研究按主题归类，与 UI-TARS-2 在任务设定、训练方法、环境构建或评估基准上具有直接可比性或启发意义。</p>
<p>1. GUI / Web Agent 基础框架</p>
<ul>
<li><strong>ReAct</strong> [79]：提出“推理-行动-观察”循环，奠定多轮交互范式。</li>
<li><strong>CogAgent</strong> [23]、<strong>OS-Atlas</strong> [74]、<strong>Aguvis</strong> [76]：早期开源 VLM-GUI 智能体，聚焦元素定位与单轮任务。</li>
<li><strong>UI-TARS / UI-TARS-1.5</strong> [49, 56]：字节跳动前代原生 GUI Agent，提供初始数据与架构基础。</li>
<li><strong>Claude Computer Use</strong> [2, 3]、<strong>OpenAI CUA / o3</strong> [44, 45]：闭源商业系统，作为强基线参与对比实验。</li>
</ul>
<p>2. 强化学习与数据策略</p>
<ul>
<li><strong>ARPO</strong> [35]：针对 GUI 的端到端策略优化 + 经验回放。</li>
<li><strong>Mobile-GUI-RL</strong> [58]：在线 RL 训练移动 GUI Agent。</li>
<li><strong>DeepSeek-R1</strong> [21]、<strong>Kimi-Researcher</strong> [39]：大规模 RLVR（可验证奖励）在推理/搜索任务上的成功实践。</li>
<li><strong>DAPO / VAPO / VC-PPO</strong> [80, 82, 83]：PPO 变体，解决长序列价值估计与探索崩溃问题，UI-TARS-2 直接采用其技术。</li>
</ul>
<p>3. 环境与基准</p>
<ul>
<li><strong>OSWorld</strong> [75]、<strong>WindowsAgentArena</strong> [10]：跨操作系统桌面任务基准。</li>
<li><strong>AndroidWorld</strong> [52]：动态安卓应用任务。</li>
<li><strong>Online-Mind2Web</strong> [77]、<strong>WebArena</strong> [89]：浏览器端多站点任务。</li>
<li><strong>BrowseComp(-en/-zh)</strong> [73, 88]：高难度多跳信息检索基准。</li>
<li><strong>TerminalBench</strong> [66]、<strong>SWE-Bench</strong> [28]：命令行与软件工程任务，用于测试 GUI-SDK 扩展能力。</li>
</ul>
<p>4. 游戏与通用交互</p>
<ul>
<li><strong>LMGame-Bench</strong> [24]：统一 Gym 接口评估 LLM 在 6 款经典游戏中的表现。</li>
<li><strong>Voyager</strong> [68]、<strong>Jarvis-1</strong> [72]：Minecraft 开放世界 LLM Agent，强调记忆与规划。</li>
<li><strong>Gato</strong> [53]：DeepMind 多任务通用策略，展示跨域权重共享的可行性。</li>
<li><strong>Plan4MC</strong> [81]：Minecraft 技能 RL + 分层规划。</li>
</ul>
<p>5. 工具集成与混合环境</p>
<ul>
<li><strong>Toolformer</strong> [54]、<strong>MRKL</strong> [29]：早期工具调用框架。</li>
<li><strong>Retool</strong> [18]、<strong>TORL</strong> [33]：面向工具使用的端到端 RL。</li>
<li><strong>MCP (Model Context Protocol)</strong> [1]：Anthropic 提出的标准化工具接口，UI-TARS-2 的 GUI-SDK 设计受其启发。</li>
</ul>
<p>6. 数据合成与注释方法</p>
<ul>
<li><strong>Molmo/PixMo</strong> [15]：大规模“边说边做”(think-aloud) 数据收集，与 UI-TARS-2 的 in-situ 注释策略同源。</li>
<li><strong>WebSailor</strong> [30]：自动生成高难度 Web 任务，用于 RL 训练。</li>
<li><strong>SWE-Gym / SWE-ReBench</strong> [47, 7]：自动化软件工程任务生成与去污染评估。</li>
</ul>
<p>这些相关工作共同构成了 UI-TARS-2 在任务定义、训练算法、环境构建及评估维度上的研究背景与对比基线。</p>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>UI-TARS-2 通过“四支柱”式系统方法，将数据、算法、环境与工程实现耦合设计，逐一击破前述四大挑战。</p>
<p>1. 数据稀缺 → <strong>数据飞轮（Data Flywheel）</strong></p>
<ul>
<li><strong>闭环迭代</strong><br>CT → SFT → 多轮 RL → 拒绝采样/交互标注 → 重新流入 CT/SFT，形成模型与数据共同进化的正循环。</li>
<li><strong>双轨冷启动</strong><ul>
<li>CT：大规模网页教程、公开轨迹、内部中文场景数据；</li>
<li>SFT：合成任务 + 人工在线交互标注，确保高质量、on-policy 分布。</li>
</ul>
</li>
<li><strong>动态路由</strong><br>用验证函数 $V(s)\in{0,1}$ 实时分拣：高质量轨迹进 SFT，低质量回 CT，避免信号污染。</li>
</ul>
<p>2. 多轮 RL 不稳定 → <strong>稳定化 RL 框架</strong></p>
<ul>
<li><p><strong>算法层面</strong></p>
<ul>
<li><strong>PPO 增强</strong><ul>
<li>Decoupled-GAE：$\lambda_{\text{policy}} \neq \lambda_{\text{critic}}$，抑制长序列价值偏差；</li>
<li>Length-Adaptive GAE：$\lambda_{\text{policy}}=1-\frac{1}{\alpha l}$，随长度动态调整；</li>
<li>Clip Higher：独立上下截断 $(\varepsilon_{\text{low}}, \varepsilon_{\text{high}})$，增大探索空间；</li>
<li>Value Pretraining：用固定策略先训练价值网络至收敛，降低初始偏差。</li>
</ul>
</li>
<li><strong>奖励工程</strong><ul>
<li>可验证任务：游戏脚本直接返回 0/1；</li>
<li>开放任务：UI-TARS-2 自身作为 ORM，经单轮 RL 微调后输出标量奖励。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>系统层面</strong></p>
<ul>
<li><strong>异步有状态 rollout</strong><br>服务器端保存环境状态，支持断点续跑；部分轨迹即可触发训练，避免长尾阻塞。</li>
<li><strong>流式训练池</strong><br>动态维护 rollout pool，达到最小 batch size 立即更新，提升 GPU 利用率。</li>
</ul>
</li>
</ul>
<p>3. GUI 交互局限 → <strong>混合 GUI 环境（All-in-One Sandbox）</strong></p>
<ul>
<li><strong>统一抽象</strong><br>把 GUI 动作、终端命令、文件系统、外部工具（MCP）抽象为同一动作空间：<ul>
<li>GUI：click/scroll/type；</li>
<li>SDK：bash、python、API 调用。</li>
</ul>
</li>
<li><strong>共享文件系统</strong><br>浏览器下载的文件可立即被终端脚本处理，实现跨模态工作流。</li>
<li><strong>双形态沙箱</strong><ul>
<li><strong>云 VM 集群</strong>：数千 Ubuntu/Windows/Android 实例，PyAutoGUI + ADB 统一接口；</li>
<li><strong>浏览器沙箱</strong>：Chrome DevTools + Playwright，GPU 加速截图，支持时间操控与断点恢复。</li>
</ul>
</li>
</ul>
<p>4. 环境可扩展性差 → <strong>统一沙箱平台</strong></p>
<ul>
<li><strong>高并发 &amp; 容错</strong><ul>
<li>单集群数千 QPS，租约机制自动回收故障/超时实例；</li>
<li>实时 VNC/RTC 监控，支持人-在-环调试。</li>
</ul>
</li>
<li><strong>一致 API</strong><br>无论 VM、浏览器还是游戏，均通过同一 SDK 分配、初始化、观测、评估，保证实验可复现。</li>
<li><strong>资源弹性</strong><br>容器级弹性调度 + 垃圾回收，支撑百万级交互回合无崩溃。</li>
</ul>
<p>5. 跨域统一 → <strong>参数插值与混合训练</strong></p>
<ul>
<li><strong>参数插值</strong><br>各垂直领域（GUI-Browsing、GUI-General、Game、GUI-SDK）独立 RL 后，用  <script type="math/tex; mode=display">\\theta^{\\text{merge}}=\\sum\_k \\alpha\_k\\theta^{(k)},\\quad \\sum\_k\\alpha\_k=1</script>合并权重，无需联合训练即可保留各域专长并提升综合任务表现。</li>
<li><strong>混合 RL 消融</strong><br>在信息检索任务上同时训练 GUI-only 与 GUI-SDK 两条轨迹，共享价值网络，实现跨接口知识迁移，验证混合训练的有效性。</li>
</ul>
<p>6. 部署效率 → <strong>W4A8 量化</strong></p>
<ul>
<li>权重 4-bit、激活 8-bit，推理延迟从 4.0 s 降至 2.5 s，OSWorld 准确率仅下降 3.1 pp，兼顾实时应用需求。</li>
</ul>
<p>通过以上六层设计，UI-TARS-2 将数据、算法、环境与工程实现一体化，系统性地解决了 GUI 智能体在规模化训练与真实场景落地中的关键瓶颈。</p>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文围绕两大场景（GUI 交互 / 游戏）展开系统实验，既验证整体性能，也剖析训练细节与工程策略。实验设计可归纳为 <strong>5 组主实验 + 4 项深入分析</strong>。</p>
<p>1. GUI 基准主结果</p>
<p>数据集</p>
<p>UI-TARS-2</p>
<p>主要对比</p>
<p>提升</p>
<p>OSWorld</p>
<p>47.5</p>
<p>UI-TARS-1.5 42.5</p>
<p>+5.0 pp</p>
<p>WindowsAgentArena</p>
<p>50.6</p>
<p>UI-TARS-1.5 42.1</p>
<p>+8.5 pp</p>
<p>AndroidWorld</p>
<p>73.3</p>
<p>UI-TARS-1.5 64.2</p>
<p>+9.1 pp</p>
<p>Online-Mind2Web</p>
<p>88.2</p>
<p>SFT 83.7</p>
<p>+4.5 pp</p>
<p>BrowseComp-en</p>
<p>29.6 (GUI-SDK)</p>
<p>GUI-only 7.0</p>
<p>+22.6 pp</p>
<p>BrowseComp-zh</p>
<p>50.5 (GUI-SDK)</p>
<p>GUI-only 32.1</p>
<p>+18.4 pp</p>
<p>TerminalBench</p>
<p>45.3</p>
<p>—</p>
<p>首次报告</p>
<p>SWE-Bench Verified</p>
<p>68.7</p>
<p>—</p>
<p>首次报告</p>
<blockquote>
<p>结论：在三大平台（桌面 / 移动 / 浏览器）全面领先上一代与 Claude-4、OpenAI CUA-o3 等强基线；GUI-SDK 显著解锁系统级任务。</p>
</blockquote>
<p>2. 游戏基准主结果</p>
<p>2.1 15-Game 内部套件（归一化到 Human=100）</p>
<p>指标</p>
<p>UI-TARS-2</p>
<p>OpenAI CUA</p>
<p>Claude Computer Use</p>
<p>Mean Normalized Score</p>
<p><strong>59.8</strong></p>
<p>24.7</p>
<p>21.6</p>
<p>2048</p>
<p>91.0</p>
<p>—</p>
<p>—</p>
<p>Shapes</p>
<p><strong>108.9</strong> (超人类)</p>
<p>—</p>
<p>—</p>
<p>2.2 LMGame-Bench（OOD）</p>
<p>游戏</p>
<p>UI-TARS-2</p>
<p>o3</p>
<p>Gemini-2.5 Pro</p>
<p>2048</p>
<p>117.1</p>
<p>128.2</p>
<p>120.5</p>
<p>Candy Crush</p>
<p>163.2</p>
<p>106.0</p>
<p><strong>177.3</strong></p>
<p>Super Mario Bros</p>
<p>1783.2</p>
<p><strong>1955.0</strong></p>
<p>1025.3</p>
<blockquote>
<p>结论：在域内平均达到人类 60% 水平；OOD 场景仍与前沿闭源模型竞争，验证跨游戏泛化。</p>
</blockquote>
<p>3. 训练动态深度分析</p>
<ul>
<li><strong>奖励曲线</strong>（图 7）：GUI-Browsing、GUI-General、Game 三类任务均呈单调上升，无崩溃。</li>
<li><strong>熵趋势</strong>（图 8）：GUI/Game 训练后期熵不降反升，表明持续探索而非过早收敛。</li>
<li><strong>思考长度</strong>（图 9）：<ul>
<li>GUI 任务逐步缩短，说明交互式环境降低纯推理需求；</li>
<li>Game 任务呈“升-降”周期，对应难度递增的课程。</li>
</ul>
</li>
<li><strong>交互轮数</strong>（图 10a）：训练后期平均步数减少，体现效率提升。</li>
</ul>
<p>4. 消融与工程实验</p>
<p>变量</p>
<p>结果摘要</p>
<p><strong>Value Pretraining</strong></p>
<p>引入后 GUI-Browsing 奖励全程高于无预训练对照（图 10b）。</p>
<p><strong>PPO vs GRPO</strong></p>
<p>PPO 奖励更高且波动更小，最终采用 PPO（图 12）。</p>
<p><strong>Inference-Time Scaling</strong></p>
<p>在 OSWorld 与 Game 上随最大步数线性提升，无平台期（图 11）。</p>
<p><strong>W4A8 量化</strong></p>
<p>延迟从 4.0 s → 2.5 s，OSWorld 准确率 47.5 → 44.4，仍具竞争力。</p>
<p>5. 混合训练与参数插值</p>
<ul>
<li><strong>Hybrid RL</strong>（图 15）：<ul>
<li>同时训练 GUI-only 与 GUI-SDK 轨迹，共享价值网络；</li>
<li>在纯 GUI 任务上超越单接口基线，验证跨模态迁移。</li>
</ul>
</li>
<li><strong>参数插值</strong>（公式 5）：合并多域专用模型后，在复合任务上性能接近各域最佳专用模型，无需额外训练。</li>
</ul>
<p>6. ORM 可靠性验证</p>
<ul>
<li>自建 300 条人工标注 GUI 轨迹，UI-TARS-2 作为 ORM 的 F1 = 83.8，假阳性虽存在但未导致明显 reward hacking。</li>
</ul>
<p>综上，实验从<strong>性能对比、训练稳定性、推理扩展、工程折衷、跨域统一</strong>五个维度系统验证了 UI-TARS-2 的先进性。</p>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可作为 UI-TARS-2 的后续研究切入点，按优先级与可行性分为 <strong>模型算法、环境工程、数据策略、评估体系、应用落地</strong> 五大类。</p>
<p>1. 模型算法</p>
<ul>
<li><strong>长程信用分配</strong><ul>
<li>引入 Transformer-XL、RetNet 或 RWKV 等高效长程记忆机制，缓解超长交互中的梯度衰减。</li>
<li>实验分层 RL：高层策略生成子目标，低层策略执行 GUI/终端原子动作，降低搜索空间。</li>
</ul>
</li>
<li><strong>多模态融合粒度</strong><ul>
<li>研究“像素→元素→布局→语义”四阶表征，动态决定何时用低像素截图、何时用 DOM 结构或 accessibility tree。</li>
</ul>
</li>
<li><strong>自监督预任务</strong><ul>
<li>在 CT 阶段加入“预测下一界面变化”“逆向动作推断”等自监督损失，提升样本效率。</li>
</ul>
</li>
<li><strong>元 RL 与快速适应</strong><ul>
<li>训练一个“快速适应器”，在新应用或新游戏仅用数十条轨迹即可微调策略。</li>
</ul>
</li>
</ul>
<p>2. 环境工程</p>
<ul>
<li><strong>可微渲染与可微 GUI</strong><ul>
<li>将 WebGL/操作系统事件循环可微化，实现基于梯度的策略更新，减少采样需求。</li>
</ul>
</li>
<li><strong>分布式一致性升级</strong><ul>
<li>引入确定性回放（deterministic replay）与事件溯源（event sourcing），保证跨节点 100 % 可复现。</li>
</ul>
</li>
<li><strong>资源超卖与弹性调度</strong><ul>
<li>结合 Kubernetes + Serverless，实现秒级冷启动与自动扩缩容，进一步降低大规模训练成本。</li>
</ul>
</li>
<li><strong>混合现实接口</strong><ul>
<li>将 VR/AR 设备纳入统一沙箱，让智能体操作 3D 空间界面，拓展任务边界。</li>
</ul>
</li>
</ul>
<p>3. 数据策略</p>
<ul>
<li><strong>弱监督与自举</strong><ul>
<li>利用录屏视频 + OCR/ASR 自动生成大规模轨迹，再通过 LLM 反向标注思考链，降低人工标注成本。</li>
</ul>
</li>
<li><strong>对抗性数据合成</strong><ul>
<li>训练一个“对抗任务生成器”，动态产出使当前策略失败的边缘案例，持续提高鲁棒性。</li>
</ul>
</li>
<li><strong>跨语言与跨文化数据</strong><ul>
<li>系统扩展中文、日文、阿拉伯语等 RTL 或非拉丁界面数据，验证文化差异对交互策略的影响。</li>
</ul>
</li>
</ul>
<p>4. 评估体系</p>
<ul>
<li><strong>长周期稳定性基准</strong><ul>
<li>设计 1000+ 步的复合任务（如“从零搭建并上线一个 Web 服务”），评估累积误差与恢复能力。</li>
</ul>
</li>
<li><strong>安全与伦理红队</strong><ul>
<li>构建“恶意指令”测试集（钓鱼、隐私窃取、越权操作），量化 Agent 的违规概率并引入安全奖励。</li>
</ul>
</li>
<li><strong>能耗-性能 Pareto 前沿</strong><ul>
<li>系统测量每千步交互的 GPU 小时与碳排，建立绿色 AI 指标。</li>
</ul>
</li>
</ul>
<p>5. 应用落地</p>
<ul>
<li><strong>企业级 RPA</strong><ul>
<li>与 SAP、Salesforce 等复杂企业软件深度集成，验证在真实业务流程中的 ROI。</li>
</ul>
</li>
<li><strong>无障碍辅助</strong><ul>
<li>将 Agent 作为视障用户的“数字导盲犬”，提供语音驱动的全自动界面操作。</li>
</ul>
</li>
<li><strong>游戏外挂检测对抗</strong><ul>
<li>研究 Agent 行为特征与真人差异，开发反检测机制，亦可反向用于提升游戏公平性检测。</li>
</ul>
</li>
<li><strong>端侧部署</strong><ul>
<li>结合 INT4 量化 + NPU 推理，在手机或车载系统上实现离线 GUI 智能体，探索端云协同策略。</li>
</ul>
</li>
</ul>
<p>6. 理论层面</p>
<ul>
<li><strong>Scaling Law for GUI Agent</strong><br>建立参数规模、训练步数、环境复杂度与任务成功率之间的定量关系，指导未来算力预算。</li>
<li><strong>可解释性机制</strong><br>引入因果推理模块，使 Agent 在每一步输出“因果图”解释为何选择该动作，满足监管需求。</li>
</ul>
<p>这些方向既可直接基于 UI-TARS-2 的现成沙箱与数据飞轮进行快速迭代，也能推动 GUI 智能体向更通用、可信、高效的下一代演进。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>一句话总结</p>
<p>UI-TARS-2 通过“数据飞轮 + 稳定多轮 RL + 混合 GUI 环境 + 统一沙箱”四件套，首次在单一模型内同时实现桌面、移动、浏览器与游戏场景的 SOTA 性能，并给出大规模 GUI 智能体训练的工程范式。</p>
<p>1. 问题与动机</p>
<ul>
<li>数据稀缺、长程 RL 不稳定、纯 GUI 局限、环境难扩展四大瓶颈阻碍通用 GUI 智能体。</li>
<li>目标：一个模型、一套环境、无人工规则，端到端完成复杂计算机任务。</li>
</ul>
<p>2. 方法总览</p>
<p>模块</p>
<p>关键设计</p>
<p>作用</p>
<p><strong>数据飞轮</strong></p>
<p>CT→SFT→RL→拒绝采样，轨迹按质量回流</p>
<p>模型与数据共同进化，零浪费</p>
<p><strong>稳定 RL</strong></p>
<p>异步有状态 rollout + PPO 改进（Decoupled-GAE、Value Pretraining、Clip Higher）</p>
<p>长序列训练不崩，GPU 利用率&gt;80 %</p>
<p><strong>混合环境</strong></p>
<p>GUI 动作 + 终端/SDK + 文件系统，同一容器</p>
<p>任务范围从“点按钮”扩展到“搭网站”</p>
<p><strong>统一沙箱</strong></p>
<p>云 VM 集群 + 浏览器容器，数千 QPS，可复现</p>
<p>百万级交互无故障</p>
<p><strong>参数插值</strong></p>
<p>各垂直域独立 RL 后线性合并权重</p>
<p>无需联合训练即可跨域泛化</p>
<p>3. 实验亮点</p>
<p>场景</p>
<p>关键结果</p>
<p>对比提升</p>
<p><strong>桌面</strong></p>
<p>OSWorld 47.5</p>
<p>超 Claude-4、CUA-o3</p>
<p><strong>移动</strong></p>
<p>AndroidWorld 73.3</p>
<p>领先基线 8-10 pp</p>
<p><strong>浏览器</strong></p>
<p>Online-Mind2Web 88.2</p>
<p>RL 带来 4.5 pp 额外增益</p>
<p><strong>系统级</strong></p>
<p>SWE-Bench 68.7</p>
<p>GUI-SDK 解锁仓库级编程</p>
<p><strong>游戏</strong></p>
<p>15 游戏平均 59.8 % 人类水平</p>
<p>领先 CUA 2.4×、Claude 2.8×</p>
<p><strong>OOD 游戏</strong></p>
<p>LMGame-Bench 与 o3 打平</p>
<p>零样本迁移</p>
<p>4. 深入分析</p>
<ul>
<li>训练熵不降反升 → 持续探索；步级思考长度递减 → 交互式任务特性。</li>
<li>Value Pretraining、PPO&gt;GRPO、W4A8 量化等消融实验给出工程最佳实践。</li>
<li>推理时步数扩展呈线性增益，未见平台期，验证策略可继续放大预算。</li>
</ul>
<p>5. 贡献与意义</p>
<ul>
<li><strong>首个</strong>在单一权重内同时统治 GUI、移动、浏览器、游戏四大交互场景的公开系统。</li>
<li><strong>方法论</strong>：给出可复现的“数据-算法-环境”闭环，为后续通用计算机智能体提供基线。</li>
</ul>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是UI-TARS-2%20Technical%20Report%3A%20Advancing%20GUI%20Agent%20with%20Multi-Turn%20Reinforcement%20Learning，链接是  https://arxiv.org/pdf/2509.02544  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.02544  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Haoming Wang,Haoyang Zou,Huatong Song,Jiazhan Feng,Junjie Fang,Junting Lu,Longxiang Liu,Qinyu Luo,Shihao Liang,Shijue Huang,Wanjun Zhong,Yining Ye,Yujia Qin,Yuwen Xiong,Yuxin Song,Zhiyong Wu,Bo Li,Chen Dun,Chong Liu,Fuxing Leng,Hanbin Wang,Hao Yu,Haobin Chen,Hongyi Guo,Jing Su,Jingjia Huang,Kai Shen,Kaiyu Shi,Lin Yan,Peiyao Zhao,Pengfei Liu,Qinghao Ye,Renjie Zheng,Wayne Xin Zhao,Wen Heng,Wenhao Huang,Wenqian Wang,Xiaobo Qin,Yi Lin,Youbin Wu,Zehui Chen,Zihao Wang,Baoquan Zhong,Xinchun Zhang,Xujing Li,Yuanfan Li,Zhongkai Zhao,Chengquan Jiang,Faming Wu,Haotian Zhou,Jinlin Pang,Li Han,Qianli Ma,Siyao Liu,Songhua Cai,Wenqi Fu,Xin Liu,Zhi Zhang,Bo Zhou,Guoliang Li,Jiajun Shi,Jiale Yang,Jie Tang,Li Li,Taoran Lu,Woyu Lin,Xiaokang Tong,Xinyao Li,Yichi Zhang,Yu Miao,Zhengxuan Jiang,Zili Li,Ziyuan Zhao,Chenxin Li,Dehua Ma,Feng Lin,Ge Zhang,Haihua Yang,Hangyu Guo,Hongda Zhu,Jiaheng Liu,Junda Du,Kai Cai,Kuanye Li,Lichen Yuan,Meilan Han,Minchao Wang,Shuyue Guo,Tianhao Cheng,Xiaobo Ma,Xiaojun Xiao,Xiaolong Huang,Xinjie Chen,Yidi Du,Yilin Chen,Yiwen Wang,Zhaojian Li,Zhenzhu Yang,Zhiyuan Zeng,Chaolin Jin,Chen Li,Hao Chen,Haoli Chen,Jian Chen,Qinghao Zhao,Guang Shi</p>
<p><strong>Categories</strong>: cs.AI,cs.CL,cs.CV,cs.HC</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.02544.pdf">https://arxiv.org/pdf/2509.02544.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.02544">https://arxiv.org/abs/2509.02544</a></p>
<p><strong>Arxiv ID</strong>: 2509.02544</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.02544">https://papers.cool/arxiv/2509.02544</a></p>
<p><strong>Published</strong>: 2025-09-02T17:44:45Z</p>
<p><strong>Updated</strong>: 2025-09-02T17:44:45.000Z</p>
<hr>
<h3 id="3-SimpleTIR-End-to-End-Reinforcement-Learning-for-Multi-Turn-Tool-Integrated-Reasoning"><a href="#3-SimpleTIR-End-to-End-Reinforcement-Learning-for-Multi-Turn-Tool-Integrated-Reasoning" class="headerlink" title="3. SimpleTIR: End-to-End Reinforcement Learning for Multi-Turn Tool-Integrated Reasoning"></a>3. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.02479">SimpleTIR: End-to-End Reinforcement Learning for Multi-Turn Tool-Integrated Reasoning</a></h3><p>Large Language Models (LLMs) can significantly improve their reasoning capabilities by interacting with external tools, a paradigm known as Tool-Integrated Reasoning (TIR). However, extending TIR to multi-turn scenarios using Reinforcement Learning (RL) is often hindered by training instability and performance collapse. We identify that such instability is primarily caused by a distributional drift from external tool feedback, leading to the generation of low-probability tokens. This issue compounds over successive turns, causing catastrophic gradient norm explosions that derail the training process. To address this challenge, we introduce SimpleTIR , a plug-and-play algorithm that stabilizes multi-turn TIR training. Its core strategy is to identify and filter out trajectories containing void turns, i.e., turns that yield neither a code block nor a final answer. By removing these problematic trajectories from the policy update, SimpleTIR effectively blocks the harmful, high-magnitude gradients, thus stabilizing the learning dynamics. Extensive experiments show that SimpleTIR achieves state-of-the-art performance on challenging math reasoning benchmarks, notably elevating the AIME24 score from a text-only baseline of 22.1 to 50.5 when starting from the Qwen2.5-7B base model. Furthermore, by avoiding the constraints of supervised fine-tuning, SimpleTIR encourages the model to discover diverse and sophisticated reasoning patterns, such as self-correction and cross-validation.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>大型语言模型（LLM）通过与外部工具的交互，可以显著提升其推理能力，这种范式被称为工具集成推理（TIR）。然而，使用强化学习（RL）将TIR扩展到多轮场景时，往往会受到训练不稳定和性能崩溃的阻碍。我们发现，这种不稳定性主要是由于来自外部工具反馈的分布漂移，导致生成低概率标记。这个问题在连续的回合中不断加剧，导致灾难性的梯度范数爆炸，从而扰乱训练过程。为了解决这个挑战，我们提出了SimpleTIR，这是一种即插即用的算法，旨在稳定多轮TIR训练。它的核心策略是识别并过滤掉包含空回合的轨迹，即那些既不产生代码块也不返回最终答案的回合。通过将这些有问题的轨迹从策略更新中移除，SimpleTIR有效地阻止了有害的高幅度梯度，从而稳定了学习动态。大量实验表明，SimpleTIR在具有挑战性的数学推理基准测试中实现了最先进的性能，显著将AIME24得分从文本基线22.1提升至50.5，起始于Qwen2.5-7B基础模型。此外，SimpleTIR通过避免监督微调的限制，鼓励模型发现多样而复杂的推理模式，如自我纠正和交叉验证。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>该工作聚焦于 <strong>多轮工具集成推理（Tool-Integrated Reasoning, TIR）场景下，使用端到端强化学习（Zero RL）训练大语言模型（LLM）时的训练不稳定与梯度爆炸问题</strong>。核心痛点在于：</p>
<ul>
<li><strong>分布漂移</strong>：外部工具（如 Python 解释器）反馈的文本分布与 LLM 预训练分布差异大，导致后续轮次生成低概率 token。</li>
<li><strong>梯度爆炸</strong>：低概率 token 使得重要性采样比 ρ 与梯度范数中的概率敏感项同时放大，造成梯度范数灾难性增长。</li>
<li><strong>信用分配错位</strong>：稀疏的终端奖励无法区分早期正确推理与后期低概率错误，导致策略偏向保守的单轮输出。</li>
</ul>
<p>为根治上述问题，论文提出 <strong>SimpleTIR</strong>：一种即插即用的轨迹过滤算法，通过识别并剔除包含“空转回合（void turns）”的轨迹（即既无完整代码块也无最终答案的回合），阻断有害的高幅梯度，稳定训练动态，同时保留 Zero RL 带来的多样化推理策略发现能力。</p>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>以下研究按主题分类，与 SimpleTIR 在方法、场景或目标上存在直接关联：</p>
<p>1. Zero RL 与纯文本推理</p>
<ul>
<li><strong>DeepSeek-R1</strong>（DeepSeek-AI Team, 2025）：首次展示从 base 模型出发、仅用结果奖励即可激发链式思维。</li>
<li><strong>SimpleRL-Zoo</strong>（Zeng et al., 2025）：开源复现 Zero RL 的“食谱”，覆盖多种开源 base 模型。</li>
<li><strong>Open-Reasoner-Zero</strong>（Hu et al., 2025）：论证无 KL 正则的 vanilla PPO 即可规模化 Zero RL。</li>
<li><strong>DAPO</strong>（Yu et al., 2025）：提出高 clip-ratio、任务过滤等技巧提升 Zero RL 稳定性。</li>
<li><strong>Dr. GRPO</strong>（Liu et al., 2025b）：去掉长度归一化项以简化 GRPO 训练。</li>
</ul>
<p>2. 工具集成推理（TIR）的 RL 训练</p>
<ul>
<li><strong>ReTool</strong>（Feng et al., 2025）：先冷启动 SFT 再 RL，使用 Qwen2.5-Math-Instruct。</li>
<li><strong>ToRL</strong>（Li et al., 2025b）与 <strong>Effective CIR</strong>（Bai et al., 2025）：在数学专用模型上探索 RL 训练配方。</li>
<li><strong>ZeroTIR</strong>（Mai et al., 2025）：唯一与 SimpleTIR 同样坚持 Zero RL 设置，提出若干正交稳定技巧。</li>
<li><strong>Search-R1 / R1-Searcher</strong>（Jin et al., 2025; Song et al., 2025）：聚焦搜索工具，面向问答任务。</li>
</ul>
<p>3. RL 训练稳定性通用技术</p>
<ul>
<li><strong>熵正则与重采样</strong>：CURE（Li et al., 2025a）、Entropy Mechanism（Cui et al., 2025）、ProRL（Liu et al., 2025a）。</li>
<li><strong>重要性采样比控制</strong>：GMPO（Zhao et al., 2025）、GSPO（Zheng et al., 2025a,b）、Yao et al. (2025)。</li>
<li><strong>轨迹过滤</strong>：Group Filtered PO（Shrivastava et al., 2025）。</li>
<li><strong>负梯度更新</strong>：Zhu et al. (2025) 证明仅使用负优势可提升稳定性。</li>
</ul>
<p>4. 理论分析</p>
<ul>
<li><strong>Lin &amp; Xu (2025)</strong>：从理论上解释 TIR 为何优于纯文本推理，SimpleTIR 为其提供实验佐证。</li>
</ul>
<p>SimpleTIR 与上述工作的关系：</p>
<ul>
<li>与 Zero RL 研究共享“无冷启动”理念；</li>
<li>与 TIR 研究共享“工具调用”场景，但坚持 Zero RL；</li>
<li>与稳定性研究正交，可叠加熵正则、IS 裁剪等方法；</li>
<li>为 Lin &amp; Xu (2025) 的理论结论提供大规模实证。</li>
</ul>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文通过 <strong>SimpleTIR</strong> 算法，从“根因诊断 → 理论分析 → 轨迹过滤 → 训练流程”四个层面系统性地解决了多轮 TIR 在 Zero RL 中的不稳定与梯度爆炸问题。</p>
<p>1. 根因诊断：低概率 token 的级联效应</p>
<ul>
<li><strong>现象</strong>：外部工具反馈（Python 执行结果）与 LLM 预训练分布差异大 → 后续轮次生成低概率 token。</li>
<li><strong>后果</strong>：<ul>
<li>重要性采样比 $\rho_{i,t}(\theta)=\pi_\theta/\pi_{\theta_\text{old}}$ 无界放大；</li>
<li>梯度范数 $|\nabla_{z_t}\mathcal{J}_\text{TIR}|_2$ 随 $P(c)\to 0$ 而爆炸（命题 3.1）；</li>
<li>稀疏终端奖励无法区分早期正确与晚期错误，信用分配错位。</li>
</ul>
</li>
</ul>
<p>2. 理论分析：梯度范数公式化</p>
<p>命题 3.1 给出梯度范数显式表达式：</p>
<script type="math/tex; mode=display">|\\nabla\_{z\_t}\\mathcal{J}_\\text{TIR}|_2 = m_{i,t}\\sum\_j m_{i,j}\\rho\_{i,t}(\\theta)g\_{i,t}|\\hat{A}\_i|\\sqrt{1-2P(c)+\\sum\_j P(j)^2}</script><ul>
<li><strong>关键项</strong>：<ul>
<li>$\rho_{i,t}(\theta)$：低 $P(c)$ 导致 $\rho$ 爆炸；</li>
<li>$\sqrt{1-2P(c)+\sum_j P(j)^2}$：低 $P(c)$ 使根号项趋近于 1，梯度持续高位。</li>
</ul>
</li>
</ul>
<p>3. 轨迹过滤：剔除“空转回合”（void turns）</p>
<ul>
<li><strong>定义</strong>：任何回合既无完整代码块也无最终答案（如重复文本、提前 eos）。</li>
<li><strong>算法</strong>：<ol>
<li>每回合正则检测代码块与答案；</li>
<li>若发现 void turn，<strong>整轨迹屏蔽</strong>（mask policy loss），不进入 GRPO 更新；</li>
<li>零额外成本，即插即用。</li>
</ol>
</li>
</ul>
<p>4. 训练流程与工程细节</p>
<ul>
<li><strong>Zero RL 设置</strong>：无 SFT 冷启动，直接从 Qwen2.5-7B/32B base 模型训练。</li>
<li><strong>实现技巧</strong>：<ul>
<li>无 chat template，工具反馈前缀统一为 <code>&quot;Code Execution Result:&quot;</code>；</li>
<li>每段代码自动带 <code>final_answer()</code> 函数，允许单回合终止；</li>
<li>最大 10 轮、24 k token，异步沙盒执行。</li>
</ul>
</li>
</ul>
<p>效果验证</p>
<ul>
<li><strong>稳定性</strong>：梯度范数无尖峰，训练曲线平滑（图 1、图 5）。</li>
<li><strong>性能</strong>：AIME24 从 22.1 → 50.5（7B），超越所有 Zero RL 基线（表 1）。</li>
<li><strong>多样性</strong>：Zero RL 自发涌现交叉验证、渐进推理、自纠错等策略（表 3、图 6）。</li>
</ul>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文围绕 <strong>训练稳定性、最终性能、消融验证、行为分析</strong> 四个维度展开系统实验，覆盖 7 B 与 32 B 两种规模、六类数学基准、多种对比方法与消融设置。</p>
<p>1. 主实验：端到端性能对比</p>
<p>维度</p>
<p>设置</p>
<p>结果摘要</p>
<p><strong>模型规模</strong></p>
<p>Qwen2.5-7B / 32B base</p>
<p>均从完全未对齐的 base 模型启动</p>
<p><strong>基准</strong></p>
<p>AIME24/25、MATH500、Olympiad、AMC23、HMMT Feb 25</p>
<p>共 6 个高难度数学集</p>
<p><strong>对比类别</strong></p>
<p>① 无 TIR 的 Zero RL（SimpleRL-Zoo, DAPO）<br>② 冷启动 TIR RL（ReTool, ToRL, Effective CIR, ARPO）<br>③ 同样 Zero RL + TIR（ZeroTIR）</p>
<p>SimpleTIR 在 Zero RL 组全面领先；7 B 在 AIME24 达 50.5，32 B 达 59.9，刷新 SOTA</p>
<p>2. 训练动态曲线</p>
<ul>
<li><strong>指标</strong>：平均准确率、梯度范数、响应长度、代码使用频率</li>
<li><strong>观察</strong>：<ul>
<li>SimpleTIR 训练 1200 步无梯度爆炸（图 1、图 5 Top）</li>
<li>将最大轮数从 1 → 5 → 10，响应长度与 Math500 分数单调提升，AIME24 则饱和，提示不同任务所需轮数差异（图 5 Top）</li>
</ul>
</li>
</ul>
<p>3. 消融实验：验证过滤策略必要性</p>
<p>方法</p>
<p>AIME24</p>
<p>Math500</p>
<p>训练稳定性</p>
<p><strong>Naive Multi-Turn</strong>（无过滤）</p>
<p>20.8</p>
<p>73.1</p>
<p>梯度爆炸</p>
<p><strong>Low-Prob Filtering</strong>（仅屏蔽极低概率 token）</p>
<p>23.3</p>
<p>72.8</p>
<p>仍不稳定</p>
<p><strong>High-Ratio Filtering</strong>（仅屏蔽高 IS 比 token）</p>
<p>26.3</p>
<p>75.0</p>
<p>仍不稳定</p>
<p><strong>Stop Generation w/o Filtering</strong>（遇 void turn 提前停，但仍计入 loss）</p>
<p>26.1</p>
<p>77.3</p>
<p>信用分配错位</p>
<p><strong>SimpleTIR</strong>（整轨迹屏蔽 void turns）</p>
<p><strong>50.5</strong></p>
<p><strong>88.4</strong></p>
<p>稳定收敛</p>
<p>4. 行为分析：涌现推理模式</p>
<ul>
<li><strong>标注方式</strong>：用 Claude-3.7-Sonnet 对 100 条正确解答进行模式计数（表 3）</li>
<li><p><strong>三类模式</strong></p>
<p>ReTool（冷启动 SFT）</p>
<p>SimpleTIR-32B（Zero RL）</p>
<p>Progressive Reasoning</p>
<p>18.9 %</p>
<p><strong>46.5 %</strong></p>
<p>Cross Validation</p>
<p>82.4 %</p>
<p>86.0 %</p>
<p>Error Correction</p>
<p>25.8 %</p>
<p><strong>38.0 %</strong></p>
</li>
<li><p><strong>结论</strong>：Zero RL 显著增加“渐进推理”与“自纠错”出现频率，验证其策略多样性优势（图 6、附录 B.2）。</p>
</li>
</ul>
<p>5. 附加分析</p>
<ul>
<li><strong>失败案例剖析</strong>：展示含 void turn 的轨迹如何导致后续输出崩溃（附录 B.1、表 4）。</li>
<li><strong>超参数与提示模板</strong>：公开完整配置与多轮 TIR prompt，确保可复现（附录 C.2、表 6）。</li>
</ul>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向既可深化 SimpleTIR 的核心思想，也能将其推广到更广阔的 LLM-Agent 场景：</p>
<p>1. 过滤准则的泛化与自适应</p>
<ul>
<li><strong>任务无关的 void turn 定义</strong>：当前准则依赖“代码块 + 最终答案”的显式格式；对搜索、API 调用等多工具场景需重新形式化。</li>
<li><strong>动态阈值</strong>：用在线估计的 token 概率分布或梯度范数自适应调整过滤门限，而非硬规则。</li>
</ul>
<p>2. 长程交互与信用分配</p>
<ul>
<li><strong>超越 10 轮</strong>：研究当最大轮数增至数十甚至上百轮时的稳定性—是否会出现新一轮梯度爆炸或奖励稀疏灾难。</li>
<li><strong>细粒度信用分配</strong>：引入 per-turn 稀疏奖励或基于执行结果差异的塑形奖励，缓解终端奖励的延迟问题。</li>
</ul>
<p>3. 工具链扩展与沙盒效率</p>
<ul>
<li><strong>异构工具</strong>：将 Python 解释器扩展至 SQL、Bash、浏览器等，验证 void turn 过滤策略在多工具环境下的通用性。</li>
<li><strong>高效异步沙盒</strong>：<ul>
<li>开发 JIT 编译或容器复用技术，降低代码执行延迟；</li>
<li>实现完全异步 rollout + 奖励计算，避免当前“同步等待”瓶颈。</li>
</ul>
</li>
</ul>
<p>4. 理论深化</p>
<ul>
<li><strong>分布漂移度量</strong>：构造可计算的 drift 指标（如 KL(工具反馈 || 预训练分布)），与梯度范数做实时关联监控。</li>
<li><strong>重要性采样比的重加权</strong>：设计新的 IS 权重或梯度裁剪策略，使低概率 token 的梯度贡献可控，而非直接丢弃整条轨迹。</li>
</ul>
<p>5. 训练效率与系统优化</p>
<ul>
<li><strong>混合精度与梯度检查点</strong>：长上下文 + 多轮生成导致显存峰值高，探索 FP8、序列并行等方案。</li>
<li><strong>分层策略</strong>：显式分离“高层回合策略”与“低层 token 策略”，用不同网络或不同更新频率减少耦合带来的方差。</li>
</ul>
<p>6. 行为与安全性研究</p>
<ul>
<li><strong>错误放大风险</strong>：当工具返回错误结果时，模型是否会因 void turn 过滤不足而持续信任错误信息？</li>
<li><strong>自动化红队</strong>：利用过滤后的失败轨迹构造对抗 prompt，测试模型在极端工具输出下的鲁棒性。</li>
</ul>
<p>7. 跨任务迁移</p>
<ul>
<li><strong>非数学领域</strong>：代码生成、数据分析、科学模拟等任务通常需要更长交互链，验证 void turn 假设是否依然成立。</li>
<li><strong>多模态工具</strong>：若工具返回图像、音频或结构化表格，需重新定义“空转”并设计对应的过滤逻辑。</li>
</ul>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>论文一句话总结</p>
<p>SimpleTIR 通过“过滤空转回合”这一极简策略，首次在 Zero RL 框架下稳定地训练出多轮工具集成推理大模型，并在高难度数学基准上刷新 SOTA，同时自发涌现出多样化推理行为。</p>
<p>核心内容速览</p>
<p>维度</p>
<p>关键信息</p>
<p><strong>问题</strong></p>
<p>多轮 TIR + Zero RL 训练常因外部工具反馈导致分布漂移、低概率 token 累积，引发梯度爆炸与信用分配错位。</p>
<p><strong>方法</strong></p>
<p>SimpleTIR：在每回合检测是否“既无完整代码块也无最终答案”（void turn），整轨迹屏蔽，阻断有害梯度。</p>
<p><strong>理论</strong></p>
<p>命题 3.1 给出梯度范数与 token 概率的显式关系，解释为何低概率 token 必然导致梯度爆炸。</p>
<p><strong>实验</strong></p>
<p>7 B/32 B base 模型 → AIME24 从 22.1→50.5/59.9；消融证实 void-turn 过滤是稳定关键；Zero RL 比冷启动 SFT 产生更多“渐进推理+自纠错”策略。</p>
<p><strong>贡献</strong></p>
<p>① 首个 Zero RL 多轮 TIR 稳定训练方案；② 即插即用、零额外成本；③ 开源代码与完整超参。</p>
<p><strong>局限与未来</strong></p>
<p>过滤准则需向搜索、SQL 等多工具泛化；轮数、沙盒效率、长程信用分配仍待优化。</p>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是SimpleTIR%3A%20End-to-End%20Reinforcement%20Learning%20for%20Multi-Turn%20Tool-Integrated%20Reasoning，链接是  https://arxiv.org/pdf/2509.02479  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.02479  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Zhenghai Xue,Longtao Zheng,Qian Liu,Yingru Li,Xiaosen Zheng,Zejun Ma,Bo An</p>
<p><strong>Categories</strong>: cs.LG</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.02479.pdf">https://arxiv.org/pdf/2509.02479.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.02479">https://arxiv.org/abs/2509.02479</a></p>
<p><strong>Arxiv ID</strong>: 2509.02479</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.02479">https://papers.cool/arxiv/2509.02479</a></p>
<p><strong>Published</strong>: 2025-09-02T16:30:19Z</p>
<p><strong>Updated</strong>: 2025-09-02T16:30:19.000Z</p>
<hr>
<h3 id="4-LLaVA-Critic-R1-Your-Critic-Model-is-Secretly-a-Strong-Policy-Model"><a href="#4-LLaVA-Critic-R1-Your-Critic-Model-is-Secretly-a-Strong-Policy-Model" class="headerlink" title="4. LLaVA-Critic-R1: Your Critic Model is Secretly a Strong Policy Model"></a>4. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.00676">LLaVA-Critic-R1: Your Critic Model is Secretly a Strong Policy Model</a></h3><p>In vision-language modeling, critic models are typically trained to evaluate outputs — assigning scalar scores or pairwise preferences — rather than to generate responses. This separation from policy models, which produce the responses, is so entrenched that critics are rarely considered for direct policy use. In this work, we challenge this convention. We propose to reorganize preference-labeled critic datasets into verifiable training signals and perform reinforcement learning directly on a base generative model, producing LLaVA-Critic-R1, a multimodal critic trained to optimize preference judgments while retaining full generation ability. Surprisingly, LLaVA-Critic-R1 emerges not only as a top-performing critic but also as a competitive policy model — matching or surpassing specialized reasoning VLMs trained with in-domain data across 26 visual reasoning and understanding benchmarks, with an average gain of +5.7% over its base model (Qwen-2.5-VL-7B). Extending this approach to existing strong reasoning VLMs yields LLaVA-Critic-R1+, which further advances policy performance without sacrificing critic quality, achieving a SoTA performance of 71.9 on MMMU at the 7B scale. Finally, we show that the enhanced critic ability benefits inference: applying self-critique at test time yields an average +13.8% improvement on five representative reasoning tasks without additional training. Our results reveal that RL training on critic data can produce a unified model excelling at both evaluation and generation, offering a simple path toward scalable, self-improving multimodal systems.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>在视觉语言建模中，批评模型通常被训练用来评估输出——分配标量评分或成对偏好——而不是生成响应。这种与生成响应的策略模型之间的分离已经根深蒂固，以至于很少考虑直接将批评者用于策略。在这项工作中，我们挑战了这一传统。我们提议将偏好标记的批评数据集重组为可验证的训练信号，并直接对基础生成模型进行强化学习，生成LLaVA-Critic-R1，一个训练用于优化偏好判断的多模态批评者，同时保持完全的生成能力。令人惊讶的是，LLaVA-Critic-R1不仅成为顶尖的批评者，还成为一个具有竞争力的策略模型——在26个视觉推理和理解基准中，与使用领域内数据训练的专业推理视觉语言模型匹敌或超越，平均比其基础模型（Qwen-2.5-VL-7B）提升了+5.7%。将这种方法扩展到现有的强推理视觉语言模型会产生LLaVA-Critic-R1+，进一步提升策略性能而不牺牲批评质量，在7B规模的MMMU上实现了71.9的最新性能。最后，我们展示了增强的批评能力对推理的好处：在测试时应用自我批评，在五个具有代表性的推理任务上平均提升了+13.8%，而无需额外训练。我们的结果表明，基于批评数据的强化学习训练可以产生一个在评估和生成方面都表现出色的统一模型，为可扩展、自我改进的多模态系统提供了一条简单路径。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p><strong>核心问题：</strong><br>传统视觉-语言模型（VLM）将“策略模型”（生成响应）与“评价模型”（评估响应质量）视为两个分离的模块。评价模型（critic）通常仅用于训练阶段提供奖励信号或推理阶段筛选候选答案，但<strong>从未被直接当作策略模型使用</strong>。这种割裂导致：</p>
<ol>
<li><strong>资源浪费</strong>：需分别训练策略和评价模型，增加计算与数据成本。</li>
<li><strong>能力局限</strong>：评价模型无法直接生成响应，策略模型缺乏自我纠错能力。</li>
<li><strong>扩展性差</strong>：测试阶段需依赖外部评价模型或人工规则（如多数投票），难以自适应优化。</li>
</ol>
<p><strong>论文的突破性目标：</strong><br><strong>证明评价模型本身即可作为强大的策略模型</strong>，通过以下方式实现统一：</p>
<ul>
<li><strong>数据重构</strong>：将偏好标注的critic数据转化为可验证的强化学习信号（无需人工打分或蒸馏）。</li>
<li><strong>统一训练</strong>：直接对基础生成模型进行强化学习（RL），使其在优化评价能力的同时，<strong>自发获得策略生成能力</strong>。</li>
<li><strong>双重验证</strong>：展示该统一模型（LLaVA-Critic-R1）在26个视觉推理/理解任务上，<strong>同时达到SOTA评价性能与超越专用策略模型的生成性能</strong>，并支持测试时自我优化（self-critique）。</li>
</ul>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>以下研究从不同角度为 LLaVA-Critic-R1 提供了方法论、数据或评估基础，可分为四大类：</p>
<p>1. 多模态 Critic / Reward 模型</p>
<ul>
<li><strong>LLaVA-Critic</strong> (Xiong et al., 2024, 2025)<br>首个大规模生成式多模态评价模型，用 SFT+知识蒸馏产出细粒度反馈，但仅用于评价而非生成。</li>
<li><strong>InternLM-XComposer2.5-Reward</strong> (Zang et al., 2025)<br>轻量级 reward 模型，采用 pairwise 打分，未探索 critic 数据对策略能力的迁移。</li>
<li><strong>VL-RewardBench / MM-RLHF</strong> (Li et al., 2025; Zhang et al., 2025c)<br>提供高质量偏好标注数据与基准，被本文直接用作 RL 训练信号。</li>
</ul>
<p>2. 强化学习与推理增强</p>
<ul>
<li><strong>DeepSeek-R1</strong> (DeepSeek-AI, 2025)<br>文本大模型中通过纯 RL 激发长链推理（long-CoT），为本文“无蒸馏 RL”路线提供先例。</li>
<li><strong>Vision-R1</strong> (Huang et al., 2025a,b)<br>将 DeepSeek-R1 的推理能力蒸馏到 VLM，再执行 RL，展示“先蒸馏后 RL”范式；本文则证明<strong>无需蒸馏</strong>即可达到同等或更好策略性能。</li>
<li><strong>MM-Eureka / OpenVLThinker / VL-Cogito</strong> (Meng et al., 2025; Deng et al., 2025; Yuan et al., 2025)<br>基于规则或课程 RL 提升多模态推理，但均依赖带 GT 答案的 reasoning 数据；本文使用<strong>无 GT 的 critic preference 数据</strong>完成策略提升。</li>
</ul>
<p>3. 测试时扩展（Test-Time Scaling）</p>
<ul>
<li><strong>OpenAI o1</strong> (OpenAI, 2024) / <strong>GLM-4.1V-Thinking</strong> (Team et al., 2025b)<br>通过延长推理链在推理阶段扩展计算，但未引入内部 critic。</li>
<li><strong>VisualPRM / GenPRM</strong> (Wang et al., 2025b,c; Zhao et al., 2025a)<br>训练过程奖励模型在测试时为候选步骤打分，需额外 critic 网络；LLaVA-Critic-R1 则<strong>自身同时扮演策略与 critic</strong>，实现 self-critique。</li>
<li><strong>Large Language Monkeys</strong> (Brown et al., 2024)<br>通过重复采样+多数投票提升性能；本文显示 self-critique 显著优于多数投票。</li>
</ul>
<p>4. 训练策略与消融研究</p>
<ul>
<li><strong>GRPO</strong> (Shao et al., 2024)<br>群体相对策略优化算法，被本文直接采用作为 RL 目标。</li>
<li><strong>R1-ShareVL / SRPO</strong> (Yao et al., 2025; Wan et al., 2025)<br>探索多模态 RL 中的规则设计与反思机制，为本文格式奖励 (r_format) 与思考模板设计提供参考。</li>
</ul>
<p>综上，LLaVA-Critic-R1 在以下方面实现突破：</p>
<ul>
<li><strong>首次</strong>将 critic 数据转化为纯 RL 信号，无需蒸馏或 GT 答案即可提升策略性能；</li>
<li><strong>首次</strong>在单一模型内同时实现 SOTA critic 与策略能力，并支持 test-time self-critique；</li>
<li>通过系统消融验证了 critic 训练与策略训练的互补性，为后续“自我改进”多模态系统提供新范式。</li>
</ul>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文通过以下四步流程将“评价模型”转化为“既是评价器又是策略器”的统一模型，并验证其有效性：</p>
<p>1. 数据重组：把偏好标注变成可验证 RL 信号</p>
<ul>
<li><strong>输入</strong>：40 k 条〈图像, 问题, 回答 A, 回答 B, 偏好标签〉的 pairwise 数据（来自 VLFeedback / RLHF-V）。</li>
<li><strong>关键操作</strong>：<ul>
<li>丢弃 GPT 生成的长链理由与 5 项人工评价指标，仅保留“哪个回答更好”这一<strong>可验证的二元标签</strong>。</li>
<li>设计极简 prompt（见表 1），要求模型输出：<br><code>&lt;think&gt; …自主推理… &lt;/think&gt;</code><br><code>\boxed{1}</code> 或 <code>\boxed{2}</code> 或 <code>\boxed{Two responses are equally good.}</code></li>
<li>结果：把传统用于 SFT 的 critic 数据，改造成<strong>无需人工打分、可直接计算奖励的 RL 任务</strong>。</li>
</ul>
</li>
</ul>
<p>2. 强化学习训练：直接对基础生成模型做 critic-RL</p>
<ul>
<li><strong>算法</strong>：Group Relative Policy Optimization (GRPO)。</li>
<li><strong>奖励函数</strong>：  <script type="math/tex; mode=display">r = \\underbrace{0.9 \\cdot r\_{\\text{pref}}}_{\\text{偏好匹配}} + \\underbrace{0.1 \\cdot r_{\\text{format}}}\_{\\text{格式合规}}</script><ul>
<li>$r_{\text{pref}} = 1$ 当且仅当模型给出的选择与标签一致；否则 0。</li>
<li>$r_{\text{format}} = 1$ 当且仅当正确使用了 <code>&lt;think&gt;</code> 与 <code>\boxed{}</code>。</li>
</ul>
</li>
<li><strong>训练细节</strong>：<ul>
<li>不经过任何蒸馏 SFT，<strong>冷启动</strong>于 Qwen-2.5-VL-7B。</li>
<li>训练 400 步即可收敛；显存占用与常规 RLHF 相同。</li>
</ul>
</li>
</ul>
<p>3. 双重验证：策略性能与评价性能同步提升</p>
<ul>
<li><strong>策略能力</strong>：<ul>
<li>在 26 个视觉推理 / 理解基准平均提升 <strong>+5.7%</strong>，与 4 个专门做 reasoning-RFT 的 7 B 模型持平或更好。</li>
<li>训练后的模型称为 <strong>LLaVA-Critic-R1</strong>；若继续用更强的 ThinkLite-VL-7B 做起点，则得到 <strong>LLaVA-Critic-R1+</strong>，在 MMMU 达到 7 B 新 SOTA 71.9。</li>
</ul>
</li>
<li><strong>评价能力</strong>：<ul>
<li>在 Visual RewardBench 上比基线提升 <strong>+10.8%</strong>，证明其 critic 质量仍保持顶尖。</li>
</ul>
</li>
</ul>
<p>4. 测试时扩展：利用自身 critic 能力做 self-critique</p>
<ul>
<li><strong>流程</strong>（Best-of-128）：<ol>
<li>作为策略器生成 128 条候选回答（temperature=0.9）。</li>
<li>作为 critic 器对所有候选进行<strong>递归 pairwise 比较</strong>，逐轮淘汰，直到只剩 1 条。</li>
</ol>
</li>
<li><strong>结果</strong>：<ul>
<li>在 5 个代表性任务上平均再提升 <strong>+13.8%</strong>，显著优于多数投票或外部 critic。</li>
<li>性能随采样规模单调上升至 128 条后饱和，验证了 critic 能力的有效性。</li>
</ul>
</li>
</ul>
<p>总结</p>
<p>通过“数据→奖励→RL→双重验证→测试时扩展”的闭环，论文首次证明：</p>
<blockquote>
<p><strong>仅用 critic 偏好数据做 RL，即可让生成模型同时成为顶尖策略器与评价器，并可自我迭代提升。</strong></p>
</blockquote>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文共设计 <strong>四大类 12 组实验</strong>，覆盖训练范式、模型规模、数据策略、测试时扩展及消融分析，系统验证“critic-RL 训练”对策略与评价能力的提升。结果均以 26 个视觉基准的平均分或具体指标呈现。</p>
<p>1. 主实验：策略与评价双重性能验证</p>
<p>模型</p>
<p>训练数据</p>
<p>评价维度</p>
<p>关键结果</p>
<p><strong>LLaVA-Critic-R1</strong></p>
<p>40 k pairwise critic 数据（无 GT 答案）</p>
<p>26 个视觉基准</p>
<p>相比 Qwen-2.5-VL-7B <strong>平均↑5.7%</strong>；MMMU ↑4.6、MathVista ↑6.2</p>
<p><strong>LLaVA-Critic-R1+</strong></p>
<p>同上，但起始于 ThinkLite-VL-7B</p>
<p>同上</p>
<p><strong>MMMU 71.9</strong>（7 B SOTA）；MathVista 82.1；MathVerse 74.1；CharXiv 62.5</p>
<p>2. 测试时扩展实验（Best-of-N）</p>
<p>策略</p>
<p>采样数</p>
<p>平均提升</p>
<p>典型任务峰值</p>
<p>Self-Critique</p>
<p>128</p>
<p><strong>+13.8%</strong></p>
<p>MathVista 78.9、MMMU 66.4</p>
<p>Majority Vote</p>
<p>128</p>
<p>+3.2%</p>
<p>早早在 16–64 饱和</p>
<p>Base-Model-Critic</p>
<p>128</p>
<p>+4.1%</p>
<p>始终低于 self-critique</p>
<p>3. 消融实验</p>
<p>3.1 训练策略对比（Qwen-2.5-VL-7B 为统一基底）</p>
<p>训练方式</p>
<p>评价能力</p>
<p>策略能力</p>
<p>结论</p>
<p><strong>Critic-only</strong> (LLaVA-Critic-R1)</p>
<p>68.1</p>
<p>57.38</p>
<p>critic 最强</p>
<p><strong>Policy-only</strong> (ThinkLite-VL)</p>
<p>57.2</p>
<p>56.72</p>
<p>策略强，评价弱</p>
<p><strong>Mixed</strong></p>
<p>64.9</p>
<p>56.31</p>
<p>两者皆次优</p>
<p><strong>Policy→Critic</strong></p>
<p>64.9</p>
<p>58.16</p>
<p><strong>最佳折中</strong></p>
<p><strong>Critic→Policy</strong></p>
<p>62.9</p>
<p>57.06</p>
<p>critic 掉点</p>
<p>3.2 SFT vs. 冷启动 RFT</p>
<p>路径</p>
<p>RewardBench</p>
<p>通用任务</p>
<p>结论</p>
<p>SFT→RFT</p>
<p>67.5</p>
<p>56.01</p>
<p>critic 略升，策略降</p>
<p><strong>冷启动 RFT</strong> (LLaVA-Critic-R1)</p>
<p><strong>68.1</strong></p>
<p><strong>57.38</strong></p>
<p>策略+评价双赢</p>
<p>3.3 格式奖励与感知能力分解</p>
<p>条件</p>
<p>感知&amp;VQA</p>
<p>推理</p>
<p>说明</p>
<p>仅推理模板（inference-time）</p>
<p>57.4 → 57.4</p>
<p>42.1 → 43.2</p>
<p>格式约束有帮助</p>
<p>仅格式奖励 RL</p>
<p>57.4 → 57.4</p>
<p>43.2 → 43.9</p>
<p>无感知增益</p>
<p><strong>完整 critic-RL</strong></p>
<p><strong>60.7</strong></p>
<p><strong>45.8</strong></p>
<p>感知+推理双重提升</p>
<p>3.4 critic/policy 能力相关性</p>
<ul>
<li><strong>训练曲线</strong>（图 3）：前 200 步 critic 与 policy 性能 <strong>Pearson r ≈ 0.94</strong>；后期 critic 波动，policy 350 步后略降，显示过拟合迹象。</li>
</ul>
<p>4. 跨基底普适性验证</p>
<p>基底模型</p>
<p>训练后名称</p>
<p>平均提升</p>
<p>新 SOTA</p>
<p>MiMo-VL-7B-RL-2508</p>
<p>LLaVA-Critic-R1+</p>
<p><strong>+2.6%</strong></p>
<p>MMMU 71.9、MathVista 82.1</p>
<p>Llama-3.2-11B-Vision</p>
<p>LLaVA-Critic-R1</p>
<p><strong>+2.6%</strong></p>
<p>MMMU 49.0 (↑13.4%)、MathVision 30.9 (↑30.9%)</p>
<p>5. 案例研究</p>
<ul>
<li><strong>计数任务</strong>（表 11）：Qwen-Thinking 漏数 1 个，LLaVA-Critic-R1+ 正确 10 个。</li>
<li><strong>GUI 代理</strong>（表 12）：Qwen 点错坐标，LLaVA-Critic-R1+ 正确点击 Format → Centered。</li>
</ul>
<p>结论</p>
<p>通过 26 个基准、4 类消融、3 种基底模型及 128 倍采样扩展，论文系统证明：</p>
<blockquote>
<p><strong>仅用 40 k 无 GT 的 critic 偏好数据做 RL，即可让单一模型在策略与评价双重任务上同时达到或超越专用模型，并具备可扩展的自我改进能力。</strong></p>
</blockquote>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可视为 LLaVA-Critic-R1 的“下一步”研究议程，按优先级与可行性分为 <strong>短期可验证</strong> 与 <strong>长期挑战性</strong> 两类：</p>
<p>短期可验证（3–6 个月）</p>
<ol>
<li><p><strong>数据规模与质量消融</strong></p>
<ul>
<li>将 40 k pairwise 数据扩展到 100 k / 500 k，观察 critic 与 policy 能力的 scaling law：  <script type="math/tex; mode=display">\\Delta\_{\\text{policy}} \\propto \\log N\_{\\text{pairwise}} \\quad ?</script></li>
<li>引入 <strong>人工精标</strong> vs <strong>GPT 标注</strong> 的对比实验，量化标注源对最终性能的敏感度。</li>
</ul>
</li>
<li><p><strong>奖励函数细粒度化</strong></p>
<ul>
<li>在 $r_{\text{pref}}$ 中引入 <strong>边际奖励</strong>（margin reward）：  <script type="math/tex; mode=display">r\_{\\text{margin}} = \\text{score}_{\\text{win}} - \\text{score}_{\\text{lose}}</script>以鼓励模型区分“显著更好”而非“微弱更好”的回答。</li>
</ul>
</li>
<li><p><strong>任务迁移谱系</strong></p>
<ul>
<li>用 <strong>医疗影像、自动驾驶、GUI 自动化</strong> 等垂直场景的偏好数据做 critic-RL，验证“跨域零样本策略提升”是否依然成立。</li>
</ul>
</li>
<li><p><strong>推理-预算最优曲线</strong></p>
<ul>
<li>绘制 <strong>Best-of-N</strong> 性能-延迟 Pareto 前沿：  <script type="math/tex; mode=display">\\text{Perf}(N) = \\alpha \\log N + \\beta</script>为实际部署提供 N 的选择依据。</li>
</ul>
</li>
</ol>
<p>长期挑战性（6–18 个月）</p>
<ol>
<li><p><strong>统一在线 self-play 框架</strong></p>
<ul>
<li>让模型在 <strong>无标注</strong> 场景下循环：<ol>
<li>生成回答 → 2. 自我 critic 打分 → 3. 用高分回答构造新 pairwise → 4. 继续 RL。<br>研究该循环是否收敛及如何避免模式崩溃。</li>
</ol>
</li>
</ul>
</li>
<li><p><strong>过程级 critic 信号</strong></p>
<ul>
<li>将 pairwise 标签细化为 <strong>逐步正确性标签</strong>（类似 Visual-PRM），训练 <strong>过程奖励模型</strong> 与策略模型共享 backbone，实现 <strong>逐步自我修正</strong>。</li>
</ul>
</li>
<li><p><strong>多模态链式思考的可解释性</strong></p>
<ul>
<li>通过注意力可视化或探针分析，验证 critic-RL 是否真正学到 <strong>视觉-符号对齐</strong> 而非语言捷径。<br>设计 <strong>对抗性幻觉检测</strong> 基准，测试模型自我发现幻觉的能力。</li>
</ul>
</li>
<li><p><strong>异构评价任务统一</strong></p>
<ul>
<li>将文本、音频、视频评价数据统一为 <strong>通用多模态 critic 格式</strong>，研究单一模型能否在 <strong>跨模态评价</strong> 与 <strong>跨模态生成</strong> 上同时达到高水准。</li>
</ul>
</li>
<li><p><strong>理论分析：评价-策略互信息</strong></p>
<ul>
<li>建立信息论框架，量化 critic 训练对策略熵的影响：  <script type="math/tex; mode=display">I(\\text{critic logits}; \\text{policy improvement})</script>为“评价能力越强 → 策略越好”提供可计算的理论上界。</li>
</ul>
</li>
</ol>
<p>附：可直接复用的实验设置</p>
<ul>
<li><strong>基底模型</strong>：InternVL2-8B、GPT-4o-mini-Vision</li>
<li><strong>数据</strong>：开源 VLFeedback-1M、即将发布的 MM-RLHF-2.0</li>
<li><strong>评估</strong>：新设 <strong>Self-Critique Robustness Suite</strong>（含对抗样本、分布外场景）</li>
</ul>
<p>这些方向既可直接落地验证，也能为未来“完全自监督的多模态智能体”奠定理论与工程基础。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>论文一句话总结</p>
<p><strong>仅用 40 k 条“偏好标注”做强化学习，即可把原本只能打分的 critic 模型变成既能生成回答又能自我评价的通用策略模型，并在 26 个视觉基准上刷新 7 B 尺度 SOTA。</strong></p>
<p>核心贡献</p>
<p>维度</p>
<p>内容</p>
<p>关键数字</p>
<p><strong>问题</strong></p>
<p>critic 与 policy 长期割裂，训练成本高、推理需外部评价</p>
<p>—</p>
<p><strong>方法</strong></p>
<p>将 pairwise 偏好数据重构成可验证 RL 任务，用 GRPO 直接对 Qwen-2.5-VL-7B 做 critic-RL</p>
<p>无 SFT、无蒸馏</p>
<p><strong>结果</strong></p>
<p>单一模型同时获得顶尖 critic 与策略能力</p>
<p>26 基准平均 ↑5.7%，MMMU 71.9（7 B SOTA）</p>
<p><strong>扩展</strong></p>
<p>测试时 Best-of-128 self-critique 再提升</p>
<p>5 任务平均 ↑13.8%</p>
<p><strong>普适</strong></p>
<p>在 MiMo-VL、LLaMA-3.2-Vision 上复现提升</p>
<p>平均 ↑2.6%</p>
<p>实验全景</p>
<ul>
<li><strong>主实验</strong>：LLaVA-Critic-R1 / R1+ 在 6 大类 26 个基准上全面领先专用 reasoning 模型。</li>
<li><strong>消融</strong>：<ol>
<li>critic-only vs policy-only vs 混合训练 → Policy→Critic 策略最优。</li>
<li>SFT→RFT vs 冷启动 RFT → 冷启动策略+评价双赢。</li>
<li>格式奖励与感知能力分解 → 两者协同提升。</li>
</ol>
</li>
<li><strong>跨基底</strong>：MiMo-VL、LLaMA-3.2-Vision 复制成功。</li>
<li><strong>案例</strong>：计数、GUI 代理等具体场景展示 critic-RL 带来的细粒度改进。</li>
</ul>
<p>结论</p>
<p>论文首次实证：<strong>“训练一个更好的 critic，就是训练一个更好的 policy。”</strong> 这为构建可自我改进、统一推理-评价的多模态大模型提供了极简而有效的路径。</p>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是LLaVA-Critic-R1%3A%20Your%20Critic%20Model%20is%20Secretly%20a%20Strong%20Policy%20Model，链接是  https://arxiv.org/pdf/2509.00676  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.00676  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Xiyao Wang,Chunyuan Li,Jianwei Yang,Kai Zhang,Bo Liu,Tianyi Xiong,Furong Huang</p>
<p><strong>Categories</strong>: cs.CV,cs.LG</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.00676.pdf">https://arxiv.org/pdf/2509.00676.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.00676">https://arxiv.org/abs/2509.00676</a></p>
<p><strong>Arxiv ID</strong>: 2509.00676</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.00676">https://papers.cool/arxiv/2509.00676</a></p>
<p><strong>Published</strong>: 2025-08-31T03:08:02Z</p>
<p><strong>Updated</strong>: 2025-08-31T03:08:02.000Z</p>
<hr>
<h3 id="5-ELV-Halluc-Benchmarking-Semantic-Aggregation-Hallucinations-in-Long-Video-Understanding"><a href="#5-ELV-Halluc-Benchmarking-Semantic-Aggregation-Hallucinations-in-Long-Video-Understanding" class="headerlink" title="5. ELV-Halluc: Benchmarking Semantic Aggregation Hallucinations in Long Video Understanding"></a>5. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2508.21496">ELV-Halluc: Benchmarking Semantic Aggregation Hallucinations in Long Video Understanding</a></h3><p>Video multimodal large language models (Video-MLLMs) have achieved remarkable progress in video understanding. However, they remain vulnerable to hallucination-producing content inconsistent with or unrelated to video inputs. Previous video hallucination benchmarks primarily focus on short-videos. They attribute hallucinations to factors such as strong language priors, missing frames, or vision-language biases introduced by the visual encoder. While these causes indeed account for most hallucinations in short videos, they still oversimplify the cause of hallucinations. Sometimes, models generate incorrect outputs but with correct frame-level semantics. We refer to this type of hallucination as Semantic Aggregation Hallucination (SAH), which arises during the process of aggregating frame-level semantics into event-level semantic groups. Given that SAH becomes particularly critical in long videos due to increased semantic complexity across multiple events, it is essential to separate and thoroughly investigate the causes of this type of hallucination. To address the above issues, we introduce ELV-Halluc, the first benchmark dedicated to long-video hallucination, enabling a systematic investigation of SAH. Our experiments confirm the existence of SAH and show that it increases with semantic complexity. Additionally, we find that models are more prone to SAH on rapidly changing semantics. Moreover, we discuss potential approaches to mitigate SAH. We demonstrate that positional encoding strategy contributes to alleviating SAH, and further adopt DPO strategy to enhance the model’s ability to distinguish semantics within and across events. To support this, we curate a dataset of 8K adversarial data pairs and achieve improvements on both ELV-Halluc and Video-MME, including a substantial 27.7% reduction in SAH ratio.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>视频多模态大型语言模型（Video-MLLMs）在视频理解方面取得了显著进展。然而，它们仍然易受到与视频输入不一致或无关的内容引起的幻觉影响。之前的视频幻觉基准主要集中在短视频上。他们将幻觉归因于一些因素，如强大的语言先验、缺失的帧或视觉编码器引入的视觉-语言偏见。尽管这些原因确实解释了大多数短视频中的幻觉，但它们仍然过于简单化了幻觉的原因。有时，模型产生的输出不正确，但帧级语义是正确的。我们将这种类型的幻觉称为语义聚合幻觉（SAH），它出现在将帧级语义聚合到事件级语义组的过程中。鉴于由于多事件之间语义复杂性的增加，SAH在长视频中特别关键，有必要分离并彻底调查这种类型幻觉的原因。为了解决上述问题，我们引入了ELV-Halluc，这是第一个专门针对长视频幻觉的基准，能够系统地调查SAH。我们的实验确认了SAH的存在，并表明其随着语义复杂性的增加而增加。此外，我们发现模型在快速变化的语义上更容易受到SAH的影响。此外，我们讨论了减轻SAH的潜在方法。我们证明了位置编码策略有助于缓解SAH，并进一步采用DPO策略来增强模型在事件内和跨事件区分语义的能力。为此，我们整理了一个包含8000个对抗数据对的数据集，并在ELV-Halluc和Video-MME上实现了改进，包括SAH比率显著降低27.7%。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>论文《ELV-Halluc: Benchmarking Semantic Aggregation Hallucinations in Long Video Understanding》聚焦的核心问题是：</p>
<ul>
<li><strong>长视频理解中的“语义聚合幻觉”（Semantic Aggregation Hallucination, SAH）</strong>。<br>具体而言，当视频多模态大语言模型（Video-MLLM）能够正确感知每一帧的局部语义，却在将这些帧级语义聚合成事件级语义时，错误地把属于事件 A 的视觉元素关联到事件 B 的概念上，从而产生与视频内容不符的幻觉。这种幻觉在短视频中影响有限，但在包含多个事件的<strong>长视频</strong>中，由于语义复杂度显著增加，SAH 变得尤为突出且难以被现有基准发现。</li>
</ul>
<p>因此，论文旨在：</p>
<ol>
<li><strong>首次系统性地揭示并量化 SAH</strong>：指出以往短视频幻觉基准忽视的“正确感知却错误聚合”现象。</li>
<li><strong>构建专门基准 ELV-Halluc</strong>：通过事件级长视频、对抗式三元组问答设计（GT / In-Video Hallucination / Out-Video Hallucination）和 SAH Ratio 指标，精确度量模型在多事件语义场景下的聚合错误。</li>
<li><strong>分析 SAH 的诱因</strong>：验证其与语义复杂度（事件数量、细粒度语义变化速度）正相关，而与视频时长、模型规模无必然联系。</li>
<li><strong>提出并验证缓解策略</strong>：<ul>
<li>改进位置编码（VideoRoPE）强化帧-事件绑定；</li>
<li>利用 DPO（Direct Preference Optimization）在 8 K 对抗样本上训练，使模型更倾向正确事件语义，最终在 ELV-Halluc 上将 SAH Ratio 降低 27.7%，同时在通用基准 Video-MME 上提升 0.9%。</li>
</ul>
</li>
</ol>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>与 ELV-Halluc 直接相关的研究可分为两大类：</p>
<ol>
<li><strong>视频理解基准</strong>（关注长视频、事件级或细粒度理解）；</li>
<li><strong>视频幻觉评测基准</strong>（聚焦幻觉类型、成因与度量）。</li>
</ol>
<p>以下按类别列出代表性工作，并说明与本文的差异。</p>
<p>1. 视频理解基准（Video Understanding Benchmarks）</p>
<p>基准</p>
<p>核心关注点</p>
<p>与 ELV-Halluc 的关系</p>
<p><strong>Video-MME</strong> (Fu et al. 2025)</p>
<p>覆盖短视频、中视频、长视频的多维度理解任务</p>
<p>未专门考察幻觉，尤其未区分 SAH</p>
<p><strong>MVBench</strong> (Li et al. 2024c)</p>
<p>多模态视频理解综合评测</p>
<p>同样未针对长视频中语义聚合错误</p>
<p><strong>ETBench</strong> (Liu et al. 2024)</p>
<p>事件级时间定位与推理</p>
<p>强调事件边界，但未设计幻觉诊断</p>
<p><strong>Video-Holmes</strong> (Cheng et al. 2025)</p>
<p>复杂推理能力（如侦探式问答）</p>
<p>关注推理深度而非幻觉类型</p>
<p><strong>LVBench</strong> (Wang et al. 2024b)</p>
<p>超长（&gt;1 h）视频理解</p>
<p>评测长视频整体理解，未细分幻觉</p>
<p><strong>MLVU</strong> (Zhou et al. 2024)</p>
<p>多任务长视频理解（整体、单细节、多细节推理）</p>
<p>未引入对抗式幻觉问答</p>
<p><strong>EgoSchema</strong> (Mangalam et al. 2023)</p>
<p>第一视角长视频问答</p>
<p>场景特殊，未探讨事件间语义错位</p>
<p>2. 视频幻觉评测基准（Hallucination Evaluation in Video-MLLMs）</p>
<p>基准</p>
<p>幻觉分类/方法</p>
<p>与 ELV-Halluc 的差异</p>
<p><strong>VideoHallucer</strong> (Wang et al. 2024c)</p>
<p>将幻觉分为 intrinsic（与视频矛盾） vs. extrinsic（无法仅由视频判定）</p>
<p>面向短视频，未讨论事件间语义聚合错误</p>
<p><strong>EventHallusion</strong> (Zhang et al. 2024a)</p>
<p>通过罕见事件与误导语境分析语言先验 &amp; 视觉-语言偏差</p>
<p>仅短视频，未显式定义 SAH</p>
<p><strong>VidHalluc</strong> (Li, Im &amp; Fazli 2025)</p>
<p>评估动态片段中的时序幻觉，指出视觉编码器归纳偏差导致幻觉</p>
<p>未聚焦长视频多事件场景</p>
<p><strong>ARGUS</strong> (Rawal et al. 2025)</p>
<p>开放式视频字幕中的幻觉与遗漏评测</p>
<p>任务形式不同，未设计事件级对抗问答</p>
<p><strong>MHBench</strong> (Kong et al. 2025)</p>
<p>运动幻觉（Motion Hallucination）</p>
<p>关注运动描述真实性，而非跨事件语义错位</p>
<p>小结</p>
<p>现有基准要么<strong>仅覆盖短视频</strong>（VideoHallucer, EventHallusion, VidHalluc），要么<strong>未将幻觉细分为语义聚合错误</strong>（Video-MME, MVBench, LVBench 等）。ELV-Halluc 首次把“正确感知却错误聚合”的 SAH 现象独立出来，并通过长视频、事件级对抗问答与 SAH Ratio 指标，填补了上述空白。</p>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>为系统性地解决“语义聚合幻觉（SAH）”这一长视频理解中的新问题，论文从 <strong>诊断 → 量化 → 归因 → 缓解</strong> 四个环节展开，形成闭环方案。</p>
<p>1. 诊断：构建专用基准 ELV-Halluc</p>
<ul>
<li><strong>事件级长视频数据</strong><br>手动收集 348 条“事件-事件”型长视频（平均 672 s），每段包含 2–10 个清晰分离的事件，天然放大跨事件语义混淆风险。</li>
<li><strong>对抗式三元组问答</strong><br>每个事件对应 3 条问答：<br>① Ground-Truth（GT）<br>② In-Video Hallucination（将 A 事件的对象/动作/细节挪到 B 事件）<br>③ Out-Video Hallucination（引入完全不存在的内容）<br>仅当模型对 GT 答“Yes”且对幻觉答“No”才算正确。</li>
<li><strong>SAH Ratio 指标</strong>  <script type="math/tex; mode=display">\\text{SAH Ratio}= \\frac{\\text{OutAcc}-\\text{InAcc}}{1-\\text{InAcc}}</script>该比值直接衡量“因跨事件语义错位导致的幻觉”在全部幻觉中的占比，消除绝对性能差异带来的干扰。</li>
</ul>
<p>2. 量化：大规模实验刻画 SAH 规律</p>
<ul>
<li><strong>覆盖 16 个模型</strong>（14 个开源 1 B–78 B + GPT-4o / Gemini-2.5-flash）。</li>
<li><strong>发现一：SAH 与语义复杂度正相关</strong><br>事件数量 ↑ → SAH Ratio ↑（图 6a）；视频时长与 SAH 无显著关系。</li>
<li><strong>发现二：SAH 与语义变化速度正相关</strong><br>细粒度、变化快的语义（视觉细节 &gt; 动作 &gt; 对象 &gt; 陈述内容）SAH Ratio 更高（图 7）。</li>
<li><strong>发现三：帧数 ↑ 带来双重效应</strong><br>整体幻觉准确率提升，但 SAH Ratio 也同步升高（图 8），说明“信息更丰富”≠“聚合更准”。</li>
</ul>
<p>3. 归因：定位 SAH 产生机制</p>
<ul>
<li><strong>帧-事件绑定薄弱</strong> 导致模型在聚合阶段把正确帧级特征错配到错误事件。</li>
<li><strong>位置编码缺陷</strong> 是重要诱因：标准 RoPE 对长视频跨事件时序关系建模不足。</li>
</ul>
<p>4. 缓解：两条正交策略</p>
<p>4.1 强化位置编码——VideoRoPE</p>
<ul>
<li>在 Qwen2-VL 框架上比较 4 种 RoPE 变体<ul>
<li>vanilla RoPE / TAD-RoPE / m-RoPE / <strong>VideoRoPE</strong></li>
</ul>
</li>
<li>结果：VideoRoPE 将 SAH Ratio 降到 0.88%（表 3），验证“增强时序绑定即可抑制 SAH”。</li>
</ul>
<p>4.2 偏好优化——DPO（Direct Preference Optimization）</p>
<ul>
<li><strong>数据构造</strong><br>用剩余 148 条视频的 GT 与幻觉字幕构建 8 K 对偏好样本（4 K In-Video + 4 K Out-Video）。</li>
<li><strong>训练设置</strong><br>以 Qwen2.5-VL-7B 为基座，三种方案：<br>① 仅用 In-Video 对；② 仅用 Out-Video 对；③ 混合 8 K 对。</li>
<li><strong>结果</strong><ul>
<li>方案① SAH Ratio 从 8.3% → 6.0%（↓27.7%），ELV-Halluc 整体准确率 ↑0.3，Video-MME ↑0.4。</li>
<li>方案② 反而略升 SAH，说明“拒绝完全不存在内容”对抑制跨事件错位帮助有限。</li>
<li>方案③ 在两者间取得平衡，但未超越方案①。</li>
</ul>
</li>
<li><strong>注意力可视化</strong>（图 9）<br>DPO 后模型对错误但语义相似区域的关注显著下降，提供可解释证据。</li>
</ul>
<p>总结流程</p>
<pre><code>graph TD
    A[发现 SAH 现象] --&gt; B[构建 ELV-Halluc 基准]
    B --&gt; C[实验量化 SAH 规律]
    C --&gt; D[定位帧-事件绑定薄弱为根因]
    D --&gt; E[VideoRoPE 强化位置编码]
    D --&gt; F[DPO 抑制幻觉偏好]
    E &amp; F --&gt; G[SAH Ratio ↓27.7%&lt;br&gt;Video-MME ↑0.9%]
</code></pre><p>通过“基准+指标+归因+策略”的完整闭环，论文首次将长视频中的语义聚合幻觉问题转化为可度量、可干预的研究方向。</p>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文围绕 <strong>ELV-Halluc 基准</strong> 共设计并执行了 4 组核心实验，覆盖 <strong>诊断→量化→归因→缓解</strong> 全链路。实验结果均在正文与附录中给出详细数值、图表与统计检验。以下按实验目标归纳：</p>
<p>1. 诊断实验：ELV-Halluc 基准整体评估</p>
<p><strong>目的</strong>：验证 SAH 存在性，给出各模型在长视频幻觉上的基线。<br><strong>设置</strong></p>
<ul>
<li>16 个模型：14 个开源（1 B–78 B）+ GPT-4o + Gemini-2.5-Flash</li>
<li>4,800 条二元 QA（4 个语义粒度 × 6 题/粒度 × 200 视频）</li>
<li>指标：In-Video Acc、Out-Video Acc、SAH Ratio</li>
</ul>
<p><strong>关键结果</strong>（表 2）</p>
<p>模型</p>
<p>In-Video Acc</p>
<p>Out-Video Acc</p>
<p>SAH Ratio↓</p>
<p>Qwen2.5-VL-32B</p>
<p>24.5 %</p>
<p>24.5 %</p>
<p><strong>0.2 %</strong></p>
<p>GPT-4o</p>
<p>8.3 %</p>
<p>8.7 %</p>
<p>1.0 %</p>
<p>Gemini-2.5-Flash</p>
<p>58.0 %</p>
<p>47.0 %</p>
<p>11.0 %</p>
<blockquote>
<p>所有模型 In-Video Acc 显著低于 Out-Video Acc，首次实证 SAH 普遍存在。</p>
</blockquote>
<p>2. 量化实验：SAH 与视频/模型属性关系</p>
<p>2.1 事件数量 vs. SAH Ratio</p>
<ul>
<li>横轴：每视频事件数（4–10）</li>
<li>纵轴：SAH Ratio</li>
<li>结果（图 6a）：Pearson r ≈ 0.85，<strong>事件越多 → SAH 越严重</strong>。</li>
</ul>
<p>2.2 视频时长 vs. SAH Ratio</p>
<ul>
<li>时长分桶：0–3 min、3–6 min、…、&gt;21 min</li>
<li>结果（图 6b）：时长与 SAH Ratio <strong>无显著线性关系</strong>（p &gt; 0.1）。</li>
</ul>
<p>2.3 语义粒度 vs. SAH Ratio</p>
<ul>
<li>四类粒度：Visual Details / Action / Object / Declarative Content</li>
<li>14 个开源模型平均（图 7）：<ul>
<li>Visual Details：SAH Ratio ≈ 0.12</li>
<li>Action：≈ 0.08</li>
<li>Object：≈ 0.05</li>
<li>Declarative：≈ 0.02<br>→ <strong>细粒度、快速变化语义更易出现 SAH</strong>。</li>
</ul>
</li>
</ul>
<p>3. 归因实验：帧数 &amp; 模型规模对幻觉的影响</p>
<p>3.1 采样帧数消融</p>
<ul>
<li>模型：Qwen2.5-VL 3 B/7 B/32 B/72 B、InternVL3 8 B/14 B/32 B</li>
<li>帧数：16 / 32 / 64 / 128 / 256（Qwen），16 / 32 / 48 / 64（InternVL3）</li>
<li>结果（图 8）：<ul>
<li><strong>整体幻觉准确率</strong>：随帧数 ↑ 而 ↑（信息增多）。</li>
<li><strong>SAH Ratio</strong>：大多数模型随帧数 ↑ 而 ↑（语义错位风险增大）。</li>
<li><strong>例外</strong>：Qwen2.5-VL-32B 因 RL 后训练，SAH Ratio 反而下降。</li>
</ul>
</li>
</ul>
<p>3.2 规模效应</p>
<ul>
<li>横轴：模型参数量（1 B→78 B）</li>
<li>结论：<ul>
<li>整体幻觉准确率与规模 <strong>正相关</strong>。</li>
<li>SAH Ratio <strong>无明显规模单调性</strong>（32 B 模型优于 72 B）。</li>
</ul>
</li>
</ul>
<p>4. 缓解实验：位置编码与 DPO</p>
<p>4.1 位置编码策略比较</p>
<ul>
<li>基座：Qwen2-VL</li>
<li>4 种 RoPE：vanilla / TAD / m-RoPE / <strong>VideoRoPE</strong></li>
<li><p>结果（表 3）：</p>
<p>方法</p>
<p>SAH Ratio↓</p>
<p>vanilla RoPE</p>
<p>1.82 %</p>
<p>VideoRoPE</p>
<p><strong>0.88 %</strong></p>
</li>
</ul>
<p>4.2 DPO 偏好优化</p>
<ul>
<li><p>基座：Qwen2.5-VL-7B</p>
</li>
<li><p>数据集：4 K In-Video 对 / 4 K Out-Video 对 / 8 K 混合</p>
</li>
<li><p>结果（表 4）：</p>
<p>训练设置</p>
<p>ELV-Halluc SAH Ratio↓</p>
<p>Video-MME Avg↑</p>
<p>基座</p>
<p>8.3 %</p>
<p>61.9 %</p>
<p>+ In-Video 4 K</p>
<p><strong>6.0 % (↓27.7 %)</strong></p>
<p>62.3 %</p>
<p>+ Out-Video 4 K</p>
<p>8.6 % (↑3.6 %)</p>
<p>62.8 %</p>
<p>+ 8 K 混合</p>
<p>8.4 % (↑1.2 %)</p>
<p>62.4 %</p>
</li>
<li><p><strong>注意力可视化</strong>（图 9）：DPO 后模型对错误区域注意力显著下降，提供机制解释。</p>
</li>
</ul>
<p>5. 稳定性验证（附录实验）</p>
<ul>
<li>选取 4 个不同规模/系列模型，各跑 3 次</li>
<li>结果（附录图 1）：Overall Acc 与 SAH Ratio 的标准差 &lt; 0.5 %，<strong>ELV-Halluc 评测稳定可靠</strong>。</li>
</ul>
<p>实验全景一览</p>
<p>实验类别</p>
<p>变量</p>
<p>结论</p>
<p>基准诊断</p>
<p>16 模型 × 4,800 QA</p>
<p>SAH 普遍存在</p>
<p>复杂度分析</p>
<p>事件数、时长、语义粒度</p>
<p>事件数↑、粒度细 → SAH↑</p>
<p>帧数/规模</p>
<p>采样帧数、模型大小</p>
<p>帧数↑ 整体好但 SAH↑；规模对 SAH 无单调改善</p>
<p>缓解策略</p>
<p>RoPE 变体、DPO 训练</p>
<p>VideoRoPE 与 In-Video DPO 分别将 SAH Ratio 降至 0.88 % 与 6.0 %</p>
<p>通过上述多维度实验，论文完整揭示了 SAH 的分布规律、影响因素与可行缓解路径。</p>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可在 ELV-Halluc 的基础上继续深入，分为 <strong>数据与任务扩展、机制剖析、模型改进、评测维度、应用落地</strong> 五大类，并给出可立即着手的研究思路。</p>
<p>1. 数据与任务扩展</p>
<ul>
<li><strong>更长、更密、更真实的长视频</strong><br>当前平均 11 min、最大 ~30 min；可收集 1 h+ 的 vlog、监控、直播流，验证 SAH 在极端长度下的饱和或爆炸趋势。</li>
<li><strong>非事件型长视频</strong><br>电影、电视剧、纪录片缺乏清晰事件边界，需设计无监督事件分割 + 幻觉检测联合任务。</li>
<li><strong>多语言 / 多模态音频</strong><br>引入非英语旁白、背景音乐、环境声，研究音频-视觉-文本三重聚合幻觉。</li>
<li><strong>时序反事实 QA</strong><br>不仅问“发生了什么”，而是“如果事件 A 提前 10 s，结果会怎样”，考察模型对因果链的聚合鲁棒性。</li>
</ul>
<p>2. 机制剖析</p>
<ul>
<li><strong>细粒度时序注意力可视化</strong><br>在帧级、事件级、跨事件级分别计算注意力熵，定位 SAH 发生的“时间-语义”热点。</li>
<li><strong>层级化记忆结构消融</strong><br>显式构建“帧缓存 → 事件缓存 → 全局记忆”三级存储，逐层关闭跨层写入，量化哪一级最易引入错位。</li>
<li><strong>误差传播实验</strong><br>人为在某一事件注入微小错误（如颜色偏差），观察后续事件的描述如何被级联放大，验证“语义漂移”假设。</li>
</ul>
<p>3. 模型改进</p>
<ul>
<li><strong>事件级对比学习</strong><br>在同一视频内构造正负事件对，拉近同一事件帧特征、推远不同事件特征，直接优化聚合边界。</li>
<li><strong>动态事件提示（Event Prompt Tuning）</strong><br>为每个事件生成可学习的 prompt token，强制模型在回答前先“聚焦”到对应事件区间。</li>
<li><strong>时序-因果 Transformer</strong><br>在自注意力中显式加入因果掩码 + 事件 ID 编码，阻断未来事件对当前事件的信息泄漏。</li>
<li><strong>链式聚合策略</strong><br>先让模型输出事件级草稿，再基于草稿做二次精修，类似“CoT for video”，降低一次性长上下文聚合压力。</li>
</ul>
<p>4. 评测维度</p>
<ul>
<li><strong>细粒度 SAH 子类型</strong><br>将 SAH 拆分为“对象错位、动作错位、时间错位、因果错位”四类，分别计算 Ratio，指导针对性改进。</li>
<li><strong>人类一致性校准</strong><br>引入多人标注的“可接受误差区间”，区分“严格幻觉”与“人类亦模糊”的灰色案例，避免过度优化。</li>
<li><strong>在线/流式场景</strong><br>模拟实时直播：边接收帧边回答问题，评测模型在“部分可见”条件下的 SAH 动态曲线。</li>
</ul>
<p>5. 应用落地</p>
<ul>
<li><strong>长视频摘要与搜索</strong><br>将 SAH Ratio 作为自动摘要系统的风险指标，触发“人工二次确认”阈值。</li>
<li><strong>法律/监控领域</strong><br>针对监控长视频，开发“事件证据链”校验工具，若检测到 SAH 高置信区间，提示审查员重点回放。</li>
<li><strong>教育与培训</strong><br>在 MOOC 长视频中实时检测 SAH，自动插入“注意：此处讲解可能与画面不符”提示，提升学习可靠性。</li>
</ul>
<p>可立即启动的短期项目（3–6 个月）</p>
<ol>
<li><strong>在现有 348 条视频上训练事件级对比学习模块</strong>，复用 ELV-Halluc 标注即可。</li>
<li><strong>将 VideoRoPE 迁移到 InternVL3-78B</strong>，观察更大模型是否进一步降低 SAH。</li>
<li><strong>构建 50 小时直播流子集</strong>，用滑动窗口实时计算 SAH Ratio，绘制“幻觉热图”。</li>
</ol>
<p>这些方向既可直接基于 ELV-Halluc 的数据与指标展开，也能推动长视频理解从“能看懂”走向“看得准、信得过”。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>论文核心概要：ELV-Halluc——长视频语义聚合幻觉基准与缓解方案</p>
<ol>
<li><p><strong>问题定义</strong><br>首次指出长视频理解中一种被忽视的幻觉类型——<strong>语义聚合幻觉（SAH）</strong>：模型虽能正确识别每一帧的局部语义，却在将帧级语义聚合成事件级语义时，把属于事件 A 的内容张冠李戴到事件 B，导致最终答案与视频不符。</p>
</li>
<li><p><strong>基准构建</strong></p>
<ul>
<li><strong>ELV-Halluc</strong>：首个面向长视频的幻觉评测基准。</li>
<li>348 条“事件-事件”型长视频（平均 11 min），人工精修事件级字幕。</li>
<li>对抗式三元组问答：GT / In-Video Hallucination / Out-Video Hallucination。</li>
<li>提出 <strong>SAH Ratio</strong> 指标：  <script type="math/tex; mode=display">\\text{SAH Ratio}= \\frac{\\text{OutAcc}-\\text{InAcc}}{1-\\text{InAcc}}</script>专门量化跨事件语义错位导致的幻觉比例。</li>
</ul>
</li>
<li><p><strong>大规模实验发现</strong></p>
<ul>
<li><strong>普遍存在</strong>：16 个主流 Video-MLLM（1 B–78 B）均出现显著 SAH。</li>
<li><strong>复杂度驱动</strong>：事件数量↑、语义粒度越细（视觉细节 &gt; 动作 &gt; 对象 &gt; 陈述内容），SAH Ratio 越高。</li>
<li><strong>帧数双刃剑</strong>：采样帧数↑ 提升整体准确率，却同时放大 SAH。</li>
<li><strong>规模非解药</strong>：增大模型规模对 SAH 无单调改善。</li>
</ul>
</li>
<li><p><strong>缓解策略</strong></p>
<ul>
<li><strong>VideoRoPE</strong>：改进的旋转位置编码，强化帧-事件绑定，SAH Ratio 降至 0.88%。</li>
<li><strong>DPO 偏好优化</strong>：用 8 K 对抗样本（4 K In-Video + 4 K Out-Video）训练 Qwen2.5-VL-7B，SAH Ratio 从 8.3% → 6.0%（↓27.7%），Video-MME 提升 0.9%，且不损通用性能。</li>
</ul>
</li>
<li><p><strong>贡献总结</strong></p>
<ul>
<li>首次系统定义并评测长视频语义聚合幻觉。</li>
<li>提供公开基准、指标与 8 K 对抗训练数据，推动长视频理解从“能看懂”走向“看得准、信得过”。</li>
</ul>
</li>
</ol>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是ELV-Halluc%3A%20Benchmarking%20Semantic%20Aggregation%20Hallucinations%20in%20Long%20Video%20Understanding，链接是  https://arxiv.org/pdf/2508.21496  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2508.21496  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Hao Lu,Jiahao Wang,Yaolun Zhang,Ruohui Wang,Xuanyu Zheng,Yepeng Tang,Dahua Lin,Lewei Lu</p>
<p><strong>Categories</strong>: cs.CV,cs.AI</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2508.21496.pdf">https://arxiv.org/pdf/2508.21496.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2508.21496">https://arxiv.org/abs/2508.21496</a></p>
<p><strong>Arxiv ID</strong>: 2508.21496</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2508.21496">https://papers.cool/arxiv/2508.21496</a></p>
<p><strong>Published</strong>: 2025-08-29T10:25:03Z</p>
<p><strong>Updated</strong>: 2025-08-29T10:25:03.000Z</p>
<hr>
<h3 id="6-VerlTool-Towards-Holistic-Agentic-Reinforcement-Learning-with-Tool-Use"><a href="#6-VerlTool-Towards-Holistic-Agentic-Reinforcement-Learning-with-Tool-Use" class="headerlink" title="6. VerlTool: Towards Holistic Agentic Reinforcement Learning with Tool Use"></a>6. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.01055">VerlTool: Towards Holistic Agentic Reinforcement Learning with Tool Use</a></h3><p>Reinforcement Learning with Verifiable Rewards (RLVR) has demonstrated success in enhancing LLM reasoning capabilities, but remains limited to single-turn interactions without tool integration. While recent Agentic Reinforcement Learning with Tool use (ARLT) approaches have emerged to address multi-turn tool interactions, existing works develop task-specific codebases that suffer from fragmentation, synchronous execution bottlenecks, and limited extensibility across domains. These inefficiencies hinder broader community adoption and algorithmic innovation. We introduce VerlTool, a unified and modular framework that addresses these limitations through systematic design principles. VerlTool provides four key contributions: (1) upstream alignment with VeRL ensuring compatibility and simplified maintenance, (2) unified tool management via standardized APIs supporting diverse modalities including code execution, search, SQL databases, and vision processing, (3) asynchronous rollout execution achieving near 2$\times$ speedup by eliminating synchronization bottlenecks, and (4) comprehensive evaluation demonstrating competitive performance across 6 ARLT domains. Our framework formalizes ARLT as multi-turn trajectories with multi-modal observation tokens (text/image/video), extending beyond single-turn RLVR paradigms. We train and evaluate models on mathematical reasoning, knowledge QA, SQL generation, visual reasoning, web search, and software engineering tasks, achieving results comparable to specialized systems while providing unified training infrastructure. The modular plugin architecture enables rapid tool integration requiring only lightweight Python definitions, significantly reducing development overhead and providing a scalable foundation for tool-augmented RL research. Our code is open-sourced at <a target="_blank" rel="noopener" href="https://github.com/TIGER-AI-Lab/verl-tool">https://github.com/TIGER-AI-Lab/verl-tool</a>.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>带可验证奖励的强化学习（RLVR）已成功提升大语言模型（LLM）的推理能力，但仍然仅限于单回合交互，没有工具集成。尽管最近出现的代理强化学习与工具使用（ARLT）方法旨在解决多回合工具交互的问题，现有的工作却开发了特定任务的代码库，导致碎片化、同步执行瓶颈和跨领域有限的可扩展性。这些低效率阻碍了更广泛的社区采用和算法创新。我们推出了 VerlTool，这是一个统一且模块化的框架，通过系统的设计原则解决这些局限性。VerlTool 提供了四个关键贡献：（1）与 VeRL 的上游对齐，确保兼容性和简化维护；（2）通过标准化的 API 统一工具管理，支持包括代码执行、搜索、SQL 数据库和视觉处理等多种模式；（3）异步上线执行，消除同步瓶颈，达到接近 2 倍的加速；（4）全面评估展示在 6 个 ARLT 领域中的竞争性能。我们的框架将 ARLT 形式化为具有多模态观察 Token（文本/图像/视频）的多回合轨迹，超越了单回合 RLVR 范式。我们在数学推理、知识问答、SQL 生成、视觉推理、网络搜索和软件工程任务上训练和评估模型，取得了与专用系统相媲美的结果，同时提供统一的训练基础设施。模块化插件架构使得工具集成迅速，仅需轻量级的 Python 定义，显著减少了开发开销，并为增强工具的 RL 研究提供了可扩展的基础。我们的代码已在 <a target="_blank" rel="noopener" href="https://github.com/TIGER-AI-Lab/verl-tool">https://github.com/TIGER-AI-Lab/verl-tool</a> 开源。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>论文针对当前 <strong>Agentic Reinforcement Learning with Tool use（ARLT）</strong> 研究中的三大瓶颈，提出统一框架 VERLTOOL，以解决以下核心问题：</p>
<ol>
<li><p><strong>碎片化与可扩展性差</strong><br>现有 ARLT 系统多为任务特定实现，工具逻辑与训练循环紧耦合，导致：</p>
<ul>
<li>每新增工具或任务需重写大量代码；</li>
<li>社区难以复现或迁移已有工作。</li>
</ul>
</li>
<li><p><strong>同步执行效率低</strong><br>传统框架按批次同步等待工具返回，GPU/CPU 出现大量空闲“气泡”，在多工具、多回合场景下吞吐率急剧下降。</p>
</li>
<li><p><strong>多模态支持不足</strong><br>主流 RL 框架仅处理文本，而视觉、视频、SQL 结果等多模态工具输出缺乏统一接口，难以在同一训练流程中无缝集成。</p>
</li>
<li><p><strong>单回合 RLVR 的局限</strong><br>RLVR 仅优化单回合、可验证答案，无法建模多回合交互中的信用分配、错误恢复与策略迭代，限制了模型在真实环境中的自主决策能力。</p>
</li>
</ol>
<p>VERLTOOL 通过 <strong>模块化插件架构 + 异步 rollout + 统一多模态 API</strong> 将 ARLT 形式化为多回合、多模态观测的强化学习问题，并在数学推理、知识问答、SQL 生成、视觉推理、网页搜索、软件工程等六大领域验证其通用性与性能。</p>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>论文在第 2 节与附录 B 中对相关研究进行了系统梳理，可归纳为四大类：</p>
<p>1. 工具增强推理（Tool-Integrated Reasoning）</p>
<ul>
<li><p><strong>Prompt-based 方法</strong></p>
<ul>
<li>HuggingGPT (Shen et al., 2023)</li>
<li>Chameleon (Lu et al., 2023)</li>
<li>MultiTool-CoT (Inaba et al., 2023)<br>特点：零样本或少量示例即可调用工具，但静态模板难以适应复杂多步任务。</li>
</ul>
</li>
<li><p><strong>监督微调方法</strong></p>
<ul>
<li>Toolformer (Schick et al., 2023) – 自举式工具调用数据合成</li>
<li>GPT4Tools (Yang et al., 2023) – 蒸馏 GPT-4 工具轨迹</li>
<li>LIMO (Ye et al., 2025) – 少样本激发长链推理<br>特点：提升单轮调用准确性，缺乏动态错误修正能力。</li>
</ul>
</li>
</ul>
<p>2. 强化学习驱动的工具使用（RL for Agentic Tool Use）</p>
<ul>
<li><p><strong>早期探索</strong></p>
<ul>
<li>ReAct (Yao et al., 2022) – 思维链+行动交替提示</li>
<li>TPTU-v2 (Kong et al., 2023) – 任务规划与工具调用联合微调</li>
</ul>
</li>
<li><p><strong>近期 ARLT 工作</strong></p>
<ul>
<li>ToRL (Li et al., 2025c) – Python 解释器 + GRPO 数学推理</li>
<li>SEARCH-R1 (Jin et al., 2025) – 搜索引擎 + GRPO 问答</li>
<li>Pixel-Reasoner (Su et al., 2025) – 视觉操作 + 好奇心奖励</li>
<li>RETOOL (Feng et al., 2025) – PPO 训练工具调用策略</li>
<li>EXCOT / THINK2SQL (Zhai et al., 2025; Papicchio et al., 2025) – SQL 执行反馈 + GRPO</li>
</ul>
</li>
</ul>
<p>3. RL 训练框架</p>
<p>框架</p>
<p>工具支持</p>
<p>同步/异步</p>
<p>备注</p>
<p>OPENRLHF (Hu et al., 2024)</p>
<p>Python, FAISS</p>
<p>同步</p>
<p>无原生多模态工具</p>
<p>VERL (Sheng et al., 2024)</p>
<p>Python, FAISS</p>
<p>同步</p>
<p>被 VERLTOOL 继承</p>
<p>AREAL (Fu et al., 2025)</p>
<p>搜索</p>
<p>异步</p>
<p>轻量级异步 RL</p>
<p>ROLL (Wang et al., 2025a)</p>
<p>无</p>
<p>异步</p>
<p>专注算法效率</p>
<p>SKYRL (Cao et al., 2025)</p>
<p>Bash, SQL, Image</p>
<p>同步</p>
<p>需容器化部署</p>
<p><strong>VERLTOOL</strong></p>
<p><strong>全六类工具</strong></p>
<p><strong>异步</strong></p>
<p><strong>统一插件架构</strong></p>
<p>4. 领域特定基准与数据集</p>
<ul>
<li><strong>数学</strong> – MATH-500, GSM8K, AIME24, DeepMath-103k</li>
<li><strong>知识问答</strong> – NQ, TriviaQA, HotpotQA, MuSiQue</li>
<li><strong>SQL</strong> – Spider, Spider-DK, Spider-SYN</li>
<li><strong>视觉推理</strong> – V* Bench</li>
<li><strong>网页搜索</strong> – GAIA, HLE</li>
<li><strong>软件工程</strong> – SWE-bench, R2E-Gym</li>
</ul>
<p>综上，VERLTOOL 在工具类型覆盖、训练范式（多回合 RL）、系统效率（异步 rollout）与模块化设计方面，与现有研究形成互补或超越。</p>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文通过提出 <strong>VERLTOOL</strong> 框架，从系统架构、训练范式与工程实现三个层面解决前述瓶颈，具体手段如下：</p>
<p>1. 统一且可扩展的系统架构</p>
<p><strong>问题对应</strong>：碎片化、任务特定代码难以复用<br><strong>解决方案</strong>：</p>
<ul>
<li><p><strong>模块化插件设计</strong></p>
<ul>
<li>每个工具实现为 <code>BaseTool</code> 子类，仅需 30–50 行 Python 代码即可注册新工具（图 3）。</li>
<li>工具与 RL 训练逻辑完全解耦，通过标准化 JSON API 通信，支持 <strong>代码、搜索、SQL、Bash、图像、MCP</strong> 六类工具（表 2）。</li>
</ul>
</li>
<li><p><strong>Upstream-Aligned 继承</strong></p>
<ul>
<li>将 VERL 作为 git submodule，确保与上游 RL 库同步更新，避免维护分叉。</li>
</ul>
</li>
</ul>
<p>2. 异步多回合训练范式</p>
<p><strong>问题对应</strong>：同步等待导致 GPU 空闲、单回合 RLVR 无法建模长程交互<br><strong>解决方案</strong>：</p>
<ul>
<li><p><strong>异步 Rollout 引擎</strong></p>
<ul>
<li>每完成一条轨迹的 action 生成即独立调用工具，消除批次级同步等待（图 2）。</li>
<li>8×H100 实测：数学任务提速 <strong>1.32×</strong>，搜索任务 <strong>1.97×</strong>（表 3）。</li>
</ul>
</li>
<li><p><strong>多回合 ARLT 形式化</strong></p>
<ul>
<li>轨迹定义为  <script type="math/tex; mode=display">\\tau = {a\_0, o\_0, a\_1, o\_1, \\dots, a\_n}</script>其中 $o_i$ 为工具返回的多模态观测 token，显式参与奖励计算但被 mask 不参与策略梯度（式 5），避免 off-policy 不稳定。</li>
</ul>
</li>
<li><p><strong>并行后端</strong></p>
<ul>
<li>轻量级工具用 <code>ThreadPoolExecutor</code>，重工具（Docker、浏览器）可切换 <strong>Ray</strong> 分布式执行，支持弹性资源调度。</li>
</ul>
</li>
</ul>
<p>3. 多模态与奖励工程</p>
<p><strong>问题对应</strong>：视觉、SQL 结果等非文本观测难以统一处理<br><strong>解决方案</strong>：</p>
<ul>
<li><p><strong>统一观测编码</strong></p>
<ul>
<li>图像/视频/表格结果经工具服务器序列化为文本或 base64，直接拼接到上下文；tokenization 采用 <strong>分离策略</strong> 避免边界 token 漂移（图 4）。</li>
</ul>
</li>
<li><p><strong>任务特定奖励</strong></p>
<ul>
<li>数学：$R_{\text{math}} = R_{\text{acc}} - 0.25 \cdot \mathbb{I}_{\text{no-tool}}$，鼓励调用解释器验证。</li>
<li>视觉：额外好奇心奖励 $r_{\text{curiosity}} = \max(0.3 - \text{tool-call-ratio}, 0)$ 防止过早退化。</li>
<li>网页搜索：$R_{\text{tool}} = +0.1$ 仅当触发搜索，平衡效率与信息增益。</li>
</ul>
</li>
</ul>
<p>4. 端到端验证</p>
<p><strong>问题对应</strong>：缺乏统一基准验证通用性<br><strong>解决方案</strong>：</p>
<ul>
<li><strong>六大任务全覆盖</strong>（表 4–8）<ul>
<li>数学推理（VT-Math）：AIME24 达 <strong>30.0%</strong>（7B）</li>
<li>知识问答（VT-Search）：NQ +43.9 pp 超越直接推理</li>
<li>SQL 生成（VT-SQL）：Spider-Test <strong>83.4%</strong> 匹配专用系统</li>
<li>视觉推理（VT-VisualReasoner）：V* Bench <strong>82.7%</strong></li>
<li>网页搜索（VT-DeepSearch）：GAIA <strong>34.0%</strong>（8B）</li>
<li>软件工程（VT-SWE）：SWE-Verified <strong>19.5</strong> 分，领先 OpenHands 基线</li>
</ul>
</li>
</ul>
<p>小结</p>
<p>VERLTOOL 通过 <strong>“插件化工具 + 异步引擎 + 多模态统一接口 + 任务定制奖励”</strong> 的组合拳，将 ARLT 从分散的专用系统升级为可扩展的统一框架，兼顾研究效率与社区复现需求。</p>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文在 <strong>6 个具有代表性的 ARLT 任务</strong> 上进行了系统实验，覆盖数学推理、知识问答、SQL 生成、视觉推理、网页搜索和软件工程六大领域。所有实验均在 <strong>统一的 VERLTOOL 框架</strong> 内完成，既验证框架通用性，也与现有专用系统对比性能。</p>
<p>1. VT-Math：数学推理 + Python 代码解释器</p>
<ul>
<li><strong>数据集</strong><br>DeepMath-103k 训练；MATH-500、GSM8K、AIME24、AMC23、Olympiad Bench 等 7 个基准评估。</li>
<li><strong>结果</strong>（表 4）<ul>
<li>1.5 B：VT-Math-DAPO <strong>55.5</strong> vs ToRL-1.5B <strong>55.2</strong></li>
<li>7 B：VT-Math-DAPO <strong>62.2</strong> vs ToRL-7B <strong>61.1</strong></li>
<li>在 AIME24 上 7B 模型首次达到 <strong>36.7–43.3%</strong>，显著优于 Instruct 基线（16.7%）。</li>
</ul>
</li>
</ul>
<p>2. VT-Search：知识问答 + FAISS 检索</p>
<ul>
<li><strong>数据集</strong><br>2018 Wikipedia dump 索引；NQ、TriviaQA、PopQA、HotpotQA、2Wiki、MuSiQue、Bamboogle 共 7 个 QA 基准。</li>
<li><strong>结果</strong>（表 5）<ul>
<li>3 B：VT-Search-GRPO <strong>34.4</strong> vs Search-R1 <strong>31.2</strong></li>
<li>7 B：VT-Search-GRPO <strong>45.9</strong> vs Search-R1 <strong>35.0</strong>（↑10.9 pp）</li>
<li>在多跳问答（HotpotQA、2Wiki）上优势更明显。</li>
</ul>
</li>
</ul>
<p>3. VT-SQL：NL2SQL + SQL 执行器</p>
<ul>
<li><strong>数据集</strong><br>SkyRL-SQL 训练集；Spider-Dev/Test、Spider-Realistic、Spider-DK、Spider-SYN 评估。</li>
<li><strong>结果</strong>（表 6）<ul>
<li>VT-SQL（7B）在 Spider-Test 达到 <strong>83.4%</strong>，与 SkyRL-SQL <strong>85.2%</strong> 相当，且显著高于 GPT-4o（83.2%）。</li>
<li>在跨域 Spider-DK 上 <strong>71.6%</strong>，领先非工具基线 8–12 pp。</li>
</ul>
</li>
</ul>
<p>4. VT-VisualReasoner：视觉推理 + 图像操作</p>
<ul>
<li><strong>数据集</strong><br>Pixel-Reasoner 官方训练集；V* Bench 评估。</li>
<li><strong>结果</strong>（表 7 左）<ul>
<li>GRPO-Complex 奖励下 <strong>82.7%</strong>，超越 Pixel-Reasoner-7B（84.3%）外的所有基线。</li>
<li>证明好奇心奖励能有效防止工具调用退化。</li>
</ul>
</li>
</ul>
<p>5. VT-DeepSearch：开放网页问答 + Google Search API</p>
<ul>
<li><strong>数据集</strong><br>SimpleDeepSearcher + WebSailor 1 k 混合训练；GAIA、HLE 评估。</li>
<li><strong>结果</strong>（表 7 右）<ul>
<li>8B 模型在 GAIA 上 <strong>34.0%</strong>，比 DeepSeek-R1-671B（25.2%）↑8.8 pp。</li>
<li>使用浏览器代理（QwQ-32B）进一步将 HLE 提升到 <strong>8.4%</strong>。</li>
</ul>
</li>
</ul>
<p>6. VT-SWE：软件工程 + Bash/Python 执行</p>
<ul>
<li><strong>数据集</strong><br>R2E-Lite 训练集；SWE-Verified 评估。</li>
<li><strong>结果</strong>（表 8）<ul>
<li>Qwen3-8B 基线 3.6 → VT-SWE <strong>19.5</strong> 分，超越 OpenHands-7B-Agent（11.0）和 SkyRL-v0（14.6）。</li>
<li>在 R2E-Gym 环境下同样领先（10.4 → 19.5）。</li>
</ul>
</li>
</ul>
<p>训练动态与消融分析</p>
<ul>
<li><strong>工具调用演化</strong>（图 5 与正文 §4.2）<ul>
<li>数学任务：平均 1–4 轮即可收敛；SQL 任务 5 轮后调用率迅速下降（记忆效应）。</li>
<li>网页搜索：调用次数随训练持续上升，因信息不可记忆。</li>
</ul>
</li>
<li><strong>异步 vs 同步</strong>（表 3）<ul>
<li>搜索任务异步加速 <strong>1.97×</strong>；数学任务 <strong>1.32×</strong>。</li>
</ul>
</li>
</ul>
<p>小结</p>
<p>任务</p>
<p>关键指标</p>
<p>VERLTOOL 结果</p>
<p>相对基线提升</p>
<p>Math</p>
<p>AIME24</p>
<p>43.3% (7B)</p>
<p>+26.6 pp vs Instruct</p>
<p>Search</p>
<p>NQ/TriviaQA 平均</p>
<p>45.9% (7B)</p>
<p>+10.9 pp vs Search-R1</p>
<p>SQL</p>
<p>Spider-Test</p>
<p>83.4%</p>
<p>持平 SkyRL-SQL</p>
<p>Visual</p>
<p>V* Bench</p>
<p>82.7%</p>
<p>次佳系统外最优</p>
<p>DeepSearch</p>
<p>GAIA</p>
<p>34.0%</p>
<p>+8.8 pp vs 671B 模型</p>
<p>SWE</p>
<p>SWE-Verified</p>
<p>19.5</p>
<p>+5.0 pp vs 最强基线</p>
<p>实验充分证明：在 <strong>统一框架</strong> 下，VERLTOOL 可同时达到或超越各任务专用系统的性能，且具备跨模态、跨任务的通用训练能力。</p>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可作为 VERLTOOL 之后的系统性扩展或深入研究点，按“框架-算法-应用”三层归纳：</p>
<p>1. 框架层：工具生态与系统效率</p>
<ul>
<li><p><strong>异构工具编排</strong></p>
<ul>
<li>引入 <strong>DAG / 图调度器</strong>，让一次推理可并行调用多个工具（如同时搜索+SQL+代码），而非当前线性链式调用。</li>
<li>支持 <strong>工具链缓存</strong>（memoization），对确定性子查询直接复用历史结果，减少冗余执行。</li>
</ul>
</li>
<li><p><strong>更细粒度异步</strong></p>
<ul>
<li>将工具内部步骤（如搜索的“查询→抓取→摘要”）拆分为可中断协程，实现 <strong>token-level streaming</strong>，进一步压缩 GPU 空闲。</li>
</ul>
</li>
<li><p><strong>自适应资源分配</strong></p>
<ul>
<li>基于工具历史耗时与失败率，在线学习为不同工具动态分配 CPU/GPU/内存配额；可结合 Ray autoscaler 实现 <strong>弹性集群</strong>。</li>
</ul>
</li>
</ul>
<p>2. 算法层：训练与推理策略</p>
<ul>
<li><p><strong>长程信用分配</strong></p>
<ul>
<li>当前 GRPO 仅在回合末给奖励。可实验：<ul>
<li><strong>每一步稀疏奖励</strong>（如 SQL 执行错误即负奖励）；</li>
<li><strong>Hindsight Credit Assignment</strong>（事后把成功轨迹的每一步都视为正例）。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>工具调用预算控制</strong></p>
<ul>
<li>引入 <strong>可学习预算 token</strong>，让模型在 prompt 中显式决定“剩余调用次数”，避免过度搜索或过早放弃。</li>
</ul>
</li>
<li><p><strong>多智能体协同</strong></p>
<ul>
<li>将不同工具封装为 <strong>独立智能体</strong>（搜索 Agent、SQL Agent、代码 Agent），通过消息总线协作，研究多智能体 RL 在工具场景下的 scaling law。</li>
</ul>
</li>
<li><p><strong>安全与对齐</strong></p>
<ul>
<li>在奖励函数中加入 <strong>沙箱逃逸检测</strong>、<strong>敏感信息泄露惩罚</strong>，验证 RL 是否仍能保持性能的同时提升安全性。</li>
</ul>
</li>
</ul>
<p>3. 应用层：新领域与评测</p>
<ul>
<li><p><strong>具身与机器人物理交互</strong></p>
<ul>
<li>接入 ROS2、Gazebo 等物理仿真工具，训练 LLM 控制机械臂、无人机，研究 <strong>真实物理反馈</strong> 对策略的影响。</li>
</ul>
</li>
<li><p><strong>科学计算工具链</strong></p>
<ul>
<li>集成 Wolfram Alpha、MATLAB、Jupyter kernel，构建 <strong>自动定理证明 + 符号计算</strong> 的数学研究助手。</li>
</ul>
</li>
<li><p><strong>跨语言 &amp; 跨模态检索</strong></p>
<ul>
<li>在 VT-Search 基础上加入 <strong>多语言维基</strong>、<strong>专利数据库</strong>、<strong>ArXiv 全文</strong>，评测模型在跨语言多跳事实核查上的表现。</li>
</ul>
</li>
<li><p><strong>细粒度评测维度</strong></p>
<ul>
<li>除准确率外，增加 <strong>工具调用效率</strong>（token/调用次数）、<strong>鲁棒性</strong>（对抗性错误 API 返回）、<strong>可解释性</strong>（生成工具调用理由）三维指标，建立更全面的 ARLT 排行榜。</li>
</ul>
</li>
</ul>
<p>4. 数据与模型</p>
<ul>
<li><p><strong>自动课程生成</strong></p>
<ul>
<li>利用工具反馈自动生成 <strong>难度递增</strong> 的任务（如 SQL 从单表到多表 join），研究课程式 RL 能否加速收敛。</li>
</ul>
</li>
<li><p><strong>小模型专用化</strong></p>
<ul>
<li>用 VERLTOOL 训练 <strong>1B 以下</strong> 超小模型，探索在边缘设备上部署工具调用型 Agent 的可行性。</li>
</ul>
</li>
</ul>
<p>一句话总结</p>
<p>VERLTOOL 已打通“多模态工具 + 异步 RL”的任督二脉，下一步可向 <strong>并行工具编排、长程信用分配、物理世界交互、安全对齐</strong> 四大纵深方向推进，持续拓展 Agentic RL 的边界。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>论文一句话总结</p>
<p>VERLTOOL 是一个面向 <strong>Agentic Reinforcement Learning with Tool use（ARLT）</strong> 的统一、高效、可扩展框架，通过模块化插件、异步 rollout 与多模态工具 API，在 6 大任务上实现与专用系统相当或更优的性能，为社区提供了开箱即用的 ARLT 训练基础设施。</p>
<p>主要内容速览</p>
<p>维度</p>
<p>关键要点</p>
<p><strong>问题</strong></p>
<p>• 现有 ARLT 代码碎片化、同步执行低效、多模态支持不足<br>• 单回合 RLVR 无法建模多回合工具交互与信用分配</p>
<p><strong>框架</strong></p>
<p>• <strong>插件式工具服务器</strong>：新增工具仅需 1 个 Python 文件<br>• <strong>异步 rollout</strong>：按轨迹级并行，实测 1.3–2× 提速<br>• <strong>上游对齐</strong>：以 VERL 为子模块，持续兼容更新</p>
<p><strong>训练范式</strong></p>
<p>• 将 ARLT 形式化为多回合轨迹 τ = {a₀,o₀,…,aₙ}<br>• 采用 GRPO，观测 token 被 mask 以稳定训练<br>• 任务定制奖励：准确率 + 工具调用激励</p>
<p><strong>实验</strong></p>
<p>• <strong>6 任务全覆盖</strong>：数学、搜索、SQL、视觉、网页、软件工程<br>• <strong>结果</strong>：在 AIME24、Spider-Test、GAIA、SWE-Verified 等基准上均达到或超越专用系统</p>
<p><strong>贡献</strong></p>
<p>① 统一工具 API ② 异步高效训练 ③ 多模态无缝支持 ④ 开源社区基础设施</p>
<p>代码与复现： <a target="_blank" rel="noopener" href="https://github.com/TIGER-AI-Lab/verl-tool">https://github.com/TIGER-AI-Lab/verl-tool</a></p>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是VerlTool%3A%20Towards%20Holistic%20Agentic%20Reinforcement%20Learning%20with%20Tool%20Use，链接是  https://arxiv.org/pdf/2509.01055  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.01055  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Dongfu Jiang,Yi Lu,Zhuofeng Li,Zhiheng Lyu,Ping Nie,Haozhe Wang,Alex Su,Hui Chen,Kai Zou,Chao Du,Tianyu Pang,Wenhu Chen</p>
<p><strong>Categories</strong>: cs.AI,cs.CL,cs.CV</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.01055.pdf">https://arxiv.org/pdf/2509.01055.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.01055">https://arxiv.org/abs/2509.01055</a></p>
<p><strong>Arxiv ID</strong>: 2509.01055</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.01055">https://papers.cool/arxiv/2509.01055</a></p>
<p><strong>Published</strong>: 2025-09-01T01:45:18Z</p>
<p><strong>Updated</strong>: 2025-09-01T01:45:18.000Z</p>
<hr>
<h3 id="7-POINTS-Reader-Distillation-Free-Adaptation-of-Vision-Language-Models-for-Document-Conversion"><a href="#7-POINTS-Reader-Distillation-Free-Adaptation-of-Vision-Language-Models-for-Document-Conversion" class="headerlink" title="7. POINTS-Reader: Distillation-Free Adaptation of Vision-Language Models for Document Conversion"></a>7. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.01215">POINTS-Reader: Distillation-Free Adaptation of Vision-Language Models for Document Conversion</a></h3><p>High-quality labeled data is essential for training accurate document conversion models, particularly in domains with complex formats such as tables, formulas, and multi-column text. However, manual annotation is both costly and time-consuming, while automatic labeling using existing models often lacks accuracy in handling such challenging scenarios. Consequently, training student models by distilling outputs from teacher models can significantly limit their performance in real-world applications. In this paper, we propose a fully automated, distillation-free framework comprising two stages for constructing high-quality document extraction datasets and models capable of handling diverse document formats and layouts. In the first stage, we introduce a method for generating large-scale, diverse synthetic data, which enables a model to extract key elements in a unified format with strong initial performance. In the second stage, we present a self-improvement approach that further adapts the model, initially trained on synthetic data, to real-world documents. Specifically, we first use the fine-tuned model to annotate real documents, then apply a suite of filtering strategies to verify annotation quality, and finally retrain the model on the verified dataset. By iteratively repeating this process, we progressively enhance both the model’s conversion capabilities and the quality of the generated data. We train a public POINTS-1.5 model to obtain POINTS-Reader, which surpasses many existing public and proprietary models of comparable or larger size. Our model is available at <a target="_blank" rel="noopener" href="https://github.com/Tencent/POINTS-Reader">https://github.com/Tencent/POINTS-Reader</a>.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>高质量的标记数据对于训练准确的文档转换模型至关重要，尤其是在表格、公式和多列文本等复杂格式的领域。然而，手动标注既昂贵又耗时，而使用现有模型进行自动标注往往在处理这些具有挑战性的场景时缺乏准确性。因此，通过从教师模型提炼输出训练学生模型可能会显著限制它们在现实应用中的表现。本文提出了一种完全自动化的无蒸馏框架，包括两个阶段，用于构建高质量文档提取数据集和能够处理多种文档格式和布局的模型。在第一阶段，我们引入了一种生成大规模多样化合成数据的方法，使模型能够以统一格式提取关键元素，并具有强大的初始性能。在第二阶段，我们提出了一种自我改进的方法，进一步调整最初在合成数据上训练的模型以适应真实文档。具体来说，我们首先使用微调后的模型对真实文档进行标注，然后应用一系列过滤策略来验证标注质量，最后在经过验证的数据集上重新训练模型。通过反复迭代这个过程，我们逐步提升模型的转换能力和生成数据的质量。我们训练了一个公共的POINTS-1.5模型以获取POINTS-Reader，其性能超过许多同类或规模更大的现有公有和专有模型。我们的模型可在 <a target="_blank" rel="noopener" href="https://github.com/Tencent/POINTS-Reader">https://github.com/Tencent/POINTS-Reader</a> 中获得。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>该论文旨在解决高质量文档转换模型训练过程中面临的两大核心难题：</p>
<ol>
<li><p><strong>高质量标注数据稀缺</strong><br>复杂版式（表格、公式、多栏文本）的文档需要大量精确标注，而人工标注成本高昂；现有自动标注方法依赖外部大模型蒸馏，既限制下一代模型研发，又导致学生模型性能受限并继承教师模型偏差。</p>
</li>
<li><p><strong>合成数据与真实数据分布差异</strong><br>直接利用合成数据训练的模型在真实文档上表现不佳；传统蒸馏方案无法摆脱对外部模型的依赖，且存在性能瓶颈与偏差传播问题。</p>
</li>
</ol>
<p>为此，论文提出<strong>完全自动化、无蒸馏</strong>的两阶段框架，通过大规模合成数据统一格式预训练 + 迭代自提升过滤策略，构建高质量文档转换数据集并训练出超越同体量甚至更大模型的 POINTS-Reader。</p>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>与本文直接相关的研究可归纳为以下三类，并给出每类的代表性工作与本文的差异点：</p>
<p>1. 端到端文档理解/转换模型</p>
<ul>
<li><strong>Nougat</strong> (Blecher et al., 2023)<br>350 M 参数，专注学术论文，LaTeX 输出，依赖扫描版 PDF，未处理复杂表格。</li>
<li><strong>GOT-OCR</strong> (Wei et al., 2024)<br>716 M 参数，通用 OCR-2.0 框架，仍以 Markdown 为主，未解决表格结构复杂性问题。</li>
<li><strong>OLMOCR</strong> (Poznanski et al., 2025)<br>7 B 参数，完全基于 GPT-4o 蒸馏，存在蒸馏偏差与计算开销。</li>
<li><strong>KOSMOS-2.5</strong> (Lv et al., 2023)<br>357 M 样本规模，Markdown 表格表示，依赖 Microsoft Read API 蒸馏。</li>
</ul>
<p><strong>差异</strong><br>本文无需任何外部模型蒸馏，采用 HTML 统一表格格式，并通过自提升迭代过滤策略持续提升数据质量。</p>
<p>2. 流水线式文档解析系统</p>
<ul>
<li><strong>MinerU</strong> (Wang et al., 2024a)<br>模块化流水线，结合布局检测+OCR+后处理，人工规则重，端到端性能仍落后于本文方法。</li>
<li><strong>Marker</strong> (2024)<br>基于启发式规则与外部 OCR，对复杂公式与表格支持有限。</li>
<li><strong>Mathpix</strong> (2024)<br>商业闭源，以公式识别见长，但表格与多栏布局精度不足。</li>
</ul>
<p><strong>差异</strong><br>本文提出端到端视觉-语言模型，无需复杂流水线即可同时输出文本、表格、公式，并在多项基准上超越流水线方法。</p>
<p>3. 通用视觉-语言大模型</p>
<ul>
<li><strong>Qwen2.5-VL 系列</strong> (Bai et al., 2025)<br>3 B/7 B/72 B 参数，原生支持任意分辨率，但文档转换任务仍依赖蒸馏数据。</li>
<li><strong>LLaVA-OneVision</strong> (Li et al., 2024)<br>通用视觉任务迁移，未针对文档版式优化。</li>
<li><strong>mPLUG-DocOwl 1.5/2</strong> (Hu et al., 2024a,b)<br>引入高分辨率编码与结构学习，仍使用公开蒸馏数据训练。</li>
</ul>
<p><strong>差异</strong><br>本文以公开 POINTS-1.5 为基座，通过无蒸馏、自生成的 1.1 M 高质量 HTML 格式数据进行指令微调，实现 3 B 参数模型在表格与公式指标上优于 72 B 蒸馏模型。</p>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文提出一套<strong>两阶段、无蒸馏、完全自动化</strong>的框架，以解决高质量文档转换数据稀缺及合成-真实分布差异的问题。核心思路与实施步骤如下：</p>
<p><strong>阶段一：统一格式预热（Uniform Format Warm-up Stage, UWS）</strong></p>
<ol>
<li><p><strong>统一输出规范</strong></p>
<ul>
<li>纯文本 → Markdown</li>
<li>表格 → 精简 HTML（保留合并单元格属性，去 CSS、换行、缩进）</li>
<li>数学公式 → LaTeX（KaTeX 规范，<script type="math/tex">...</script> 行内，$$$…$$$ 行间）</li>
</ul>
</li>
<li><p><strong>大规模合成数据生成</strong></p>
<ul>
<li>用 LLM 按四类模板生成内容：<ol>
<li>纯文本</li>
<li>文本+公式</li>
<li>文本+表格</li>
<li>多栏文本+表格</li>
</ol>
</li>
<li>规则过滤公式/表格合法性后，通过 HTML 模板渲染成图像，得到 <strong>80 万图像-文本对</strong>。</li>
</ul>
</li>
<li><p><strong>基座模型预热训练</strong></p>
<ul>
<li>以公开 POINTS-1.5 为视觉-语言基座，仅用上述合成数据进行指令微调，获得具备统一格式输出能力的初始模型。</li>
</ul>
</li>
</ol>
<p><strong>阶段二：迭代自提升（Iterative Self-improvement Stage, ISS）</strong></p>
<ol>
<li><p><strong>自标注</strong></p>
<ul>
<li>用 UWS 模型对 <strong>200 万 DocMatix 真实文档图像</strong> 进行端到端推理，生成伪标签。</li>
</ul>
</li>
<li><p><strong>三重规则过滤</strong></p>
<ul>
<li><strong>纯文本</strong>：与 PaddleOCR 结果计算 token-level F1，阈值 0.9 以上保留。</li>
<li><strong>表格</strong>：检查每行列数一致性，剔除结构非法样本。</li>
<li><strong>公式</strong>：仅做 LaTeX 语法校验，剔除语法错误样本。</li>
</ul>
</li>
<li><p><strong>再训练与迭代</strong></p>
<ul>
<li>将过滤后的高质量数据与 UWS 数据混合，继续指令微调。</li>
<li>重复「推理 → 过滤 → 再训练」<strong>5 轮</strong>，逐步提升模型对真实分布的适应能力。</li>
</ul>
</li>
</ol>
<p><strong>关键设计总结</strong></p>
<ul>
<li><strong>无蒸馏</strong>：全程不依赖外部大模型标注，避免性能天花板与偏差继承。</li>
<li><strong>统一格式</strong>：降低模型学习难度，提升跨元素一致性。</li>
<li><strong>规则过滤</strong>：轻量级、可扩展的自动化质检，保证每轮训练数据质量。</li>
<li><strong>合成-真实桥接</strong>：先用合成数据学“格式”，再用自提升学“版式”，实现域迁移。</li>
</ul>
<p>通过以上流程，最终得到的 <strong>POINTS-Reader（3 B 参数）</strong> 在 OmniDocBench、Fox 等基准上，表格与公式指标超越 Qwen2.5-VL-72B 等更大蒸馏模型，验证了框架的有效性。</p>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文实验围绕 <strong>数据构建有效性、模型性能、消融分析</strong> 三条主线展开，可归纳为以下 4 组实验：</p>
<p>1. 数据构建与质量验证实验</p>
<ul>
<li><strong>合成数据规模曲线</strong><br>将 UWS 阶段每类样本从 10 万线性增至 120 万，观察 OmniDocBench 整体指标。结果显示 80 万样本后性能饱和甚至下降，证明<strong>过度合成会过拟合人工布局</strong>。</li>
<li><strong>长宽比过滤</strong><br>统计合成图像宽高比分布，仅保留区间 $\bigl(\tfrac{2}{5},\tfrac{5}{2}\bigr)$ 内的样本，整体指标再降 1.2 pt，验证<strong>剔除异常形状可提升泛化性</strong>。</li>
</ul>
<p>2. 迭代自提升（ISS）实验</p>
<ul>
<li><strong>过滤策略消融</strong><br>在 DocMatix 200 万图上依次加入<br>① 文本 F1≥0.9 过滤<br>② 表格结构一致性过滤<br>③ 公式语法过滤<br>结果：每增加一项，对应子任务 Edit Distance 显著下降（文本 0.470→0.374，表格 0.561→0.492，公式 0.514→0.457）。</li>
<li><strong>迭代轮次曲线</strong><br>重复 5 轮「推理-过滤-再训练」，OmniDocBench 整体指标从 0.493 持续降至 0.259；同时保留样本的 F1 与数量均逐轮提升，说明<strong>数据质量与模型能力同步增强</strong>。</li>
<li><strong>F1 阈值敏感性</strong><br>测试 0.70 / 0.80 / 0.90 / 0.95 四档阈值：过低引入噪声，过高丢失多样性，0.90 为最佳折中。</li>
</ul>
<p>3. 主实验：与 SOTA 对比</p>
<p>在 <strong>OmniDocBench-en、Fox-en、PubTabNet</strong> 三个公开基准上，与三类方法对比：</p>
<ul>
<li><strong>流水线系统</strong>（MinerU、Marker、Mathpix）</li>
<li><strong>通用 VLM</strong>（Qwen2.5-VL-3/7/72 B）</li>
<li><strong>专用 OCR 模型</strong>（GOT-OCR、Nougat、Mistral OCR、OLMOCR）</li>
</ul>
<p>结果：</p>
<ul>
<li>POINTS-Reader（3 B）在 <strong>表格指标</strong> 上领先所有对比模型（OmniDocBench 0.335 vs GOT-OCR 0.532→<strong>-0.197</strong>）。</li>
<li>整体指标 0.259，优于 72 B 蒸馏模型 Qwen2.5-VL-72B（0.214）之外的全部对手，且参数量仅 4%。</li>
</ul>
<p>4. 补充消融与案例</p>
<ul>
<li><strong>初始化策略</strong><br>每轮重新加载<strong>预训练权重</strong>优于继续上一轮权重，避免噪声累积。</li>
<li><strong>数据平衡实验</strong><br>对文本/表格/公式按 1:1:1、1:2:4、1:4:8 三种比例重采样，发现<strong>强制平衡反而降低泛化</strong>，保持自然分布最佳。</li>
<li><strong>案例可视化</strong><br>随机抽取 3 份文档，展示第 1 轮与第 5 轮模型输出，直观呈现<strong>表格结构、公式语法、阅读顺序</strong>的显著改进。</li>
</ul>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可作为 POINTS-Reader 框架的后续研究切入点，按优先级与可行性排序：</p>
<p>1. 语言与字体扩展</p>
<ul>
<li><strong>多语言支持</strong><br>当前仅英文；可引入中文、日文等语系，需重新设计合成 prompt 并验证字符集、排版规则差异。</li>
<li><strong>手写与混合字体</strong><br>现有数据均为印刷体；探索手写文本合成（GAN 或 diffusion-based 字体生成）与半合成混合数据，缓解手写场景性能下降。</li>
</ul>
<p>2. 元素与版式升级</p>
<ul>
<li><strong>图像元素提取</strong><br>将图表、流程图、照片等视觉元素纳入统一输出格式，扩展 HTML 标签集（如 <code>&lt;img&gt;</code>、<code>&lt;svg&gt;</code>），并设计对应过滤规则（分辨率、可读性）。</li>
<li><strong>复杂版式建模</strong><br>引入页眉页脚、脚注、双栏交错公式等更细粒度布局，通过 LayoutLM-style 绝对位置编码或 segment-wise attention 提升空间理解。</li>
</ul>
<p>3. 数据策略优化</p>
<ul>
<li><strong>主动学习采样</strong><br>用不确定性估计或梯度冲突指标，在 ISS 阶段主动挑选高价值样本，减少 200 万→更小但更有效的子集。</li>
<li><strong>合成-真实混合比例动态调度</strong><br>每轮自适应调整 UWS 与 ISS 数据比例，避免合成数据过拟合；可建模为在线权衡问题，用强化学习或贝叶斯优化求解。</li>
</ul>
<p>4. 过滤规则升级</p>
<ul>
<li><strong>语义级校验</strong><br>对公式引入 CAS（Computer Algebra System）检查语义一致性；对表格引入逻辑约束（行列求和、单位一致性）。</li>
<li><strong>置信度联合过滤</strong><br>将模型自身置信度、一致性投票、外部轻量模型打分融合，替代单一 F1/语法阈值，提升过滤鲁棒性。</li>
</ul>
<p>5. 模型架构改进</p>
<ul>
<li><strong>高分辨率编码器</strong><br>采用 NaViT 或 mPLUG-DocOwl2 的任意分辨率编码策略，减少下采样导致的细粒度信息损失。</li>
<li><strong>端到端阅读顺序模块</strong><br>显式建模阅读顺序（如 2-D positional embedding + reading order head），替代当前隐式依赖。</li>
</ul>
<p>6. 训练策略</p>
<ul>
<li><strong>课程式迭代</strong><br>先易后难：首轮仅用单栏文档，逐步加入多栏、密集公式、复杂表格，降低早期噪声放大风险。</li>
<li><strong>多任务正则化</strong><br>同时预测文本、表格、公式与版面分割 mask，利用辅助任务梯度抑制过拟合。</li>
</ul>
<p>7. 评估与基准</p>
<ul>
<li><strong>细粒度子任务 Benchmark</strong><br>构建针对「合并单元格识别」「行间公式编号对齐」「手写混合场景」等子集的专用评测集，量化模型短板。</li>
<li><strong>跨域鲁棒性测试</strong><br>在扫描古籍、低分辨率拍照、多语言混排等极端场景下评估，推动实际落地。</li>
</ul>
<p>8. 计算效率</p>
<ul>
<li><strong>知识蒸馏压缩</strong><br>将 POINTS-Reader 3 B 蒸馏至 ≤1 B 端侧模型，保持精度损失 &lt;3%，适配手机/边缘设备。</li>
<li><strong>推理加速</strong><br>采用 speculative decoding 或 early-exit 机制，在 2 百万 DocMatix 推理任务上缩短 10 h → &lt;3 h。</li>
</ul>
<p>以上方向既可独立推进，也可组合形成多任务联合优化路径，为文档理解领域提供持续迭代空间。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p><strong>POINTS-Reader：无需蒸馏的端到端文档转换框架</strong></p>
<p>1. 问题背景</p>
<ul>
<li>高质量文档转换需要大量标注，人工昂贵，现有自动方法依赖外部大模型蒸馏，导致学生模型性能受限并继承偏差。</li>
<li>合成数据与真实文档在版式、字体、复杂度上差异大，直接训练效果差。</li>
</ul>
<p>2. 解决方案</p>
<p>提出<strong>两阶段、无蒸馏、完全自动化</strong>框架：</p>
<p>阶段</p>
<p>目标</p>
<p>关键做法</p>
<p><strong>UWS（统一格式预热）</strong></p>
<p>让模型学会统一输出格式</p>
<p>• 用 LLM 生成 80 万合成样本：纯文本、文本+公式、文本+表格、多栏+表格<br>• 统一格式：文本→Markdown，表格→HTML，公式→LaTeX<br>• 渲染成图像，微调公开 POINTS-1.5 基座</p>
<p><strong>ISS（迭代自提升）</strong></p>
<p>把模型适配到真实分布</p>
<p>• 用 UWS 模型给 200 万 DocMatix 真实图像打伪标签<br>• <strong>三重规则过滤</strong>：<br> - 文本：与 OCR 结果算 F1≥0.9<br> - 表格：行列数一致性<br> - 公式：LaTeX 语法正确<br>• 过滤后数据再训练，循环 5 轮</p>
<p>3. 实验结果</p>
<ul>
<li><strong>消融</strong>：每增加一类合成数据或一层过滤，OmniDocBench 整体指标持续下降；80 万合成样本后性能饱和，验证 ISS 必要性。</li>
<li><strong>对比</strong>：3 B 参数的 POINTS-Reader 在表格指标上领先所有公开/闭源对手，整体指标优于 72 B 蒸馏模型 Qwen2.5-VL-72B 之外的全部基线。</li>
<li><strong>案例</strong>：迭代 5 轮后，表格结构、公式语法、阅读顺序显著改善。</li>
</ul>
<p>4. 贡献与局限</p>
<ul>
<li><strong>贡献</strong>：首个无需蒸馏即可生成百万级高质量文档转换数据的两阶段框架；3 B 模型达到 SOTA。</li>
<li><strong>局限</strong>：仅英文、仅印刷体、尚未支持图像元素；未来计划扩展多语言、手写、图表等。</li>
</ul>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是POINTS-Reader%3A%20Distillation-Free%20Adaptation%20of%20Vision-Language%20Models%20for%20Document%20Conversion，链接是  https://arxiv.org/pdf/2509.01215  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.01215  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Yuan Liu,Zhongyin Zhao,Le Tian,Haicheng Wang,Xubing Ye,Yangxiu You,Zilin Yu,Chuhan Wu,Xiao Zhou,Yang Yu,Jie Zhou</p>
<p><strong>Categories</strong>: cs.CV</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.01215.pdf">https://arxiv.org/pdf/2509.01215.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.01215">https://arxiv.org/abs/2509.01215</a></p>
<p><strong>Arxiv ID</strong>: 2509.01215</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.01215">https://papers.cool/arxiv/2509.01215</a></p>
<p><strong>Published</strong>: 2025-09-01T07:54:18Z</p>
<p><strong>Updated</strong>: 2025-09-01T07:54:18.000Z</p>
<hr>
<h3 id="8-Baichuan-M2-Scaling-Medical-Capability-with-Large-Verifier-System"><a href="#8-Baichuan-M2-Scaling-Medical-Capability-with-Large-Verifier-System" class="headerlink" title="8. Baichuan-M2: Scaling Medical Capability with Large Verifier System"></a>8. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.02208">Baichuan-M2: Scaling Medical Capability with Large Verifier System</a></h3><p>As large language models (LLMs) advance in conversational and reasoning capabilities, their practical application in healthcare has become a critical research focus. However, there is a notable gap between the performance of medical LLMs on static benchmarks such as USMLE and their utility in real-world clinical decision-making. This discrepancy arises because traditional exams fail to capture the dynamic, interactive nature of medical consultations. To address this challenge, we introduce a novel dynamic verification framework that moves beyond static answer verifier, establishing a large-scale, high-fidelity interactive reinforcement learning system. Our framework comprises two key components: a Patient Simulator that creates realistic clinical environments using de-identified medical records, and a Clinical Rubrics Generator that dynamically produces multi-dimensional evaluation metrics. Building on this foundation, we develop Baichuan-M2, a 32B-parameter medical augmented reasoning model trained through a multi-stage reinforcement learning strategy with an improved Group Relative Policy Optimization (GRPO) algorithm. Evaluated on HealthBench, Baichuan-M2 outperforms all other open-source models and most advanced closed-source counterparts, achieving a score above 32 on the challenging HealthBench Hard benchmark-previously exceeded only by GPT-5. Our work demonstrates that robust dynamic verifier system is essential for aligning LLM capabilities with practical clinical applications, establishing a new Pareto front in the performance-parameter trade-off for medical AI deployment.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>随着大规模语言模型（LLMs）在对话和推理能力上的进步，它们在医疗保健中的实际应用已成为一个关键的研究重点。然而，医疗LLMs在静态基准测试（如USMLE）上的表现与它们在现实世界临床决策中的实用性之间存在显著差距。这种差距的出现是因为传统考试无法捕捉到医疗咨询的动态互动特性。为了解决这一挑战，我们提出了一种新颖的动态验证框架，超越了静态回答验证器，建立了一个大规模、高保真度的互动强化学习系统。我们的框架包括两个关键组成部分：一个患者模拟器，使用匿名医疗记录创建逼真的临床环境，以及一个临床评分生成器，动态产生多维评估指标。在此基础上，我们开发了Baichuan-M2，这是一个32B参数的医疗增强推理模型，通过多阶段强化学习策略和改进的群体相对策略优化（GRPO）算法进行训练。在HealthBench上评估时，Baichuan-M2的表现超越了所有其他开源模型和大多数先进的闭源模型，在具有挑战性的HealthBench Hard基准测试中得分超过32，这一成果之前仅被GPT-5超越。我们的工作表明，强大的动态验证系统对于将LLM的能力与实际临床应用对齐至关重要，为医疗AI部署的性能参数权衡建立了一个新的Pareto前沿。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>论文聚焦的核心问题是：<strong>现有医疗大语言模型（LLM）在静态考试（如 USMLE）上表现良好，却在真实临床决策中表现不佳</strong>。根本原因在于传统静态基准无法反映临床实践的动态、交互、信息不完备和多轮推理特性。</p>
<p>为解决这一差距，论文提出并验证了一个 <strong>动态验证框架</strong>，通过以下方式弥合模型评估与真实临床场景之间的鸿沟：</p>
<ul>
<li><strong>构建高保真虚拟临床环境</strong>：用“患者模拟器”替代静态题库，模拟真实患者的心理、社会背景及多轮对话行为。</li>
<li><strong>引入可动态生成的多维临床评分体系</strong>：“临床评分生成器”实时产出涵盖诊断准确性、沟通共情、医学伦理等维度的量化指标。</li>
<li><strong>基于该环境进行多阶段强化学习</strong>：改进 GRPO 算法，使 32B 参数的 Baichuan-M2 在 HealthBench（尤其是 Hard 子集）上达到与 GPT-5 比肩的水平，刷新开源医疗模型的性能-参数帕累托前沿。</li>
</ul>
<p>简言之，论文旨在 <strong>让医疗 LLM 的训练与评估从“答对题”转向“当好医生”</strong>。</p>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>与 Baichuan-M2 直接相关或构成其技术背景的研究可分为四类：</p>
<ol>
<li>医疗大模型与 RLVR 框架</li>
<li>患者/临床模拟器</li>
<li>医疗评测基准</li>
<li>强化学习算法改进</li>
</ol>
<p>以下按类别列出代表性工作（括号内为论文引用编号）：</p>
<p>1. 医疗大模型与 RLVR 框架</p>
<ul>
<li><strong>HuatuoGPT-o1</strong> [5]：首次在医疗场景尝试 RLVR，用规则奖励提升复杂推理。</li>
<li><strong>Beyond Distillation</strong> [4]：极简规则 RL 用于医学 LLM，验证强化学习对医学推理的提升。</li>
<li><strong>HealAI</strong> [1]：面向医疗文档的 LLM，展示领域专用模型的实际落地。</li>
<li><strong>Talk2Care</strong> [3]：语音 LLM 在老年护理中的交互研究，强调沟通维度。</li>
</ul>
<p>2. 患者/临床模拟器</p>
<ul>
<li><strong>Agent Hospital</strong> [18]：可演化医疗智能体的模拟医院环境，提供多科室交互数据。</li>
<li><strong>Exploring the Inquiry-Diagnosis Relationship</strong> [16]：高级患者模拟器研究生成式问诊与诊断的关系，为 Baichuan-M2 的模拟器设计提供直接基础。</li>
<li><strong>LLM-based Agents in Medicine Survey</strong> [19]：系统综述了医学智能体与模拟环境的研究现状。</li>
</ul>
<p>3. 医疗评测基准</p>
<ul>
<li><strong>HealthBench</strong> [15]：OpenAI 发布的 5000 例多轮临床对话评测集，含 48 k+ 医生撰写 rubrics；Baichuan-M2 的主要评估基准。</li>
<li><strong>MedXpertQA</strong> [35] / <strong>SuperGPQA</strong> [34]：面向专家级医学理解与推理的问答基准，用于规则 RL 阶段的知识验证。</li>
<li><strong>USMLE 官方评分政策</strong> [14]：传统静态医学考试基准，被论文指出与真实临床差距。</li>
</ul>
<p>4. 强化学习算法改进</p>
<ul>
<li><strong>DeepSeek-R1</strong> [6]：大规模 RLVR 在数学与代码领域的成功实践，为 GRPO 改进提供经验。</li>
<li><strong>DeepSeekMath</strong> [8]：Group Relative Policy Optimization（GRPO）的原始论文，Baichuan-M2 在其基础上做医疗适配。</li>
<li><strong>DAPO</strong> [31]：开源大规模 RL 系统，提出若干工程优化点，被 Baichuan-M2 借鉴。</li>
<li><strong>Rubric-based RL</strong> [36]：用细粒度评分锚点做强化学习，与本文 rubric-based RL 阶段思路一致。</li>
</ul>
<p>这些研究共同构成了 Baichuan-M2 从“静态题库训练”转向“动态交互临床环境训练”的技术与评估基础。</p>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文通过“构建动态验证系统 + 多阶段强化学习”双轮驱动，把模型训练从静态题库转移到高保真虚拟临床环境，具体实施路径如下：</p>
<p>1. 设计动态验证系统（Dynamic Verifier System）</p>
<p>1.1 患者模拟器（Patient Simulator）</p>
<ul>
<li><strong>数据</strong>：脱敏真实病历 + 医患对话</li>
<li><strong>建模</strong><ul>
<li><strong>医学维度</strong>：主诉、现病史、既往史 → 保证疾病真实性</li>
<li><strong>心理-社会维度</strong>：MBTI 16 型人格 + 社会经济标签 → 模拟信息隐瞒、情绪表达、文化差异</li>
</ul>
</li>
<li><strong>架构</strong>（小模型即可高保真）<ul>
<li>Termination Gate：判断是否结束对话</li>
<li>Affective Unit：人格驱动的语言风格</li>
<li>Factual Unit：实时核查医学事实，防止信息泄露与矛盾</li>
</ul>
</li>
<li><strong>效果</strong>：在隐私、事实、人格一致性三项指标上优于 DeepSeek-V3（图 3）</li>
</ul>
<p>1.2 临床评分生成器（Clinical Rubrics Generator）</p>
<ul>
<li><strong>输入</strong>：患者模拟器产出的多轮对话片段</li>
<li><strong>输出</strong>：覆盖诊断、沟通、伦理等 7+ 维度的可量化评分规则（rubric）</li>
<li><strong>流程</strong><ol>
<li>专家定义核心维度 → LLM 生成候选 rubrics → 专家筛选并赋权 [-10,10]</li>
<li>以种子 rubrics 进行数据扩展 → 训练轻量级 rubric 生成器</li>
</ol>
</li>
<li><strong>验证</strong>：与 100 例专家标注对比，一致性 92.7 %（GPT-4.1 仲裁）</li>
</ul>
<p>2. 三阶段强化学习（Multi-Stage RL）</p>
<p>基于改进的 GRPO（Group Relative Policy Optimization）算法，把复杂医疗 RL 任务拆成递进的三段：</p>
<p>阶段</p>
<p>目标</p>
<p>数据来源</p>
<p>奖励设计</p>
<p><strong>Rule-based RL</strong></p>
<p>建立可验证推理基础</p>
<p>有唯一答案的医学/数学/代码任务</p>
<p>规则匹配奖励</p>
<p><strong>Rubric-based RL</strong></p>
<p>对齐多维度临床标准</p>
<p>开放式医学问答（由 Rubric Generator 实时评分）</p>
<p>细粒度 rubric 分数 + 条件长度惩罚</p>
<p><strong>Multi-turn RL</strong></p>
<p>提升动态交互能力</p>
<p>与 Patient Simulator 的多轮对话</p>
<p>每轮实时 rubric 反馈，片段级采样降噪</p>
<p><strong>GRPO 关键改进</strong></p>
<ul>
<li>去掉 KL 约束，减少参考模型开销</li>
<li>非对称 clip (ε_low, ε_high) 防止熵塌缩</li>
<li>长度归一化 + 组内相对优势，稳定多源数据训练</li>
</ul>
<p>3. 训练流程总览</p>
<ol>
<li><strong>Mid-Training</strong>：轻量级医学继续预训练（2:2:1 医学/通用/数学混合）</li>
<li><strong>SFT</strong>：200 万样本（20 % 医疗），建立推理与对话基础</li>
<li><strong>上述三阶段 RL</strong>：依次提升推理 → 医学对齐 → 交互能力</li>
</ol>
<p>4. 效果验证</p>
<ul>
<li><strong>HealthBench</strong>：32B 参数即获 60.1 总分，Hard 子集 34.7（仅次于 GPT-5）</li>
<li><strong>中国 MDT 病例</strong>：在 57 例复杂会诊中，Baichuan-M2 在沟通、检查、诊断、治疗、安全五维度均领先 gpt-oss-120B（图 11）</li>
<li><strong>通用能力</strong>：AIME24/25、IFEval、Arena-Hard 等基准保持领先（表 1）</li>
</ul>
<p>5. 部署优化</p>
<ul>
<li><strong>量化</strong>：W4A16 / W4A8 + KV8，RTX 4090 单卡即可 21 k token 长序列</li>
<li><strong>投机解码</strong>：Eagle-3 框架，2.17× 吞吐提升</li>
</ul>
<p>通过“高保真虚拟临床环境 + 细粒度动态评分 + 分阶段 RL”，论文把医疗 LLM 的训练范式从“答对题”升级为“在模拟临床实践中持续优化诊断与沟通”，从而在 32B 参数规模上实现此前仅 GPT-5 能达到的临床推理水平。</p>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文围绕「动态验证框架 + Baichuan-M2」共设计了四类实验，覆盖验证系统、模型性能、真实临床场景与部署效率：</p>
<p>1. 验证系统实验</p>
<p>1.1 患者模拟器</p>
<ul>
<li><strong>对比对象</strong>：DeepSeek-V3（带/不带心理提示）</li>
<li><strong>指标</strong>：<ul>
<li>Privacy Score（隐私泄露比例）</li>
<li>Fact Score（事实一致性）</li>
<li>Personification Score（人格/文化一致性）</li>
</ul>
</li>
<li><strong>结果</strong>：<ul>
<li>在保持隐私与事实得分不降的前提下，Personification Score 达到 89.2，显著高于基线（图 3）。</li>
</ul>
</li>
</ul>
<p>1.2 临床评分生成器</p>
<ul>
<li><strong>设置</strong>：随机抽取 100 例，由 3 名医生 + GPT-4.1 仲裁</li>
<li><strong>指标</strong>：与专家标注 rubric 的维度级一致性</li>
<li><strong>结果</strong>：一致性 92.7 %，验证动态 rubric 的可靠性（§2.2.4）。</li>
</ul>
<p>2. 公开基准实验（HealthBench）</p>
<ul>
<li><strong>测试集</strong>：HealthBench / HealthBench Hard / HealthBench Consensus（共 5 k 例多轮对话，48 k+ rubrics）</li>
<li><strong>对比模型</strong>：<ul>
<li>开源：gpt-oss-120B、Qwen3-235B-A22B、DeepSeek-R1、GLM-4.5、Kimi-K2 等</li>
<li>闭源：o3、Grok 3、Gemini 2.5 Pro、GPT-4.1、o1 等</li>
</ul>
</li>
<li><strong>结果</strong>：<ul>
<li><strong>Overall</strong>：60.1（SOTA 开源，领先第二名 2.5 分）</li>
<li><strong>Hard</strong>：34.7（全球唯二 &gt;32，仅次于 GPT-5 的 46.2）</li>
<li><strong>Consensus</strong>：91.5（与最佳闭源模型持平）</li>
<li>维度/主题细分：在 Emergency Referrals、Communication、Global Health 等 7 项主题均排名第一（图 9-10）。</li>
</ul>
</li>
</ul>
<p>3. 中国真实临床场景实验</p>
<ul>
<li><strong>数据集</strong>：57 例三甲医院 MDT 会诊病例（平均 3 k 汉字/例，无唯一金标准）</li>
<li><strong>评估维度</strong>：Communication、Examination、Diagnosis、Treatment、Safety（10 项加权指标）</li>
<li><strong>评估人</strong>：5 名高年资医生盲评</li>
<li><strong>结果</strong>（图 11）：<ul>
<li>Baichuan-M2 在 5 个维度均优于 gpt-oss-120B；</li>
<li>最大差距出现在 Communication（67 % vs 11 %）。</li>
</ul>
</li>
</ul>
<p>4. 通用能力与部署效率实验</p>
<p>4.1 通用基准</p>
<p>类别</p>
<p>基准</p>
<p>Baichuan-M2-32B</p>
<p>对比模型（Qwen3-32B）</p>
<p>Math</p>
<p>AIME24</p>
<p><strong>83.4</strong></p>
<p>81.4</p>
<p>Instruction</p>
<p>IFEval</p>
<p><strong>86.0</strong></p>
<p>85.0</p>
<p>Arena-Hard-V2.0</p>
<p><strong>45.8</strong></p>
<p>44.5</p>
<p>4.2 量化与推理</p>
<ul>
<li><strong>配置</strong>：RTX 4090 单卡</li>
<li><strong>最大序列长度</strong>：<ul>
<li>W4A16：9,982 tokens</li>
<li>W4A8-KV8：<strong>21,133 tokens</strong></li>
</ul>
</li>
<li><strong>投机解码</strong>：Eagle-3 框架 → 吞吐从 41.5 → 89.9 tokens/s（2.17× 加速）</li>
</ul>
<p>实验总结</p>
<p>实验类别</p>
<p>关键结论</p>
<p>验证系统</p>
<p>患者模拟器与 rubric 生成器均达到高保真、高一致性</p>
<p>公开基准</p>
<p>32B 参数即获 SOTA，Hard 子集仅次于 GPT-5</p>
<p>真实场景</p>
<p>在中国复杂会诊中全面领先最强开源模型</p>
<p>部署效率</p>
<p>量化 + 投机解码实现单卡 21 k tokens 长序列与 2× 提速</p>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可在 Baichuan-M2 基础上继续深入，按优先级与可行性归纳为 <strong>模型能力、验证系统、训练范式、落地扩展</strong> 四大类：</p>
<p>1. 模型能力深化</p>
<ul>
<li><p><strong>幻觉抑制与知识溯源</strong></p>
<ul>
<li>引入 <strong>检索增强（RAG）</strong> 或 <strong>工具调用</strong> 机制，实时对接权威指南、药品说明书、最新文献，降低幻觉率。</li>
<li>设计 <strong>可解释引用链</strong>：让模型在输出结论时显式给出文献片段或数据库查询结果。</li>
</ul>
</li>
<li><p><strong>多模态融合</strong></p>
<ul>
<li>将影像（CT/MRI）、检验时间序列、生命体征波形与文本对话联合建模，实现 <strong>跨模态诊断推理</strong>。</li>
</ul>
</li>
<li><p><strong>长程记忆与跨会话一致性</strong></p>
<ul>
<li>研究 <strong>外部记忆机制</strong>（如医疗知识图谱 + 患者个人健康档案）以支持慢病随访、复诊场景。</li>
</ul>
</li>
</ul>
<p>2. 验证系统升级</p>
<ul>
<li><p><strong>患者模拟器 2.0</strong></p>
<ul>
<li>引入 <strong>情绪演化模型</strong>（基于心理学情绪环状理论），模拟患者从焦虑到信任的情绪迁移，考察 AI 的安抚与知情同意能力。</li>
<li>加入 <strong>罕见病/共病/药物相互作用</strong> 的自动剧本生成，提升长尾场景覆盖率。</li>
</ul>
</li>
<li><p><strong>Rubric 精细化</strong></p>
<ul>
<li>将 rubric 权重从人工设定改为 <strong>在线贝叶斯优化</strong>，根据真实医生反馈动态调整各维度重要性。</li>
<li>引入 <strong>时间维度评分</strong>（如“是否在前三轮对话内锁定关键诊断线索”），强化策略效率。</li>
</ul>
</li>
<li><p><strong>对抗性评测</strong></p>
<ul>
<li>构建 <strong>红队模拟器</strong> 刻意给出误导信息或情绪化语言，测试模型鲁棒性与安全边界。</li>
</ul>
</li>
</ul>
<p>3. 训练范式创新</p>
<ul>
<li><p><strong>完整对话级 RL</strong></p>
<ul>
<li>当前仅片段级训练 → 扩展到 <strong>整段会话奖励</strong>，用蒙特卡洛树搜索（MCTS）或分层 RL 优化全局诊断路径。</li>
</ul>
</li>
<li><p><strong>联邦/隐私计算 RL</strong></p>
<ul>
<li>与多家医院合作，在 <strong>联邦学习框架</strong> 下利用本地脱敏数据继续强化学习，既保护隐私又提升地域多样性。</li>
</ul>
</li>
<li><p><strong>课程式 RL Curriculum</strong></p>
<ul>
<li>按难度（常见病 → 疑难病 → 多系统共病）自动编排训练顺序，加速收敛并减少灾难性遗忘。</li>
</ul>
</li>
</ul>
<p>4. 落地与伦理扩展</p>
<ul>
<li><p><strong>临床试点与 RCT</strong></p>
<ul>
<li>设计 <strong>随机对照试验</strong>：将 Baichuan-M2 作为住院医师辅助工具，衡量实际诊疗质量、患者满意度、医生负荷变化。</li>
</ul>
</li>
<li><p><strong>法规与伦理审计</strong></p>
<ul>
<li>建立 <strong>动态风险监控面板</strong>：实时追踪模型在不同人群（年龄、性别、种族）上的性能差异，满足未来 FDA/NMPA 审计要求。</li>
</ul>
</li>
<li><p><strong>低成本边缘部署</strong></p>
<ul>
<li>探索 <strong>端-云协同推理</strong>：在手机/平板上运行 4-bit 量化小模型做草稿，云端大模型做复核，实现基层医院可负担的 AI 医生。</li>
</ul>
</li>
</ul>
<p>小结</p>
<p>方向</p>
<p>短期可行</p>
<p>长期价值</p>
<p>检索增强 + 引用链</p>
<p>✅ 3 个月</p>
<p>显著降低幻觉</p>
<p>情绪-社会背景模拟器</p>
<p>✅ 6 个月</p>
<p>提升沟通与共情评估</p>
<p>整段对话 RL</p>
<p>⚠️ 需算力</p>
<p>全局策略最优</p>
<p>联邦 RL + RCT</p>
<p>⚠️ 需合规</p>
<p>真正临床级落地</p>
<p>上述任何一点的突破，都能进一步拉大医疗 LLM 在“真实临床能力”而非“考试分数”上的领先优势。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>论文一句话总结</p>
<p>用「高保真虚拟临床环境 + 动态多维评分 + 多阶段强化学习」把 32B 参数的 Baichuan-M2 训练成首个在真实临床场景（HealthBench Hard）上逼近 GPT-5 的开源医疗大模型，并给出可落地的低成本部署方案。</p>
<p>核心内容速览</p>
<p>维度</p>
<p>要点</p>
<p><strong>问题</strong></p>
<p>传统静态医学考试（USMLE）高分 ≠ 真实临床决策好用；缺少动态、交互、信息不完备场景下的验证与训练。</p>
<p><strong>解法</strong></p>
<p>构建「动态验证系统」：① 患者模拟器（人格+社会背景+真实病历）② 临床评分生成器（实时多维 rubric）。</p>
<p><strong>训练</strong></p>
<p>三阶段 RL：规则奖励 → rubric 奖励 → 多轮交互奖励，基于改进 GRPO，32B 模型即可收敛。</p>
<p><strong>结果</strong></p>
<p>HealthBench 总分 60.1（开源 SOTA），Hard 34.7（全球仅次 GPT-5）；中国 57 例 MDT 会诊全面领先 gpt-oss-120B；通用基准不掉点。</p>
<p><strong>部署</strong></p>
<p>RTX 4090 单卡 21 k token 长序列 + 投机解码 2× 提速，W4A8 量化几乎无损。</p>
<p><strong>开放</strong></p>
<p>模型、量化权重、推理代码全部开源，推动资源受限医院也能用上先进医疗 AI。</p>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Baichuan-M2%3A%20Scaling%20Medical%20Capability%20with%20Large%20Verifier%20System，链接是  https://arxiv.org/pdf/2509.02208  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.02208  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Baichuan-M2 Team,:,Chengfeng Dou,Chong Liu,Fan Yang,Fei Li,Jiyuan Jia,Mingyang Chen,Qiang Ju,Shuai Wang,Shunya Dang,Tianpeng Li,Xiangrong Zeng,Yijie Zhou,Chenzheng Zhu,Da Pan,Fei Deng,Guangwei Ai,Guosheng Dong,Hongda Zhang,Jinyang Tai,Jixiang Hong,Kai Lu,Linzhuang Sun,Peidong Guo,Qian Ma,Rihui Xin,Shihui Yang,Shusen Zhang,Yichuan Mo,Zheng Liang,Zhishou Zhang,Hengfu Cui,Zuyi Zhu,Xiaochuan Wang</p>
<p><strong>Categories</strong>: cs.LG,cs.AI</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.02208.pdf">https://arxiv.org/pdf/2509.02208.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.02208">https://arxiv.org/abs/2509.02208</a></p>
<p><strong>Arxiv ID</strong>: 2509.02208</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.02208">https://papers.cool/arxiv/2509.02208</a></p>
<p><strong>Published</strong>: 2025-09-02T11:23:35Z</p>
<p><strong>Updated</strong>: 2025-09-02T11:23:35.000Z</p>
<hr>
<h3 id="9-Kwai-Keye-VL-1-5-Technical-Report"><a href="#9-Kwai-Keye-VL-1-5-Technical-Report" class="headerlink" title="9. Kwai Keye-VL 1.5 Technical Report"></a>9. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.01563">Kwai Keye-VL 1.5 Technical Report</a></h3><p>In recent years, the development of Large Language Models (LLMs) has significantly advanced, extending their capabilities to multimodal tasks through Multimodal Large Language Models (MLLMs). However, video understanding remains a challenging area due to the dynamic and information-dense nature of videos. Existing models struggle with the trade-off between spatial resolution and temporal coverage when processing video content. We present Keye-VL-1.5, which addresses fundamental challenges in video comprehension through three key innovations. First, we introduce a novel Slow-Fast video encoding strategy that dynamically allocates computational resources based on inter-frame similarity, processing key frames with significant visual changes at higher resolution (Slow pathway) while handling relatively static frames with increased temporal coverage at lower resolution (Fast pathway). Second, we implement a progressive four-stage pre-training methodology that systematically extends the model’s context length from 8K to 128K tokens, enabling processing of longer videos and more complex visual content. Third, we develop a comprehensive post-training pipeline focusing on reasoning enhancement and human preference alignment, incorporating a 5-step chain-of-thought data construction process, iterative GSPO-based reinforcement learning with progressive prompt hinting for difficult cases, and alignment training. Through extensive evaluation on public benchmarks and rigorous internal human assessment, Keye-VL-1.5 demonstrates significant improvements over existing models, particularly excelling in video understanding tasks while maintaining competitive performance on general multimodal benchmarks.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>近年来，大型语言模型（LLMs）的发展取得了显著进展，通过多模态大型语言模型（MLLMs）扩展了其在多模态任务中的能力。然而，由于视频的动态性和信息密集性，视频理解仍然是一个具有挑战性的领域。现有模型在处理视频内容时，空间分辨率与时间覆盖之间的权衡存在困难。我们提出了Keye-VL-1.5，针对视频理解中的基本挑战进行了三项关键创新。首先，我们引入了一种新颖的慢-快视频编码策略，该策略根据帧间相似性动态分配计算资源，以更高的分辨率处理具有显著视觉变化的关键帧（慢通道），同时以较低的分辨率处理相对静态的帧，增加时间覆盖（快通道）。第二，我们实施了一种渐进式四阶段预训练方法，系统地将模型的上下文长度从8K扩展到128K个标记，从而能够处理更长的视频和更复杂的视觉内容。第三，我们开发了一条全面的后训练流程，重点关注推理增强和人类偏好的对齐，该流程包括一个五步的思维链数据构建过程、基于GSPO的迭代强化学习在困难案例中的渐进式提示、以及对齐训练。通过在公共基准测试上的广泛评估和严格的内部人类评估，Keye-VL-1.5在视频理解任务中展示了显著的改善，特别是在视频理解任务中表现优异，同时在一般多模态基准测试中保持竞争力的表现。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>论文针对<strong>视频理解</strong>这一多模态大模型（MLLM）尚未充分攻克的难题，提出并验证了 Keye-VL-1.5。核心问题可概括为：</p>
<ol>
<li><p><strong>视频时空信息权衡困境</strong><br>现有方法普遍采用固定分辨率+均匀帧采样，导致：</p>
<ul>
<li>高空间分辨率时，时间覆盖不足，丢失动态细节；</li>
<li>高帧率时，空间分辨率被迫降低，细节模糊。<br>论文提出 <strong>SlowFast 视频编码策略</strong>，依据帧间相似度动态分配计算资源：</li>
<li><strong>Slow 路径</strong>：高分辨率处理关键帧（显著视觉变化）；</li>
<li><strong>Fast 路径</strong>：低分辨率+高帧率处理静态帧，兼顾时序连贯性。</li>
</ul>
</li>
<li><p><strong>长视频上下文建模瓶颈</strong><br>长视频（分钟级）需超大上下文窗口（&gt;100k tokens），传统 8K 上下文难以支撑。<br>论文设计 <strong>四阶段渐进预训练</strong>：</p>
<ul>
<li>从 8K 逐步扩展至 128K tokens，通过退火阶段稳定训练；</li>
<li>引入长视频、长文本、高分辨率图像混合数据，确保窗口利用率。</li>
</ul>
</li>
<li><p><strong>推理能力与人类偏好对齐不足</strong><br>现有模型在复杂推理（如因果、时序）及人类偏好（格式、风格）上表现欠佳。<br>论文构建 <strong>三阶段后训练流水线</strong>：</p>
<ul>
<li><strong>LongCoT 冷启动</strong>：5 步自动化数据构造，生成高质量思维链；</li>
<li><strong>GSPO 强化学习</strong>：基于可验证奖励，对困难样本采用 <strong>渐进提示采样</strong>（分 5 级提示，最小干预原则）；</li>
<li><strong>对齐 RL</strong>：优化指令遵循、格式规范、伦理安全，结合规则奖励与生成式奖励。</li>
</ul>
</li>
</ol>
<p>综上，论文通过 <strong>架构创新（SlowFast）+ 训练范式革新（渐进上下文扩展 + 多轮 RL）</strong>，系统性解决视频理解中的时空权衡、长上下文及推理对齐三大挑战。</p>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>Keye-VL-1.5 的工作建立在近年来多模态大模型（MLLM）与视频理解领域的多项关键研究之上，可归纳为以下四大类：</p>
<p>1. 多模态大模型基础架构</p>
<ul>
<li><strong>LLM 主干</strong><ul>
<li><strong>Qwen3-8B</strong>（Yang et al., 2025）：作为语言解码器，提供通用世界知识与推理能力。</li>
<li><strong>Llama-3/4</strong>（Grattafiori et al., 2024；FaceBook, 2025）：开源 LLM 系列，推动多模态扩展。</li>
</ul>
</li>
<li><strong>视觉编码器</strong><ul>
<li><strong>SigLIP-400M-384-14</strong>（Zhai et al., 2023）：CLIP 变体，用于初始化视觉编码器。</li>
<li><strong>NaViT</strong>（Dehghani et al., 2023）：原生分辨率 ViT，支持动态长宽比输入，Keye-VL-1.5 借鉴其思想实现 2D-RoPE 与动态分辨率。</li>
</ul>
</li>
</ul>
<p>2. 视频编码与时空建模</p>
<ul>
<li><strong>均匀帧采样策略</strong><ul>
<li><strong>Video-LLaVA</strong>（Lin et al., 2023）：统一视觉表征，先对齐后投影，但受限于固定帧率。</li>
<li><strong>Qwen2.5-VL</strong>（Bai et al., 2025）：提出 2D 卷积合并相邻帧，降低 token 开销，但假设相邻帧高度相似，可能丢失突变信息。</li>
</ul>
</li>
<li><strong>SlowFast 思想来源</strong><ul>
<li><strong>SlowFast R-CNN</strong>（Feichtenhofer et al., 2019）：CVPR 经典工作，双路径处理视频（慢路径高空间分辨率，快路径高时间分辨率）。Keye-VL-1.5 将其适配到 MLLM，通过<strong>帧间相似度</strong>动态分配计算资源。</li>
</ul>
</li>
</ul>
<p>3. 长上下文与渐进训练</p>
<ul>
<li><strong>上下文扩展技术</strong><ul>
<li><strong>LongViTA</strong>（Shen et al., 2025）：百万级 token 上下文，采用分段编码与位置插值。</li>
<li><strong>Emu3</strong>（Wang et al., 2024a）：基于 next-token prediction 的多模态统一框架，支持长序列。</li>
</ul>
</li>
<li><strong>训练策略</strong><ul>
<li><strong>退火阶段（Annealing）</strong>：借鉴 LLM 训练（如 DeepSeek-V3, Liu et al., 2024a），在高质量数据上微调以提升鲁棒性。</li>
</ul>
</li>
</ul>
<p>4. 推理增强与 RLHF</p>
<ul>
<li><strong>思维链（CoT）数据构造</strong><ul>
<li><strong>DeepSeek-R1</strong>（Guo et al., 2025a）：通过 RL 激励 LLM 推理能力，Keye-VL-1.5 借鉴其“冷启动+RL”范式。</li>
<li><strong>Seed1.5-Thinking</strong>（Seed et al., 2025）：多模态推理模型，采用分步验证奖励。</li>
</ul>
</li>
<li><strong>强化学习优化</strong><ul>
<li><strong>GSPO</strong>（Zheng et al., 2025）：Group Sequence Policy Optimization，Keye-VL-1.5 用于 RLVR（可验证奖励）。</li>
<li><strong>MMPR/RLHF</strong>（Zhang et al., 2025b；Wang et al., 2024b）：多模态偏好对齐数据集与算法，用于 SFT 与 MPO 阶段。</li>
</ul>
</li>
</ul>
<p>5. 评估基准与数据资源</p>
<ul>
<li><strong>视频理解基准</strong><ul>
<li><strong>Video-MME</strong>（Fu et al., 2025b）：首个综合视频 MLLM 评测集，Keye-VL-1.5 作为主要对比基准。</li>
<li><strong>TempCompass</strong>（Liu et al., 2024d）：评估时序理解能力，揭示现有模型缺陷。</li>
</ul>
</li>
<li><strong>数据合成与增强</strong><ul>
<li><strong>PixMo</strong>（Deitke et al., 2024）：开放 grounding 与计数数据，用于训练专家模型。</li>
<li><strong>Molmo</strong>（Deitke et al., 2024）：大规模图文交错数据，支持长上下文训练。</li>
</ul>
</li>
</ul>
<p>总结</p>
<p>Keye-VL-1.5 通过整合 <strong>SlowFast 视频编码（受 CV 经典工作启发）</strong>、<strong>渐进上下文扩展（借鉴长序列 LLM 技术）</strong> 与 <strong>多轮 RL 推理增强（融合 DeepSeek-R1/Seed1.5 范式）</strong>，在现有 MLLM 研究基础上实现了视频理解的显著突破。</p>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>Keye-VL-1.5 从 <strong>架构、训练、后训练</strong> 三条主线协同解决视频理解难题，具体做法如下：</p>
<p>1. 架构层面：SlowFast 视频编码</p>
<p><strong>问题</strong>：固定分辨率+均匀采样无法兼顾空间细节与时间连贯性。<br><strong>解法</strong>：</p>
<ul>
<li><strong>动态帧分类</strong><ul>
<li>用 patch-level 相似度函数将帧分为两类：<ul>
<li><strong>Slow 帧</strong>（关键帧）：视觉变化显著，保持 <strong>高分辨率</strong>（token 占比高）。</li>
<li><strong>Fast 帧</strong>（静态帧）：相似度&gt;95%，以 <strong>低分辨率+高帧率</strong> 处理，扩大时间覆盖。</li>
</ul>
</li>
</ul>
</li>
<li><strong>双路径 token 分配</strong><ul>
<li>Fast 帧 token 预算仅为 Slow 帧的 30%，通过 <strong>二分搜索</strong> 精确控制总 token 数（如 75k）。</li>
<li>引入特殊 token <code>&lt;|clip_time_start|&gt;</code> 与绝对时间戳，显式标注 Slow/Fast 边界，辅助模型学习时序对齐。</li>
</ul>
</li>
</ul>
<p>2. 训练层面：四阶段渐进预训练</p>
<p><strong>问题</strong>：长视频需 128K 上下文，直接训练不稳定。<br><strong>解法</strong>：</p>
<p>阶段</p>
<p>目标</p>
<p>关键技术</p>
<p>上下文长度</p>
<p><strong>Stage 0</strong></p>
<p>ViT 适应内部分布</p>
<p>SigLIP 对比损失 + NaViT 动态分辨率</p>
<p>8K</p>
<p><strong>Stage 1</strong></p>
<p>跨模态对齐</p>
<p>冻结 ViT &amp; LLM，仅训练 MLP 投影层</p>
<p>8K</p>
<p><strong>Stage 2</strong></p>
<p>多任务预训练</p>
<p>全参数微调（OCR、VQA、Grounding 等）</p>
<p>8K</p>
<p><strong>Stage 3</strong></p>
<p>长上下文退火</p>
<p>RoPE 频率从 1M→8M，引入长视频/长文本</p>
<p>128K</p>
<ul>
<li><strong>资源优化</strong>：8K 阶段用 Zero-2 + DP；128K 阶段切换 Zero-1 + Context/Pipeline Parallelism。</li>
<li><strong>数据配比</strong>：128K 时 24% token 给视频、50% 给图像、26% 给文本，平衡视觉-语言能力。</li>
</ul>
<p>3. 后训练层面：推理增强与偏好对齐</p>
<p>3.1 LongCoT 冷启动</p>
<p><strong>问题</strong>：缺乏高质量推理链数据。<br><strong>解法</strong>：</p>
<ul>
<li><strong>5 步自动化流水线</strong>（图 6）：<ol>
<li><strong>多源数据收集</strong>：数学、OCR、STEM、GUI 等 7 类任务。</li>
<li><strong>多路径生成</strong>：用 MLLM 生成多条推理链，记录 step-wise 置信度。</li>
<li><strong>双层质量评估</strong>：答案正确性 + 推理逻辑性，分 A/B/C 三级。</li>
<li><strong>人工增强</strong>：修正 B 级样本冗余/逻辑漏洞。</li>
<li><strong>动态评分</strong>：1-5 分质量评级，高分样本重复训练。</li>
</ol>
</li>
</ul>
<p>3.2 迭代 GSPO 强化学习</p>
<p><strong>问题</strong>：困难样本利用率低。<br><strong>解法</strong>：</p>
<ul>
<li><strong>渐进提示采样</strong>（表 9）：<ul>
<li>对多次失败的样本，按 <strong>5 级提示</strong>（概念→策略→工具→步骤→完整解）逐步提供最小必要信息。</li>
<li>成功样本用于更新策略，提升 RL 效率（无提示时错误率 25.56% → 5 级提示后 0.2%）。</li>
</ul>
</li>
<li><strong>迭代范式</strong>：<ul>
<li>RL 模型 → 拒绝采样 → 更新冷启动数据 → 新一轮 RL，数学基准从 60.37→62.24（图 8）。</li>
</ul>
</li>
</ul>
<p>3.3 对齐 RL</p>
<p><strong>问题</strong>：指令遵循、格式、伦理偏好不足。<br><strong>解法</strong>：</p>
<ul>
<li><strong>三维奖励系统</strong>：<ul>
<li><strong>规则奖励</strong>：格式（JSON/Markdown）、推理结构（think/no_think）。</li>
<li><strong>生成奖励</strong>：用 MLLM 评估安全性、相关性。</li>
<li><strong>模型奖励</strong>：基于人类偏好训练的奖励模型打分。</li>
</ul>
</li>
<li><strong>任务设计</strong>：<ul>
<li>25 类硬约束（关键词、标点）+ 20 类软约束（风格）。</li>
<li>12k 数学推理题分步验证，RAG 任务模拟实时搜索行为。</li>
</ul>
</li>
</ul>
<p>4. 系统级优化</p>
<ul>
<li><strong>异构并行</strong>：ViT 仅用 DP，LLM 用 DP+TP+PP，解决架构异构导致的资源浪费。</li>
<li><strong>动态负载均衡</strong>：按样本计算复杂度预分配 GPU 任务，减少空闲等待。</li>
<li><strong>I/O 优化</strong>：独立 I/O 服务器处理视频解码，实例级断点续训保障稳定性。</li>
</ul>
<p>总结</p>
<p>通过 <strong>SlowFast 动态编码</strong> 解决时空权衡，<strong>四阶段渐进训练</strong> 扩展至 128K 上下文，<strong>冷启动+GSPO RL+对齐 RL</strong> 的三级后训练体系，Keye-VL-1.5 在视频理解（Video-MME 73.0%）与通用任务（OpenCompass 79.5%）均取得 SOTA，验证了系统性解决方案的有效性。</p>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文围绕 <strong>视频理解能力验证、通用多模态性能、内部人工评估、消融研究</strong> 四条主线展开实验，覆盖 20 + 公开基准与 200 项内部案例。主要实验与结果如下：</p>
<p>1. 视觉编码器验证（零样本分类）</p>
<p>模型</p>
<p>ImageNet-1K</p>
<p>ImageNet-A</p>
<p>ObjectNet</p>
<p>SigLIP-Base</p>
<p>83.08</p>
<p>82.22</p>
<p>76.99</p>
<p>+1D 插值</p>
<p>82.02</p>
<p>80.92</p>
<p>67.58 ↓</p>
<p>+2D RoPE（Keye-VL）</p>
<p><strong>82.65</strong></p>
<p><strong>83.26</strong></p>
<p><strong>78.70</strong></p>
<ul>
<li><strong>结论</strong>：2D-RoPE 显著提升高分辨率鲁棒性，验证原生分辨率 ViT 的有效性。</li>
</ul>
<p>2. SlowFast 策略对比实验</p>
<p><strong>基准</strong>：Video-MME（短/中/长视频，帧数 32–768，FPS 1–4）</p>
<ul>
<li><strong>性能拐点</strong>：<ul>
<li>Qwen-2.5-VL：128/384/128 帧</li>
<li>Keye-VL-1.5：<strong>192/512/384</strong> 帧（更晚下降，说明融合更充分）</li>
</ul>
</li>
<li><strong>Token 效率</strong>：高帧数场景下，Keye-VL 比 Qwen 少 15–30 % token，仍保持更高分数。</li>
<li><strong>FPS 鲁棒性</strong>：Keye-VL 在不同 FPS 下波动 &lt; 2 %，Qwen 波动 &gt; 5 %。</li>
</ul>
<p>3. 公开基准全面评测</p>
<p>类别</p>
<p>基准示例</p>
<p>Keye-VL-1.5</p>
<p>Qwen2.5-VL</p>
<p>InternVL3</p>
<p>GPT-4o</p>
<p><strong>通用</strong></p>
<p>OpenCompass</p>
<p><strong>79.5</strong></p>
<p>70.9</p>
<p>73.6</p>
<p>72.0</p>
<p>MMMU-val</p>
<p><strong>71.4</strong></p>
<p>58.6</p>
<p>62.7</p>
<p>70.7</p>
<p><strong>视频</strong></p>
<p>Video-MME</p>
<p><strong>73.0</strong></p>
<p>65.1</p>
<p>66.3</p>
<p>71.9</p>
<p>Video-MMMU</p>
<p><strong>66.0</strong></p>
<p>47.4</p>
<p>48.9</p>
<p>59.5</p>
<p><strong>数学</strong></p>
<p>MathVision</p>
<p><strong>46.8</strong></p>
<p>26.2</p>
<p>28.8</p>
<p>31.2</p>
<p>OlympiadBench</p>
<p><strong>47.5</strong></p>
<p>19.4</p>
<p>25.9</p>
<p>25.9</p>
<ul>
<li><strong>结论</strong>：在 18 个基准上取得 <strong>开源 SOTA</strong>，视频与数学任务领先幅度最大（↑6–20 %）。</li>
</ul>
<p>4. 内部人工评估（200 案例，8 维度）</p>
<p>维度</p>
<p>Keye-VL-1.5</p>
<p>MiMo-VL-7B-RL</p>
<p>Δ</p>
<p>推理能力</p>
<p><strong>3.81</strong></p>
<p>3.56</p>
<p>+0.25</p>
<p>时序理解</p>
<p><strong>3.36</strong></p>
<p>3.18</p>
<p>+0.18</p>
<p>鲁棒性</p>
<p><strong>4.29</strong></p>
<p>3.46</p>
<p>+0.83</p>
<p>整体得分</p>
<p><strong>3.53</strong></p>
<p>3.40</p>
<p>+0.13</p>
<ul>
<li><strong>场景示例</strong>：<ul>
<li><strong>时间定位</strong>：准确指出 26 s 视频中手提包出现时段 22.3–23.8 s（误差 0.1 s）。</li>
<li><strong>行为推理</strong>：解释大狗咬小狗耳朵是为了“教育其不要偷吃”，结合画面与字幕。</li>
</ul>
</li>
</ul>
<p>5. 消融研究</p>
<p>5.1 训练策略对比（表 6）</p>
<p>设置</p>
<p>OpenCompass</p>
<p>MathVista</p>
<p>OCRBench</p>
<p>SFT-15k</p>
<p>67.24</p>
<p>63.50</p>
<p>82.70</p>
<p>+ MPO-15k</p>
<p>69.31</p>
<p>67.00</p>
<p>83.20</p>
<p>LongCoT 冷启动</p>
<p>75.32</p>
<p>76.40</p>
<p>86.10</p>
<p>+ RL（完整）</p>
<p><strong>79.41</strong></p>
<p><strong>81.30</strong></p>
<p>85.70</p>
<ul>
<li><strong>结论</strong>：LongCoT 冷启动带来 <strong>+8 %</strong> 以上增益，RL 阶段再提升 3–5 %。</li>
</ul>
<p>5.2 专家模型与合并（表 7）</p>
<p>模型</p>
<p>TextVQA</p>
<p>ChartQA</p>
<p>OCRBench</p>
<p>Base</p>
<p>70.45</p>
<p>78.08</p>
<p>85.70</p>
<p>OCR Expert</p>
<p>79.36</p>
<p>84.76</p>
<p>86.40</p>
<p>合并后</p>
<p><strong>83.40</strong></p>
<p><strong>84.88</strong></p>
<p><strong>86.70</strong></p>
<ul>
<li><strong>结论</strong>：专家模型 + 合并可在不损失通用能力的情况下，OCR 任务提升 <strong>+5–13 %</strong>。</li>
</ul>
<p>5.3 对齐 RL 效果（表 8）</p>
<p>基准</p>
<p>前</p>
<p>后</p>
<p>Δ</p>
<p>MIA-Bench</p>
<p>87.60</p>
<p><strong>91.95</strong></p>
<p>+4.35</p>
<p>IFEval</p>
<p>73.75</p>
<p><strong>78.37</strong></p>
<p>+4.62</p>
<p>MathVision</p>
<p>46.22</p>
<p><strong>48.45</strong></p>
<p>+2.23</p>
<p>5.4 渐进提示采样（表 9）</p>
<p>提示级别</p>
<p>完全错误率</p>
<p>4 次平均得分</p>
<p>无提示</p>
<p>25.56 %</p>
<p>1.62</p>
<p>Level 5（完整解）</p>
<p><strong>0.20 %</strong></p>
<p><strong>3.96</strong></p>
<ul>
<li><strong>结论</strong>：分层提示将困难样本利用率提升 <strong>25×</strong>。</li>
</ul>
<p>5.5 拒绝采样迭代（图 8）</p>
<ul>
<li>数学基准从 60.37 → 62.24（两轮 RL + 拒绝采样）。</li>
</ul>
<p>实验总结</p>
<p>通过 <strong>公开基准 + 内部人工 + 系统消融</strong> 三维验证，论文证明：</p>
<ol>
<li>SlowFast 编码在同等算力下显著优于 2D 卷积合并；</li>
<li>128K 上下文 + LongCoT + GSPO RL 是视频推理跃升的关键；</li>
<li>专家模型合并与对齐 RL 可进一步拔高专项与安全性能。</li>
</ol>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可在 Keye-VL-1.5 的基础上继续深入，分为 <strong>技术深化、场景扩展、系统优化、理论分析</strong> 四大类：</p>
<p>1. 技术深化</p>
<p>方向</p>
<p>可探索点</p>
<p>潜在收益</p>
<p><strong>SlowFast 编码</strong></p>
<p>1. 将 patch 级相似度升级为 <strong>光流/深度估计</strong> 驱动的运动显著性检测；<br>2. 引入 <strong>可学习的帧预算控制器</strong>（RL-based token router），实时调整 Slow/Fast 比例。</p>
<p>进一步降低 10–20 % token 冗余，提升长视频细粒度动作识别。</p>
<p><strong>Long Context</strong></p>
<p>1. 研究 <strong>>128K</strong>（如 256K–1M）时的 scaling law；<br>2. 结合 <strong>压缩记忆（compressive memory）</strong> 或 <strong>token 丢弃策略</strong>，避免线性开销。</p>
<p>支撑小时级直播、电影理解等超长内容。</p>
<p><strong>专家模型</strong></p>
<p>1. 扩展更多垂直专家（医疗影像、卫星视频、AR/VR 3D 流）；<br>2. 探索 <strong>动态路由专家网络</strong>（MoE-style），按需激活。</p>
<p>在保持通用能力的同时，领域任务再提升 5–10 %。</p>
<p>2. 场景扩展</p>
<p>场景</p>
<p>待解决问题</p>
<p>研究思路</p>
<p><strong>多视角/全景视频</strong></p>
<p>360° 全景或无人机多机位视频带来 <strong>空间-时间双重冗余</strong>。</p>
<p>将 SlowFast 思想扩展到 <strong>空间维度</strong>：高分辨率聚焦 ROI，低分辨率覆盖全景。</p>
<p><strong>音频-视频联合推理</strong></p>
<p>当前 ASR 仅作为文本插入，未与视觉对齐。</p>
<p>设计 <strong>跨模态 SlowFast</strong>：音频事件（如爆炸）触发高分辨率视觉重采样。</p>
<p><strong>交互式视频问答</strong></p>
<p>用户实时追问，需要 <strong>在线增量推理</strong>。</p>
<p>用 <strong>KV-Cache 复用 + 局部重编码</strong> 实现毫秒级延迟的流式问答。</p>
<p>3. 系统与数据优化</p>
<p>维度</p>
<p>可优化点</p>
<p>预期效果</p>
<p><strong>数据合成</strong></p>
<p>1. 引入 <strong>程序生成（procedural generation）</strong> 合成无限长视频；<br>2. 使用 <strong>扩散模型</strong> 生成高动态、少样本场景（罕见天气、异常事件）。</p>
<p>降低对昂贵人工标注的依赖，提升长尾场景覆盖。</p>
<p><strong>训练效率</strong></p>
<p>1. <strong>帧级动态批处理</strong>（根据视频长度动态调整 batch 内样本数）；<br>2. <strong>混合精度 + FlashAttention-3</strong> 支持 128K 长序列不降速。</p>
<p>训练时间 ↓30 %，GPU 利用率 ↑15 %。</p>
<p><strong>评测体系</strong></p>
<p>构建 <strong>中文长视频基准</strong>（&gt;5 min，含方言、多模态噪声），弥补现有英文短视频偏差。</p>
<p>更真实反映国内短视频平台场景。</p>
<p>4. 理论与分析</p>
<p>方向</p>
<p>研究问题</p>
<p>方法论</p>
<p><strong>Scaling Law</strong></p>
<p>视频理解是否遵循 <strong>Chinchilla-optimal</strong>？<br>需同时考虑帧数、分辨率、token 预算三维。</p>
<p>在固定算力下系统扫描 (F, R, T) 空间，拟合性能-预算曲面。</p>
<p><strong>可解释性</strong></p>
<p>SlowFast 决策是否 <strong>与人类注意力一致</strong>？</p>
<p>引入 eye-tracking 数据集，对比模型 patch 权重与人眼注视热图。</p>
<p><strong>鲁棒性诊断</strong></p>
<p>长上下文是否引入 <strong>新的幻觉模式</strong>（如跨帧混淆）？</p>
<p>设计 <strong>时序对抗样本</strong>（帧顺序扰动、关键帧删除）测试模型稳定性。</p>
<p>小结</p>
<ul>
<li><strong>短期</strong>（3–6 个月）：<br>光流驱动的 SlowFast、256K 上下文 scaling、中文长视频基准。</li>
<li><strong>中期</strong>（6–12 个月）：<br>动态路由专家、音频-视觉联合 SlowFast、交互式流式推理。</li>
<li><strong>长期</strong>（&gt;12 个月）：<br>统一时空-模态的 scaling law、可解释注意力对齐、自监督无限视频生成。</li>
</ul>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>论文一句话总结</p>
<p>Keye-VL-1.5 通过 <strong>SlowFast 动态视频编码、128 K 渐进预训练、三阶段推理-对齐后训练</strong>，在 20 + 公开基准与 200 项内部评测中刷新开源视频理解 SOTA，同时保持通用多模态竞争力。</p>
<p>核心贡献速览</p>
<p>维度</p>
<p>关键做法</p>
<p>效果</p>
<p><strong>架构</strong></p>
<p>• SlowFast 双路径：高分辨率 Slow 帧捕捉突变，低分辨率 Fast 帧覆盖静态<br>• 原生分辨率 ViT + 2D-RoPE，支持任意长宽比</p>
<p>同等算力下 Video-MME ↑7.9 %，token 节省 15–30 %</p>
<p><strong>预训练</strong></p>
<p>四阶段渐进：ViT 对齐 → 多任务 8 K → 退火 128 K → 模型融合</p>
<p>128 K 上下文稳定训练，长视频/大图/长文本一次看全</p>
<p><strong>后训练</strong></p>
<p>• LongCoT 冷启动：5 步自动构造高质量思维链<br>• GSPO 强化学习 + 5 级渐进提示，困难样本利用率 ↑25×<br>• 对齐 RL：规则+生成+模型三重奖励，指令/格式/偏好一次到位</p>
<p>数学推理平均 ↑4–6 %，内部人工评测整体 ↑0.13–0.51</p>
<p><strong>系统</strong></p>
<p>异构并行（ViT-DP + LLM 3D 并行）、动态负载均衡、I/O 服务器</p>
<p>128 K 训练效率与 8 K 持平，GPU 利用率 ↑15 %</p>
<p>实验亮点</p>
<ul>
<li><strong>公开基准</strong>：Video-MME 73.0 %（开源第一），MathVision 46.8 %（超 Qwen2.5-VL 20 + %）。</li>
<li><strong>内部评测</strong>：200 例细粒度对比，鲁棒性 ↑0.83，时序理解 ↑0.77。</li>
<li><strong>消融</strong>：LongCoT 冷启动贡献最大（↑8 %），专家模型合并 OCR 再 ↑5 %，拒绝采样两轮 RL 再 ↑2 %。</li>
</ul>
<p>一句话展望</p>
<p>Keye-VL-1.5 为“看得细、看得长、想得深”的多模态大模型提供了可复制的全栈范式，下一步可向更长视频、实时交互与领域专精继续演进。</p>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Kwai%20Keye-VL%201.5%20Technical%20Report，链接是  https://arxiv.org/pdf/2509.01563  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.01563  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Biao Yang,Bin Wen,Boyang Ding,Changyi Liu,Chenglong Chu,Chengru Song,Chongling Rao,Chuan Yi,Da Li,Dunju Zang,Fan Yang,Guorui Zhou,Guowang Zhang,Han Shen,Hao Peng,Haojie Ding,Hao Wang,Hengrui Ju,Jiaming Huang,Jiangxia Cao,Jiankang Chen,Jingyun Hua,Kaibing Chen,Kaiyu Jiang,Kaiyu Tang,Kun Gai,Muhao Wei,Qiang Wang,Ruitao Wang,Sen Na,Shengnan Zhang,Siyang Mao,Sui Huang,Tianke Zhang,Tingting Gao,Wei Chen,Wei Yuan,Xiangyu Wu,Xiao Hu,Xingyu Lu,Yi-Fan Zhang,Yiping Yang,Yulong Chen,Zeyi Lu,Zhenhua Wu,Zhixin Ling,Zhuoran Yang,Ziming Li,Di Xu,Haixuan Gao,Hang Li,Jing Wang,Lejian Ren,Qigen Hu,Qianqian Wang,Shiyao Wang,Xinchen Luo,Yan Li,Yuhang Hu,Zixing Zhang</p>
<p><strong>Categories</strong>: cs.CV</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.01563.pdf">https://arxiv.org/pdf/2509.01563.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.01563">https://arxiv.org/abs/2509.01563</a></p>
<p><strong>Arxiv ID</strong>: 2509.01563</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.01563">https://papers.cool/arxiv/2509.01563</a></p>
<p><strong>Published</strong>: 2025-09-01T15:46:58Z</p>
<p><strong>Updated</strong>: 2025-09-01T15:46:58.000Z</p>
<hr>
<h3 id="10-Reasoning-Vectors-Transferring-Chain-of-Thought-Capabilities-via-Task-Arithmetic"><a href="#10-Reasoning-Vectors-Transferring-Chain-of-Thought-Capabilities-via-Task-Arithmetic" class="headerlink" title="10. Reasoning Vectors: Transferring Chain-of-Thought Capabilities via Task Arithmetic"></a>10. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.01363">Reasoning Vectors: Transferring Chain-of-Thought Capabilities via Task Arithmetic</a></h3><p>Large language models often require costly optimization, such as reinforcement learning, to master complex reasoning tasks. This work demonstrates that reasoning ability, once learned, can be extracted and transferred between models as a compact task vector. We source two publicly available, identically initialized Qwen2.5 models, one fine-tuned with supervised fine-tuning (SFT) and the other with group relative policy optimization (GRPO) on the same dataset. From these, we extract a reasoning vector: $v<em>{\text{reason}} = \theta</em>{\text{GRPO}} - \theta_{\text{SFT}}$. We hypothesize that this vector captures the reasoning capability instilled by reinforcement learning while factoring out shared knowledge from the SFT process. When added to compatible instruction-tuned models through simple arithmetic, this vector consistently improves performance across diverse reasoning benchmarks: GSM8K (+4.9%), HumanEval (+4.3%), SciQ (+1.7%), and BigBenchHard (+12.3% for the 1.5B model). The performance improvements persist under adversarial conditions. Conversely, subtracting the vector causes significant performance degradation (-11.8% on GSM8K), demonstrating the vector’s strong contribution to the model’s reasoning abilities. This work shows how reasoning capabilities, typically developed through expensive training, can be extracted from existing open-source models and reused through simple tensor arithmetic, offering a practical way to enhance models by recycling prior computational investments.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>大型语言模型通常需要代价高昂的优化，例如强化学习，以掌握复杂的推理任务。本研究表明，一旦学会推理能力，可以提取并在模型之间以紧凑的任务向量形式进行转移。我们获取了两个公开可用、完全相同初始化的Qwen2.5模型，一个经过监督微调（SFT），另一个则在同一数据集上使用组相对策略优化（GRPO）。从中，我们提取了一个推理向量：$v<em>{    ext{reason}} =     heta</em>{    ext{GRPO}} -     heta_{    ext{SFT}}$。我们假设这个向量捕捉了通过强化学习培养的推理能力，同时排除了SFT过程中的共享知识。当通过简单的算术将此向量添加到兼容的指令调优模型中时，持续改善了不同推理基准的性能：GSM8K（+4.9%），HumanEval（+4.3%），SciQ（+1.7%），以及BigBenchHard（对于1.5B模型，+12.3%）。在对抗条件下，性能提升依然存在。相反，减去该向量会导致显著的性能下降（在GSM8K上下降11.8%），这表明该向量对模型推理能力的强大贡献。本研究展示了如何从现有的开源模型中提取推理能力，通常通过代价高昂的训练获得，并通过简单的张量运算重复使用，提供了一种通过回收先前的计算投资来增强模型的实用方法。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>论文聚焦的核心问题是：</p>
<blockquote>
<p><strong>如何以低成本、可复用的方式，将强化学习（RL）训练出的复杂推理能力迁移到任意兼容的大语言模型，而无需对每个目标模型重新执行昂贵的 RL 训练。</strong></p>
</blockquote>
<p>具体而言，作者观察到：</p>
<ul>
<li>强化学习（如 GRPO）虽能显著提升 LLM 的多步推理表现，但计算开销巨大、调参复杂，难以普及。</li>
<li>现有开源社区已经公开了大量经过 RL 训练的模型，其计算投入被“沉淀”在权重中，却难以被其他模型直接利用。</li>
</ul>
<p>因此，论文提出并验证了一个假设：</p>
<blockquote>
<p><strong>“推理能力”可以在参数空间中被提取为一个紧凑的向量（reasoning vector），并通过简单的张量加减运算，零训练地注入到任何满足兼容性条件的指令微调模型中，从而复用先前的 RL 计算投资。</strong></p>
</blockquote>
<p>简言之，论文将“推理能力”视为一种可迁移、可插拔的模块化组件，解决了 RL 训练成本高、难以复用的瓶颈。</p>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>论文在 §2 中系统回顾了与“推理增强”和“任务向量/模型合并”两条主线相关的研究，可归纳为以下三类：</p>
<p>1. 大模型推理能力增强</p>
<p>方法类别</p>
<p>代表工作</p>
<p>核心思想</p>
<p><strong>Prompting 策略</strong></p>
<p>CoT [28,29]、Self-Consistency [28]、Tree-of-Thoughts [33]、Zero-shot “think step by step” [15]</p>
<p>不改动参数，仅通过提示词触发已有推理路径</p>
<p><strong>程序辅助推理</strong></p>
<p>Program-of-Thought [3]、PAL [8]</p>
<p>将计算步骤外包给外部解释器，减少模型算术负担</p>
<p><strong>训练式方法</strong></p>
<p>RLHF [23,4]、PPO [26]、GRPO [24]、Verifier-guided RL [5,17]</p>
<p>通过监督微调或 RL 在数据上直接编码推理能力</p>
<p>作者指出：上述训练式方法虽有效，但需重复昂贵训练；而本文通过“任务算术”把 RL 训练结果提取成向量，实现<strong>零训练迁移</strong>，桥接了“训练式”与“提示式”两条路线。</p>
<p>2. 任务算术与模型合并</p>
<p>技术</p>
<p>代表工作</p>
<p>关键贡献</p>
<p><strong>任务算术</strong></p>
<p>Ilharco et al. [13]</p>
<p>证明微调能力可表示为参数差向量，可加减</p>
<p><strong>冲突消解</strong></p>
<p>TIES-Merging [31]</p>
<p>解决符号冲突，减少向量合并时的干扰</p>
<p><strong>重要性加权</strong></p>
<p>Fisher Merging [19]</p>
<p>用 Fisher 信息给参数加权，提升合并鲁棒性</p>
<p><strong>回归视角</strong></p>
<p>RegMean [14]</p>
<p>将最优参数组合形式化为线性回归问题</p>
<p><strong>线性模式连通性</strong></p>
<p>Frankle et al. [7]</p>
<p>提供理论保证：同初始化模型位于同一低损盆地</p>
<p><strong>实践工具</strong></p>
<p>MergeKit [9]、Model Soups [30]、Ratatouille [25]</p>
<p>在十亿级模型上实现无训练合并与域外泛化</p>
<p>本文首次将上述技术用于**复杂认知能力（多步推理）**的提取与迁移，而非传统意义上的任务知识或风格迁移。</p>
<p>3. 模块化/参数高效增强</p>
<p>方法</p>
<p>代表工作</p>
<p>特点</p>
<p><strong>低秩适配</strong></p>
<p>LoRA [11]</p>
<p>引入可训练低秩矩阵，冻结原模型</p>
<p><strong>前缀/提示微调</strong></p>
<p>Prefix Tuning [18]、Prompt Tuning [16]</p>
<p>仅优化少量软提示或前缀</p>
<p><strong>知识编辑</strong></p>
<p>Meng et al. [20]、Tangent-space Editing [22]</p>
<p>精准修改特定事实或神经元</p>
<p>与这些方法相比，本文提出的 reasoning vector 属于<strong>全局、一次性、无需再训练</strong>的增强方式，且不局限于单一任务或局部知识。</p>
<p>综上，本文在以下两点实现突破：</p>
<ul>
<li>将“推理能力”视为可迁移的通用向量，而非任务特定模式；</li>
<li>利用开源社区已训练的 SFT/RL 模型，通过简单张量运算实现零成本复用。</li>
</ul>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文通过“<strong>提取-注入</strong>”两步法，把强化学习（RL）训练出的推理能力封装成一个可复用的参数向量，并以零训练的方式迁移到任意兼容模型。具体流程如下：</p>
<p>1. 提取阶段：构造 reasoning vector</p>
<ul>
<li><strong>数据来源</strong>：从开源社区获取两个<strong>同架构、同初始化、同预训练</strong>的 Qwen2.5 模型<ul>
<li>θSFT：仅做监督微调（SFT）</li>
<li>θGRPO：在相同数据上继续做 Group Relative Policy Optimization（RL）</li>
</ul>
</li>
<li><strong>向量定义</strong>  <script type="math/tex; mode=display">\\mathbf{v}_{\\text{reason}} = \\theta_{\\text{GRPO}} - \\theta\_{\\text{SFT}}</script>该差值被假设为<strong>仅包含 RL 引入的推理增强信号</strong>，而共享知识被抵消。</li>
</ul>
<p>2. 注入阶段：零训练迁移</p>
<ul>
<li><strong>目标模型</strong>：任意兼容的指令微调模型 θtarget（同架构、同 tokenizer、同源初始化）</li>
<li><strong>算术操作</strong>（仅需两次逐元素张量运算）<ol>
<li>预计算：$\mathbf{v}<em>{\text{reason}} \leftarrow \theta</em>{\text{GRPO}} - \theta_{\text{SFT}}$</li>
<li>注入：$\theta_{\text{enhanced}} = \theta_{\text{target}} + \alpha \cdot \mathbf{v}_{\text{reason}}$<br>实验中 α=1 即最佳，无需再调参。</li>
</ol>
</li>
<li><strong>可选控制</strong>：通过二进制掩码 m 限定注入层，实验显示全注入已足够鲁棒。</li>
</ul>
<p>3. 理论保障：Linear Mode Connectivity</p>
<ul>
<li>θSFT 与 θGRPO 从同一初始化出发，满足线性模式连通性（LMC）</li>
<li>因此 $\mathbf{v}_{\text{reason}}$ 位于共享低损盆地，注入后不会导致灾难性遗忘或损失激增。</li>
</ul>
<p>4. 激活策略</p>
<ul>
<li>在输入前加一句 “Think step by step” 可进一步激发注入的推理路径，类似 RL 训练时的条件推理。</li>
</ul>
<p>5. 结果验证</p>
<ul>
<li>在 1.5 B / 7 B 模型上，<strong>仅两次张量运算</strong>即可带来<ul>
<li>GSM8K +4.9 %</li>
<li>HumanEval +4.3 %</li>
<li>BigBenchHard +12.3 %</li>
</ul>
</li>
<li>对抗扰动、向量缩放、跨域迁移、正负向消融均验证其有效性与因果性。</li>
</ul>
<p>总结：论文把昂贵的 RL 训练成果压缩成一个可插拔的向量，通过**“减法提取、加法迁移”**完成推理能力的回收与再利用，实现从“重训练”到“轻编辑”的范式转换。</p>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文围绕 <strong>“reasoning vector 能否零训练地提升模型推理能力”</strong> 设计了四类实验，覆盖性能、鲁棒性、消融及跨域迁移四个维度。所有实验均在 Qwen2.5-1.5 B 与 7 B 模型上完成，使用公开 checkpoint 与 MergeKit 工具，确保可复现。</p>
<p>1. 主实验：基准性能对比</p>
<p><strong>目的</strong>：验证向量注入是否带来一致提升。<br><strong>配置</strong>（四种）</p>
<ul>
<li>Baseline：官方 Qwen2.5-Instruct</li>
<li>G+T：GRPO 训练源模型 + “Think step by step” 提示</li>
<li>+Vector：Baseline + vreason（α = 1）</li>
<li>+Vector+Think：+Vector 再加提示</li>
</ul>
<p><strong>数据集</strong></p>
<ul>
<li>GSM8K（数学）</li>
<li>HumanEval / HumanEval+（代码生成）</li>
<li>SciQ（科学问答）</li>
<li>BigBenchHard（多跳逻辑）</li>
</ul>
<p><strong>结果摘要</strong>（绝对提升，单跑）</p>
<p>模型</p>
<p>GSM8K</p>
<p>HumanEval</p>
<p>BBH</p>
<p>1.5 B</p>
<p>+4.9 %</p>
<p>+4.3 %</p>
<p>+12.3 %</p>
<p>7 B</p>
<p>+5.0 %</p>
<p>+3.7 %</p>
<p>+1.4 %</p>
<p>2. 鲁棒性实验：对抗扰动测试</p>
<p><strong>目的</strong>：排除“表面模式匹配”质疑，验证推理能力是否真正内化。<br><strong>扰动数据集</strong>（基于 GSM8K 自制）</p>
<ul>
<li>GSM Hard Lite：数值范围扩大、推理步数增多</li>
<li>Noise+Digit：插入无关数字、拼写错误、干扰符号</li>
<li>Sentence Shuffle：打乱句子顺序但保留逻辑依赖</li>
</ul>
<p><strong>结果</strong>（1.5 B 模型）</p>
<ul>
<li>在所有三种扰动下，+Vector 仍稳定领先 Baseline 2–6 %。</li>
<li>+Vector+Think 进一步提升至 3–6 % 区间，显示提示与向量互补。</li>
</ul>
<p>3. 消融实验：因果性 &amp; 缩放性</p>
<p>3.1 向量移除</p>
<ul>
<li>操作：θdegraded = θbaseline − vreason</li>
<li>结果：GSM8K 准确率从 45.1 % 跌至 33.4 %（-11.8 %），证明向量的因果贡献。</li>
</ul>
<p>3.2 缩放系数 α</p>
<ul>
<li>α ∈ {0.5, 1.0, 1.5, 2.0}</li>
<li>结果：α = 1.0 最优；过大或过小均略降性能，显示向量已自然校准。</li>
</ul>
<p>3.3 跨域迁移</p>
<ul>
<li>用代码 RL 向量（HumanEval 训练）注入数学模型 → GSM8K +2.1 %</li>
<li>用数学 RL 向量（GSM8K 训练）注入代码模型 → HumanEval +1.8 %</li>
<li>结论：向量包含部分<strong>领域通用</strong>推理成分，但主增益仍来自同源任务。</li>
</ul>
<p>4. 定性示例（附录）</p>
<ul>
<li>展示同一道多步应用题在<ul>
<li>θbase − vreason（错误逻辑、步骤混乱）</li>
<li>θbase + vreason（正确聚合、步骤清晰）<br>的输出对比，直观说明向量对推理链的因果影响。</li>
</ul>
</li>
</ul>
<p>综上，实验体系完整覆盖了 <strong>有效性、鲁棒性、因果性、通用性</strong> 四个关键维度，为 reasoning vector 的实用价值提供了系统证据。</p>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可视为对本文工作的自然延伸或深层拓展，按“可行性—风险—潜在收益”递进排序，供后续研究参考。</p>
<p>1. 兼容性放宽与跨族迁移</p>
<ul>
<li><strong>问题</strong>：当前要求同架构、同源初始化，限制了向量适用范围。</li>
<li><strong>探索路线</strong><ul>
<li><strong>线性映射</strong>：学习一个轻量级映射矩阵 $W$，使得 $\theta_{\text{target}} + W v_{\text{reason}}$ 在异构模型上仍有效。</li>
<li><strong>Tokenizer 对齐</strong>：研究子词差异对嵌入层的影响，尝试用“词汇表投影”或“嵌入插值”缓解 tokenizer 不一致问题。</li>
<li><strong>模块化注入</strong>：仅对齐 Transformer 的某几层（如 middle layers），其余层冻结，降低架构敏感性。</li>
</ul>
</li>
</ul>
<p>2. 多向量组合与推理技能解耦</p>
<ul>
<li><strong>问题</strong>：单一 reasoning vector 可能混合多种推理策略（算术、逻辑、代码）。</li>
<li><strong>探索路线</strong><ul>
<li><strong>正交分解</strong>：用 PCA、ICA 或稀疏编码将 $v_{\text{reason}}$ 拆成若干正交子向量，对应不同推理技能。</li>
<li><strong>技能插值</strong>：类似模型汤（model soups），对不同技能向量加权组合，实现“按需推理”。</li>
<li><strong>任务算术图</strong>：构建“向量图谱”，研究跨任务迁移路径与冲突。</li>
</ul>
</li>
</ul>
<p>3. 动态系数与自适应路由</p>
<ul>
<li><strong>问题</strong>：固定 $\alpha=1$ 未必对所有输入最优。</li>
<li><strong>探索路线</strong><ul>
<li><strong>输入条件化</strong>：训练一个小型路由网络 $g(x)$，根据输入难度动态输出 $\alpha(x)$。</li>
<li><strong>层级门控</strong>：在每层引入可学习的门控值 $\alpha_l$，实现“细粒度”推理增强。</li>
<li><strong>强化微调</strong>：用轻量级 RL 对 $\alpha$ 进行再优化，仅更新极少参数。</li>
</ul>
</li>
</ul>
<p>4. 向量压缩与低秩近似</p>
<ul>
<li><strong>问题</strong>：完整 $v_{\text{reason}}$ 与模型同尺寸，存储/传输成本高。</li>
<li><strong>探索路线</strong><ul>
<li><strong>LoRA 化</strong>：对 $v_{\text{reason}}$ 做秩-$r$ 分解 $v_{\text{reason}} \approx AB^\top$，$r \ll d$。</li>
<li><strong>量化</strong>：8-bit 或 4-bit 量化向量，评估性能下降边界。</li>
<li><strong>稀疏掩码</strong>：保留 top-$k%$ 幅值参数，研究稀疏度—性能帕累托前沿。</li>
</ul>
</li>
</ul>
<p>5. 安全性与对抗鲁棒性再审视</p>
<ul>
<li><strong>问题</strong>：若恶意向量被注入，是否可植入后门或误导推理？</li>
<li><strong>探索路线</strong><ul>
<li><strong>向量认证</strong>：设计检测机制，判断未知向量是否包含恶意梯度方向。</li>
<li><strong>对抗训练</strong>：在注入阶段加入对抗样本，提升向量鲁棒性。</li>
<li><strong>可解释性</strong>：可视化向量方向与注意力模式，定位高风险参数区域。</li>
</ul>
</li>
</ul>
<p>6. 跨模态与工具增强推理</p>
<ul>
<li><strong>问题</strong>：当前仅限文本，能否迁移到多模态或工具调用场景？</li>
<li><strong>探索路线</strong><ul>
<li><strong>视觉推理</strong>：从文本-图像 RL 模型提取向量，注入 LLaVA 类模型，测试 MathVista 等基准。</li>
<li><strong>工具使用</strong>：对 Code-Interpreter RL 模型提取向量，注入支持函数调用的 Chat 模型，评估 API 调用准确率。</li>
<li><strong>具身推理</strong>：在机器人控制或游戏环境中，验证向量对策略泛化的帮助。</li>
</ul>
</li>
</ul>
<p>7. 理论深化</p>
<ul>
<li><strong>问题</strong>：LMC 仅提供充分条件，缺乏对 reasoning vector 的严格理论刻画。</li>
<li><strong>探索路线</strong><ul>
<li><strong>信息论视角</strong>：用 Fisher 信息或 Hessian 轨迹分析 $v_{\text{reason}}$ 的有效维度。</li>
<li><strong>损失景观切片</strong>：沿 $v_{\text{reason}}$ 方向做高密度采样，量化平坦区域宽度与性能边界。</li>
<li><strong>泛化误差界</strong>：推导向量迁移后的 PAC-Bayes 或 Rademacher 复杂度上界。</li>
</ul>
</li>
</ul>
<p>8. 社区级“向量市场”</p>
<ul>
<li><strong>问题</strong>：如何鼓励开源社区持续发布高质量 reasoning vector？</li>
<li><strong>探索路线</strong><ul>
<li><strong>标准化格式</strong>：定义 JSON/ Safetensors schema，包含向量来源、训练数据、验证指标。</li>
<li><strong>排行榜</strong>：建立跨基准的向量性能榜单，促进公平比较。</li>
<li><strong>许可证设计</strong>：研究针对“向量”而非“权重”的新型开源协议，防止闭源滥用。</li>
</ul>
</li>
</ul>
<p>以上方向既可独立开展，也可组合研究；其中 1、2、4 属于短期可行且工程价值高；3、5、6 兼具学术与应用潜力；7、8 则偏向长期生态与理论建设。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>论文一句话总结</p>
<p>通过“θGRPO − θSFT”提取一条可复用的 <strong>reasoning vector</strong>，仅用两次张量加减即可把强化学习练出的多步推理能力零训练地迁移到任何兼容模型，显著降低推理增强成本。</p>
<p>核心内容速览</p>
<p>模块</p>
<p>要点</p>
<p><strong>问题</strong></p>
<p>RL 虽能提升推理，但训练昂贵；如何复用已有 RL 模型的计算成果？</p>
<p><strong>方法</strong></p>
<p>1. 取公开 Qwen2.5 的两份权重：仅 SFT 的 θSFT 与继续 RL 的 θGRPO<br>2. 定义 <strong>vreason = θGRPO − θSFT</strong><br>3. 对任意同源指令模型执行 <strong>θenhanced = θtarget + vreason</strong></p>
<p><strong>理论</strong></p>
<p>利用 Linear Mode Connectivity 保证加减操作仍在低损盆地，避免灾难遗忘。</p>
<p><strong>实验</strong></p>
<p>• 1.5 B/7 B 模型在 GSM8K、HumanEval、SciQ、BigBenchHard 上 <strong>+1.4 %–12.3 %</strong><br>• 对抗扰动、向量缩放、跨域迁移、正负向消融均验证因果性</p>
<p><strong>结论</strong></p>
<p>推理能力可作为 <strong>模块化向量</strong> 存储、迁移、复用，实现“训练一次，人人受益”。</p>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Reasoning%20Vectors%3A%20Transferring%20Chain-of-Thought%20Capabilities%20via%20Task%20Arithmetic，链接是  https://arxiv.org/pdf/2509.01363  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.01363  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Mohammad Zbeeb,Hasan Abed Al Kader Hammoud,Bernard Ghanem</p>
<p><strong>Categories</strong>: cs.CL</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.01363.pdf">https://arxiv.org/pdf/2509.01363.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.01363">https://arxiv.org/abs/2509.01363</a></p>
<p><strong>Arxiv ID</strong>: 2509.01363</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.01363">https://papers.cool/arxiv/2509.01363</a></p>
<p><strong>Published</strong>: 2025-09-01T11:04:51Z</p>
<p><strong>Updated</strong>: 2025-09-01T11:04:51.000Z</p>
<hr>
<h3 id="11-Implicit-Actor-Critic-Coupling-via-a-Supervised-Learning-Framework-for-RLVR"><a href="#11-Implicit-Actor-Critic-Coupling-via-a-Supervised-Learning-Framework-for-RLVR" class="headerlink" title="11. Implicit Actor Critic Coupling via a Supervised Learning Framework for RLVR"></a>11. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.02522">Implicit Actor Critic Coupling via a Supervised Learning Framework for RLVR</a></h3><p>Recent advances in Reinforcement Learning with Verifiable Rewards (RLVR) have empowered large language models (LLMs) to tackle challenging reasoning tasks such as mathematics and programming. RLVR leverages verifiable outcome rewards to guide policy optimization, enabling LLMs to progressively improve output quality in a grounded and reliable manner. Despite its promise, the RLVR paradigm poses significant challenges, as existing methods often suffer from sparse reward signals and unstable policy gradient updates, particularly in RL-based approaches. To address the challenges, we propose $\textbf{PACS}$, a novel RLVR framework that achieves im$\textbf{P}$licit $\textbf{A}$ctor $\textbf{C}$ritic coupling via a $\textbf{S}$upervised learning framework. By treating the outcome reward as a predictable label, we reformulate the RLVR problem into a supervised learning task over a score function parameterized by the policy model and optimized using cross-entropy loss. A detailed gradient analysis shows that this supervised formulation inherently recovers the classical policy gradient update while implicitly coupling actor and critic roles, yielding more stable and efficient training. Benchmarking on challenging mathematical reasoning tasks, PACS outperforms strong RLVR baselines, such as PPO and GRPO, achieving superior reasoning performance. For instance, PACS achieves 59.78\% at pass@256 on AIME 2025, representing improvements of 13.32 and 14.36 points over PPO and GRPO. This simple yet powerful framework offers a promising avenue for LLMs post-training with verifiable rewards. Our code and data are available as open source at <a target="_blank" rel="noopener" href="https://github.com/ritzz-ai/PACS">https://github.com/ritzz-ai/PACS</a>.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>具有可验证奖励的强化学习 （RLVR） 的最新进展使大型语言模型 （LLM） 能够处理数学和编程等具有挑战性的推理任务。RLVR 利用可验证的结果奖励来指导策略优化，使 LLM 能够以扎根可靠的方式逐步提高输出质量。尽管 RLVR 范式前景广阔，但它带来了重大挑战，因为现有方法经常受到稀疏奖励信号和不稳定的策略梯度更新的影响，特别是在基于 RL 的方法中。为了应对这些挑战，我们提出了 $\textbf{PACS}$，这是一种新颖的 RLVR 框架，它通过 $\textbf{S}$upervised 学习框架实现了 im$\textbf{P}$licit $\textbf{A}$ctor $\textbf{C}$ritic 耦合。通过将结果奖励视为可预测的标签，我们将 RLVR 问题重新表述为由策略模型参数化并使用交叉熵损失进行优化的分数函数上的监督学习任务。详细的梯度分析表明，这种监督公式本质上恢复了经典的策略梯度更新，同时隐式耦合了参与者和批评者的角色，从而产生了更稳定和高效的训练。PACS 以具有挑战性的数学推理任务为基准，优于 PPO 和 GRPO 等强大的 RLVR 基线，实现了卓越的推理性能。例如，PACS 在 AIME 2025 中以 59.78\% 的pass@256率实现，比 PPO 和 GRPO 提高了 13.32 和 14.36 个百分点。这个简单而强大的框架为法学硕士在培训后提供了一条有前途的途径，并获得了可验证的奖励。我们的代码和数据在 <a target="_blank" rel="noopener" href="https://github.com/ritzz-ai/PACS">https://github.com/ritzz-ai/PACS</a> 上以开源形式提供。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<ul>
<li><strong>稀疏奖励信号</strong>：在 RLVR 中，只有最终答案的对错（0/1）作为奖励，且仅在完整输出后给出，导致传统 RL 方法难以进行细粒度的信用分配，梯度更新稀疏且不稳定。</li>
<li><strong>训练不稳定性</strong>：现有基于 PPO、GRPO 等策略梯度方法要么依赖额外的价值模型（增加复杂度），要么采用高方差的蒙特卡洛估计（导致训练震荡）。</li>
<li><strong>范式局限</strong>：传统 RL 范式将策略优化与奖励估计分离（显式 Actor-Critic 结构），存在时间不一致和超参数敏感的问题。</li>
</ul>
<p><strong>核心目标</strong>：提出一种无需显式价值模型、通过监督学习框架隐式耦合 Actor-Critic 的新方法 PACS，以稳定、高效地利用可验证奖励提升 LLM 的数学推理能力。</p>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>与本文相关的研究可分为两条主线：<strong>推理模型（Reasoning Models）</strong> 与 <strong>可验证奖励强化学习（RLVR）</strong>。以下按类别归纳：</p>
<p>1. 推理模型（Reasoning-oriented LLMs）</p>
<ul>
<li><strong>OpenAI-o1</strong>（Jaech et al., 2024）<br>首个公开强调“链式思维”推理能力的模型，通过扩大测试时计算（test-time compute）提升数学与编程任务表现。</li>
<li><strong>DeepSeek-R1</strong>（Guo et al., 2025）<br>采用 <strong>GRPO</strong>（Shao et al., 2024）与规则型可验证奖励，展示 RLVR 在数学推理上的显著增益。</li>
<li><strong>QWQ</strong>（Qwen-Team, 2025）<br>两阶段 RL 框架：冷启动阶段建立推理能力，后续通用 RL 微调扩展泛化性。</li>
<li><strong>Gemini 2.5 Pro</strong>（Comanici et al., 2025）<br>融合人类反馈、检索增强与多模态感知，推动推理模型向通用智能体演进。</li>
</ul>
<p>2. 可验证奖励强化学习（RLVR）</p>
<p>2.1 基于价值模型（Value-model-based）</p>
<ul>
<li><strong>PPO</strong>（Schulman et al., 2017）<br>经典 Actor-Critic 方法，使用广义优势估计（GAE）降低方差，但需要独立的价值网络。</li>
<li><strong>VinePPO</strong>（Kazemnejad et al., 2024）<br>通过细粒度信用分配改进 PPO，用于 LLM 的 RLHF 训练。</li>
<li><strong>VAPO</strong>（Yue et al., 2025）<br>针对复杂推理任务设计的价值模型增强方法，强调训练稳定性。</li>
</ul>
<p>2.2 无价值模型（Value-model-free）</p>
<ul>
<li><strong>GRPO</strong>（Shao et al., 2024）<br>通过组内相对奖励估计优势，避免显式价值网络，但依赖高方差蒙特卡洛估计。</li>
<li><strong>REINFORCE++</strong>（Hu et al., 2025）<br>改进 REINFORCE 的基线设计，降低梯度方差。</li>
<li><strong>DAPO</strong>（Yu et al., 2025）<br>开源大规模 RL 系统，采用去 KL 正则化的 GRPO 变体。</li>
</ul>
<p>2.3 与 PACS 相关的技术</p>
<ul>
<li><strong>RLOO 估计器</strong>（Kool et al., 2019; Ahmadian et al., 2024）<br>用于无偏估计相对优势，被 PACS 用作 score 函数的核心实现。</li>
<li><strong>DPO</strong>（Rafailov et al., 2023）<br>将奖励建模转化为监督学习，但针对偏好数据；PACS 将其思想扩展到可验证奖励场景。</li>
<li><strong>Dr. GRPO</strong>（Liu et al., 2025b）<br>去除标准差的 GRPO 变体，在消融实验中作为 PACS 的对比基线。</li>
</ul>
<p>总结</p>
<p>类别</p>
<p>代表方法</p>
<p>与 PACS 的关系</p>
<p>推理模型</p>
<p>OpenAI-o1, DeepSeek-R1, QWQ, Gemini 2.5</p>
<p>目标场景一致（数学推理），但 PACS 聚焦训练算法创新</p>
<p>Value-model-based</p>
<p>PPO, VAPO, VinePPO</p>
<p>作为 PACS 的对照基线，展示无需独立价值网络的优势</p>
<p>Value-model-free</p>
<p>GRPO, REINFORCE++, DAPO</p>
<p>直接对比对象，PACS 通过监督学习框架降低方差与复杂度</p>
<p>技术组件</p>
<p>RLOO, DPO, Dr. GRPO</p>
<p>被 PACS 采用或对比，验证设计选择的有效性</p>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文通过提出 <strong>PACS（imPlicit Actor Critic coupling via a Supervised learning framework）</strong> 框架，将 RLVR 问题重新表述为监督学习任务，从而绕过传统 RL 方法在稀疏奖励下的固有缺陷。具体解决方案分为三个层面：</p>
<p>1. 问题重述：从 RL 到监督学习</p>
<ul>
<li><p><strong>核心思想</strong><br>将可验证的 0/1 奖励视为<strong>标签</strong>，而非稀疏的强化信号。<br>目标不再是最大化期望奖励，而是训练一个由策略参数化的<strong>打分函数</strong> $\psi(q,o;\pi_\theta)$ 来预测该标签，使用<strong>二元交叉熵损失</strong>：</p>
<p>[ \mathcal{L}(\theta) = -\mathbb{E}<em>{q,o\sim\pi</em>\theta(\cdot|q)}\Big[R(q,o)\log\sigma(\psi) + (1-R)\log(1-\sigma(\psi))\Big] ]</p>
</li>
<li><p><strong>优势</strong><br>直接利用监督学习的稳定优化特性，避免稀疏奖励导致的梯度消失或高方差问题。</p>
</li>
</ul>
<p>2. 隐式 Actor-Critic 耦合：统一梯度更新</p>
<ul>
<li><p><strong>梯度分解</strong><br>对交叉熵损失求导后，梯度自然分解为两项（公式6）：</p>
<ol>
<li><strong>Actor 项</strong>：$\mathbb{E}[\ell(q,o;\pi_\theta)\nabla_\theta\log\pi_\theta(o|q)]$<br>等价于策略梯度，但权重由预测误差 $\ell$ 动态调整。</li>
<li><strong>Critic 项</strong>：$\mathbb{E}[(R-\sigma(\psi))\nabla_\theta\psi]$<br>通过残差 $R-\sigma(\psi)$ 直接优化打分函数，无需独立价值网络。</li>
</ol>
</li>
<li><strong>耦合机制</strong><br>两项共享同一参数 $\theta$，实现<strong>单步更新</strong>中策略改进（Actor）与奖励估计（Critic）的协同优化，消除传统 Actor-Critic 的时间不一致性。</li>
</ul>
<p>3. 打分函数实例化：RLOO 与稳定训练</p>
<ul>
<li><p><strong>RLOO 估计器</strong><br>采用 REINFORCE Leave-One-Out 计算相对优势：</p>
<p>[ \psi(q,o_i;\pi_\theta) = \underbrace{\beta\log\frac{\pi_\theta(o_i|q)}{\pi_{\text{ref}}(o_i|q)}}<em>{\text{reward proxy } \hat{r}(q,o_i)} - \frac{1}{G-1}\sum</em>{j\neq i}\hat{r}(q,o_j) ]</p>
<ul>
<li>通过组内对比降低方差，避免显式价值模型。</li>
<li>周期性重置参考策略 $\pi_{\text{ref}}$ 防止训练不稳定。</li>
</ul>
</li>
<li><strong>类别不平衡处理</strong><br>对正确/错误样本加权（King &amp; Zeng, 2001），缓解数据分布偏差。</li>
</ul>
<p>4. 实验验证：性能与稳定性</p>
<ul>
<li><strong>显著优于基线</strong><br>在 AIME 2025 上，PACS 的 pass@256 达到 <strong>59.78%</strong>，较 PPO 提升 <strong>13.32</strong> 分，较 GRPO 提升 <strong>14.36</strong> 分。</li>
<li><strong>训练动态</strong><br>熵损失与梯度范数显示 PACS 维持更高探索性，避免 PPO/GRPO 的熵崩溃问题。</li>
</ul>
<p>总结：PACS 的解决路径</p>
<p>传统 RLVR 问题</p>
<p>PACS 解决方案</p>
<p>稀疏奖励导致信用分配困难</p>
<p>将奖励视为标签，用交叉熵损失直接优化</p>
<p>高方差梯度（GRPO 等）</p>
<p>RLOO 组内相对估计 + 预测误差加权</p>
<p>Actor-Critic 结构复杂</p>
<p>共享参数隐式耦合，单模型双角色</p>
<p>训练不稳定</p>
<p>监督学习优化 + 参考策略重置 + 类别加权</p>
<p>通过“监督学习形式的策略优化”，PACS 在保持简洁性的同时，实现了稳定、高效的 RLVR 训练。</p>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文围绕 <strong>数学推理能力</strong> 与 <strong>训练稳定性</strong> 两条主线，在 4 个公开基准、2 个模型规模上系统验证了 PACS 的有效性，并辅以消融与动态分析。实验设计可概括为以下 5 组：</p>
<p>1. 主实验：4 个数学基准上的 pass@k 对比</p>
<p><strong>数据集</strong></p>
<ul>
<li>MATH 500（500 题）</li>
<li>AMC23（2023 AMC 系列竞赛题）</li>
<li>AIME 2024 / 2025（最新两届 AIME 邀请赛）</li>
</ul>
<p><strong>模型规模</strong></p>
<ul>
<li>Qwen2.5-3B（训练 140 步）</li>
<li>Qwen2.5-7B（训练 300 步）</li>
</ul>
<p><strong>基线</strong></p>
<ul>
<li>Base（未微调）</li>
<li>PPO（价值模型型 RLVR）</li>
<li>GRPO（无价值模型型 RLVR）</li>
</ul>
<p><strong>评估指标</strong></p>
<ul>
<li>pass@k（k ∈ {1,2,4,8,16,32,64,128,256}），采用无偏估计（Chen et al., 2021）。</li>
</ul>
<p><strong>关键结果</strong></p>
<p>数据集</p>
<p>模型</p>
<p>pass@256 提升（vs PPO / GRPO）</p>
<p>AIME 2025</p>
<p>7B</p>
<p><strong>+15.31</strong> / <strong>+11.77</strong></p>
<p>AIME 2024</p>
<p>7B</p>
<p><strong>+13.32</strong> / <strong>+14.36</strong></p>
<p>MATH 500</p>
<p>3B</p>
<p>67.31@1（超 Base +10.65）</p>
<p>AMC23</p>
<p>7B</p>
<p>78.17@8（超 GRPO +5.97）</p>
<p>2. 消融实验</p>
<p>2.1 超参数 β 敏感性</p>
<ul>
<li>β ∈ {0.1, 0.5, 1, 2, 10}</li>
<li><strong>结论</strong>：β = 1 时整体最优；高难度任务（AIME）对 β 更敏感。</li>
</ul>
<p>2.2 优势估计器对比</p>
<ul>
<li>默认 <strong>RLOO</strong> vs <strong>GRPO</strong> vs <strong>Dr. GRPO</strong></li>
<li><strong>结论</strong>：<ul>
<li>简单任务（MATH 500、AMC23）三者相近；</li>
<li>高难度任务（AIME 24/25）RLOO 显著领先，pass@256 领先 Dr. GRPO <strong>≈ 9 个百分点</strong>。</li>
</ul>
</li>
</ul>
<p>2.3 类别加权机制</p>
<ul>
<li>PACS vs PACS w/o weight</li>
<li><strong>结论</strong>：加权机制在 AIME 上带来 <strong>6.36</strong> 个点的 pass@32 提升，验证其缓解数据不平衡的作用。</li>
</ul>
<p>3. 训练动态分析（Qwen2.5-7B）</p>
<p><strong>监控指标</strong></p>
<ul>
<li>熵损失（Entropy Loss）</li>
<li>梯度范数（Gradient Norm）</li>
<li>平均响应长度（Response Length）</li>
</ul>
<p><strong>发现</strong></p>
<ul>
<li><strong>PPO / GRPO</strong>：熵快速崩溃 → 保守输出；梯度范数低且平稳 → 收敛过早。</li>
<li><strong>PACS</strong>：熵先升后稳（≈ 1200–1300），梯度范数持续高位（峰值 40）→ 保持探索与更新活力。</li>
<li><strong>响应长度</strong>：PACS 生成更长、更详细的推理链。</li>
</ul>
<p>4. 扩展结果</p>
<p>附录给出全部 k 值的完整表格（AMC23、AIME 2024/2025 的 3B &amp; 7B 结果），确保可复现与进一步对比。</p>
<p>5. 实验总结</p>
<p>维度</p>
<p>验证内容</p>
<p>结论</p>
<p>性能</p>
<p>4 基准 + 2 规模</p>
<p>PACS 全面领先 PPO/GRPO，尤其高难度任务</p>
<p>稳健性</p>
<p>β、估计器、加权</p>
<p>设计选择均对性能有显著影响</p>
<p>训练</p>
<p>熵、梯度、长度</p>
<p>PACS 实现更优探索-利用平衡，避免熵崩溃</p>
<p>实验体系完整覆盖了 <strong>效果、鲁棒性、机制解释</strong> 三个层面，支撑了 PACS 作为 RLVR 新范式的有效性。</p>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可在 PACS 基础上继续深入，分为 <strong>方法改进、理论分析、场景扩展、系统优化</strong> 四大类：</p>
<p>1. 方法改进</p>
<ul>
<li><strong>细粒度奖励</strong><br>将 0/1 结果奖励拆解为 <strong>步骤级或子问题级</strong> 信号（如部分得分、关键推理步骤正确性），构造多标签或序列标注形式的监督目标，进一步缓解稀疏性。</li>
<li><strong>动态 β 与自适应加权</strong><br>用元学习或在线贝叶斯方法 <strong>自动调整 β</strong> 及类别权重，避免人工搜索；同时可随训练阶段动态降低 KL 正则强度，实现从保守到开放的平滑过渡。</li>
<li><strong>混合估计器</strong><br>将 RLOO 与 <strong>GAE、V-trace</strong> 等低方差估计结合，设计门控网络根据样本难度或不确定性选择最优估计器，兼顾方差与偏差。</li>
</ul>
<p>2. 理论分析</p>
<ul>
<li><strong>收敛性与样本复杂度</strong><br>在 bandit 或 tabular MDP 简化设定下，证明 PACS 的 <strong>收敛速率</strong> 及与 PPO/GRPO 的样本复杂度差距，量化监督损失带来的方差缩减。</li>
<li><strong>隐式正则化机制</strong><br>研究交叉熵损失在策略空间中诱导的 <strong>隐式熵正则</strong> 与 <strong>相对熵约束</strong>，解释为何 PACS 能自然保持较高策略熵。</li>
<li><strong>函数逼近误差影响</strong><br>分析打分函数 ψ 的 <strong>表达能力</strong>（如深度、宽度、LoRA rank）对策略偏差的上界，给出最小化近似误差的网络设计指导。</li>
</ul>
<p>3. 场景扩展</p>
<ul>
<li><strong>代码生成与形式验证</strong><br>将 PACS 迁移至 <strong>编程竞赛、定理证明</strong> 等可自动验证领域，利用单元测试或形式化验证器作为 0/1 奖励，验证跨任务鲁棒性。</li>
<li><strong>多模态推理</strong><br>在 <strong>几何题、图表问答</strong> 中引入视觉编码器，构造跨模态 (q, o) 输入，检验打分函数 ψ 对多模态上下文的建模能力。</li>
<li><strong>对话式数学辅导</strong><br>把单轮问答扩展为多轮 <strong>对话式解题</strong>，奖励定义为最终答案正确性，但需在每轮维护对话历史，探索长程信用分配。</li>
</ul>
<p>4. 系统优化</p>
<ul>
<li><strong>大规模训练框架</strong><br>基于 <strong>3D-并行 + ZeRO-3</strong> 将 PACS 扩展至 70B+ 模型，研究梯度同步频率、微批次大小对训练效率与收敛的影响。</li>
<li><strong>在线课程学习</strong><br>设计 <strong>难度自适应课程</strong>：根据当前模型 pass@k 曲线动态筛选训练题目，优先训练模型成功率 30%–70% 的区间，提升样本效率。</li>
<li><strong>推理-训练协同优化</strong><br>在推理阶段采用 <strong>test-time scaling</strong>（如多数投票、过程奖励模型）生成更高质量样本，再反哺 PACS 训练，形成自我改进闭环。</li>
</ul>
<p>5. 风险与伦理</p>
<ul>
<li><strong>奖励劫持与过度优化</strong><br>监测模型是否通过 <strong>符号操纵、格式漏洞</strong> 获得高分答案，引入 <strong>鲁棒性测试集</strong> 与对抗奖励函数，确保真实推理能力提升。</li>
<li><strong>可解释性工具</strong><br>利用注意力热图或因果探针分析 ψ 的决策依据，验证打分函数是否关注关键推理步骤而非表面特征。</li>
</ul>
<p>总结：潜在研究路线图</p>
<p>阶段</p>
<p>目标</p>
<p>关键问题</p>
<p>短期</p>
<p>细粒度奖励 + 动态 β</p>
<p>步骤级标签如何构造？β 自适应是否稳定？</p>
<p>中期</p>
<p>理论保证 + 代码/定理迁移</p>
<p>收敛速率与样本复杂度上界？跨任务超参数是否一致？</p>
<p>长期</p>
<p>多模态 + 在线课程 + 70B 规模</p>
<p>视觉-文本联合 ψ 如何设计？课程策略能否持续增益？</p>
<p>这些方向既可直接在 PACS 框架上迭代，也可作为 RLVR 领域更广泛的开放问题。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>论文一句话总结</p>
<p>PACS 把 RLVR 中的稀疏 0/1 奖励直接当作监督标签，用交叉熵损失训练一个由策略本身参数化的打分函数，从而在同一套参数里隐式完成 Actor-Critic 耦合，显著提升了大模型在数学推理任务上的效果与训练稳定性。</p>
<p>主要内容提炼</p>
<p>维度</p>
<p>关键信息</p>
<p><strong>问题</strong></p>
<p>现有 RLVR 方法受限于稀疏奖励带来的信用分配难、梯度高方差或价值模型复杂。</p>
<p><strong>思路</strong></p>
<p>将 RL 问题重构成<strong>监督学习</strong>：用策略 πθ 直接预测 (q,o) 的 0/1 正确性标签，损失为二元交叉熵。</p>
<p><strong>理论</strong></p>
<p>梯度自然拆成两项：<br>1. Actor：策略梯度，权重由预测误差决定；<br>2. Critic：残差驱动打分函数更新。<br>二者共享参数，实现<strong>隐式 Actor-Critic 耦合</strong>。</p>
<p><strong>实现</strong></p>
<p>打分函数 ψ 用 <strong>RLOO 相对优势</strong> 计算，基于 log-prob ratio；定期重置参考策略 πref 防漂移；对正确/错误样本加权缓解类别不平衡。</p>
<p><strong>实验</strong></p>
<p>在 MATH 500、AMC23、AIME 2024/2025 上，用 3B/7B Qwen2.5 模型：<br>- 全面优于 PPO、GRPO；<br>- AIME 2025 pass@256 提升 13–15 个百分点；<br>- 消融显示 β=1、RLOO、类别加权均关键；<br>- 训练动态表明 PACS 保持更高熵与梯度活力，避免熵崩溃。</p>
<p><strong>贡献</strong></p>
<p>提出一种<strong>无需独立价值网络、训练稳定、效果领先</strong>的 RLVR 新范式，并开源代码与数据。</p>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Implicit%20Actor%20Critic%20Coupling%20via%20a%20Supervised%20Learning%20Framework%20for%20RLVR，链接是  https://arxiv.org/pdf/2509.02522  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.02522  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Jiaming Li,Longze Chen,Ze Gong,Yukun Chen,Lu Wang,Wanwei He,Run Luo,Min Yang</p>
<p><strong>Categories</strong>: cs.CL,cs.LG</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.02522.pdf">https://arxiv.org/pdf/2509.02522.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.02522">https://arxiv.org/abs/2509.02522</a></p>
<p><strong>Arxiv ID</strong>: 2509.02522</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.02522">https://papers.cool/arxiv/2509.02522</a></p>
<p><strong>Published</strong>: 2025-09-02T17:22:46Z</p>
<p><strong>Updated</strong>: 2025-09-02T17:22:46.000Z</p>
<hr>
<h3 id="12-Jointly-Reinforcing-Diversity-and-Quality-in-Language-Model-Generations"><a href="#12-Jointly-Reinforcing-Diversity-and-Quality-in-Language-Model-Generations" class="headerlink" title="12. Jointly Reinforcing Diversity and Quality in Language Model Generations"></a>12. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.02534">Jointly Reinforcing Diversity and Quality in Language Model Generations</a></h3><p>Post-training of Large Language Models (LMs) often prioritizes accuracy and helpfulness at the expense of diversity. This creates a tension: while post-training improves response quality, it also sharpens output distributions and reduces the range of ideas, limiting the usefulness of LMs in creative and exploratory tasks such as brainstorming, storytelling, or problem solving. We address this challenge with Diversity-Aware Reinforcement Learning (DARLING), a framework that jointly optimizes for response quality and semantic diversity. At its core, DARLING introduces a learned partition function to measure diversity beyond surface-level lexical variations. This diversity signal is then combined with a quality reward during online reinforcement learning, encouraging models to generate outputs that are both high-quality and distinct. Experiments across multiple model families and sizes show that DARLING generalizes to two regimes: non-verifiable tasks (instruction following and creative writing) and verifiable tasks (competition math). On five benchmarks in the first setting, DARLING consistently outperforms quality-only RL baselines, producing outputs that are simultaneously of higher quality and novelty. In the second setting, DARLING achieves higher pass@1 (solution quality) and pass@k (solution variety). Most strikingly, explicitly optimizing for diversity catalyzes exploration in online RL, which manifests itself as higher-quality responses.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>大型语言模型（LM）的后期训练往往优先考虑准确性和有用性，而牺牲多样性。这产生了一种紧张关系：虽然后期训练提高了响应质量，但它也加剧了输出分布，减少了思想的范围，限制了 LM 在创造性和探索性任务中的有用性，例如头脑风暴、讲故事或解决问题。我们通过多样性感知强化学习（DARLING）来解决这一挑战，这是一种共同优化响应质量和语义多样性的框架。在其核心，DARLING 引入了一个学习的划分函数，以测量表面层面词汇变化之外的多样性。然后在在线强化学习过程中，将这种多样性信号与质量奖励结合，鼓励模型生成既高质量又独特的输出。在多个模型系列和规模的实验中，DARLING 在两种模式下都表现出良好的泛化能力：不可验证任务（指令跟随和创造性写作）和可验证任务（竞赛数学）。在第一个设置的五个基准测试中，DARLING 一直优于仅考虑质量的强化学习基线，产生同时具有更高质量和新颖性的输出。在第二个设置中，DARLING 达到了更高的通过率@1（解决方案质量）和通过率@k（解决方案多样性）。最引人注目的是，明确优化多样性促进了在线强化学习中的探索，这表现为更高质量的响应结果。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>论文针对大型语言模型（LLM）在<strong>后训练阶段</strong>出现的<strong>多样性崩溃</strong>现象，提出了一种新的在线强化学习方法——<strong>DARLING（Diversity-Aware Reinforcement Learning）</strong>，旨在<strong>同时优化响应质量与语义多样性</strong>，解决以下核心问题：</p>
<ul>
<li><strong>后训练导致输出分布过度尖锐化</strong>：现有RLHF/RL后训练方法（如GRPO）以“质量”或“正确性”为唯一优化目标，导致模型输出趋于同质化，重复或近似重复的回答显著增加，限制了模型在<strong>创意写作、头脑风暴、科学假设生成</strong>等需要高多样性任务中的实用性。</li>
<li><strong>缺乏语义层面的多样性度量</strong>：传统基于词法（如n-gram重叠）的多样性指标无法捕捉深层语义差异，而人工评估又难以规模化集成到在线训练中。</li>
<li><strong>质量与多样性的权衡困境</strong>：现有方法往往需手动调节权重或牺牲一方性能，难以在**可验证任务（如竞赛数学）<strong>与</strong>不可验证任务（如开放写作）**中同时提升质量与多样性。</li>
</ul>
<p>DARLING通过以下机制解决上述问题：</p>
<ol>
<li><strong>语义等价分类器</strong>：训练一个可扩展的二元分类器，将同一prompt的多个回答划分为语义等价簇，从而量化<strong>语义多样性</strong>。</li>
<li><strong>乘法奖励融合</strong>：将质量奖励与归一化的语义多样性奖励<strong>相乘</strong>（而非相加），避免尺度失衡，直接放大“高质量且语义独特”回答的梯度信号。</li>
<li><strong>在线RL兼容性</strong>：在不修改模型架构或解码策略的前提下，嵌入现有GRPO框架，兼容不同模型规模（8B-70B）与任务类型（数学/写作）。</li>
</ol>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>论文在 §7 与附录 H 中系统梳理了与“训练阶段提升多样性”和“推理阶段提升多样性”相关的研究，并明确区分了 DARLING 与这些工作的差异。以下按主题归纳：</p>
<p>1. <strong>训练阶段多样性增强（Training-time Diversity）</strong></p>
<p>方法类别</p>
<p>代表工作</p>
<p>核心思想</p>
<p>与 DARLING 的区别</p>
<p><strong>修改最大似然目标</strong></p>
<p>Li et al., 2016b（MMI）；Welleck et al., 2020（Unlikelihood）；Li et al., 2020（Gaussian prior）；Zhang et al., 2024（高熵匹配）</p>
<p>在预训练或微调阶段通过损失函数惩罚重复、鼓励高熵输出</p>
<p>均为<strong>离线</strong>修改交叉熵损失，DARLING 是在<strong>在线 RL</strong>中直接重塑奖励</p>
<p><strong>偏好优化类</strong></p>
<p>DivPO（Lanchantin et al., 2025a）；Ismayilzada et al., 2025（Creative PO）</p>
<p>在 DPO 框架内将“多样性”作为偏好对的一部分</p>
<p>属于<strong>离线</strong>偏好学习，DARLING 是<strong>在线 RL</strong></p>
<p><strong>在线 RL 重加权</strong></p>
<p>He et al., 2025a（Rewarding the Unlikely）；Chen et al., 2025a（Seed-GRPO）</p>
<p>通过似然或熵调节奖励权重以促进探索</p>
<p>仍依赖<strong>词法或熵信号</strong>，DARLING 引入<strong>语义等价分类器</strong></p>
<p><strong>梯度/表示级探索</strong></p>
<p>Jung et al., 2025（Prismatic Synthesis）</p>
<p>利用梯度相似度进行数据多样化</p>
<p>作用于<strong>数据增强</strong>，DARLING 作用于<strong>奖励塑形</strong></p>
<p>2. <strong>推理阶段多样性增强（Inference-time Diversity）</strong></p>
<p>方法类别</p>
<p>代表工作</p>
<p>核心思想</p>
<p>与 DARLING 的关系</p>
<p><strong>改进解码算法</strong></p>
<p>Vijayakumar et al., 2018（Diverse Beam Search）；Kulikov et al., 2019</p>
<p>在 beam search 中加入多样性惩罚</p>
<p><strong>正交</strong>：DARLING 训练模型本身，可与任何解码策略叠加</p>
<p><strong>提示工程</strong></p>
<p>Nagarajan et al., 2025（随机种子）；Shur-Ofry et al., 2024（persona 条件）；Zhang et al., 2025b（直接提示“be diverse”）</p>
<p>通过 prompt 设计诱导多样化输出</p>
<p><strong>互补</strong>：DARLING 训练后的模型在推理阶段仍可受益于这些技巧</p>
<p>3. <strong>多样性度量与评估</strong></p>
<p>度量类型</p>
<p>代表工作</p>
<p>特点</p>
<p>DARLING 的改进</p>
<p><strong>词法度量</strong></p>
<p>Distinct-n（Li et al., 2016a）；Self-BLEU（Zhu et al., 2018）</p>
<p>计算 n-gram 重叠或 BLEU 多样性</p>
<p>无法捕捉语义等价，DARLING 采用<strong>语义分类器</strong></p>
<p><strong>神经度量</strong></p>
<p>Wieting &amp; Gimpel, 2018（ParaNMT 嵌入）；He et al., 2025a（log-likelihood 差异）</p>
<p>使用句子嵌入距离</p>
<p>计算开销大，DARLING 用<strong>轻量级分类器</strong>实现在线集成</p>
<p><strong>LM-as-a-Judge</strong></p>
<p>Lanchantin et al., 2025a；Zhang et al., 2025b</p>
<p>用强模型评估语义等价</p>
<p>推理成本高，DARLING 将其蒸馏为<strong>小模型分类器</strong></p>
<p>4. <strong>多样性崩溃与后训练分析</strong></p>
<p>研究方向</p>
<p>代表工作</p>
<p>结论</p>
<p>DARLING 的回应</p>
<p><strong>模式崩溃归因</strong></p>
<p>Kirk et al., 2024；Yang &amp; Holtzman, 2025；O’Mahony et al., 2024</p>
<p>RLHF 导致分布收缩、熵降低</p>
<p>通过<strong>奖励塑形</strong>反向抵消收缩趋势</p>
<p><strong>探索-利用权衡</strong></p>
<p>Liu et al., 2025d；Zeng et al., 2025</p>
<p>增大熵或调整 KL 系数不一定提升性能</p>
<p>DARLING 不引入新超参数，直接<strong>加权高质量且语义独特的轨迹</strong></p>
<p>5. <strong>并发与后续工作</strong></p>
<ul>
<li><strong>Chen et al., 2025b</strong>（Pass@k Training）：用 pass@k 作为 RL 奖励，与 DARLING 的 pass@k 评估目标一致，但未显式建模语义多样性。</li>
<li><strong>Liu et al., 2025c</strong>（R1-Zero 分析）：指出 GRPO 的标准差归一化会放大噪声，DARLING 在 §6.3 通过实验验证并采纳该建议，在稠密奖励场景移除归一化。</li>
</ul>
<p>综上，DARLING 与现有工作的核心差异在于：</p>
<ul>
<li><strong>语义级多样性信号</strong>：超越 n-gram 或熵，使用可学习的语义等价分类器。</li>
<li><strong>在线 RL 奖励塑形</strong>：在训练阶段直接放大“高质量且语义独特”样本的梯度，而非事后解码或离线损失修正。</li>
<li><strong>模型与任务无关性</strong>：无需调整架构或超参数，即可在 8B-70B 模型、写作/数学任务上通用。</li>
</ul>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文提出的 <strong>DARLING（Diversity-Aware Reinforcement Learning）</strong> 通过以下三步机制，在在线 RL 训练阶段同时优化<strong>响应质量</strong>与<strong>语义多样性</strong>，从而系统性解决后训练导致的多样性崩溃问题。</p>
<p>1. 语义等价划分：用可学习分类器量化“真实多样性”</p>
<ul>
<li><strong>输入</strong>：对同一 prompt 的 n 条 rollout ${y_1,\dots,y_n}$。</li>
<li><strong>分类器</strong> $ \text{classify}(y_i,y_j)\in{0,1}$：判断两条回答是否语义等价。</li>
<li><strong>输出</strong>：将回答聚类为若干语义等价簇，得到每条回答的多样性分数  <script type="math/tex; mode=display">
\\text{Div}_d(y\_i)=\\frac{1}{n-1}\\sum_{j\\neq i}\\bigl(1-\\text{classify}(y\_i,y\_j)\\bigr)\\in\[0,1\].</script>该指标仅统计“语义独特”的比例，避免表面词汇差异。</li>
</ul>
<blockquote>
<p>实现细节：</p>
<ul>
<li>非可验证任务：微调 ModernBERT-base（8 k token 窗口）。</li>
<li>可验证数学任务：微调 Qwen3-Embedding-4B，用 Llama-3.3-70B 标注 2 万对解。</li>
</ul>
</blockquote>
<p>2. 乘法奖励融合：将多样性信号嵌入 RL 目标</p>
<ul>
<li><strong>质量奖励</strong> $r(x,y_i)$：<ul>
<li>非可验证任务：Athene-RM-8B 打分。</li>
<li>数学任务：Math-Verify 二进制正确性。</li>
</ul>
</li>
<li><strong>多样性-感知奖励</strong>  <script type="math/tex; mode=display">
r\_{\\text{darling}}(x,y\_i)=r(x,y\_i)\\cdot \\text{Norm}\\bigl(\\text{Div}\_d(y\_i)\\bigr),</script>其中 Norm 将多样性线性映射到 $[0,1]$。</li>
<li><strong>优势计算</strong>（GRPO 改进）  <script type="math/tex; mode=display">
A\_{i,t}=r\_{\\text{darling}}(x,y\_i)-\\frac{1}{n}\\sum\_{j=1}^n r\_{\\text{darling}}(x,y\_j).</script>通过<strong>乘法</strong>而非加法，确保梯度更新优先流向“高质量+高多样性”轨迹，避免尺度失衡。</li>
</ul>
<p>3. 在线 RL 训练流程：零额外超参数、即插即用</p>
<ul>
<li><strong>算法骨架</strong>：沿用 GRPO（Group Relative Policy Optimization），仅做两处轻量修改：<ol>
<li>将序列级平均改为 token 级平均，消除长度偏差；</li>
<li>在稠密奖励场景移除标准差归一化，抑制噪声放大（§6.3）。</li>
</ol>
</li>
<li><strong>训练配置</strong>：<ul>
<li>8×H200 GPU，8 rollout/prompt，β=0.001（或数学任务 β=0），10 epoch。</li>
<li>与基线共享所有超参数，无需额外调参。</li>
</ul>
</li>
</ul>
<p>效果验证：质量与多样性同步提升</p>
<p>场景</p>
<p>指标</p>
<p>基线 (GRPO)</p>
<p>DARLING</p>
<p>提升</p>
<p><strong>非可验证</strong></p>
<p>AlpacaEval 2.0 LCWR</p>
<p>48.7 %</p>
<p>55.2 %</p>
<p>+6.5</p>
<p>NoveltyBench Distinct</p>
<p>2.08</p>
<p>5.49</p>
<p>+164 %</p>
<p><strong>可验证数学</strong></p>
<p>pass@1 (4B)</p>
<p>23.4 %</p>
<p>26.9 %</p>
<p>+3.5</p>
<p>pass@128 (4B)</p>
<p>53.4 %</p>
<p>61.0 %</p>
<p>+7.6</p>
<p>总结</p>
<p>DARLING 通过</p>
<ol>
<li><strong>语义等价分类器</strong> → 精准量化多样性，</li>
<li><strong>乘法奖励融合</strong> → 无权重调优地联合优化质量与多样性，</li>
<li><strong>在线 RL 嵌入</strong> → 零架构改动、跨任务通用，<br>在训练阶段直接防止分布收缩，实现“更高质量 + 更高多样性”的双赢。</li>
</ol>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文围绕 <strong>DARLING</strong> 在两类任务（非可验证、可验证）与两类模型规模（8B/70B 与 4B/14B）上，共设计并执行了 <strong>5 组实验 + 3 组消融</strong>，覆盖质量、多样性、温度敏感性、奖励融合方式、多样性度量方式及归一化策略。所有实验均使用公开基准与统一训练/评估脚本，确保可复现。</p>
<p>1. 非可验证任务：通用指令遵循与创意写作</p>
<ul>
<li><strong>模型</strong><br>Llama-3.1-8B-Instruct、Llama-3.3-70B-Instruct</li>
<li><strong>训练数据</strong><br>WildChat 10 k 子集（与 Lanchantin et al., 2025a 相同）</li>
<li><strong>基线</strong><br>GRPO、DivPO、GRPO-Unlikeliness</li>
<li><strong>评估基准与指标</strong><ul>
<li><strong>质量</strong>：AlpacaEval 2.0（LCWR）、ArenaHard v2.0（WR）、EQ-Bench（ELO）</li>
<li><strong>多样性</strong>：NoveltyBench（Distinct、Distinct-4）</li>
</ul>
</li>
<li><strong>结果</strong>（表 1）<ul>
<li>8B：DARLING 在 <strong>AlpacaEval LCWR 55.2 %</strong>（+6.5 vs GRPO）、<strong>Distinct 5.49</strong>（+164 %）均夺魁。</li>
<li>70B：DARLING <strong>LCWR 80.4 %</strong>（+7.1）、<strong>ELO 1531</strong>（+270）同时领先。</li>
</ul>
</li>
</ul>
<p>2. 温度敏感性：质量-多样性 Pareto 前沿</p>
<ul>
<li><strong>设置</strong><br>固定模型后，仅改变采样温度 T∈{0.2,0.4,0.6,0.8,1.2}。</li>
<li><strong>观测</strong>（图 3）<br>在 8B 与 70B 两个尺度，DARLING 的蓝色曲线始终位于 GRPO 与基线的<strong>右上方</strong>，即<strong>同温度下质量与多样性双优</strong>，有效推进 Pareto 前沿。</li>
</ul>
<p>3. 可验证任务：竞赛数学</p>
<ul>
<li><strong>模型</strong><br>Qwen3-4B-Base、Qwen3-14B-Base</li>
<li><strong>训练数据</strong><br>DeepscaleR 过滤后 10 k 题</li>
<li><strong>基线</strong><br>GRPO</li>
<li><strong>评估基准</strong><br>AIME25、OlympiadBench、HMMT 2025、Brumo 2025</li>
<li><strong>指标</strong><br>pass@1（质量）、pass@k 至 k=128（多样性）</li>
<li><strong>结果</strong>（图 6 &amp; 表 9/10）<ul>
<li>4B：DARLING <strong>pass@1 26.9 %</strong>（+3.5）、<strong>pass@128 61.0 %</strong>（+7.6）。</li>
<li>14B：DARLING <strong>pass@1 34.4 %</strong>（+1.9）、<strong>pass@128 76.4 %</strong>（+10.2）。</li>
<li>最难数据集 HMMT 上提升最大，验证“探索→质量”正循环。</li>
</ul>
</li>
</ul>
<p>4. 消融实验</p>
<p>4.1 奖励融合方式：加法 vs 乘法</p>
<ul>
<li><strong>设置</strong><br>在 Llama-3.1-8B 上比较<ul>
<li>Quality + Diversity（加法）</li>
<li>Quality × Diversity（DARLING，乘法）</li>
</ul>
</li>
<li><strong>结果</strong>（表 2）<br>乘法在 AlpacaEval 与 NoveltyBench 均优于加法，且无需调权重。</li>
</ul>
<p>4.2 多样性度量：语义分类器 vs 4-gram</p>
<ul>
<li><strong>设置</strong><br>用 4-gram 独有度替换语义分类器。</li>
<li><strong>结果</strong>（表 3 &amp; 4）<ul>
<li>非可验证任务：4-gram 在 NoveltyBench 多样性显著落后（3.59 vs 5.49）。</li>
<li>数学任务：4-gram 出现<strong>奖励劫持</strong>（生成无关反思），pass@1 反而下降（22.49 vs 26.9）。</li>
</ul>
</li>
</ul>
<p>4.3 GRPO 归一化项</p>
<ul>
<li><strong>设置</strong><br>移除标准差归一化（w/o norm）。</li>
<li><strong>结果</strong>（表 5 &amp; 11）<ul>
<li>稠密奖励（写作）：去归一化带来 <strong>AlpacaEval +3.8 %</strong>、<strong>Distinct +2.1</strong>。</li>
<li>稀疏奖励（数学）：归一化无影响，验证理论分析。</li>
</ul>
</li>
</ul>
<p>5. 定性分析</p>
<ul>
<li><strong>EQ-Bench 细粒度 rubrics</strong>（图 4）<br>DARLING 在“Interesting &amp; Original”“Avoids Cliché”维度胜率最高，直接体现多样性优势。</li>
<li><strong>NoveltyBench 并行采样</strong>（图 5 &amp; C.2）<br>同一 prompt 四次采样：基线模型四次重复“Amazon”或“Quokka”；DARLING 输出不同品牌/动物并附独特理由，展示语义多样性。</li>
</ul>
<p>实验覆盖矩阵</p>
<p>维度</p>
<p>非可验证</p>
<p>可验证</p>
<p>8B</p>
<p>70B</p>
<p>4B</p>
<p>14B</p>
<p>主实验</p>
<p>✅</p>
<p>✅</p>
<p>✅</p>
<p>✅</p>
<p>✅</p>
<p>✅</p>
<p>温度敏感性</p>
<p>✅</p>
<p>—</p>
<p>✅</p>
<p>✅</p>
<p>—</p>
<p>—</p>
<p>消融</p>
<p>✅</p>
<p>✅</p>
<p>✅</p>
<p>—</p>
<p>✅</p>
<p>—</p>
<p>所有实验代码与模型检查点已开源： <a target="_blank" rel="noopener" href="https://github.com/facebookresearch/darling">https://github.com/facebookresearch/darling</a></p>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可作为 DARLING 的后续研究切入点，按“理论—方法—应用—评估”四个层面展开：</p>
<p>1. 理论层面：多样性-质量耦合机制</p>
<ul>
<li><strong>奖励乘法的理论边界</strong><br>当前乘法融合 $r_{\text{darling}} = r \cdot \text{Norm}(\text{Div})$ 在实验上有效，但缺乏对梯度方差、收敛速度的理论刻画。可借鉴 <strong>multi-objective RL</strong> 或 <strong>constrained RL</strong> 框架，给出最优性保证或单调提升条件。</li>
<li><strong>多样性正则化的 KL 解释</strong><br>将 $\log \text{Div}$ 视为额外熵正则项，推导其与原始 KL 约束 $\beta D_{\text{KL}}(\pi|\pi_{\text{ref}})$ 的联合最优分布，分析是否等价于 <strong>熵-质量正则化</strong> 的特例。</li>
</ul>
<p>2. 方法层面：分类器与奖励设计</p>
<ul>
<li><strong>更细粒度的语义距离</strong><br>将二元等价分类器升级为 <strong>连续相似度模型</strong>（如 BERTScore、SimCSE），构造可微的多样性奖励，避免离散聚类带来的梯度稀疏问题。</li>
<li><strong>动态多样性权重</strong><br>引入课程式或自适应系数 $\alpha_t$：  <script type="math/tex; mode=display">r\_t = r + \\alpha\_t \\cdot \\text{Div},</script>在训练初期放大多样性以扩大探索，后期逐渐回归质量主导。</li>
<li><strong>跨语言/跨模态扩展</strong><br>验证分类器在 <strong>多语言</strong>（中/英/法）或 <strong>多模态</strong>（文本+代码+图像描述）场景下的迁移性，并构建相应标注数据。</li>
</ul>
<p>3. 应用层面：任务与系统</p>
<ul>
<li><strong>长文本与对话系统</strong><br>在 <strong>长文档生成</strong>（&gt;4 k tokens）与 <strong>多轮对话</strong> 中测试 DARLING，观察长程语义多样性是否仍能被分类器捕获；并探索 <strong>对话上下文</strong> 如何影响等价判断。</li>
<li><strong>工具使用与代码生成</strong><br>将框架迁移到 <strong>函数调用</strong> 或 <strong>程序合成</strong> 任务，定义“语义等价”为 <strong>功能等价</strong>（同输入同输出），验证是否能减少重复代码片段。</li>
<li><strong>联邦或分布式 RL</strong><br>在 <strong>联邦 RLHF</strong> 场景下，各客户端本地维护轻量分类器，定期聚合多样性度量，避免集中式标注瓶颈。</li>
</ul>
<p>4. 评估层面：度量与基准</p>
<ul>
<li><strong>多样性-质量联合指标</strong><br>设计单一指标（如 <strong>Diversity-Adjusted Quality Score, DAQS</strong> = 质量 × log(1+多样性)），替代当前双指标报告，便于 Pareto 前沿比较。</li>
<li><strong>人类细粒度评估</strong><br>针对 <strong>创意写作</strong> 引入“新颖性”“惊喜度”“情感丰富度”等维度的人类打分，验证 DARLING 是否在这些维度上仍保持优势。</li>
<li><strong>鲁棒性与对抗测试</strong><br>构造 <strong>对抗 prompt</strong>（要求重复、模板化输出），测试模型是否仍能坚持高多样性；或引入 <strong>多样性奖励攻击</strong>（故意生成语义相近但表面差异大的回答），评估分类器鲁棒性。</li>
</ul>
<p>5. 计算与系统优化</p>
<ul>
<li><strong>分类器蒸馏与量化</strong><br>将 4B/8B 分类器进一步蒸馏到 <strong>&lt;1B</strong> 参数量，或量化为 <strong>INT4</strong>，降低在线 RL 的 GPU 显存与延迟开销。</li>
<li><strong>异步多样性缓存</strong><br>在多 GPU rollout 场景，维护共享的 <strong>语义簇缓存</strong>，避免重复计算等价关系，提升训练吞吐。</li>
</ul>
<p>6. 社会与伦理视角</p>
<ul>
<li><strong>多样性 vs 安全性权衡</strong><br>研究提升多样性是否会意外放大 <strong>有害或不真实内容</strong>，并探索在奖励函数中加入 <strong>安全过滤器</strong> 的联合优化。</li>
<li><strong>用户可控多样性接口</strong><br>提供运行时旋钮，让用户在推理阶段实时调节“多样性强度”，实现个性化生成。</li>
</ul>
<p>通过上述方向，可进一步将 DARLING 从“同时提升质量与多样性”的验证性工作，扩展为 <strong>可解释、可扩展、可泛化</strong> 的通用 RLHF 增强框架。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>论文一句话总结</p>
<p>DARLING 提出一种在线强化学习框架，通过<strong>语义等价分类器+乘法奖励融合</strong>，在后训练阶段<strong>同时优化响应质量与语义多样性</strong>，在写作与数学任务上均实现质量与多样性的双赢。</p>
<p>核心内容速览</p>
<p>模块</p>
<p>关键要点</p>
<p><strong>问题</strong></p>
<p>现有 RLHF/GRPO 后训练导致输出分布尖锐化，多样性崩溃，影响创意与探索任务。</p>
<p><strong>方法</strong></p>
<p>1) 训练轻量级分类器，将同一 prompt 的 rollout 划分为语义等价簇；<br>2) 将质量奖励与归一化多样性分数<strong>相乘</strong>，得到多样性-感知奖励；<br>3) 嵌入 GRPO，在线放大“高质量且语义独特”回答的梯度。</p>
<p><strong>实验</strong></p>
<p>- <strong>非可验证</strong>（WildChat→Llama-3.1/3.3）：AlpacaEval LCWR +6.5 %，NoveltyBench Distinct +164 %。<br>- <strong>可验证数学</strong>（DeepscaleR→Qwen3-4B/14B）：pass@1 +3.5 %，pass@128 +7.6 %。<br>- <strong>消融</strong>：乘法优于加法；语义分类器优于 4-gram；移除标准差归一化在稠密奖励场景再提升。</p>
<p><strong>贡献</strong></p>
<p>1) 首个在在线 RL 中联合优化质量与语义多样性的系统框架；<br>2) 提供可扩展的语义等价分类器与开源实现；<br>3) 证明显式鼓励多样性可反哺质量提升。</p>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Jointly%20Reinforcing%20Diversity%20and%20Quality%20in%20Language%20Model%20Generations，链接是  https://arxiv.org/pdf/2509.02534  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.02534  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Tianjian Li,Yiming Zhang,Ping Yu,Swarnadeep Saha,Daniel Khashabi,Jason Weston,Jack Lanchantin,Tianlu Wang</p>
<p><strong>Categories</strong>: cs.CL,cs.LG</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.02534.pdf">https://arxiv.org/pdf/2509.02534.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.02534">https://arxiv.org/abs/2509.02534</a></p>
<p><strong>Arxiv ID</strong>: 2509.02534</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.02534">https://papers.cool/arxiv/2509.02534</a></p>
<p><strong>Published</strong>: 2025-09-02T17:38:47Z</p>
<p><strong>Updated</strong>: 2025-09-02T17:38:47.000Z</p>
<hr>
<h3 id="13-Gated-Associative-Memory-A-Parallel-O-N-Architecture-for-Efficient-Sequence-Modeling"><a href="#13-Gated-Associative-Memory-A-Parallel-O-N-Architecture-for-Efficient-Sequence-Modeling" class="headerlink" title="13. Gated Associative Memory: A Parallel O(N) Architecture for Efficient Sequence Modeling"></a>13. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.00605">Gated Associative Memory: A Parallel O(N) Architecture for Efficient Sequence Modeling</a></h3><p>The Transformer architecture, underpinned by the self-attention mechanism, has become the de facto standard for sequence modeling tasks. However, its core computational primitive scales quadratically with sequence length (O(N^2)), creating a significant bottleneck for processing long contexts. In this paper, we propose the Gated Associative Memory (GAM) network, a novel, fully parallel architecture for sequence modeling that exhibits linear complexity (O(N)) with respect to sequence length. The GAM block replaces the self-attention layer with two parallel pathways: a causal convolution to efficiently capture local, position-dependent context, and a parallel associative memory retrieval mechanism to model global, content-based patterns. These pathways are dynamically fused using a gating mechanism, allowing the model to flexibly combine local and global information for each token. We implement GAM from scratch and conduct a rigorous comparative analysis against a standard Transformer model and a modern linear-time baseline (Mamba) on the WikiText-2 benchmark, as well as against the Transformer on the TinyStories dataset. Our experiments demonstrate that GAM is consistently faster, outperforming both baselines on training speed, and achieves a superior or competitive final validation perplexity across all datasets, establishing it as a promising and efficient alternative for sequence modeling.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>Transformer架构基于自注意力机制，已成为序列建模任务的事实标准。然而，它的核心计算原语随序列长度呈平方级别增长（O(N^2)），这为处理长上下文带来了显著瓶颈。在本文中，我们提出了门控关联记忆（GAM）网络，这是一种新颖的、完全并行的序列建模架构，其相对于序列长度展示线性复杂度（O(N)）。GAM模块用两个并行通道替代自注意力层：一个因果卷积用于高效捕获局部、位置依赖的上下文，另一个并行关联记忆检索机制用于建模全局、基于内容的模式。这些通道通过门控机制动态融合，使得模型能够灵活地结合每个标记的局部和全局信息。我们从零开始实现GAM，并在WikiText-2基准上对标准Transformer模型和现代线性时间基线（Mamba）进行严格的比较分析，同时在TinyStories数据集上与Transformer进行对比。我们的实验表明，GAM在训练速度上始终更快，超越了两个基线，并在所有数据集上实现了优越或具有竞争力的最终验证困惑度，确立了它作为序列建模的一种有前景的高效替代方案。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>论文针对的核心问题是 <strong>Transformer 自注意力机制在长序列建模中的二次复杂度瓶颈</strong>。<br>具体而言：</p>
<ul>
<li><strong>计算瓶颈</strong>：自注意力需要计算 Query 与 Key 的 $N \times N$ 点积，带来 $O(N^2 d)$ 的时间与显存开销，严重限制了对长序列（如高分辨率文档、基因组、长视频）的处理能力。</li>
<li><strong>现有折中</strong>：<ul>
<li>“高效 Transformer” 通过稀疏、低秩或核近似降低复杂度，但常引入架构复杂性或表达能力损失。</li>
<li>线性 RNN/SSM（如 Mamba）虽达到 $O(N)$，却依赖递归扫描，牺牲了训练阶段的最大并行度。</li>
</ul>
</li>
</ul>
<p>GAM 的设计目标即 <strong>在保持完全并行、非递归的前提下，实现序列长度的线性复杂度</strong>，同时不损失建模精度，从而为长序列任务提供一种高效且可扩展的新架构。</p>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>论文将 GAM 置于“高效序列建模”这一活跃研究领域，并明确关联了三大类已有工作：</p>
<ol>
<li><p><strong>高效 Transformer（稀疏 / 低秩 / 核近似）</strong></p>
<ul>
<li>Longformer：局部窗口 + 稀疏全局注意力，支持数千 token。</li>
<li>Linformer：利用低秩投影将 Key/Value 降维，把 $O(N^2)$ 降至 $O(N)$。</li>
<li>Performer：通过随机特征映射近似 softmax 核，实现线性注意力。<br><em>共同点</em>：仍围绕“如何近似自注意力矩阵”展开；GAM 则<strong>彻底替换</strong>该机制。</li>
</ul>
</li>
<li><p><strong>循环 / 状态空间模型（SSM）</strong></p>
<ul>
<li>LSTM/GRU：经典 $O(N)$ 递归网络，训练并行度低。</li>
<li>S4 / Mamba：结构化状态空间模型，用硬件感知的并行扫描实现线性时间；Mamba 通过“选择性”机制动态过滤输入。<br><em>差异点</em>：Mamba 仍含递归扫描；GAM 完全避免递归，依赖卷积与矩阵乘的<strong>全并行原语</strong>。</li>
</ul>
</li>
<li><p><strong>卷积序列模型</strong></p>
<ul>
<li>TCN（Temporal Convolutional Network）：因果卷积已被证明能有效捕获局部历史。<br><em>GAM 的局部路径即采用 1D 因果卷积，但进一步与全局关联记忆并行融合，并通过可学习门控动态权衡局部/全局信息</em>。</li>
</ul>
</li>
</ol>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文提出 Gated Associative Memory（GAM）网络，用以下三步策略 <strong>彻底替换自注意力</strong>，同时满足线性复杂度与完全并行：</p>
<ol>
<li><p><strong>局部路径：1D 因果卷积</strong></p>
<ul>
<li>对输入序列做深度可分离因果卷积（kernel=3），复杂度 $O(Nkd)$，捕获局部 n-gram 与词序。</li>
<li>通过非对称填充确保因果性，可完全并行执行。</li>
</ul>
</li>
<li><p><strong>全局路径：并行关联记忆检索</strong></p>
<ul>
<li>维护一个可学习的记忆矩阵 $M \in \mathbb{R}^{\text{num_slots} \times d}$。</li>
<li>对全部 token 并行执行一次矩阵乘法 $X M^\top$ 得到相似度，再经 softmax 加权求和，生成全局上下文；复杂度 $O(N \cdot \text{num_slots} \cdot d)$，仅与序列长度成线性关系。</li>
</ul>
</li>
<li><p><strong>动态门控融合</strong></p>
<ul>
<li>用单层线性映射为每个 token 生成两个门值 $g_{\text{local}}, g_{\text{global}} \in (0,1)$。</li>
<li>按 $\sigma(g_{\text{local}})\cdot \text{LocalContext} + \sigma(g_{\text{global}})\cdot \text{GlobalContext}$ 融合两条路径，实现 token-level 自适应地权衡局部语法与全局语义。</li>
</ul>
</li>
</ol>
<p>通过 <strong>卷积 + 关联记忆 + 门控</strong> 这一完全可并行、无递归的组合，GAM 在保持 $O(N)$ 复杂度的同时，规避了自注意力的二次瓶颈与 SSM 的递归限制。</p>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>实验围绕 <strong>准确率</strong>（语言建模困惑度）与 <strong>效率</strong>（训练耗时、显存占用）两条主线展开，并辅以消融与扩展分析。具体设置与结果如下：</p>
<p>1. 主实验：WikiText-2 与 TinyStories 对比</p>
<ul>
<li><p><strong>模型规模对齐</strong></p>
<ul>
<li>GAM：6 层，d_model=512，22.6 M 参数</li>
<li>Transformer：6 层，d_model=512，8 头，24.2 M 参数</li>
<li>Mamba：6 层，d_model=512，20.5 M 参数（仅 WikiText-2）</li>
</ul>
</li>
<li><p><strong>训练配置</strong></p>
<ul>
<li>5 epoch，AdamW，lr=3e-4，batch=32，序列长度 256，单张 NVIDIA T4</li>
</ul>
</li>
<li><strong>结果摘要</strong></li>
</ul>
<p>数据集</p>
<p>模型</p>
<p>参数量</p>
<p>每 epoch 时间</p>
<p>Val PPL</p>
<p>WikiText-2</p>
<p>Transformer</p>
<p>24.2 M</p>
<p>131.9 s</p>
<p>918.99</p>
<p>WikiText-2</p>
<p>Mamba</p>
<p>20.5 M</p>
<p>127.1 s</p>
<p>1017.54</p>
<p>WikiText-2</p>
<p>GAM</p>
<p>22.6 M</p>
<p><strong>117.2 s</strong></p>
<p><strong>882.57</strong></p>
<p>TinyStories</p>
<p>Transformer</p>
<p>24.2 M</p>
<p>671.6 s</p>
<p>23.55</p>
<p>TinyStories</p>
<p>GAM</p>
<p>22.6 M</p>
<p><strong>601.4 s</strong></p>
<p><strong>23.15</strong></p>
<p>→ GAM 在两个数据集上均取得 <strong>最低困惑度</strong> 与 <strong>最短训练时间</strong>。</p>
<p>2. 扩展基准：序列长度可扩展性</p>
<ul>
<li><p><strong>设置</strong></p>
<ul>
<li>固定 batch=16，d_model=512，比较 <strong>单个 block</strong> 的前向+反向耗时与峰值显存</li>
<li>序列长度从 256 → 8192</li>
</ul>
</li>
<li><strong>关键结果</strong></li>
</ul>
<p>序列长度</p>
<p>GAM 时间 (ms)</p>
<p>Transformer 时间 (ms)</p>
<p>GAM 显存 (MB)</p>
<p>Transformer 显存 (MB)</p>
<p>256</p>
<p>8.97</p>
<p>8.90</p>
<p>179</p>
<p>216</p>
<p>1024</p>
<p>25.86</p>
<p>74.19</p>
<p>618</p>
<p>1965</p>
<p>2048</p>
<p>51.94</p>
<p>279.37</p>
<p>1202</p>
<p>7484</p>
<p>4096</p>
<p>105.03</p>
<p><strong>OOM</strong></p>
<p>2370</p>
<p><strong>OOM</strong></p>
<p>8192</p>
<p>217.30</p>
<p><strong>OOM</strong></p>
<p>4707</p>
<p><strong>OOM</strong></p>
<p>→ Transformer 呈二次增长并在 4096 处 OOM；GAM 显存与时间均呈线性增长。</p>
<p>3. 消融实验：验证各组件必要性（WikiText-2）</p>
<p>配置</p>
<p>门控</p>
<p>局部卷积</p>
<p>关联记忆</p>
<p>参数量</p>
<p>Val PPL</p>
<p>GAM (Full)</p>
<p>✓</p>
<p>✓</p>
<p>✓</p>
<p>22.6 M</p>
<p><strong>900.84</strong></p>
<p>GAM (Sum Fusion)</p>
<p>✗</p>
<p>✓</p>
<p>✓</p>
<p>19.4 M</p>
<p>942.59</p>
<p>GAM (Global Only)</p>
<p>✗</p>
<p>✗</p>
<p>✓</p>
<p>19.4 M</p>
<p>905.45</p>
<p>GAM (Local Only)</p>
<p>✗</p>
<p>✓</p>
<p>✗</p>
<p>17.9 M</p>
<p>944.70</p>
<p>→ <strong>门控机制</strong> 对性能至关重要；<strong>全局记忆</strong> 贡献最大，但 <strong>局部卷积</strong> 仍提供不可或缺的补充信息。</p>
<p>4. 训练动态曲线</p>
<ul>
<li>论文给出 WikiText-2 与 TinyStories 的验证困惑度、损失、epoch 时间随训练步数的变化曲线，显示 GAM 全程保持速度与性能优势（图 3、图 4）。</li>
</ul>
<p>综上，实验从 <strong>标准基准、效率对比、长度扩展、组件消融</strong> 四个维度系统验证了 GAM 的有效性。</p>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可作为 GAM 的后续研究切入点，按优先级与可行性排序：</p>
<p>1. 长序列基准与极限压力测试</p>
<ul>
<li><strong>Long Range Arena</strong>（LRA）及 <strong>PG-19</strong>、<strong>arXiv 摘要 16k+ token</strong> 任务：验证 GAM 在 4k–32k 序列上的线性优势是否持续。</li>
<li><strong>显存-时间联合优化</strong>：量化不同序列长度下的 FLOPs-utilization 曲线，评估在 A100/H100 上的实际吞吐。</li>
</ul>
<p>2. 规模定律（Scaling Law）研究</p>
<ul>
<li><strong>参数-数据联合扩展</strong>：在 125 M → 1 B → 7 B 参数区间，配合 C4 / SlimPajama 大规模语料，绘制 PPL-Compute 曲线，与同等规模 Transformer、Mamba 对比。</li>
<li><strong>记忆槽位扩展规律</strong>：固定模型宽度，线性增加 <code>num_slots</code>（512→2k→8k），观察对长距离依赖任务的边际收益与显存开销。</li>
</ul>
<p>3. 记忆可解释性与可控性</p>
<ul>
<li><strong>记忆槽位聚类与语义分析</strong>：<ul>
<li>对记忆向量 $M$ 做 k-means 或 SVD，可视化其捕获的语法/主题原型。</li>
<li>引入“槽位干预”实验：冻结或替换特定槽位，测量下游任务性能变化，验证记忆的可编辑性。</li>
</ul>
</li>
<li><strong>动态记忆扩展</strong>：<ul>
<li>在线新增/删除槽位（类似增量化词典），探索持续学习场景下的灾难性遗忘问题。</li>
</ul>
</li>
</ul>
<p>4. 门控机制升级</p>
<ul>
<li><strong>多头门控</strong>（Multi-Head Gating）：为每个注意力头或卷积通道学习独立门值，提升细粒度融合能力。</li>
<li><strong>输入条件化门控</strong>：用上一层隐藏状态或外部元数据（如文档类型）调制门值，实现任务自适应。</li>
</ul>
<p>5. 跨模态与特殊领域适配</p>
<ul>
<li><strong>代码建模</strong>：在 HumanEval / MBPP 上评估 GAM 对长代码文件的补全能力。</li>
<li><strong>基因组、时间序列</strong>：利用因果卷积的局部敏感性与关联记忆的全局模式捕获，测试 DNA 长序列分类或金融高频数据预测。</li>
</ul>
<p>6. 训练效率再优化</p>
<ul>
<li><strong>内核融合</strong>：将卷积、记忆检索与门控融合为单一 CUDA kernel，减少内存往返。</li>
<li><strong>混合精度稳定性</strong>：研究 bfloat16 下 softmax 数值误差对记忆检索的影响，设计专用 log-sum-exp 技巧。</li>
</ul>
<p>7. 理论复杂度与下界分析</p>
<ul>
<li>证明在特定假设（如低秩或稀疏依赖）下，GAM 的 $O(N)$ 实现可逼近任意自注意力函数，给出误差上界。</li>
</ul>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>论文核心概要</p>
<p><strong>题目</strong>：Gated Associative Memory: A Parallel O(N) Architecture for Efficient Sequence Modeling<br><strong>作者</strong>：Rishiraj Acharya</p>
<p>1. 问题</p>
<ul>
<li>Transformer 的自注意力带来 $O(N^2)$ 复杂度，长序列受限。</li>
<li>现有线性方案（稀疏/低秩 Transformer、SSM/RNN）要么牺牲表达能力，要么引入递归扫描，训练并行度不足。</li>
</ul>
<p>2. 方案：Gated Associative Memory (GAM)</p>
<ul>
<li><strong>目标</strong>：线性复杂度 + 完全并行 + 不牺牲精度。</li>
<li><strong>核心模块 GAMBlock</strong>（取代 Multi-Head Self-Attention）：<ol>
<li><strong>局部路径</strong>：1D 因果卷积（kernel=3，深度可分离）→ $O(N)$ 捕获局部语法/位置信息。</li>
<li><strong>全局路径</strong>：并行关联记忆<ul>
<li>可学习记忆矩阵 $M \in \mathbb{R}^{\text{num_slots} \times d}$</li>
<li>一次矩阵乘法 $X M^\top$ 得到相似度，再 softmax 加权求和 → $O(N)$ 捕获全局语义模式。</li>
</ul>
</li>
<li><strong>动态门控</strong>：用 sigmoid 门值逐 token 融合两条路径，实现自适应权衡。</li>
</ol>
</li>
</ul>
<p>3. 实验</p>
<ul>
<li><strong>数据集</strong>：WikiText-2、TinyStories（序列长度 256）。</li>
<li><strong>对比基线</strong>：6 层 Transformer（24.2 M）、Mamba（20.5 M）。</li>
<li><strong>结果</strong>：<ul>
<li><strong>效率</strong>：GAM 每 epoch 时间最短（WikiText-2 117.2 s，TinyStories 601.4 s），显存随长度线性增长，Transformer 在 4k 处 OOM。</li>
<li><strong>精度</strong>：GAM 取得最低验证困惑度（WikiText-2 882.57；TinyStories 23.15）。</li>
</ul>
</li>
<li><strong>消融</strong>：门控机制、全局记忆、局部卷积缺一不可；门控对性能提升最关键。</li>
</ul>
<p>4. 结论</p>
<p>GAM 用“卷积 + 关联记忆 + 门控”的组合，在保持完全并行、无递归的前提下，实现线性复杂度，并在速度与精度上均优于 Transformer 与 Mamba，为长序列建模提供了新的高效架构。</p>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Gated%20Associative%20Memory%3A%20A%20Parallel%20O%28N%29%20Architecture%20for%20Efficient%20Sequence%20Modeling，链接是  https://arxiv.org/pdf/2509.00605  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.00605  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Rishiraj Acharya</p>
<p><strong>Categories</strong>: cs.CL,cs.LG</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.00605.pdf">https://arxiv.org/pdf/2509.00605.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.00605">https://arxiv.org/abs/2509.00605</a></p>
<p><strong>Arxiv ID</strong>: 2509.00605</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.00605">https://papers.cool/arxiv/2509.00605</a></p>
<p><strong>Published</strong>: 2025-08-30T20:59:46Z</p>
<p><strong>Updated</strong>: 2025-08-30T20:59:46.000Z</p>
<hr>
<h3 id="14-DynaGuard-A-Dynamic-Guardrail-Model-With-User-Defined-Policies"><a href="#14-DynaGuard-A-Dynamic-Guardrail-Model-With-User-Defined-Policies" class="headerlink" title="14. DynaGuard: A Dynamic Guardrail Model With User-Defined Policies"></a>14. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.02563">DynaGuard: A Dynamic Guardrail Model With User-Defined Policies</a></h3><p>Guardian models are used to supervise and moderate the outputs of user-facing chatbots, enforcing guardrails and detecting bad behaviors. Standard guardian models like LlamaGuard detect predefined, static categories of harms. We propose dynamic guardian models that evaluate text based on user-defined policies, making them useful for different application domains that are not addressed by standard guardian models. Our dynamic guardian models can be used for fast detection of policy violations or with chain-of-thought reasoning that articulates and justifies the model outputs. Our dynamic guardian models match static models in detection accuracy for static harm categories while identifying violations of free-form policies with accuracy comparable to frontier reasoning models in a fraction of the time.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>守卫模型用于监督和调节用户面对面的聊天机器人输出，执行保护措施并检测不当行为。标准守卫模型如 LlamaGuard 检测预定义的静态危害类别。我们提出了动态守卫模型，它们根据用户定义的政策评估文本，使其在标准守卫模型未能覆盖的不同应用领域中具有用处。我们的动态守卫模型可以快速检测政策违规，或者通过链式思维推理来阐述和证明模型输出。我们的动态守卫模型在静态危害类别的检测准确性上可与静态模型相媲美，同时以与前沿推理模型类似的准确性在极短的时间内识别自由形式政策的违规行为。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>论文针对的核心问题是：<strong>现有 guardian 模型只能识别固定、静态的有害类别，无法适应真实部署场景中千变万化的业务规则与合规需求</strong>。<br>具体而言，现有方案（如 LlamaGuard）将“暴力、武器、色情、自残、犯罪策划”等固定类别作为检测目标，而企业级应用往往要求模型遵守高度定制、领域特定的政策，例如：</p>
<ul>
<li><strong>“绝不允许以任何理由退款”</strong>（避免 Air Canada 被判赔偿的案例重演）</li>
<li><strong>“讨论人体解剖时不得屏蔽，但禁止色情内容”</strong>（医疗场景）</li>
<li><strong>“引用新闻中的暴力事件可以，但禁止教唆暴力”</strong>（RAG 场景）</li>
</ul>
<p>这些需求超出了静态类别的范畴，导致传统 guardian 模型失效。<br>因此，论文提出 <strong>DynaGuard：一个能够接受用户任意编写的政策（policy），在运行时动态检测违规并给出可解释反馈的轻量级 guardian 模型</strong>，同时保持对经典静态有害类别的检测精度。</p>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>与 DynaGuard 相关的研究可分为 <strong>guardian 模型</strong> 与 <strong>合规/安全数据集</strong> 两大方向。</p>
<p>1. Guardian 模型</p>
<p>模型</p>
<p>关键特征</p>
<p>与 DynaGuard 的关系</p>
<p><strong>LlamaGuard</strong> (Inan et al., 2023)</p>
<p>基于固定 6 类安全标签（暴力、武器、色情…）训练；支持 zero-shot 适配新类别，但泛化有限。</p>
<p>DynaGuard 仍保留对这类静态类别的检测能力，同时支持任意用户自定义规则。</p>
<p><strong>LlamaGuard3-Vision</strong> (Chi et al., 2024)</p>
<p>将 LlamaGuard 扩展到多模态（图像+文本）。</p>
<p>DynaGuard 目前专注文本，但训练方法可迁移到多模态。</p>
<p><strong>WildGuard</strong> (Han et al., 2024)</p>
<p>提供 13 类细粒度安全标签，区分用户输入与模型输出风险；含对抗样本。</p>
<p>DynaBench 训练集吸收了 WildGuard 的安全数据，但测试集规则完全不同，用于衡量泛化。</p>
<p><strong>Aegis2.0</strong> (Ghosh et al., 2024)</p>
<p>21 类商业安全标签（版权、政府决策、未授权建议等）；单轮对话。</p>
<p>DynaGuard 支持多轮、多规则组合，且规则不局限于 21 类。</p>
<p><strong>GuardReasoner</strong> (Liu et al., 2025)</p>
<p>引入 Chain-of-Thought 推理，输出自然语言解释；推理开销大。</p>
<p>DynaGuard 同样提供解释，但额外提供“快速推理”模式，显著降低延迟。</p>
<p><strong>ShieldGemma</strong> (Zeng et al., 2024)</p>
<p>Google 基于 Gemma 的专有多模态内容审核模型；闭源。</p>
<p>DynaGuard 8B 在静态安全基准上与之持平或更好，且开放权重。</p>
<p><strong>RigorLLM</strong> (Yuan et al., 2024)</p>
<p>通过约束优化与神经符号方法提升鲁棒性。</p>
<p>DynaGuard 的 GRPO 阶段也采用 RL 微调，但目标是对齐用户自定义政策。</p>
<p>2. 合规/安全数据集</p>
<p>数据集</p>
<p>规模与特色</p>
<p>与 DynaBench 的关系</p>
<p><strong>BeaverTails</strong> (Ji et al., 2023)</p>
<p>300k 样本，14 类有害/无害细粒度标签；强调人类偏好对齐。</p>
<p>DynaBench 将其转换为“政策+对话+违规标签”格式，用于训练/测试。</p>
<p><strong>ToxicChat</strong> (Lin et al., 2023)</p>
<p>真实单轮对话，含对抗攻击与越狱标签。</p>
<p>同样被转换为政策格式，用于提升 DynaGuard 对对抗场景的鲁棒性。</p>
<p><strong>WildGuardMix</strong> (Han et al., 2024)</p>
<p>合成单轮对话，细粒度标签。</p>
<p>作为安全数据的一部分参与 DynaGuard 训练。</p>
<p><strong>DynaBench</strong> (本文)</p>
<p>40k 训练 + 手工 测试集；规则覆盖交易、监管、品牌一致性等 5 大新类别；多轮对话。</p>
<p>首个面向“任意用户政策”的规模化数据集，用于训练与评估动态 guardian 模型。</p>
<p>综上，DynaGuard 在 <strong>任务定义</strong>（动态政策 vs 静态类别）、<strong>数据构建</strong>（DynaBench）、<strong>推理效率</strong>（双模式推理）与 <strong>开放权重</strong> 四个维度，对现有 guardian 研究进行了系统扩展。</p>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文通过 <strong>“数据-模型-训练-推理” 四步闭环</strong> 解决“静态 guardian 无法适应动态政策”的问题。</p>
<p>1. 数据：构建 DynaBench——首个面向任意用户政策的 40 K 规模数据集</p>
<ul>
<li><strong>规则库</strong><ul>
<li>手写 500 条种子规则 → 用 GPT-4o/Gemini/Claude 扩展到 5 000 条 → 人工去噪，确保客观可判定。</li>
</ul>
</li>
<li><strong>政策生成</strong><ul>
<li>按主题随机采样规则（1–86 条/政策），再用 LLM 改写，避免重复。</li>
</ul>
</li>
<li><strong>对话生成</strong><ul>
<li>为每条政策生成多轮对话（1–30 轮），包含：<ul>
<li>正常遵守、用户诱导违规、用户诱导但成功防御、无意违规 4 种场景。</li>
</ul>
</li>
<li>用户/Agent 画像由属性库（职业、地域、行业等）程序化组合，保证多样性。</li>
</ul>
</li>
<li><strong>测试集</strong><ul>
<li>与行业专家手工设计 8 大业务影响类别 × 15 种失败模式，确保零规则与训练集重叠，难度极高（LlamaGuard3 仅 13.1 % 准确率）。</li>
</ul>
</li>
</ul>
<p>2. 模型：DynaGuard——双模式轻量级 guardian</p>
<ul>
<li><strong>架构</strong><ul>
<li>基于 Qwen3-1.7B/4B/8B 指令模型，保留全部权重开放。</li>
</ul>
</li>
<li><strong>双模式输出</strong><ol>
<li><strong>快速模式</strong> <code>&lt;answer&gt;PASS/FAIL&lt;/answer&gt;</code> + <code>&lt;explanation&gt;…&lt;/explanation&gt;</code>（低延迟，≈1.3 % 精度损失）。</li>
<li><strong>推理模式</strong> <code>&lt;think&gt;…&lt;/think&gt;&lt;answer&gt;…&lt;/answer&gt;</code>（完整 CoT，用于调试或高置信场景）。</li>
</ol>
</li>
</ul>
<p>3. 训练：两阶段混合微调</p>
<ul>
<li><strong>阶段 1：监督微调（SFT）</strong><ul>
<li>80 K 混合样本 = 40 K DynaBench + 40 K 经典安全数据（WildGuard/BeaverTails/ToxicChat/Aegis2.0）。</li>
<li>1/3 样本使用 CoT 推理链，2/3 仅标签+简短解释，以诱导双模式行为。</li>
</ul>
</li>
<li><strong>阶段 2：GRPO 强化学习</strong><ul>
<li>11 K 样本继续优化，奖励 = 正确性 + KL 正则，提升对复杂多跳规则的鲁棒性。</li>
</ul>
</li>
</ul>
<p>4. 推理与反馈：实时守护 + 可解释恢复</p>
<ul>
<li><strong>运行时流程</strong><ol>
<li>用户政策 + 当前对话 → DynaGuard。</li>
<li>若 FAIL，输出自然语言解释（如“Rule 1 被违反：用户未提及 OpenAI，却出现 ‘accurate’ 一词”）。</li>
<li>解释回传给主模型，触发自我修正（实验中将 Ministral-8B 的 IFEval 准确率从 57.3 % 提升到 63.8 %）。</li>
</ol>
</li>
</ul>
<p>结果摘要</p>
<ul>
<li><strong>静态类别</strong>：在 6 大安全基准上平均 F1 79.6 %，超越 GPT-4o-mini 与所有现有 guardian。</li>
<li><strong>动态政策</strong>：在零见过的 DynaBench 测试集上 F1 72.5 %（8B），而 LlamaGuard3 仅 13.1 %。</li>
<li><strong>效率</strong>：非 CoT 模式延迟接近传统小模型，满足生产部署需求。</li>
</ul>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文围绕 <strong>“动态政策合规检测”</strong> 与 <strong>“经典安全基准”</strong> 两条主线，共设计并执行了 5 组实验，覆盖准确率、效率、可解释性与实际落地场景。</p>
<p>1. 主实验：DynaBench 与 6 大安全基准的横向对比</p>
<ul>
<li><strong>数据集</strong><ul>
<li>DynaBench 测试集（零规则与训练集重叠）</li>
<li>Aegis 2.0、BeaverTails、HarmBench、SafeRLHF、WildGuard、XSTest</li>
</ul>
</li>
<li><strong>对比模型</strong><ul>
<li>开源 guardian：LlamaGuard3、WildGuard、NemoGuard、ShieldGemma</li>
<li>推理型 guardian：GuardReasoner-8B（CoT/非 CoT）</li>
<li>通用 API：GPT-4o-mini、Qwen3-8B（基座）</li>
</ul>
</li>
<li><strong>指标</strong><ul>
<li>F1（macro）</li>
</ul>
</li>
<li><strong>结果（表 2）</strong><ul>
<li>DynaGuard-8B 在 <strong>“All Tasks Avg”</strong> 78.4 % <strong>SOTA</strong>，其中 DynaBench 72.5 %，领先 GPT-4o-mini（70.1 %）与所有现有 guardian。</li>
<li>非 CoT 模式仅比 CoT 模式低 1.3 %，验证快速推理可行性。</li>
</ul>
</li>
</ul>
<p>2. 消融实验：验证训练配方各组件的贡献</p>
<p>2.1 推理链的必要性</p>
<p>训练配方</p>
<p>WildGuard + Compliance F1</p>
<p>Δ</p>
<p>Base Qwen3-4B</p>
<p>33.9</p>
<p>—</p>
<p>仅标签 SFT（40 k）</p>
<p>64.6</p>
<p>+30.7</p>
<p>标签 + 推理 SFT + GRPO</p>
<p>71.7</p>
<p>+37.8</p>
<p>2.2 合成合规数据的价值</p>
<p>数据混合（SFT+GRPO）</p>
<p>WildGuard + Compliance F1</p>
<p>Δ</p>
<p>仅 40 k 安全数据</p>
<p>56.5</p>
<p>+22.6</p>
<p>仅 40 k Compliance</p>
<p>71.7</p>
<p>+37.8</p>
<p>20 k 安全 + 20 k Compliance</p>
<p>72.0</p>
<p>+38.1</p>
<p>40 k 安全 + 40 k Compliance</p>
<p>73.2</p>
<p>+39.3</p>
<p>3. 模型家族迁移性验证</p>
<ul>
<li><strong>方法</strong>：将同一训练配方迁移到 Qwen3、Qwen2.5、Llama3.2 的 1B–8B 模型，记录平均 F1 提升。</li>
<li><strong>结果（表 4）</strong><ul>
<li>Qwen3 +28.4（安全） / +22.5（合规）</li>
<li>Llama3.2 +35.4 / +21.3</li>
<li>证明配方跨架构通用。</li>
</ul>
</li>
</ul>
<p>4. 错误分析：定位模型弱点</p>
<ul>
<li><strong>高错误率类别</strong>（表 7）<ul>
<li>事实知识型规则 73.4 %</li>
<li>多子句规则 60.7 %</li>
<li>计数型规则 53.4 %</li>
</ul>
</li>
<li><strong>长上下文极限</strong>（表 8）<ul>
<li>DynaGuard-8B 在 13 轮对话 / 91 条规则 / 10 跳推理前仍保持 &gt;50 % 准确率，显著优于基座模型。</li>
</ul>
</li>
</ul>
<p>5. 实际场景案例研究</p>
<p>5.1 IFEval 指令修正实验</p>
<ul>
<li><strong>设置</strong><ul>
<li>将 IFEval 的每条指令视为“未见政策”，Ministral-8B 生成回答，DynaGuard 检测违规并给出解释，再让 Ministral 修正。</li>
</ul>
</li>
<li><strong>结果（表 3）</strong><ul>
<li>Ministral-8B 原始 57.3 % → +DynaGuard 63.8 %（+6.5 pp），显著高于其他 guardian。</li>
<li>32/232 失败样本被成功修正，改善率 13.8 %；其中列表格式提升 18.8 %，JSON 格式 0 %。</li>
</ul>
</li>
</ul>
<p>5.2 人工验证</p>
<ul>
<li>50 训练 + 25 测试样本双盲标注<ul>
<li>测试集 100 % 一致性，96 % 与合成标签一致，确认高难度但高可靠性。</li>
</ul>
</li>
</ul>
<p>实验结论速览</p>
<ul>
<li><strong>动态政策</strong>：DynaGuard 在零见过的规则上仍保持 70 %+ F1，而 LlamaGuard3 仅 13.1 %。</li>
<li><strong>经典安全</strong>：平均 F1 79.6 %，全面领先现有开源与 API 模型。</li>
<li><strong>效率</strong>：非 CoT 模式延迟接近传统小模型，满足生产级部署。</li>
</ul>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可被视为 DynaGuard 框架的 <strong>直接延伸</strong> 或 <strong>长期研究议程</strong>，按优先级与可行性分层列出：</p>
<p>1. 解释-驱动的交互式恢复机制</p>
<ul>
<li><strong>问题</strong>：目前仅将 DynaGuard 的解释作为一次性提示回传给主模型，缺乏多轮协同策略。</li>
<li><strong>可探索</strong><ul>
<li>设计 <strong>“解释-修正-再检测”</strong> 的闭环协议，让主模型与 guardian 进行 <strong>多轮对话式修复</strong>（类似 self-critique）。</li>
<li>引入 <strong>强化学习</strong> 以优化“何时停止修正”策略，避免无限循环或过度保守。</li>
</ul>
</li>
</ul>
<p>2. 多模态政策合规</p>
<ul>
<li><strong>问题</strong>：DynaGuard 仅处理文本；真实场景中政策常涉及图像、PDF、表格等多模态内容。</li>
<li><strong>可探索</strong><ul>
<li>将 DynaGuard 训练配方迁移到 <strong>视觉-语言基座</strong>（如 Llama-3.2-Vision、Qwen-VL），构建 <strong>Omniguard-style</strong> 动态多模态 guardian。</li>
<li>扩展 DynaBench：加入带截图、图表、扫描合同的对话，形成 <strong>DynaBench-V</strong> 数据集。</li>
</ul>
</li>
</ul>
<p>3. 规则复杂度与模型容量的 Scaling Law</p>
<ul>
<li><strong>问题</strong>：当政策规则数 &gt;100 或需跨 20+ 轮推理时，8B 模型准确率骤降（表 8）。</li>
<li><strong>可探索</strong><ul>
<li>系统研究 <strong>规则数量、对话轮数、推理跳数</strong> 与 <strong>模型参数规模</strong> 的关系，给出容量-性能 Pareto 曲线。</li>
<li>试验 <strong>检索增强 guardian</strong>：将超长政策分段存入向量库，让模型在推理时动态检索相关子规则，降低上下文压力。</li>
</ul>
</li>
</ul>
<p>4. 不确定性估计与人工回退</p>
<ul>
<li><strong>问题</strong>：DynaGuard 输出硬 PASS/FAIL，缺乏置信度；高 ambiguity 场景易误报。</li>
<li><strong>可探索</strong><ul>
<li>在 guardian 头部增加 <strong>置信度头</strong>（verbalized 或 softmax 温度），对低置信样本触发 <strong>人工审核</strong> 或 <strong>更慢但更准的推理模式</strong>。</li>
<li>建立 <strong>“可接受风险-成本”</strong> 权衡界面，让业务方通过旋钮调节自动通过率。</li>
</ul>
</li>
</ul>
<p>5. 对抗鲁棒性与红队基准</p>
<ul>
<li><strong>问题</strong>：DynaBench 已含部分对抗对话，但未系统评估 <strong>prompt injection、规则混淆、社会工程</strong> 等高级攻击。</li>
<li><strong>可探索</strong><ul>
<li>构建 <strong>DynaRed</strong> 子集：红队针对给定政策自动生成越狱提示，衡量 guardian 的 <strong>最小可欺骗规则长度</strong>。</li>
<li>引入 <strong>对抗训练</strong>（Adv-GRPO）：在红队生成的失败样本上继续 RL，提升鲁棒性。</li>
</ul>
</li>
</ul>
<p>6. 在线政策学习与持续对齐</p>
<ul>
<li><strong>问题</strong>：业务规则随时间变化，重新训练全量模型成本高。</li>
<li><strong>可探索</strong><ul>
<li>采用 <strong>LoRA-adapter 插件机制</strong>：为每条新政策训练轻量 adapter，推理时动态加载/卸载，实现 <strong>“热插拔”式政策更新</strong>。</li>
<li>研究 <strong>人类反馈在线 RLHF</strong>：收集真实对话中 guardian 的误报/漏报，实时微调 adapter。</li>
</ul>
</li>
</ul>
<p>7. 人机协同政策编辑器</p>
<ul>
<li><strong>问题</strong>：非技术用户撰写高质量规则仍具挑战，易产生歧义。</li>
<li><strong>可探索</strong><ul>
<li>开发 <strong>“规则 Copilot”</strong>：LLM 辅助用户将自然语言需求转化为 <strong>形式化规则</strong>，并即时模拟违规/合规对话进行验证。</li>
<li>引入 <strong>规则复杂度评分</strong>（可读性、歧义度、与现有规则冲突度），引导用户迭代优化。</li>
</ul>
</li>
</ul>
<p>8. 跨语言与地域合规</p>
<ul>
<li><strong>问题</strong>：DynaBench 以英文为主，未覆盖多语言、多法规环境。</li>
<li><strong>可探索</strong><ul>
<li>构建 <strong>DynaBench-Multi</strong>：将规则与对话机器翻译为 10+ 语言，研究 guardian 在 <strong>GDPR、CCPA、PIPL</strong> 等地域法规下的零样本表现。</li>
<li>试验 <strong>跨语言规则对齐</strong>：同一政策的多语言表述是否导致检测差异，并设计一致性正则项。</li>
</ul>
</li>
</ul>
<p>9. 伦理与社会影响度量</p>
<ul>
<li><strong>问题</strong>：动态政策可能被滥用（过度审查、歧视性规则）。</li>
<li><strong>可探索</strong><ul>
<li>建立 <strong>“政策伦理审计”</strong> 工具：自动检测用户规则是否包含 <strong>歧视性关键词、过度宽泛限制</strong>。</li>
<li>与政策制定者合作，开展 <strong>用户研究</strong> 评估解释对 <strong>透明度感知、信任度、合规行为</strong> 的影响。</li>
</ul>
</li>
</ul>
<p>10. 边缘部署与 Tiny-DynaGuard</p>
<ul>
<li><strong>问题</strong>：医疗、金融等场景需本地部署，8B 仍显笨重。</li>
<li><strong>可探索</strong><ul>
<li>知识蒸馏到 <strong>1B 以下 Tiny 模型</strong>，在量化（INT4/INT8）后保持 &gt;65 % 的 DynaBench 性能。</li>
<li>利用 <strong>投机解码</strong>（speculative decoding）：Tiny 模型快速给出初步判断，大 guardian 仅在低置信时介入。</li>
</ul>
</li>
</ul>
<p>以上方向既可直接基于已开源的 DynaGuard 权重与 DynaBench 数据继续迭代，也可作为独立课题深入。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>论文一句话总结</p>
<p>提出 <strong>DynaGuard</strong>——首个能在运行时接受<strong>任意用户政策</strong>、<strong>轻量级</strong>、<strong>可解释</strong>且<strong>开放权重</strong>的 guardian 模型，并配套发布高难度基准 <strong>DynaBench</strong>，在经典安全与动态合规任务上同时取得 SOTA。</p>
<p>核心贡献</p>
<p>维度</p>
<p>内容</p>
<p>结果</p>
<p><strong>任务定义</strong></p>
<p>从“静态有害类别”转向“用户自定义政策”</p>
<p>覆盖交易、法规、品牌、内容控制等 5 类新场景</p>
<p><strong>数据集</strong></p>
<p>DynaBench：40 k 训练 + 手工测试集</p>
<p>零规则重叠，LlamaGuard3 仅 13.1 % F1</p>
<p><strong>模型</strong></p>
<p>基于 Qwen3 的 1.7B/4B/8B 双模式 guardian</p>
<p>非 CoT 延迟低，CoT 提供自然语言解释</p>
<p><strong>训练</strong></p>
<p>SFT（安全+合规 80 k）+ GRPO（11 k）</p>
<p>跨模型家族平均 +30 % F1</p>
<p><strong>实验</strong></p>
<p>6 大安全基准 + DynaBench + IFEval 修正</p>
<p>平均 F1 79.6 % SOTA；IFEval +6.5 pp</p>
<p><strong>部署</strong></p>
<p>开放权重、可本地推理、快速/解释双模式</p>
<p>满足医疗/金融低延迟、数据不出域需求</p>
<p>一句话记忆</p>
<p>DynaGuard = <strong>“把 LlamaGuard 的静态护栏变成用户可编程的动态护栏”</strong>，并给出数据、模型、训练配方全套开源方案。</p>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是DynaGuard%3A%20A%20Dynamic%20Guardrail%20Model%20With%20User-Defined%20Policies，链接是  https://arxiv.org/pdf/2509.02563  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.02563  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Monte Hoover,Vatsal Baherwani,Neel Jain,Khalid Saifullah,Joseph Vincent,Chirag Jain,Melissa Kazemi Rad,C. Bayan Bruss,Ashwinee Panda,Tom Goldstein</p>
<p><strong>Categories</strong>: cs.LG,cs.CL</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.02563.pdf">https://arxiv.org/pdf/2509.02563.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.02563">https://arxiv.org/abs/2509.02563</a></p>
<p><strong>Arxiv ID</strong>: 2509.02563</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.02563">https://papers.cool/arxiv/2509.02563</a></p>
<p><strong>Published</strong>: 2025-09-02T17:57:56Z</p>
<p><strong>Updated</strong>: 2025-09-02T17:57:56.000Z</p>
<hr>
<h3 id="15-DCPO-Dynamic-Clipping-Policy-Optimization"><a href="#15-DCPO-Dynamic-Clipping-Policy-Optimization" class="headerlink" title="15. DCPO: Dynamic Clipping Policy Optimization"></a>15. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.02333">DCPO: Dynamic Clipping Policy Optimization</a></h3><p>Reinforcement Learning from Verifiable Rewards (RLVR) has emerged as a promising framework for enhancing the reasoning capabilities of large language models. However, existing approaches such as GRPO often suffer from zero gradients. This problem arises primarily due to fixed clipping bounds for token-level probability ratios and the standardization of identical rewards, which can lead to ineffective gradient updates and underutilization of generated responses. In this work, we propose Dynamic Clipping Policy Optimization (DCPO), which introduces a dynamic clipping strategy that adaptively adjusts the clipping bounds based on token-specific prior probabilities to enhance token-level exploration, and a smooth advantage standardization technique that standardizes rewards across cumulative training steps to improve the response-level effective utilization of generated responses. DCPO achieved state-of-the-art performance on four benchmarks based on four different models. In particular, DCPO achieved an Avg@1 of 46.7 under greedy decoding and an Avg@32 of 38.8 under 32 times sampling on the AIME24 benchmark, surpassing both DAPO (36.7/31.6) and GRPO (36.7/32.1) on the Qwen2.5-Math-7B model. On the AIME25 benchmark based on Qwen2.5-14B, DCPO achieves a performance of (23.3/19.0), surpassing GRPO (13.3/10.5) and DAPO (20.0/15.3). Furthermore, DCPO achieved an average 28% improvement in the nonzero advantage over GRPO in four models, doubled the training efficiency over DAPO, and significantly reduced the token clipping ratio by an order of magnitude compared to both GRPO and DAPO, while achieving superior performance. These results highlight DCPO’s effectiveness in leveraging generated data more efficiently for reinforcement learning in large language models.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>基于可验证奖励的强化学习（RLVR）已经成为增强大型语言模型推理能力的一个有前景的框架。然而，现有的方法如GRPO往往面临零梯度的问题。这个问题主要是由于固定的剪切界限造成的，这些界限适用于基于token的概率比率，并且相同奖励的标准化可能导致梯度更新效果不佳以及生成响应的使用不足。在这项工作中，我们提出了动态剪切策略优化（DCPO），它引入了一种动态剪切策略，根据特定token的先验概率自适应地调整剪切界限，以增强token级探索，同时采用平滑的优势标准化技术，在累积训练步骤中标准化奖励，以改善生成响应在响应级的有效使用。DCPO在四个不同模型的四个基准测试中实现了最先进的性能。特别是在贪婪解码下，DCPO在AIME24基准上达到了46.7的Avg@1，在32次采样下得到了38.8的Avg@32，超越了Qwen2.5-Math-7B模型上的DAPO（36.7/31.6）和GRPO（36.7/32.1）。在基于Qwen2.5-14B的AIME25基准上，DCPO的表现为（23.3/19.0），超越了GRPO（13.3/10.5）和DAPO（20.0/15.3）。此外，在四个模型上，DCPO在非零优势方面比GRPO平均提高了28%，在训练效率上是DAPO的两倍，并且在与GRPO和DAPO的比较中，显著减少了token剪切比例的数量级，同时实现了更优的性能。这些结果突显了DCPO在有效利用生成数据进行大型语言模型强化学习方面的有效性。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>论文《DCPO: Dynamic Clipping Policy Optimization》针对<strong>强化学习从可验证奖励（RLVR）框架下大型语言模型推理能力提升</strong>的核心瓶颈，提出了两项关键问题并给出系统性解决方案：</p>
<p><strong>1. 固定裁剪导致的“零梯度”与探索受限</strong></p>
<ul>
<li><p><strong>问题根源</strong>：现有方法（如GRPO、DAPO）采用<strong>固定或半固定概率比裁剪边界</strong>（如|r(x)−1|≤ϵ），在旧策略赋予低概率的token区域强行限制更新幅度，导致：</p>
<ul>
<li><strong>低概率token的梯度被过度抑制</strong>，模型难以探索稀有但可能关键的推理路径；</li>
<li><strong>高概率token的裁剪冗余</strong>，浪费计算资源。</li>
</ul>
</li>
<li><p><strong>解决方案</strong>：提出<strong>动态自适应裁剪（DAC）</strong>，根据token的旧策略概率q(x)动态调整裁剪边界：</p>
<ul>
<li>对低概率token放宽边界，公式化为： <script type="math/tex">\\text{动态边界} \\propto \\frac{1}{\\sqrt{q(x)}}</script></li>
<li>保留高概率token的严格约束，避免不稳定更新。</li>
</ul>
</li>
</ul>
<p><strong>2. 奖励标准化导致的“响应级效率低下”</strong></p>
<ul>
<li><p><strong>问题根源</strong>：传统方法（如GRPO）对每个训练步的响应奖励进行<strong>局部标准化</strong>（仅当前步的G个响应），引发：</p>
<ul>
<li><strong>零优势响应</strong>：当某步所有响应奖励相同时，标准化后优势为零，导致<strong>响应被丢弃</strong>（响应利用率仅44.6%）；</li>
<li><strong>训练不稳定</strong>：高熵采样下奖励分布波动剧烈，标准化结果符号反转或幅度异常。</li>
</ul>
</li>
<li><p><strong>解决方案</strong>：提出<strong>平滑优势标准化（SAS）</strong>：</p>
<ul>
<li><strong>累积全局奖励分布</strong>：将当前步响应与历史所有同提示响应的奖励合并计算均值μ_total和方差σ_total；</li>
<li><strong>平滑融合</strong>：通过加权平均（权重随训练步数动态调整）平衡局部与全局标准化结果，公式化为： <script type="math/tex">\\hat{A}_{\\text{smooth}} = \\frac{i-1}{i}\\hat{A}_{\\text{local}} + \\frac{1}{i}\\hat{A}\_{\\text{global}}</script></li>
<li><strong>响应利用率提升</strong>：即使当前步奖励相同，历史差异仍提供非零梯度（利用率提升至71.8%）。</li>
</ul>
</li>
</ul>
<p><strong>3. 损失函数设计的“相对优势稀释”</strong></p>
<ul>
<li><p><strong>问题根源</strong>：现有损失函数（如GRPO的SLM或DAPO的TLM）存在：</p>
<ul>
<li><strong>SLM</strong>：跨响应平均导致长序列主导梯度；</li>
<li><strong>TLM</strong>：跨token平均破坏响应间相对优势关系。</li>
</ul>
</li>
<li><p><strong>解决方案</strong>：提出<strong>仅token级平均损失（OTM）</strong>：</p>
<ul>
<li>仅对单个响应内的token取平均，保留响应间相对优势，公式化为： <script type="math/tex">\\mathcal{L}_{\\text{OTM}} = \\sum_{i=1}^{G} \\frac{1}{|o\_i|} \\sum\_{t=1}^{|o\_i|} \\min\\left(r\_{i,t}\\hat{A}_{i,t}, \\text{clip}(r_{i,t}, \\epsilon\_{\\text{low}}, \\epsilon\_{\\text{high}})\\hat{A}\_{i,t}\\right)</script></li>
</ul>
</li>
</ul>
<p><strong>总结：DCPO的核心贡献</strong></p>
<p>通过<strong>动态裁剪</strong>、<strong>平滑标准化</strong>和<strong>响应级损失设计</strong>，DCPO在以下方面实现突破：</p>
<ul>
<li><strong>性能</strong>：AIME24基准上7B模型Avg@32从32.1（GRPO）提升至38.8；</li>
<li><strong>效率</strong>：训练时间较DAPO减半，响应利用率提升28%；</li>
<li><strong>稳定性</strong>：token裁剪比例降低一个数量级，熵崩溃风险显著缓解。</li>
</ul>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>以下研究均与 DCPO 的核心动机（提升大模型在 RLVR 场景下的推理能力、缓解零梯度与低样本效率问题）密切相关，可归纳为 <strong>四类</strong>：基础 RLVR 算法、裁剪策略改进、优势估计方法、以及高效训练框架。</p>
<p>1. 基础 RLVR 算法</p>
<p>方法</p>
<p>关键思想</p>
<p>与 DCPO 的关系</p>
<p><strong>GRPO</strong> (Group Relative Policy Optimization)<br>DeepSeek-AI et al., 2024</p>
<p>基于规则奖励，对同一 prompt 的 G 条响应做组内标准化，使用固定对称裁剪 ϵ。</p>
<p>DCPO 将其作为基线，指出其存在 <strong>零梯度</strong> 与 <strong>熵崩溃</strong> 问题。</p>
<p><strong>DAPO</strong> (Dynamic sAmpling Policy Optimization)<br>Yu et al., 2025</p>
<p>引入 Clip-Higher 与动态采样过滤同 reward 响应，缓解熵崩溃但牺牲样本效率。</p>
<p>DCPO 通过 SAS 与 DAC 解决同样问题，<strong>无需丢弃响应</strong>，训练效率提升 2×。</p>
<p><strong>VAPO</strong> (Variance-Aware Policy Optimization)<br>Yuan et al., 2025</p>
<p>在奖励方差过高时降低 KL 惩罚，减少梯度噪声。</p>
<p>与 DCPO 的平滑标准化思路互补，但 DCPO 直接修正优势估计本身。</p>
<p>2. 裁剪策略改进</p>
<p>方法</p>
<p>关键思想</p>
<p>与 DCPO 的关系</p>
<p><strong>PPO</strong> (Proximal Policy Optimization)<br>Schulman et al., 2017</p>
<p>固定对称裁剪</p>
<p>r−1</p>
<p><strong>Dual-clip PPO</strong><br>Ye et al., 2020</p>
<p>额外限制 r≤r_max=10，防止极端重要性权重。</p>
<p>DCPO 继承 r_max=10 的“双裁剪”思想，但将其嵌入动态边界公式。</p>
<p><strong>TR-DPO</strong> (Trust-Region Direct Preference Optimization)<br>Rafailov et al., 2023</p>
<p>在 DPO 中引入 KL 约束，避免策略偏离参考模型过远。</p>
<p>DCPO 不依赖 KL 项，通过裁剪边界本身控制策略偏移。</p>
<p>3. 优势估计与标准化方法</p>
<p>方法</p>
<p>关键思想</p>
<p>与 DCPO 的关系</p>
<p><strong>GAE</strong> (Generalized Advantage Estimation)<br>Schulman et al., 2016</p>
<p>利用 λ-加权多步 TD 误差平滑优势。</p>
<p>DCPO 的 SAS 可视为 <strong>跨训练步而非跨时间步</strong> 的平滑，解决奖励随机性。</p>
<p><strong>RLOO</strong> (REINFORCE Leave-One-Out)<br>Ahmad et al., 2023</p>
<p>通过留一法减少基线方差。</p>
<p>DCPO 的累积标准化同样降低方差，但针对 <strong>同 prompt 响应集合</strong>。</p>
<p><strong>Wang et al., 2025</strong><br>“High-entropy minority tokens drive effective RL”</p>
<p>论证低概率高熵 token 是推理能力涌现的关键。</p>
<p>为 DCPO 的动态裁剪提供 <strong>理论依据</strong>：放宽低概率 token 的边界可提升探索。</p>
<p>4. 高效训练框架与系统优化</p>
<p>方法</p>
<p>关键思想</p>
<p>与 DCPO 的关系</p>
<p><strong>HybridFlow</strong><br>Sheng et al., 2024</p>
<p>灵活高效的 RLHF 框架，支持微批次流水线。</p>
<p>DCPO 实验基于其代码库 Verl，但替换了损失计算逻辑。</p>
<p><strong>DeepSeek-R1</strong><br>Guo et al., 2025</p>
<p>大规模 RLVR 训练，使用 GRPO 作为默认算法。</p>
<p>DCPO 在相同场景下显著优于 GRPO，可直接作为其替代。</p>
<p>小结：DCPO 的“继承-创新”关系</p>
<ul>
<li><strong>继承</strong>：沿用 GRPO 的组内奖励评估、PPO 的裁剪思想、Dual-clip 的 r_max 限制。</li>
<li><strong>创新</strong>：<ul>
<li><strong>动态裁剪</strong> → 解决固定边界对低概率 token 的探索抑制；</li>
<li><strong>平滑标准化</strong> → 解决局部标准化导致的零梯度与训练震荡；</li>
<li><strong>OTM 损失</strong> → 解决响应间相对优势被稀释的问题。</li>
</ul>
</li>
</ul>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文通过 <strong>Dynamic Clipping Policy Optimization（DCPO）</strong> 框架，从 <strong>token 级裁剪、优势标准化、损失函数</strong> 三个维度协同解决 RLVR 场景下的“零梯度”与“低样本效率”问题。具体实现路径如下：</p>
<p>1. 动态自适应裁剪（Dynamic-Adaptive Clipping，DAC）</p>
<p><strong>目的</strong>：消除固定裁剪对低概率 token 的探索抑制，同时防止高概率区域更新失控。</p>
<ul>
<li><p><strong>概率依赖边界</strong><br>将传统固定边界 <code>|r−1|≤ϵ</code> 替换为： <script type="math/tex">0.5+\\tfrac12\\sqrt{\\max!\\bigl(1-\\tfrac{4\\epsilon\_{\\text{low}}}{q(x)},0\\bigr)} \\le r(x)\\le 0.5+\\tfrac12\\sqrt{1+\\tfrac{4\\epsilon\_{\\text{high}}}{q(x)}}</script></p>
<ul>
<li><code>q(x)</code> 越小，允许 <code>r(x)</code> 的相对变化越大，<strong>低概率 token 获得更宽更新区间</strong>；</li>
<li>高概率 token 仍受严格约束，避免梯度爆炸。</li>
</ul>
</li>
<li><strong>双裁剪安全上限</strong><br>借鉴 Ye et al. (2020)，对正负优势均设 <code>r_max = 10</code>，防止极端重要性权重。</li>
</ul>
<p>2. 平滑优势标准化（Smooth Advantage Standardization，SAS）</p>
<p><strong>目的</strong>：解决局部标准化导致的零优势与训练震荡，提升响应利用率。</p>
<ul>
<li><p><strong>累积全局统计量</strong><br>维护同 prompt 的所有历史响应奖励，计算全局均值 <code>μ_total</code> 与方差 <code>σ_total</code>。</p>
</li>
<li><p><strong>加权平滑融合</strong><br>每一步的优势估计为局部与全局统计量的加权平均： <script type="math/tex">\\hat{A}_{\\text{smooth}}=\\min!\\bigl(|\\hat{S}_{\\text{new}}|,|\\hat{S}_{\\text{total}}|\\bigr)\\cdot\\text{sign}(\\cdot)</script> 其中  </p>
<script type="math/tex; mode=display">\\hat{S}_{\\text{new}}=\\tfrac{i-1}{i}\\hat{A}_{\\text{local}}+\\tfrac1i\\hat{A}_{\\text{global}},\\quad \\hat{S}_{\\text{total}}=\\tfrac1i\\hat{A}_{\\text{local}}+\\tfrac{i-1}{i}\\hat{A}\_{\\text{global}}</script><ul>
<li>训练初期以全局分布为主，避免零梯度；</li>
<li>后期逐步偏向局部分布，保持对最新策略的适应性。</li>
</ul>
</li>
</ul>
<p>3. 仅 Token 级平均损失（Only-Token-Mean Loss，OTM）</p>
<p><strong>目的</strong>：保留响应间相对优势，避免长序列主导梯度或跨响应稀释。</p>
<ul>
<li><strong>响应内平均</strong><br>对每个响应单独计算 token 平均损失： <script type="math/tex">\\mathcal{L}_{\\text{OTM}}=\\sum_{i=1}^{G}\\frac{1}{|o\_i|}\\sum\_{t=1}^{|o\_i|}\\min!\\bigl(r\_{i,t}\\hat{A}_{i,t},\\ \\text{clip}(r_{i,t},\\epsilon\_{\\text{low}},\\epsilon\_{\\text{high}})\\hat{A}\_{i,t}\\bigr)</script><ul>
<li>不跨响应求和，<strong>短响应与高优势响应不再被长响应淹没</strong>；</li>
<li>无需 KL 惩罚项，裁剪边界本身控制策略偏移。</li>
</ul>
</li>
</ul>
<p>4. 训练流程整合</p>
<ul>
<li><strong>数据利用</strong>：不丢弃任何响应（对比 DAPO 的动态采样），所有生成样本均参与更新。</li>
<li><strong>系统实现</strong>：基于 Verl 框架，400 步训练，512 响应批次 + 32 微批次，G=16，温度=1.0。</li>
</ul>
<p>效果验证</p>
<p>指标</p>
<p>GRPO</p>
<p>DAPO</p>
<p>DCPO（提升）</p>
<p>AIME24-Avg@32 (7B)</p>
<p>32.1</p>
<p>31.6</p>
<p><strong>38.8</strong> (+6.7)</p>
<p>响应利用率</p>
<p>44.6%</p>
<p>—</p>
<p><strong>71.8%</strong> (+28% abs)</p>
<p>Token 裁剪比例</p>
<p>10⁻²</p>
<p>10⁻²</p>
<p><strong>10⁻³</strong> (×0.1)</p>
<p>训练耗时</p>
<p>1×</p>
<p>2×</p>
<p><strong>1×</strong> (vs DAPO 减半)</p>
<p>通过 <strong>DAC + SAS + OTM</strong> 的协同设计，DCPO 在 <strong>不牺牲稳定性</strong> 的前提下，显著提升了低概率 token 的探索空间与样本利用效率，最终在高难度数学推理任务上取得 SOTA。</p>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文围绕 <strong>“数学推理 + RLVR”</strong> 场景，设计了一套完整、可复现的实验体系，从 <strong>模型规模、任务难度、解码方式、训练效率、消融分析</strong> 五个维度验证 DCPO 的有效性。具体实验如下：</p>
<p>1. 主实验：四模型 × 四基准</p>
<p><strong>目的</strong>：验证 DCPO 在不同规模模型与不同难度任务上的通用性与领先性。</p>
<p>维度</p>
<p>设置</p>
<p><strong>模型</strong></p>
<p>Qwen2.5-Math-1.5B-Instruct<br>Qwen2.5-3B（通用基座）<br>Qwen2.5-Math-7B（数学基座）<br>Qwen2.5-14B（通用基座）</p>
<p><strong>训练集</strong></p>
<p>25 k 题：DAPO-Math-17K ∪ MATH L3-5</p>
<p><strong>评估基准</strong></p>
<p>MATH500、AMC23、AIME24、AIME25</p>
<p><strong>指标</strong></p>
<p>• Avg@1：贪心解码单次准确率<br>• Avg@32：temperature=1.0 采样 32 次平均准确率</p>
<p><strong>基线</strong></p>
<p>GRPO、DAPO（均使用官方或原论文超参）</p>
<p><strong>关键结果</strong>（节选）</p>
<ul>
<li><strong>AIME24-Avg@32（7B）</strong>：DCPO 38.8 vs GRPO 32.1 vs DAPO 31.6</li>
<li><strong>AIME25-Avg@32（14B）</strong>：DCPO 19.0 vs GRPO 10.5 vs DAPO 15.3</li>
<li><strong>四模型平均提升</strong>：DCPO 在 8 项指标中 7 项第一，平均领先 GRPO +5.4%，DAPO +2.1%</li>
</ul>
<p>2. Token 级诊断实验</p>
<p>2.1 Token Clipping Ratio（TCR）</p>
<ul>
<li><strong>定义</strong>：被裁剪 token 数 / 总 token 数</li>
<li><strong>观测</strong>：<ul>
<li>GRPO/DAPO 的 TCR 随训练波动大，且量级 10⁻²；</li>
<li>DCPO 稳定维持 10⁻³，<strong>降低一个数量级</strong>。</li>
</ul>
</li>
</ul>
<p>2.2 Response Utilization Ratio（RUR）</p>
<ul>
<li><strong>定义</strong>：非零优势响应数 / 总响应数</li>
<li><strong>观测</strong>：<ul>
<li>GRPO 从 &gt;90% 骤降到 &lt;50%，最终平均 43.8%；</li>
<li>DCPO 稳定保持 ~71.8%，<strong>绝对提升 28%</strong>。</li>
</ul>
</li>
</ul>
<p>3. 训练效率对比</p>
<ul>
<li><strong>生成样本效率</strong>：完成同样 400 步参数更新，DAPO 需生成 3-5× 响应；DCPO 与 GRPO 持平。</li>
<li><strong>GPU 时间</strong>：在 32×H20 集群上，DCPO 训练时间仅为 DAPO 的 <strong>50%</strong>。</li>
</ul>
<p>4. 消融实验（Qwen2.5-Math-7B，Avg@32）</p>
<p>变体</p>
<p>说明</p>
<p>Avg@32 相对增益</p>
<p><strong>GRPO</strong></p>
<p>原始基线</p>
<p>0</p>
<p>+ OTM</p>
<p>仅替换损失为 OTM</p>
<p>+2.4</p>
<p>+ SAS</p>
<p>仅替换优势标准化为 SAS</p>
<p>+3.1</p>
<p>+ DAC</p>
<p>仅替换裁剪为动态自适应</p>
<p>+4.9</p>
<p><strong>DCPO</strong></p>
<p>OTM+SAS+DAC 全量</p>
<p><strong>+7.2</strong></p>
<p>结论：三项组件 <strong>正交且互补</strong>，组合后获得 <strong>累积增益</strong>。</p>
<p>5. 趋势曲线分析</p>
<ul>
<li><strong>Avg@1 / Avg@32 训练曲线</strong>：DCPO 全程单调上升，无 GRPO 的“性能坍塌”或 DAPO 的大幅震荡。</li>
<li><strong>熵曲线</strong>：DCPO 将策略熵稳定在中等区间，避免 GRPO 的熵崩溃与 DAPO 的高熵震荡。</li>
</ul>
<p>6. 复现与可扩展性</p>
<ul>
<li><strong>代码与超参</strong>：附录 A.9 给出统一训练脚本；GitHub 已开源。</li>
<li><strong>模板一致性</strong>：所有实验使用同一 Qwen-Math 模板，确保结果可比。</li>
</ul>
<p>一句话总结</p>
<p>论文通过 <strong>大规模主实验 + 细粒度诊断 + 消融 + 效率对比</strong> 的立体化实验，系统证明了 DCPO 在 <strong>性能、稳定性、样本效率</strong> 三方面对现有 RLVR 方法的全面超越。</p>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可作为 DCPO 的后续研究切入点，按 <strong>理论深化、算法扩展、系统优化、跨领域迁移</strong> 四个层面展开：</p>
<p>1. 理论深化</p>
<ul>
<li><p><strong>动态裁剪的极限分析</strong><br>在 <code>q(x)→0</code> 时，DAC 上界按 <code>1/√q(x)</code> 发散，虽已设 <code>r_max=10</code> 硬截断，但<br>– 该截断对梯度方差-偏差权衡的 <strong>精确影响</strong> 尚缺理论刻画；<br>– 可尝试 <strong>变上限</strong> 或 <strong>概率自适应上限</strong> 进一步放宽约束。</p>
</li>
<li><p><strong>平滑系数自适应</strong><br>SAS 的权重 <code>1/i</code> 为线性衰减，可研究：<br>– <strong>指数衰减</strong> <code>α^i</code> 或 <strong>基于 KL 距离</strong> 的动态权重，以更快适应策略漂移；<br>– 引入 <strong>bandit 算法</strong> 在线调参，减少人工设定。</p>
</li>
</ul>
<p>2. 算法扩展</p>
<ul>
<li><p><strong>多模态输入</strong><br>将 DCPO 从纯文本数学推理扩展到 <strong>图表、几何图形</strong> 等多模态任务，验证 DAC 在跨模态 token（如图像 patch）上的有效性。</p>
</li>
<li><p><strong>链式推理长度自适应</strong><br>– 对极长推理链（&gt;8 k tokens）设计 <strong>分段裁剪</strong>：每段独立应用 DAC，避免单 token 误差累积；<br>– 结合 <strong>长度惩罚</strong> 或 <strong>动态终止</strong> 机制，减少无效生成。</p>
</li>
<li><p><strong>离线-在线混合训练</strong><br>当前为纯在线 RLVR，可探索：<br>– <strong>离线预训练 + 在线微调</strong>：先用大规模离线数学语料预训练，再接入 DCPO 微调；<br>– <strong>重要性采样修正</strong> 处理离线数据分布偏移。</p>
</li>
</ul>
<p>3. 系统优化</p>
<ul>
<li><p><strong>微批次级并行</strong><br>– 将 OTM 损失计算 <strong>下放到 token 级 CUDA kernel</strong>，减少 CPU-GPU 通信；<br>– 研究 <strong>梯度检查点</strong> 与 <strong>动态微批次大小</strong> 以适配超长序列。</p>
</li>
<li><p><strong>异构硬件适配</strong><br>– 在 <strong>L20/A100/H200</strong> 混合集群上测试 DCPO 的 <strong>流水线并行效率</strong>；<br>– 探索 <strong>FP8 低精度训练</strong> 对动态裁剪数值稳定性的影响。</p>
</li>
</ul>
<p>4. 跨领域迁移</p>
<ul>
<li><p><strong>代码生成</strong><br>将训练集替换为 <strong>CodeContests + APPS</strong>，验证：<br>– DAC 对 <strong>稀有库函数 token</strong> 的探索效果；<br>– SAS 在 <strong>单元测试奖励稀疏</strong> 场景下的稳定性。</p>
</li>
<li><p><strong>科学问答 / 定理证明</strong><br>– 在 <strong>MMLU-STEM</strong> 或 <strong>Isabelle/HOL Light</strong> 证明数据集上测试 DCPO；<br>– 研究 <strong>形式化语言 token</strong>（如 ∀, ∃）的裁剪行为差异。</p>
</li>
<li><p><strong>对话与安全对齐</strong><br>– 将奖励模型从 <strong>规则型</strong> 替换为 <strong>人类偏好模型</strong>，观察 DCPO 在 <strong>PPO-RLHF</strong> 框架下的表现；<br>– 分析 <strong>毒性/幻觉 token</strong> 的低概率特性，评估 DAC 是否放大风险。</p>
</li>
</ul>
<p>5. 风险与伦理</p>
<ul>
<li><strong>低概率稀有 token 的副作用</strong><br>– 监控 <strong>训练后期</strong> 是否因过度探索低概率 token 导致 <strong>有害或幻觉输出</strong>；<br>– 引入 <strong>安全过滤器</strong> 或 <strong>KL 回退机制</strong> 作为保障。</li>
</ul>
<p>可立即启动的实验清单</p>
<p>方向</p>
<p>7 天实验</p>
<p>4 周实验</p>
<p><strong>理论</strong></p>
<p>不同 <code>r_max</code> 对梯度方差影响</p>
<p>自适应权重 SAS 的收敛性证明</p>
<p><strong>算法</strong></p>
<p>代码生成小规模复现</p>
<p>多模态数学几何题训练</p>
<p><strong>系统</strong></p>
<p>FP8 训练数值误差分析</p>
<p>微批次级 CUDA kernel 重写</p>
<p><strong>跨域</strong></p>
<p>MMLU-STEM 零样本评估</p>
<p>人类偏好 RLHF 全流程</p>
<p>通过上述探索，DCPO 有望从 <strong>数学推理专用优化器</strong> 演进为 <strong>通用 RLVR 引擎</strong>，同时兼顾性能、效率与安全。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>DCPO 论文一句话总结</p>
<p>用 <strong>“动态裁剪 + 平滑标准化 + 响应级损失”</strong> 三板斧，解决 RLVR 训练中 <strong>低概率 token 探索受限</strong> 与 <strong>零梯度/低样本效率</strong> 两大顽疾，在四个数学基准、四个模型上全面超越 GRPO 与 DAPO。</p>
<p>1. 研究背景</p>
<ul>
<li>任务：用可验证奖励（RLVR）提升大模型数学推理。</li>
<li>痛点：<br>– GRPO 固定裁剪 → 低概率 token 更新被“卡死”；<br>– 步级标准化 → 同奖励响应优势归零，浪费样本。</li>
</ul>
<p>2. 方法总览（DCPO）</p>
<p>模块</p>
<p>关键公式</p>
<p>作用</p>
<p><strong>动态自适应裁剪 DAC</strong></p>
<script type="math/tex; mode=display">r\_{\\text{low}}(q), r\_{\\text{high}}(q)\\propto 1/\\sqrt{q}</script><p>低概率 token 放宽边界，高概率 token 严格约束</p>
<p><strong>平滑优势标准化 SAS</strong></p>
<p>$$\hat{A}_{\text{smooth}}=\min(</p>
<p>\hat{S}_{\text{new}}</p>
<p><strong>仅 Token 级平均损失 OTM</strong></p>
<p>$$\mathcal{L}=\sum_i\frac{1}{</p>
<p>o_i</p>
<p>3. 实验结果</p>
<p>指标</p>
<p>DCPO vs GRPO vs DAPO</p>
<p><strong>AIME24-Avg@32 (7B)</strong></p>
<p>38.8 vs 32.1 vs 31.6</p>
<p><strong>响应利用率</strong></p>
<p>71.8 % vs 43.8 % vs —</p>
<p><strong>Token 裁剪比例</strong></p>
<p>10⁻³ vs 10⁻² vs 10⁻²</p>
<p><strong>训练耗时</strong></p>
<p>1× vs 1× vs 2×</p>
<p>4. 结论</p>
<p>DCPO 通过 <strong>概率自适应裁剪</strong> 释放低概率 token 探索空间，<strong>累积平滑标准化</strong> 消除零梯度，<strong>响应级损失</strong> 保证相对优势，实现 <strong>更高性能、更高样本效率、更稳训练</strong>。</p>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是DCPO%3A%20Dynamic%20Clipping%20Policy%20Optimization，链接是  https://arxiv.org/pdf/2509.02333  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.02333  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Shihui Yang,Chengfeng Dou,Peidong Guo,Kai Lu,Qiang Ju,Fei Deng,Rihui Xin</p>
<p><strong>Categories</strong>: cs.CL,cs.AI,cs.LG</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.02333.pdf">https://arxiv.org/pdf/2509.02333.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.02333">https://arxiv.org/abs/2509.02333</a></p>
<p><strong>Arxiv ID</strong>: 2509.02333</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.02333">https://papers.cool/arxiv/2509.02333</a></p>
<p><strong>Published</strong>: 2025-09-02T14:01:07Z</p>
<p><strong>Updated</strong>: 2025-09-02T14:01:07.000Z</p>
<hr>
<h3 id="16-GenCompositor-Generative-Video-Compositing-with-Diffusion-Transformer"><a href="#16-GenCompositor-Generative-Video-Compositing-with-Diffusion-Transformer" class="headerlink" title="16. GenCompositor: Generative Video Compositing with Diffusion Transformer"></a>16. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.02460">GenCompositor: Generative Video Compositing with Diffusion Transformer</a></h3><p>Video compositing combines live-action footage to create video production, serving as a crucial technique in video creation and film production. Traditional pipelines require intensive labor efforts and expert collaboration, resulting in lengthy production cycles and high manpower costs. To address this issue, we automate this process with generative models, called generative video compositing. This new task strives to adaptively inject identity and motion information of foreground video to the target video in an interactive manner, allowing users to customize the size, motion trajectory, and other attributes of the dynamic elements added in final video. Specifically, we designed a novel Diffusion Transformer (DiT) pipeline based on its intrinsic properties. To maintain consistency of the target video before and after editing, we revised a light-weight DiT-based background preservation branch with masked token injection. As to inherit dynamic elements from other sources, a DiT fusion block is proposed using full self-attention, along with a simple yet effective foreground augmentation for training. Besides, for fusing background and foreground videos with different layouts based on user control, we developed a novel position embedding, named Extended Rotary Position Embedding (ERoPE). Finally, we curated a dataset comprising 61K sets of videos for our new task, called VideoComp. This data includes complete dynamic elements and high-quality target videos. Experiments demonstrate that our method effectively realizes generative video compositing, outperforming existing possible solutions in fidelity and consistency.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>视频合成将实时动作视频结合在一起，以创造视频制作，在视频创作和电影制作中扮演着重要角色。传统的工作流程需要大量人力和专家协作，导致生产周期漫长和人力成本高昂。为了解决这个问题，我们使用生成模型自动化此过程，称为生成视频合成。这个新任务旨在以互动的方式自适应地将前景视频的身份和运动信息注入到目标视频中，使用户能够自定义最终视频中添加的动态元素的大小、运动轨迹和其他属性。具体而言，我们设计了一种基于其内在特性的创新扩散变换器（DiT）流程。为了在编辑前后保持目标视频的一致性，我们修订了一个轻量化的基于DiT的背景保留分支，并进行了掩码令牌注入。为了从其他来源继承动态元素，提出了一个使用全自注意力的DiT融合块，并为训练提供了一种简单而有效的前景增强。此外，为了基于用户控制将背景和前景视频融合到具有不同布局中，我们开发了一种新型位置嵌入，称为扩展旋转位置嵌入（ERoPE）。最后，我们策划了一个包含61K组视频的数据集，用于我们的新任务，称为VideoComp。该数据集包括完整的动态元素和高质量的目标视频。实验表明，我们的方法有效实现了生成视频合成，超越了现有可能的解决方案，在保真度和一致性方面表现更佳。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>该论文提出并解决了一个全新的任务——<strong>生成式视频合成（Generative Video Compositing）</strong>，其核心目标可概括为：</p>
<ul>
<li><p><strong>自动化传统视频合成流程</strong>：传统视频合成依赖大量人工与专家协作，周期长、成本高。论文通过扩散 Transformer 首次将这一流程自动化，实现<strong>用生成模型把任意前景视频动态元素无缝注入到背景视频中</strong>。</p>
</li>
<li><p><strong>同时满足三大挑战</strong>：</p>
<ol>
<li><strong>背景一致性</strong>：编辑后的视频必须与原始背景在内容与布局上保持像素级一致。</li>
<li><strong>前景身份与运动保真</strong>：注入的前景元素必须完整保留其外观细节与动态特征，并与背景自然交互（如光影、遮挡）。</li>
<li><strong>灵活的用户控制</strong>：允许用户通过轨迹、缩放因子等显式控制前景元素的位置、大小与运动，而无需精确分割或逐帧调整。</li>
</ol>
</li>
<li><p><strong>现有方法无法胜任</strong>：</p>
<ul>
<li>可控视频生成只能接受文本/图像条件，无法精确到像素级控制，也不支持外部视频条件。</li>
<li>视频协调方法仅做颜色匹配，需要精确掩码且不能调整轨迹或尺寸。</li>
</ul>
</li>
</ul>
<p>因此，论文的任务定义可形式化为：<br>给定背景视频 $v_b$、前景视频 $v_f$ 和用户控制 $c$（轨迹、缩放），生成输出 $z_0$，使得 $z_0$ 在保留 $v_b$ 背景的同时，将 $v_f$ 的元素按 $c$ 注入并自然融合。</p>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>论文将相关研究划分为两大类别，并指出它们与所提任务“生成式视频合成（Generative Video Compositing）”的关键差异。</p>
<p>1. 基于扩散模型的视频编辑（Diffusion-based Video Editing）</p>
<ul>
<li><strong>共同点</strong>：均利用扩散模型对视频进行编辑或再生成。</li>
<li><strong>差异</strong>：现有方法主要依赖文本或单张图像作为条件，无法直接接受外部视频片段作为控制信号，因而在像素级外观与运动细节上控制不足。</li>
<li><strong>代表性工作</strong>：<ul>
<li>Tune-A-Video [48]：一次性微调 T2I 模型实现文本驱动的视频编辑。</li>
<li>VideoPainter [2]、FateZero [32]：通过掩码+文本提示完成视频修复/编辑。</li>
<li>Revideo [30]、Tora [59]：支持轨迹控制，但仍以图像或文本为初始条件，而非直接使用前景视频。</li>
<li>其他：InstructPix2Pix [5]、DynVFX [54]、MagicVFX [13] 等。</li>
</ul>
</li>
</ul>
<p>2. 视频协调（Video Harmonization）</p>
<ul>
<li><strong>共同点</strong>：关注如何把前景元素与背景在颜色、光照上保持一致。</li>
<li><strong>差异</strong>：需要精确、像素对齐的前景掩码；仅做颜色/亮度调整，不允许用户改变前景的位置、大小或运动轨迹；无法处理掩码不准确带来的边缘伪影。</li>
<li><strong>代表性工作</strong>：<ul>
<li>Harmonizer [22]：白盒式回归图像级滤波参数进行协调。</li>
<li>VideoTripletTransformer [14]：用 Triplet Transformer 同时处理多个低层视频任务，包括协调。</li>
<li>其他：Deep Video Harmonization [9, 29]、TSA² [49] 等。</li>
</ul>
</li>
</ul>
<p>小结</p>
<p>类别</p>
<p>条件形式</p>
<p>是否支持外部视频</p>
<p>是否支持用户控制轨迹/尺寸</p>
<p>是否解决掩码不准确</p>
<p>是否保持前景 ID &amp; 运动</p>
<p>扩散视频编辑</p>
<p>文本 / 图像</p>
<p>×</p>
<p>部分支持</p>
<p>×</p>
<p>弱</p>
<p>视频协调</p>
<p>合成后视频 + 精确掩码</p>
<p>×</p>
<p>×</p>
<p>×</p>
<p>仅颜色</p>
<p><strong>GenCompositor（本文）</strong></p>
<p><strong>前景视频 + 背景视频 + 用户控制</strong></p>
<p><strong>√</strong></p>
<p><strong>√</strong></p>
<p><strong>√</strong></p>
<p><strong>√</strong></p>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文通过一套专为“生成式视频合成”设计的 Diffusion Transformer（DiT）流水线 <strong>GenCompositor</strong>，从数据、模型架构、训练策略三个层面系统性地解决了前述三大挑战。核心思路可概括为：</p>
<p>1. 数据层面：构建 VideoComp 数据集</p>
<ul>
<li><strong>61 K 组高质量三元组</strong>（背景视频、前景视频、对应掩码视频）。</li>
<li><strong>自动标注与清洗流程</strong><ol>
<li>用 CogVLM + QWen 自动识别并描述显著动态元素；</li>
<li>用 Grounded SAM2 分割出前景与掩码；</li>
<li>人工过滤低质量/碎片化样本。</li>
</ol>
</li>
<li><strong>前景中心化</strong><br>在保存前景视频时将物体居中，去除原始全局轨迹，仅保留外观与动作，方便后续用户自定义轨迹。</li>
</ul>
<p>2. 模型架构：三组件协同</p>
<p>2.1 Background Preservation Branch（BPBranch）</p>
<ul>
<li><strong>目标</strong>：像素级保留背景内容。</li>
<li><strong>做法</strong><ul>
<li>输入：掩码视频 + masked 视频（32 ch）。</li>
<li>仅用 <strong>2 个轻量 DiT block</strong> 提取背景特征。</li>
<li><strong>Masked token injection</strong>：  <script type="math/tex; mode=display">\\mathbf z\_t = \\mathbf z\_t + (1-\\mathbf M)\\odot \\mathbf z\_{\\text{BPBranch}}</script>仅将背景区域注入主支，避免干扰前景生成。</li>
</ul>
</li>
</ul>
<p>2.2 Foreground Generation Mainstream（42 个 DiT Fusion Blocks）</p>
<ul>
<li><strong>目标</strong>：把前景视频的外观与动作注入到指定位置，并与背景自然交互。</li>
<li><strong>关键设计：DiT Fusion Block</strong><ul>
<li><strong>Token-wise 拼接</strong>：将待去噪 token 与前景 token 在序列维度拼接，而非通道维度，避免像素未对齐导致的混叠。</li>
<li><strong>纯 Self-Attention 融合</strong>：利用全自注意力同时处理前景条件与背景上下文，比 cross-attention 更能保留低层细节。</li>
<li><strong>ERoPE</strong>：解决前景与背景布局不一致时的位置编码冲突（见下）。</li>
</ul>
</li>
</ul>
<p>2.3 Extended Rotary Position Embedding（ERoPE）</p>
<ul>
<li><strong>问题</strong>：原始 3D RoPE 把前景与背景的 token 按相同坐标编码，导致内容串扰。</li>
<li><strong>解决方案</strong><ul>
<li>在 <strong>高度维度</strong> 上将前景 token 的坐标整体偏移 $h$，使两组 token 的坐标空间完全错位：  <script type="math/tex; mode=display">\\text{ERoPE}(t, y, x) = \\text{RoPE}(t, y+\\Delta, x)</script></li>
<li>无需额外参数，即可在自注意力阶段阻断未对齐内容的干扰。</li>
</ul>
</li>
</ul>
<p>3. 训练策略：提升泛化与鲁棒性</p>
<ul>
<li><strong>Luminance Augmentation</strong><br>每轮随机对前景视频做 $\gamma \in [0.4, 1.9]$ 的 Gamma 校正，迫使模型自适应调整光照。</li>
<li><strong>Mask Inflation</strong><br>用高斯滤波膨胀掩码，人为扩大遮罩区域，让网络学会在边界处生成自然过渡，容忍不精确掩码。</li>
<li><strong>输入转换</strong><br>训练阶段自动将用户轨迹、缩放因子转换为 mask video 与 masked video，无需成对“干净背景”数据，降低数据准备成本。</li>
</ul>
<p>4. 推理流程</p>
<ol>
<li>用户给定背景视频、前景视频、轨迹/缩放。</li>
<li>系统自动生成 mask video（含膨胀）与 masked video。</li>
<li>送入 GenCompositor → 输出合成视频，其中<ul>
<li>背景内容保持不变；</li>
<li>前景元素严格沿轨迹运动，尺寸符合缩放因子；</li>
<li>光影、遮挡等交互由模型自动预测。</li>
</ul>
</li>
</ol>
<p>总结</p>
<p>挑战</p>
<p>解决方案</p>
<p>所在模块</p>
<p>背景一致性</p>
<p>BPBranch + Masked token injection</p>
<p>2.1</p>
<p>前景 ID/运动保真</p>
<p>DiT Fusion Block + Token-wise Self-Attention</p>
<p>2.2</p>
<p>用户可控轨迹/尺寸</p>
<p>ERoPE + 输入转换</p>
<p>2.3 &amp; 3</p>
<p>掩码不精确</p>
<p>Mask Inflation + Luminance Augmentation</p>
<p>3</p>
<p>通过上述设计，GenCompositor 首次实现了<strong>无需人工逐帧调整、直接以视频为条件的生成式视频合成</strong>。</p>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文围绕“生成式视频合成”这一全新任务，从<strong>定量指标、视觉对比、用户主观评价、消融分析、泛化验证</strong>五个维度展开实验，系统验证 GenCompositor 的有效性与通用性。具体实验设计如下：</p>
<p>1. 与现有任务的对比实验</p>
<p>由于尚无直接可比的“生成式视频合成”方法，论文将其与两类最相关任务的代表性算法进行比较。</p>
<p>1.1 视频协调（Video Harmonization）</p>
<ul>
<li><p><strong>对比方法</strong><br>Harmonizer [22]、VideoTripletTransformer [14]，以及人工逐帧粘贴（manually paste）。</p>
</li>
<li><p><strong>数据集</strong><br>HYouTube [29]（含前景、掩码、背景三元组）。</p>
</li>
<li><p><strong>评价指标</strong><br>PSNR、SSIM、CLIP-Similarity、LPIPS。</p>
</li>
<li><p><strong>结果</strong></p>
<p>方法</p>
<p>PSNR↑</p>
<p>SSIM↑</p>
<p>CLIP↑</p>
<p>LPIPS↓</p>
<p>Harmonizer</p>
<p>39.76</p>
<p>0.9402</p>
<p>0.9614</p>
<p>0.0412</p>
<p>VideoTripletTransformer</p>
<p>40.03</p>
<p>0.9297</p>
<p>0.9564</p>
<p>0.0455</p>
<p><strong>GenCompositor</strong></p>
<p><strong>42.00</strong></p>
<p><strong>0.9487</strong></p>
<p><strong>0.9713</strong></p>
<p><strong>0.0385</strong></p>
</li>
<li><p><strong>视觉对比</strong><br>图 6 显示：对比方法在前景边缘出现锯齿、颜色不一致；GenCompositor 边缘平滑且光照自然。</p>
</li>
</ul>
<p>1.2 轨迹可控视频生成（Trajectory-controlled Generation）</p>
<ul>
<li><p><strong>对比方法</strong><br>Tora [59]、ReVideo [30]。</p>
</li>
<li><p><strong>评价基准</strong><br>VBench 四维指标：</p>
<ol>
<li>Subject Consistency（主体一致性）</li>
<li>Background Consistency（背景一致性）</li>
<li>Motion Smoothness（运动平滑度）</li>
<li>Aesthetic Quality（美学质量）</li>
</ol>
</li>
<li><p><strong>结果</strong></p>
<p>方法</p>
<p>Subj. Cons↑</p>
<p>Bg. Cons↑</p>
<p>Motion↑</p>
<p>Aesthetic↑</p>
<p>Tora</p>
<p>88.44 %</p>
<p>92.45 %</p>
<p>98.03 %</p>
<p>49.33 %</p>
<p>ReVideo</p>
<p>88.02 %</p>
<p>92.90 %</p>
<p>96.85 %</p>
<p>48.56 %</p>
<p><strong>GenCompositor</strong></p>
<p><strong>89.75 %</strong></p>
<p><strong>93.43 %</strong></p>
<p><strong>98.69 %</strong></p>
<p><strong>52.00 %</strong></p>
</li>
<li><p><strong>视觉对比</strong><br>图 7 显示：Tora/ReVideo 存在主体 ID 漂移、轨迹偏离、元素消失；GenCompositor 严格遵循轨迹且保持前景身份一致。</p>
</li>
</ul>
<p>2. 用户主观研究</p>
<ul>
<li><strong>设置</strong><br>每类任务各 20 组对比，邀请 19 位专业志愿者投票。</li>
<li><strong>结果</strong>（图 11）<ul>
<li>视频协调：77.37 % 偏好 GenCompositor。</li>
<li>轨迹可控生成：71.58 % 偏好 GenCompositor。</li>
</ul>
</li>
</ul>
<p>3. 消融实验（Ablation Study）</p>
<p>验证四个关键组件：DiT Fusion Block、BPBranch、Luminance Augmentation、Mask Inflation。</p>
<p>配置</p>
<p>PSNR↑</p>
<p>SSIM↑</p>
<p>CLIP↑</p>
<p>LPIPS↓</p>
<p>Subj. Cons↑</p>
<p>Bg. Cons↑</p>
<p>Motion↑</p>
<p>Aesthetic↑</p>
<p>w/o fusion block</p>
<p>19.89</p>
<p>0.8015</p>
<p>0.9341</p>
<p>0.1535</p>
<p>88.85 %</p>
<p>92.21 %</p>
<p>98.34 %</p>
<p>48.85 %</p>
<p>w/o BPBranch</p>
<p>40.01</p>
<p>0.9378</p>
<p>0.9709</p>
<p>0.0432</p>
<p>88.77 %</p>
<p>89.62 %</p>
<p>97.25 %</p>
<p>51.51 %</p>
<p>w/o augmentation</p>
<p>39.80</p>
<p>0.9295</p>
<p>0.9629</p>
<p>0.0520</p>
<p>88.00 %</p>
<p>89.97 %</p>
<p>98.30 %</p>
<p>50.73 %</p>
<p>w/o mask inflation</p>
<p>41.86</p>
<p>0.9422</p>
<p>0.9701</p>
<p>0.0409</p>
<p>89.72 %</p>
<p>91.62 %</p>
<p>98.28 %</p>
<p>50.87 %</p>
<p><strong>full model</strong></p>
<p><strong>42.00</strong></p>
<p><strong>0.9487</strong></p>
<p><strong>0.9713</strong></p>
<p><strong>0.0385</strong></p>
<p><strong>89.75 %</strong></p>
<p><strong>93.43 %</strong></p>
<p><strong>98.69 %</strong></p>
<p><strong>52.00 %</strong></p>
<ul>
<li><strong>视觉观察</strong>（图 8）<ul>
<li>无 fusion block：前景 ID 与动作丢失。</li>
<li>无 BPBranch：背景一致性下降。</li>
<li>无 augmentation / 无 inflation：边缘锯齿明显。</li>
</ul>
</li>
</ul>
<p>4. ERoPE 维度选择实验</p>
<ul>
<li><strong>设置</strong><br>在 height、width、timing 三个维度分别扩展 ERoPE，并对比统一 RoPE（w/o ERoPE）。</li>
<li><strong>结果</strong>（图 12）<br>三种 ERoPE 变体的训练损失均显著低于统一 RoPE，且三者曲线几乎重合；最终选用沿 height 扩展的方案。</li>
</ul>
<p>5. 泛化能力验证</p>
<ul>
<li><strong>任务迁移</strong><br>将前景条件替换为“空白视频”，GenCompositor 可直接用于<strong>视频补全 / 物体移除</strong>（图 10）。</li>
<li><strong>流程</strong><ol>
<li>SAM2 提取待移除物体掩码；</li>
<li>膨胀掩码 → masked video；</li>
<li>空白前景作为条件 → 模型自动填补背景。</li>
</ol>
</li>
<li><strong>结果</strong><br>无需额外训练即可生成连贯、自然的补全内容，验证任务本身的通用性。</li>
</ul>
<p>实验总结</p>
<p>维度</p>
<p>结论</p>
<p>与现有任务对比</p>
<p>在协调与轨迹控制两个子任务上均显著优于 SOTA</p>
<p>消融分析</p>
<p>四个关键组件缺一不可</p>
<p>用户主观</p>
<p>专业用户显著偏好 GenCompositor</p>
<p>泛化验证</p>
<p>同一模型可直接用于视频补全/物体移除</p>
<p>训练稳定性</p>
<p>ERoPE 有效降低损失并加速收敛</p>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可作为 GenCompositor 的后续研究切入点，按“数据-模型-应用”三层递进，并给出可行思路：</p>
<p>1. 数据与条件层面</p>
<ul>
<li><strong>极端光照鲁棒性</strong><br>当前仅用 Gamma 校正模拟光照差异；可引入 <strong>HDR 合成数据</strong> 或 <strong>物理光照估计（inverse rendering）</strong> 作为额外条件，提升强光/逆光场景下的自然度。</li>
<li><strong>复杂遮挡与深度推理</strong><br>现有方法对“前景被背景物体部分遮挡”或“前景投射阴影到背景”仅做隐式建模。可显式引入 <strong>单目深度估计</strong> 或 <strong>3D-aware 表示（depth-conditioned DiT）</strong>，实现更精确的遮挡与阴影推理。</li>
<li><strong>多前景同时注入</strong><br>当前一次仅处理单个前景视频；扩展为 <strong>多前景并行条件</strong>，需解决前景-前景交互、遮挡排序及计算效率问题。</li>
</ul>
<p>2. 模型架构层面</p>
<ul>
<li><strong>时空分辨率提升</strong><br>目前训练分辨率 480×720、49 帧；可借鉴 <strong>CogVideoX-HD</strong> 或 <strong>Wan2.1</strong> 的 4K/长视频策略，引入 <strong>temporal-upscale DiT</strong> 或 <strong>latent interpolation</strong> 模块，支持分钟级 1080p 合成。</li>
<li><strong>轻量化与实时化</strong><br>6 B 参数、65 s/clip 的推理成本仍高。可探索：<ul>
<li><strong>蒸馏</strong> → 小 3-4 倍的 DiT-Student；</li>
<li><strong>步数蒸馏</strong> → 4-8 步超快采样；</li>
<li><strong>边缘端适配</strong> → INT8 量化 + 移动 GPU 部署。</li>
</ul>
</li>
<li><strong>ERoPE 的维度扩展</strong><br>目前仅在 height 维度错位，可研究 <strong>learnable offset</strong> 或 <strong>adaptive coordinate warping</strong>，让网络自动决定错位维度与幅度，进一步提升对任意布局的泛化。</li>
</ul>
<p>3. 交互与应用层面</p>
<ul>
<li><strong>实时交互式编辑</strong><br>结合 <strong>拖拽式 UI</strong>（类似 DragGAN）与 <strong>流式 VAE</strong>，实现“边拖拽边预览”的实时合成体验。</li>
<li><strong>风格化与重照明</strong><br>在前景注入后，增加 <strong>风格迁移分支</strong> 或 <strong>重照明控制</strong>（如指定目标环境光方向），满足影视级后期需求。</li>
<li><strong>跨模态条件融合</strong><br>除轨迹/缩放外，引入 <strong>文本描述</strong>（“让蝴蝶闪烁蓝光”）或 <strong>音频节奏</strong>（爆炸与鼓点对齐），实现多模态联合控制。</li>
<li><strong>下游任务零样本迁移</strong><br>当前已验证视频补全/物体移除；可进一步测试 <strong>视频替换（actor swap）</strong>、<strong>虚拟广告植入</strong> 等场景，评估零样本性能。</li>
</ul>
<p>4. 评估与基准</p>
<ul>
<li><strong>新指标</strong><br>提出针对“生成式视频合成”的专用指标：<ul>
<li><strong>前景-背景交互一致性（FBIC）</strong>：衡量阴影、反射、遮挡的物理正确性；</li>
<li><strong>用户控制精度（UCP）</strong>：轨迹偏移量、缩放误差等。</li>
</ul>
</li>
<li><strong>大规模基准</strong><br>将 VideoComp 扩展至 <strong>百万级</strong> 并覆盖更多类别（人物、车辆、特效），建立类似 VBench 的公开排行榜。</li>
</ul>
<p>总结：可探索路线图</p>
<p>阶段</p>
<p>目标</p>
<p>关键技术</p>
<p>短期</p>
<p>提升光照/遮挡鲁棒性</p>
<p>HDR 数据、depth-conditioned DiT</p>
<p>中期</p>
<p>高分辨率+实时化</p>
<p>4K 训练、蒸馏+量化</p>
<p>长期</p>
<p>多模态交互+新基准</p>
<p>文本/音频联合控制、FBIC 指标</p>
<p>这些方向既可独立开展，也可组合迭代，逐步把 GenCompositor 推向影视级生产工具。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<h2 id="论文一句话总结"><a href="#论文一句话总结" class="headerlink" title="论文一句话总结"></a>论文一句话总结</h2><p>GenCompositor 首次提出“生成式视频合成”任务，并用一套轻量级 Diffusion-Transformer 流水线，把任意前景视频按用户轨迹/尺寸无缝注入背景视频，在背景一致性、前景保真与用户可控性上均优于现有方法。</p>
<p>1. 任务定义</p>
<ul>
<li><strong>输入</strong>：背景视频 $v_b$、前景视频 $v_f$、用户控制 $c$（轨迹+缩放）。</li>
<li><strong>输出</strong>：合成视频 $z_0$，要求<ol>
<li>背景像素级不变；</li>
<li>前景身份与动作完整保留；</li>
<li>支持任意轨迹/尺寸交互。</li>
</ol>
</li>
</ul>
<p>2. 技术方案</p>
<p>模块</p>
<p>功能</p>
<p>关键设计</p>
<p><strong>Background Preservation Branch</strong></p>
<p>保证背景不变</p>
<p>2 个轻量 DiT block + masked token 注入</p>
<p><strong>Foreground Generation Mainstream</strong></p>
<p>注入前景并交互</p>
<p>42 个 <strong>DiT Fusion Block</strong>（token-wise 自注意力融合）</p>
<p><strong>ERoPE</strong></p>
<p>解决前景-背景布局不对齐</p>
<p>在高度维度错位编码，零额外参数</p>
<p><strong>训练增强</strong></p>
<p>提升鲁棒性</p>
<p>Mask inflation + 随机 Gamma 校正</p>
<p>3. 数据与实验</p>
<ul>
<li><strong>VideoComp 数据集</strong>：61 K 组（背景、前景、掩码），全自动标注+人工过滤。</li>
<li><strong>对比实验</strong>：<ul>
<li>视频协调：PSNR ↑ 42.0 vs 40.0（SOTA）。</li>
<li>轨迹可控生成：四项 VBench 指标均第一。</li>
</ul>
</li>
<li><strong>消融实验</strong>：四个关键组件缺一不可。</li>
<li><strong>用户研究</strong>：77 % 以上专业用户偏好 GenCompositor。</li>
<li><strong>泛化验证</strong>：同一模型零样本完成视频补全/物体移除。</li>
</ul>
<p>4. 结论与展望</p>
<p>GenCompositor 已覆盖常见场景；未来可探索 HDR 光照、深度感知遮挡、4K 长视频、实时交互等方向。</p>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是GenCompositor%3A%20Generative%20Video%20Compositing%20with%20Diffusion%20Transformer，链接是  https://arxiv.org/pdf/2509.02460  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.02460  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Shuzhou Yang,Xiaoyu Li,Xiaodong Cun,Guangzhi Wang,Lingen Li,Ying Shan,Jian Zhang</p>
<p><strong>Categories</strong>: cs.CV</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.02460.pdf">https://arxiv.org/pdf/2509.02460.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.02460">https://arxiv.org/abs/2509.02460</a></p>
<p><strong>Arxiv ID</strong>: 2509.02460</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.02460">https://papers.cool/arxiv/2509.02460</a></p>
<p><strong>Published</strong>: 2025-09-02T16:10:13Z</p>
<p><strong>Updated</strong>: 2025-09-02T16:10:13.000Z</p>
<hr>
<h3 id="17-OpenVision-2-A-Family-of-Generative-Pretrained-Visual-Encoders-for-Multimodal-Learning"><a href="#17-OpenVision-2-A-Family-of-Generative-Pretrained-Visual-Encoders-for-Multimodal-Learning" class="headerlink" title="17. OpenVision 2: A Family of Generative Pretrained Visual Encoders for Multimodal Learning"></a>17. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.01644">OpenVision 2: A Family of Generative Pretrained Visual Encoders for Multimodal Learning</a></h3><p>This paper provides a simplification on OpenVision’s architecture and loss design for enhancing its training efficiency. Following the prior vision-language pretraining works CapPa and AIMv2, as well as modern multimodal designs like LLaVA, our changes are straightforward: we remove the text encoder (and therefore the contrastive loss), retaining only the captioning loss as a purely generative training signal. We name this new version OpenVision 2. The initial results are promising: despite this simplification, OpenVision 2 competitively matches the original model’s performance on a broad set of multimodal benchmarks while substantially cutting both training time and memory consumption. For example, with ViT-L/14, it reduces training time by about 1.5x (from 83h to 57h), and memory usage by about 1.8x (from 24.5GB to 13.8GB, equivalently allowing the maximum batch size to grow from 2k to 8k). This superior training efficiency also allows us to scale far beyond the largest vision encoder used in OpenVision, reaching more than 1 billion parameters. We hold a strong belief that this lightweight, generative-only paradigm is compelling for future vision encoder development in multimodal foundation models.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>本文对OpenVision的架构和损失设计进行了简化，以提高其训练效率。按照之前的视觉-语言预训练工作CapPa和AIMv2，以及现代多模态设计如LLaVA，我们的改动非常简单：我们去除了文本编码器（因此去除了对比损失），仅保留作为纯生成训练信号的字幕损失。我们将这个新版本命名为OpenVision 2。初步结果令人鼓舞：尽管进行了简化，OpenVision 2在广泛的多模态基准测试中仍然与原模型的性能相匹配，同时显著减少了训练时间和内存消耗。例如，使用ViT-L/14时，训练时间减少了约1.5倍（从83小时降至57小时），内存使用量减少了约1.8倍（从24.5GB降至13.8GB，相当于允许最大批量大小从2000增加到8000）。这种卓越的训练效率还使我们能够将规模扩大到超出OpenVision使用的最大视觉编码器，达到超过10亿个参数。我们坚信，这种轻量级、仅生成的范式对未来多模态基础模型中的视觉编码器开发具有吸引力。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>论文核心解决的问题是：<strong>如何在保持甚至提升多模态性能的同时，大幅降低视觉-语言预训练的计算与内存开销</strong>。</p>
<p>具体而言，OpenVision 2 针对以下痛点提出改进：</p>
<ul>
<li><strong>计算冗余</strong>：OpenVision 原版采用“对比学习+生成式损失”双路训练，需同时维护文本编码器与文本解码器，导致 FLOPs 与显存显著高于 CLIP 基线。</li>
<li><strong>数据与模型规模受限</strong>：高内存占用限制了可使用的 batch size，进而阻碍在更大规模数据或更大模型上的训练。</li>
<li><strong>架构与下游任务不匹配</strong>：预训练阶段的多目标（对比+生成）与下游 LLaVA 类框架仅使用生成式微调的范式存在目标差异，可能带来迁移损耗。</li>
</ul>
<p>通过<strong>完全移除文本编码器与对比损失，仅保留生成式字幕损失</strong>，OpenVision 2 将训练流程简化为“图像编码器 → 文本解码器”的轻量级两模块架构，从而在以下方面取得突破：</p>
<ul>
<li><strong>训练效率</strong>：ViT-L/14 训练时间从 83 h 降至 57 h（≈1.5×），显存从 24.5 GB 降至 13.8 GB（≈1.8×），最大 batch size 由 2 k 提升到 8 k。</li>
<li><strong>可扩展性</strong>：节省的资源使训练 1.01 B 参数量的 ViT-g/14 成为可能，且仍保持成本可控。</li>
<li><strong>性能保持</strong>：在 TextVQA、ChartQA、OCR-Bench、MME 等多模态基准上，OpenVision 2 与原版 OpenVision 得分相当甚至略优，证明生成式预训练足以替代传统的 CLIP 式对比学习。</li>
</ul>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>OpenVision 2 的提出与以下四条研究脉络紧密相关，并在这些工作的基础上进行简化与扩展：</p>
<ol>
<li><p><strong>对比式视觉-语言预训练</strong></p>
<ul>
<li><strong>CLIP</strong> [44]、ALIGN [20]：奠定“图像-文本对比学习”范式。</li>
<li><strong>LAION-2B-CLIP</strong> [19]、<strong>DataComp-1B-CLIP</strong> [16]、<strong>MetaCLIP-5B</strong> [59]：基于大规模公开数据训练的开源 CLIP 变体。</li>
<li><strong>SigLIP</strong> [62]：用 sigmoid 损失替代 InfoNCE，提升训练效率。</li>
<li><strong>EVA-CLIP</strong> [50]、<strong>DFN-CLIP</strong> [12]：通过数据过滤或网络架构改进进一步提升性能。<br>→ 这些工作均以对比损失为核心，OpenVision 2 则<strong>完全舍弃对比损失</strong>，验证其非必要性。</li>
</ul>
</li>
<li><p><strong>生成式视觉-语言预训练</strong></p>
<ul>
<li><strong>CapPa</strong> [53]：首次提出“仅用字幕生成损失训练视觉编码器”，但使用短且噪声较大的网页 alt-text。</li>
<li><strong>AIMv2</strong> [14]：采用 Prefix-ViT 与混合目标（图像块回归 + 文本生成），参数量达 1.8 B。</li>
<li><strong>CoCa</strong> [61]、<strong>Flamingo</strong> [1]：将对比与生成目标结合，架构更复杂。<br>→ OpenVision 2 在 CapPa 的“字幕唯一监督”思想基础上，引入<strong>更高质量合成字幕</strong>与<strong>随机 token 掩码</strong>策略，提高效率与性能。</li>
</ul>
</li>
<li><p><strong>高效训练策略</strong></p>
<ul>
<li><strong>CLIPA</strong> [32]：低分辨率预训练 + 高分辨率微调，显著减少训练 FLOPs。</li>
<li><strong>Token masking / dropping</strong>：在 AIMv2、PaLI-X 等工作中用于降低解码器负担；OpenVision 2 将其系统研究并验证最优掩码比例（25–35 %）。</li>
</ul>
</li>
<li><p><strong>数据质量与合成字幕</strong></p>
<ul>
<li><strong>Recap-DataComp-1B</strong> [31]：用 LLaMA-3-LLaVA 对 DataComp-1B 重新生成字幕，提升标注质量。</li>
<li><strong>ReCap-DataComp-1B v2</strong>：进一步以原始 alt-text 为条件并采用加权 top-k 采样，获得更长、更细粒度的描述，成为 OpenVision 2 的默认训练语料。</li>
</ul>
</li>
</ol>
<p>综上，OpenVision 2 将</p>
<ul>
<li>CapPa 的“生成式监督”思想、</li>
<li>CLIPA 的“低分辨率预训练”策略、</li>
<li>Recap 的“高质量合成字幕”方法、</li>
<li>以及 token-masking 的“计算节省”技巧<br>整合为一套简洁、高效、可扩展的视觉编码器预训练方案，并在 1 B 参数规模上验证了其通用性与有效性。</li>
</ul>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>OpenVision 2 通过一套极简而系统的“三步手术”将 OpenVision 的复杂多分支训练流程压缩为轻量级两模块架构，从而同时解决计算冗余、内存瓶颈与可扩展性问题。</p>
<p>步骤</p>
<p>原 OpenVision 设计</p>
<p>OpenVision 2 改动</p>
<p>直接收益</p>
<p><strong>1. 架构剪枝</strong></p>
<p>保留文本编码器，执行双路对比损失（web-caption &amp; synthetic-caption）</p>
<p><strong>完全移除文本编码器</strong> → 仅剩 ViT 图像编码器 + 文本解码器</p>
<p>训练图从 3 模块减为 2 模块；显存峰值 ↓≈1.8×</p>
<p><strong>2. 损失简化</strong></p>
<p>对比损失 + 生成式字幕损失（需额外文本解码器）</p>
<p><strong>仅保留字幕生成损失</strong>；用高质量合成字幕作为唯一监督</p>
<p>每图 FLOPs ↓≈1.3×；训练时间 ↓≈1.5–2×</p>
<p><strong>3. 训练加速与正则</strong></p>
<p>无 token 掩码；高分辨率全程训练</p>
<p>• <strong>继承 CLIPA</strong>：低分辨率预训练 + 高分辨率微调<br>• <strong>随机掩码 65 % 视觉 token</strong> 再送入解码器</p>
<p>解码器计算量再降 65 %；支持 batch 8 k 不 OOM</p>
<p>补充技术细节</p>
<ul>
<li><strong>数据升级</strong>：用 ReCap-DataComp-1B v2（LLaMA-3-LLaVA 重标注，更长、更细粒度）取代噪声 web alt-text，保证字幕质量。</li>
<li><strong>目标对齐</strong>：预训练阶段与下游 LLaVA 微调阶段均为“ViT 特征 → 文本生成”，消除目标不匹配。</li>
<li><strong>规模验证</strong>：在 1.01 B 参数的 ViT-g/14 上仍保持训练可行，并在 OCR、ChartQA 等细粒度任务上取得新高。</li>
</ul>
<p>通过以上三步，OpenVision 2 在不牺牲多模态性能的前提下，实现了训练时间、显存占用与 FLOPs 的大幅下降，从而解决了大规模视觉-语言预训练的效率与可扩展性难题。</p>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文围绕 <strong>性能验证</strong>、<strong>效率评估</strong> 与 <strong>设计消融</strong> 三条主线展开实验，覆盖 8 个主流多模态基准、3 种模型规模、2 个下游框架，以及多种训练策略与数据配置。具体实验如下：</p>
<p>1. 多模态下游性能验证</p>
<p><strong>目的</strong>：验证 OpenVision 2 在标准多模态任务上能否与 OpenVision、CLIP 等基线持平或更优。</p>
<p>框架</p>
<p>模型规模</p>
<p>分辨率</p>
<p>基准任务（共 8 项）</p>
<p>关键结论</p>
<p>LLaVA-1.5</p>
<p>ViT-L/14、SoViT-400M/14、ViT-H/14、ViT-g/14</p>
<p>224 / 336 / 448</p>
<p>TextVQA、ChartQA、OCR-Bench、MME、SEED、SQA、GQA、POPE</p>
<p>OpenVision 2 在 30/32 个设定中 ≥ 原 OpenVision；OCR-Bench 平均 +15~+30 分</p>
<p>Open-LLaVA-Next</p>
<p>同上</p>
<p>同上</p>
<p>同上</p>
<p>结果与 LLaVA-1.5 趋势一致；ViT-H/14@448 在 OCR-Bench 创 590 新高</p>
<p>2. 训练效率与可扩展性评估</p>
<p><strong>目的</strong>：量化时间、FLOPs、显存节省，并验证能否扩展到 1 B 参数。</p>
<p>指标</p>
<p>ViT-L/14 @224</p>
<p>SoViT-400M/14 @384</p>
<p>ViT-g/14 @224</p>
<p><strong>训练时间</strong></p>
<p>83 h → 57 h (×1.5↓)</p>
<p>241 h → 121 h (×2↓)</p>
<p>首次成功训练 1 B 模型</p>
<p><strong>FLOPs / image</strong></p>
<p>271.8 → 208.9 (×1.3↓)</p>
<p>1636.8 → 1017.7 (×1.6↓)</p>
<p>—</p>
<p><strong>显存 / chip</strong></p>
<p>24.5 GB → 13.8 GB (×1.8↓)</p>
<p>27.4 GB → 14.5 GB (×1.9↓)</p>
<p>32 GB 内支持 batch 2 k</p>
<p><strong>最大 batch size</strong></p>
<p>2 k → 8 k (不 OOM)</p>
<p>512 → 1 k (不 OOM)</p>
<p>—</p>
<p>3. 消融实验</p>
<p>3.1 字幕来源对性能的影响</p>
<p>训练字幕</p>
<p>TextVQA</p>
<p>OCR-Bench</p>
<p>结论</p>
<p>原始 alt-text</p>
<p>51.8</p>
<p>238</p>
<p>噪声大，性能最差</p>
<p>ReCap-DataComp-1B</p>
<p>56.9</p>
<p>291</p>
<p>显著提升</p>
<p>ReCap-DataComp-1B v2</p>
<p>56.5</p>
<p>303</p>
<p>OCR 更强 → 选为默认</p>
<p>3.2 视觉 token 保留比例</p>
<p>Keep Ratio</p>
<p>OCR-Bench</p>
<p>TextVQA</p>
<p>结论</p>
<p>100 %</p>
<p>254</p>
<p>53.8</p>
<p>计算高，非最优</p>
<p>35 %</p>
<p>291</p>
<p>56.9</p>
<p>最佳平衡点</p>
<p>10 %</p>
<p>276</p>
<p>55.6</p>
<p>信息不足，性能下降</p>
<p>3.3 训练策略组合收益（ViT-L/14 @224）</p>
<p>配置</p>
<p>训练时间</p>
<p>说明</p>
<p>CapPa 基线</p>
<p>217 h</p>
<p>无 CLIPA、无掩码</p>
<p>+ Token Mask</p>
<p>190 h</p>
<p>仅掩码</p>
<p>+ CLIPA</p>
<p>67 h</p>
<p>仅 CLIPA</p>
<p>+ 两者</p>
<p>55 h</p>
<p>协同最佳</p>
<p>4. 扩展实验</p>
<ul>
<li><strong>1.01 B 参数 ViT-g/14</strong> 成功训练并在多模态基准取得 SOTA 或接近 SOTA 结果，证明方法可扩展至十亿级模型。</li>
</ul>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可作为 OpenVision 2 之后的延伸研究，按“数据—模型—训练—评测—应用”五维度展开：</p>
<p>1. 数据层面</p>
<ul>
<li><strong>多语言合成字幕</strong><br>将 ReCap-DataComp-1B v2 扩展到 30+ 语言，验证字幕-only 预训练在多语场景下的通用性。</li>
<li><strong>细粒度与多轮字幕</strong><br>引入对象级、区域级或对话式字幕，测试对 Referring Expression、Visual Grounding 等任务的影响。</li>
<li><strong>动态字幕长度课程</strong><br>由短到长逐步增加字幕复杂度，观察收敛速度与最终性能权衡。</li>
</ul>
<p>2. 模型层面</p>
<ul>
<li><strong>混合视觉骨干</strong><br>尝试 Swin-V3、ConvNeXt-3D 或 ViT-MoE，验证 caption-only 目标对不同视觉归纳偏置的鲁棒性。</li>
<li><strong>解码器容量缩放</strong><br>固定 ViT 规模，系统增大文本解码器（1 B→4 B），测试“视觉编码器轻+语言解码器重”的极限配比。</li>
<li><strong>跨模态 Q-Former 替代方案</strong><br>在 ViT 与 LLM 之间插入可学习的 Query Token，评估是否进一步减少解码 FLOPs 同时保性能。</li>
</ul>
<p>3. 训练策略</p>
<ul>
<li><strong>掩码策略自适应</strong><br>用强化学习或元学习动态决定每样本 token keep ratio，而非固定 35 %。</li>
<li><strong>字幕难度采样</strong><br>按困惑度或信息熵对字幕重加权，让模型优先学习高信息增益样本。</li>
<li><strong>持续预训练</strong><br>先字幕预训练，再小规模对比微调，验证“生成→对比”两阶段能否兼得效率与对齐优势。</li>
</ul>
<p>4. 评测与分析</p>
<ul>
<li><strong>细粒度探针任务</strong><br>新增属性识别、计数、空间关系等诊断集，量化 caption-only 表征的细粒度能力。</li>
<li><strong>对抗与鲁棒性</strong><br>在 ImageNet-A、ImageNet-R 及 patch-shuffle 攻击下测试鲁棒性，对比 CLIP 风格模型。</li>
<li><strong>可解释性工具</strong><br>利用 Grad-CAM、token attribution 分析被保留的 35 % token 的语义分布，验证掩码合理性。</li>
</ul>
<p>5. 下游应用与系统</p>
<ul>
<li><strong>端到端多模态大模型</strong><br>将 OpenVision 2 ViT-g/14 直接接入 7 B/13 B LLM，训练完全开源的 LLaVA-3B/7B 系列。</li>
<li><strong>边缘端推理优化</strong><br>结合 token 稀疏化与量化（INT4 ViT + INT8 LLM），在移动端实现实时图文对话。</li>
<li><strong>跨模态检索再审视</strong><br>仅用 caption-only 预训练权重初始化双塔检索模型，微调后对比 CLIP 在 Flickr30K、MS-COCO 上的 Zero-shot Recall@K。</li>
</ul>
<p>这些方向既可直接复用 OpenVision 2 已发布的代码与数据，也能进一步验证“生成式监督是否足以取代对比学习”这一核心假设。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>论文一句话总结</p>
<p>OpenVision 2 通过“仅保留字幕生成损失、移除文本编码器与对比损失”的极简方案，在保持甚至提升多模态性能的同时，将训练时间、显存与 FLOPs 分别降低 1.5×、1.8× 与 1.3×，并成功把视觉编码器扩展到 1 B 参数规模。</p>
<p>核心内容速览</p>
<p>维度</p>
<p>原 OpenVision</p>
<p>OpenVision 2 改动</p>
<p>结果</p>
<p><strong>架构</strong></p>
<p>ViT + 文本编码器 + 文本解码器（双路损失）</p>
<p><strong>仅 ViT + 文本解码器</strong>（字幕损失唯一监督）</p>
<p>训练图从 3 模块减为 2 模块</p>
<p><strong>损失</strong></p>
<p>对比损失（web &amp; synth caption）+ 生成损失</p>
<p><strong>仅字幕生成损失</strong></p>
<p>FLOPs↓1.3×，训练时间↓1.5–2×</p>
<p><strong>数据</strong></p>
<p>ReCap-DataComp-1B</p>
<p><strong>ReCap-DataComp-1B v2</strong>（更长、更细粒度合成字幕）</p>
<p>OCR-Bench↑+15~+30</p>
<p><strong>训练策略</strong></p>
<p>无 token 掩码</p>
<p><strong>随机掩码 65 % 视觉 token</strong> + CLIPA 低分辨率课程</p>
<p>显存峰值↓1.8×，batch 2 k→8 k</p>
<p><strong>规模</strong></p>
<p>最大 632 M</p>
<p><strong>首次训练 1.01 B ViT-g/14</strong></p>
<p>十亿级模型仍可高效训练</p>
<p><strong>评测</strong></p>
<p>8 项多模态基准</p>
<p>在 LLaVA-1.5 &amp; Open-LLaVA-Next 框架下</p>
<p>性能持平或优于原 OpenVision</p>
<p>结论</p>
<p>OpenVision 2 证明：</p>
<ol>
<li><strong>字幕-only 生成式预训练即可媲美 CLIP 式对比学习</strong>；</li>
<li><strong>极简架构带来显著效率与可扩展性优势</strong>；</li>
<li><strong>为社区提供了完全开源、可复现的十亿级视觉编码器训练范式</strong>。</li>
</ol>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是OpenVision%202%3A%20A%20Family%20of%20Generative%20Pretrained%20Visual%20Encoders%20for%20Multimodal%20Learning，链接是  https://arxiv.org/pdf/2509.01644  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.01644  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Yanqing Liu,Xianhang Li,Letian Zhang,Zirui Wang,Zeyu Zheng,Yuyin Zhou,Cihang Xie</p>
<p><strong>Categories</strong>: cs.CV</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.01644.pdf">https://arxiv.org/pdf/2509.01644.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.01644">https://arxiv.org/abs/2509.01644</a></p>
<p><strong>Arxiv ID</strong>: 2509.01644</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.01644">https://papers.cool/arxiv/2509.01644</a></p>
<p><strong>Published</strong>: 2025-09-01T17:38:21Z</p>
<p><strong>Updated</strong>: 2025-09-01T17:38:21.000Z</p>
<hr>
<h3 id="18-Benchmarking-Optimizers-for-Large-Language-Model-Pretraining"><a href="#18-Benchmarking-Optimizers-for-Large-Language-Model-Pretraining" class="headerlink" title="18. Benchmarking Optimizers for Large Language Model Pretraining"></a>18. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.01440">Benchmarking Optimizers for Large Language Model Pretraining</a></h3><p>The recent development of Large Language Models (LLMs) has been accompanied by an effervescence of novel ideas and methods to better optimize the loss of deep learning models. Claims from those methods are myriad: from faster convergence to removing reliance on certain hyperparameters. However, the diverse experimental protocols used to validate these claims make direct comparisons between methods challenging. This study presents a comprehensive evaluation of recent optimization techniques across standardized LLM pretraining scenarios, systematically varying model size, batch size, and training duration. Through careful tuning of each method, we provide guidance to practitioners on which optimizer is best suited for each scenario. For researchers, our work highlights promising directions for future optimization research. Finally, by releasing our code and making all experiments fully reproducible, we hope our efforts can help the development and rigorous benchmarking of future methods.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>大型语言模型（LLMs）的近期发展伴随着一系列新颖的思想和方法，用以更好地优化深度学习模型的损失。这些方法的声明数不胜数：从加速收敛到消除对某些超参数的依赖。然而，用于验证这些声明的多样实验协议使得方法之间的直接比较变得具有挑战性。本研究在标准化的LLM预训练场景中，对近期优化技术进行了全面评估，系统地变化模型大小、批量大小和训练时间。通过对每种方法的精心调整，我们为实践者提供了指导，帮助他们了解哪种优化器最适合每种场景。对于研究人员而言，我们的工作强调了未来优化研究的有希望方向。最后，通过发布我们的代码并使所有实验完全可重现，我们希望我们的努力能够帮助未来方法的发展和严格基准测试。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>该论文旨在解决 <strong>大规模语言模型（LLM）预训练中优化器选择的系统性评估缺失</strong> 的问题。具体而言，论文试图回答以下核心问题：</p>
<ol>
<li><p><strong>AdamW是否仍是LLM预训练的最优选择？</strong><br>尽管AdamW在过去十年中占据主导地位，但近期涌现的优化器（如AdEMAMix、MARS、SOAP等）声称在收敛速度、通信效率或下游任务性能上更优。论文通过标准化实验验证这些新方法的实际效果。</p>
</li>
<li><p><strong>如何公平比较不同优化器？</strong><br>现有研究常因实验协议差异（如模型规模、批次大小、训练时长、超参数设置）导致结论不可比。论文通过统一基准测试框架，控制变量（模型参数、批次大小、训练token数），并经过大规模超参数调优（2900次实验，约3万GPU小时），确保比较的公平性。</p>
</li>
<li><p><strong>优化器性能如何随规模变化？</strong><br>论文系统评估了11种优化器在 <strong>124M到720M参数</strong> 的密集模型和 <strong>520M参数的MoE模型</strong> 上的表现，覆盖从Chinchilla最优训练时长到超扩展训练的场景，揭示不同优化器在规模扩展时的鲁棒性。</p>
</li>
<li><p><strong>超参数（如学习率、权重衰减、warmup）如何影响优化器表现？</strong><br>通过消融实验，论文量化了关键超参数（如权重衰减λ、学习率衰减比例γ_end、warmup步数）对不同优化器的影响，并提出实用调优建议（如长训练需增大β₂或β₃）。</p>
</li>
<li><p><strong>为实践者和研究者提供指导</strong></p>
<ul>
<li><strong>实践者</strong>：给出不同训练场景（如短训练、长训练、小批次/大批次）下的最优优化器选择（如AdEMAMix和MARS在多数场景下优于AdamW）。</li>
<li><strong>研究者</strong>：开源完整基准测试工具包（代码、超参数配置），为未来优化器设计提供标准化评估框架。</li>
</ul>
</li>
</ol>
<p><strong>总结</strong>：论文填补了LLM预训练中优化器比较的系统性和规模性空白，挑战了AdamW的默认地位，并推动社区向更高效的优化器发展。</p>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>论文在第2节“Background &amp; Related Work”中系统梳理了与LLM优化器相关的研究，可归纳为以下5个方向：</p>
<p>1. <strong>Adam(W)的统治地位与局限性</strong></p>
<ul>
<li><strong>AdamW</strong> [66, 84]：作为LLM预训练的事实标准，其成功归因于自适应学习率和动量机制，但存在对超参数敏感、通信开销大等问题。</li>
<li><strong>理论解释</strong>：<ul>
<li>[5, 96, 158, 74, 72] 探讨AdamW在Transformer上的优势，归因于符号更新（sign-based updates）和二阶矩估计对梯度噪声的鲁棒性。</li>
<li>[160] 从Hessian角度解释AdamW为何优于SGD。</li>
</ul>
</li>
</ul>
<p>2. <strong>Adam变体与改进</strong></p>
<ul>
<li><strong>ADOPT</strong> [134]：通过调整二阶矩更新顺序解决AdamW在非凸问题上的收敛问题，但论文发现其β₂仍需调优（与理论声称矛盾）。</li>
<li><strong>AdEMAMix</strong> [99]：引入慢动量（β₃）加速收敛，论文验证其在大规模训练中需增大β₃以维持优势。</li>
</ul>
<p>3. <strong>符号优化器（Sign-based Methods）</strong></p>
<ul>
<li><strong>Signum</strong> [9, 161]：SignSGD的动量版本，内存高效（仅需1个状态缓存），但小批次下性能差，需大批次或特殊调参（如权重衰减λ=0.5）。</li>
<li><strong>Lion</strong> [17]：符号发现的优化器，与AdEMAMix结构相似，论文发现其β₁=0.99最优，且受益于长warmup。</li>
</ul>
<p>4. <strong>二阶/近似二阶方法</strong></p>
<ul>
<li><strong>Sophia</strong> [79]：使用对角Fisher信息矩阵近似Hessian，论文发现其存在收敛不稳定问题（尤其在长训练和小批次下）。</li>
<li><strong>SOAP</strong> [141]：改进Shampoo的预条件方法，论文指出其性能依赖超参数（如批次大小、权重衰减），且在大批次下优势减弱。</li>
<li><strong>Muon/D-Muon</strong> [59, 81]：针对矩阵参数的正交化优化器，D-Muon通过全局权重衰减解决Muon的局限性。</li>
</ul>
<p>5. <strong>无调度器/自适应方法</strong></p>
<ul>
<li><strong>Schedule-Free AdamW (SF-AdamW)</strong> [27]：通过迭代平均消除学习率调度器，但论文发现其需梯度裁剪且对β₂敏感（需0.9999）。</li>
<li><strong>Prodigy</strong> [90]：自适应学习率方法，论文验证其有效学习率（γ_eff）可近似AdamW的调参过程，但小批次下对β₂敏感。</li>
</ul>
<p>6. <strong>其他相关研究</strong></p>
<ul>
<li><strong>MARS</strong> [153]：结合方差缩减的二阶方法，论文发现其在大批次和MoE模型中表现优异。</li>
<li><strong>MoE优化器</strong> [35, 165]：论文首次将优化器基准扩展到MoE架构，验证密集模型调参可直接迁移。</li>
</ul>
<p>关键对比点</p>
<p>方法</p>
<p>核心创新</p>
<p>论文发现</p>
<p><strong>AdamW</strong></p>
<p>自适应+权重衰减</p>
<p>需调大β₂（0.999）和长训练</p>
<p><strong>AdEMAMix</strong></p>
<p>双动量（β₃）</p>
<p>长训练需增大β₃至0.9999</p>
<p><strong>Signum/Lion</strong></p>
<p>符号更新+动量</p>
<p>需大批次或高λ=0.5，长warmup</p>
<p><strong>SOAP</strong></p>
<p>预条件+AdamW混合</p>
<p>性能依赖批次大小和超参数</p>
<p><strong>Sophia</strong></p>
<p>对角Hessian近似</p>
<p>长训练不稳定（小批次/多迭代）</p>
<p><strong>Prodigy</strong></p>
<p>自适应学习率</p>
<p>γ_eff可指导AdamW调参</p>
<p>总结</p>
<p>论文通过对比上述方法，揭示了<strong>现有研究的局限性</strong>（如Sophia的收敛问题、SOAP的超参数敏感性），并提出了<strong>新的调优规则</strong>（如β₂/β₃随训练时长调整、权重衰减的阶段性作用），为后续优化器设计提供了实证基础。</p>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文通过以下 <strong>系统性、可复现的实验设计</strong> 解决 LLM 优化器评估缺失的问题，核心思路是 <strong>“标准化基准 + 大规模调参 + 多维度消融”</strong>：</p>
<p>1. <strong>构建统一基准框架</strong></p>
<ul>
<li><strong>控制变量</strong>：固定模型架构（Llama-like）、数据（FineWeb 100B tokens）、训练流程（序列长度512、混合精度bf16），仅改变优化器与超参数。</li>
<li><strong>覆盖场景</strong>：<ul>
<li><strong>模型规模</strong>：124M → 720M 密集模型，520M MoE 模型。</li>
<li><strong>训练时长</strong>：从 Chinchilla 最优（~20 tokens/param）到 7× 超扩展训练。</li>
<li><strong>批次大小</strong>：16k → 2M tokens，模拟小/大批次实际场景。</li>
</ul>
</li>
<li><strong>开源工具链</strong>：提供完整训练脚本、超参数配置（附录 E）与评估流水线，确保复现性。</li>
</ul>
<p>2. <strong>大规模超参数调优</strong></p>
<ul>
<li><strong>调参策略</strong>：<ul>
<li><strong>分阶段调参</strong>：先在小模型（124M）上调优，再迁移到更大模型（210M/720M），仅微调学习率/β参数。</li>
<li><strong>关键超参数</strong>：学习率 γ、权重衰减 λ、β₁/β₂/β₃、warmup 步数、梯度裁剪阈值、学习率衰减终点 γ_end。</li>
</ul>
</li>
<li><strong>调参规模</strong>：<ul>
<li><strong>2900 次实验</strong>，覆盖 11 种优化器（AdamW、AdEMAMix、MARS、SOAP 等）。</li>
<li><strong>~3 万 GPU 小时</strong>（A100/H100），确保每个优化器在每种场景下均达到最优。</li>
</ul>
</li>
</ul>
<p>3. <strong>多维度消融实验</strong></p>
<p>通过 <strong>控制单一变量</strong> 揭示优化器行为规律：</p>
<p>(1) <strong>权重衰减 λ 的阶段性作用</strong></p>
<ul>
<li><strong>短训练</strong>：λ=0.5 加速收敛（Signum/Lion 甚至超越 AdamW）。</li>
<li><strong>长训练</strong>：λ=0.1 更稳健（避免梯度爆炸）。</li>
<li><strong>MoE 验证</strong>：D-Muon 通过全局 λ 解决 Muon 的矩阵参数无衰减问题。</li>
</ul>
<p>(2) <strong>学习率与 β 参数的耦合</strong></p>
<ul>
<li><strong>β₂/β₃ 需随训练时长调整</strong>：<ul>
<li>AdamW/AdEMAMix 长训练需增大 β₂（0.999→0.9999）。</li>
<li>Prodigy 小批次下 β₂ 微小变化（0.999→0.9999）导致发散，需启用偏差修正。</li>
</ul>
</li>
<li><strong>学习率迁移性</strong>：小模型调优的 γ 可平滑迁移至大模型（8× 训练时长）。</li>
</ul>
<p>(3) <strong>学习率调度器的选择</strong></p>
<ul>
<li><strong>Cosine 调度器</strong> 在多数场景最优，但 Muon 偏好 WSD（Warmup-Stable-Decay）。</li>
<li><strong>γ_end 需远小于 0.1γ_max</strong>：0.01γ_max（Cosine）或 0.001γ_max（Linear）显著提升性能。</li>
</ul>
<p>(4) <strong>优化器特异性现象</strong></p>
<ul>
<li><strong>Sophia 的收敛崩溃</strong>：小批次或长训练下梯度爆炸（图31-32），需慎用。</li>
<li><strong>Signum 的批次敏感性</strong>：小批次下性能差，但 512×512 批次下接近 AdamW。</li>
<li><strong>SF-AdamW 的梯度裁剪</strong>：原论文建议禁用裁剪，但实验表明 <strong>必须启用</strong>（阈值 0.5）。</li>
</ul>
<p>4. <strong>MoE 架构的扩展验证</strong></p>
<ul>
<li><strong>直接迁移调参</strong>：将密集模型的最优超参数（如 λ=0.1）应用于 520M MoE，验证优化器在稀疏模型上的鲁棒性。</li>
<li><strong>发现</strong>：AdEMAMix 和 MARS 在 MoE 中仍保持优势，SOAP 需重新调 β 参数。</li>
</ul>
<p>5. <strong>实用指导与开源贡献</strong></p>
<ul>
<li><strong>实践建议</strong>：<ul>
<li><strong>短训练</strong>：优先用 AdEMAMix 或 MARS，λ=0.5 加速收敛。</li>
<li><strong>长训练</strong>：AdEMAMix（β₃=0.9999）+ λ=0.1 + Cosine 调度器。</li>
<li><strong>MoE 训练</strong>：直接复用密集模型调参，但需关注 SOAP 的 β₂。</li>
</ul>
</li>
<li><strong>开源资源</strong>：<br><a target="_blank" rel="noopener" href="https://github.com/epfml/llm-optimizer-benchmark">GitHub 仓库</a> 提供完整代码、超参数表（附录 E）和训练日志，支持后续研究。</li>
</ul>
<p>总结：论文的解决方案</p>
<p>通过 <strong>标准化实验 + 大规模调参 + 细粒度消融</strong>，论文首次系统回答了：</p>
<ul>
<li><strong>“何时放弃 AdamW？”</strong> → 在多数场景下，AdEMAMix/MARS 更优。</li>
<li><strong>“如何调参？”</strong> → 提供分场景的调参规则（如 λ、β₂ 随训练时长调整）。</li>
<li><strong>“如何复现？”</strong> → 开源全链路工具，消除实验偏差。</li>
</ul>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文通过 <strong>分阶段、多维度的系统性实验</strong> 全面评估了 11 种优化器在 LLM 预训练中的表现。实验设计围绕 <strong>模型规模、批次大小、训练时长、架构类型（密集/MoE）</strong> 四个核心变量展开，具体实验如下：</p>
<p><strong>1. 核心基准实验（主实验）</strong></p>
<p><strong>密集模型（Dense LLMs）</strong></p>
<ul>
<li><strong>模型规模</strong>：124M、210M、583M、720M 参数（Llama-like 架构）。</li>
<li><strong>批次大小</strong>：<ul>
<li>124M：16k/131k/262k tokens（32×512/256×512/512×512）。</li>
<li>210M：131k tokens（256×512）。</li>
<li>583M：2M tokens（3936×512）。</li>
<li>720M：1M tokens（1984×512）。</li>
</ul>
</li>
<li><strong>训练时长</strong>：<ul>
<li>124M/210M：1B→16.8B tokens（覆盖 Chinchilla 最优 2.5B/4.2B）。</li>
<li>583M：13B tokens（Chinchilla 最优 11.7B）。</li>
<li>720M：8B→48B tokens（Chinchilla 最优 14.4B）。</li>
</ul>
</li>
<li><strong>优化器</strong>：11 种（AdamW、AdEMAMix、MARS、SOAP、Sophia、Muon、D-Muon、Signum、Lion、SF-AdamW、Prodigy）。</li>
<li><strong>评估指标</strong>：验证集交叉熵损失（Final Validation Loss）。</li>
</ul>
<p><strong>MoE 模型</strong></p>
<ul>
<li><strong>架构</strong>：520M 参数 Switch-Transformer（8 专家，top-2 路由）。</li>
<li><strong>批次大小</strong>：131k tokens（256×512）。</li>
<li><strong>训练时长</strong>：5.5B→44B tokens（Chinchilla 最优 10.4B）。</li>
<li><strong>验证</strong>：直接复用密集模型的调参结果，测试迁移性。</li>
</ul>
<p><strong>2. 关键消融实验（Ablations）</strong></p>
<p><strong>超参数敏感性分析</strong></p>
<ul>
<li><strong>权重衰减 λ</strong>：<br>扫描 λ∈{0, 0.1, 0.5}，发现短训练需高 λ（0.5），长训练需 λ=0.1。</li>
<li><strong>学习率 γ</strong>：<br>固定其他参数，扫描 γ∈{1e-4, 3e-4, 5e-4, 1e-3, 2e-3}，验证迁移性。</li>
<li><strong>β 参数</strong>：<ul>
<li>AdamW/AdEMAMix：β₂ 从 0.95→0.9999（长训练需更大值）。</li>
<li>Prodigy：β₂ 微小变化（0.999→0.9999）导致发散，需偏差修正。</li>
</ul>
</li>
<li><strong>Warmup 步数</strong>：<br>扫描 {2k, 8k, 32k}，发现符号优化器（Signum/Lion）需长 warmup（8k+）。</li>
<li><strong>学习率调度器</strong>：<br>对比 Cosine、WSD、Linear，发现 Cosine 多数最优，Muon 偏好 WSD。</li>
</ul>
<p><strong>架构与实现细节</strong></p>
<ul>
<li><strong>Newton-Schulz 迭代次数</strong>（Muon）：<br>TNS∈{1,5,10,20}，TNS=5 最优，&gt;5 无提升。</li>
<li><strong>梯度裁剪</strong>（SF-AdamW）：<br>原论文建议禁用，实验发现必须启用（阈值 0.5）。</li>
<li><strong>z-loss 正则化</strong>：<br>验证其对优化器排名的影响（无提升，反而降低性能）。</li>
</ul>
<p><strong>3. 扩展实验</strong></p>
<p><strong>梯度范数动态</strong></p>
<ul>
<li>追踪不同优化器在训练中的梯度范数变化，关联稳定性与超参数（λ、γ、调度器）。</li>
</ul>
<p><strong>权重初始化与 Warmup</strong></p>
<ul>
<li>对比 std=0.02（常规）与 std=0.006（DeepSeek 风格），发现小初始化需更长 warmup。</li>
</ul>
<p><strong>Wall-clock 时间</strong></p>
<ul>
<li>在 30M→1B 模型上测试 100 迭代耗时，SOAP 因预条件计算显著更慢，Signum 最快。</li>
</ul>
<p><strong>4. 实验规模统计</strong></p>
<p>维度</p>
<p>范围/细节</p>
<p><strong>总实验次数</strong></p>
<p>2900 次（含所有优化器与超参数组合）</p>
<p><strong>GPU 小时</strong></p>
<p>~30,000（A100/H100/GH200）</p>
<p><strong>模型规模</strong></p>
<p>30M→1026M（含密集与 MoE）</p>
<p><strong>训练时长</strong></p>
<p>1B→48B tokens（覆盖短/长训练）</p>
<p><strong>超参数扫描</strong></p>
<p>γ、λ、β、warmup、调度器、裁剪阈值</p>
<p><strong>总结：实验设计的独特性</strong></p>
<ul>
<li><strong>覆盖全面</strong>：从 124M 到 720M 密集模型 + 520M MoE，涵盖实际部署场景。</li>
<li><strong>调参深度</strong>：每个优化器在每种场景下均独立调参（如 AdEMAMix 的 β₃=0.9999）。</li>
<li><strong>现象级发现</strong>：如 Sophia 的收敛崩溃、Signum 的大批次优势、SF-AdamW 的裁剪必要性。</li>
<li><strong>开源复现</strong>：所有实验配置与结果公开，支持后续研究直接对比。</li>
</ul>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向均直接源于论文的实验结果与讨论部分（§5 “Limitations” 及各节 Takeaways），可作为后续研究的切入点，按优先级与可行性由高到低列出：</p>
<p>1. <strong>超参数与训练时长的动态规律</strong></p>
<ul>
<li><strong>β₂/β₃ 的“时变”策略</strong><br>论文发现 AdamW-like 优化器在长训练时需显著增大 β₂（0.95→0.9999）。可进一步：<ul>
<li>建立 β₂(T) 的解析式（如 β₂=1−c/T），验证其在千亿级模型上的普适性。</li>
<li>探索 β₃ 对 AdEMAMix 在超扩展训练（&gt;100B tokens）中的极限值。</li>
</ul>
</li>
<li><strong>权重衰减的阶段性调度</strong><br>实验显示 λ=0.5 仅在短训练有效。可设计 <strong>λ 退火策略</strong>（如线性衰减至 0.1），兼顾早期收敛与后期稳定性。</li>
</ul>
<p>2. <strong>优化器在更大规模与更长训练中的行为</strong></p>
<ul>
<li><strong>千亿级模型验证</strong><br>当前实验止于 720M 参数。需测试：<ul>
<li>AdEMAMix/MARS 在 7B/70B 模型上是否仍优于 AdamW。</li>
<li>Sophia 的收敛崩溃是否因模型增大而缓解（如梯度噪声相对减小）。</li>
</ul>
</li>
<li><strong>超扩展训练（&gt;50× Chinchilla）</strong><br>论文观察到 SOAP 在长训练中被 AdamW 反超。需验证：<ul>
<li>是否因预条件矩阵更新频率不足？可尝试动态调整预条件频率 ϕ∝1/√t。</li>
</ul>
</li>
</ul>
<p>3. <strong>下游任务与损失的相关性</strong></p>
<ul>
<li><strong>“好损失≠好下游”的例外场景</strong><br>论文仅报告验证损失，未验证下游任务。需：<ul>
<li>在相同实验设置下，测试优化器对 MMLU、HumanEval 等指标的影响。</li>
<li>特别关注 Sophia（高损失但可能高鲁棒性）与 Signum（低损失但可能欠拟合）。</li>
</ul>
</li>
</ul>
<p>4. <strong>内存高效优化器的统一基准</strong></p>
<ul>
<li><strong>内存受限场景</strong><br>论文未覆盖 GaLore、APOLLO 等内存高效方法。可：<ul>
<li>在单卡 24GB GPU 上复现所有实验，比较显存占用与性能权衡。</li>
<li>量化 Signum/Lion 的内存优势（少 50% 状态缓存）是否随模型增大而放大。</li>
</ul>
</li>
</ul>
<p>5. <strong>MoE 架构的优化器特异性</strong></p>
<ul>
<li><strong>专家负载均衡与优化器耦合</strong><br>论文发现 MoE 中优化器排名与密集模型一致，但未分析：<ul>
<li>不同优化器对专家负载均衡损失（router z-loss）的敏感度。</li>
<li>是否需为 MoE 设计专家级学习率（如专家频率自适应 γ）。</li>
</ul>
</li>
</ul>
<p>6. <strong>理论驱动的优化器改进</strong></p>
<ul>
<li><strong>Sophia 的收敛崩溃根因</strong><br>实验排除实现 bug，可能原因：<ul>
<li>对角 Hessian 近似在长训练中误差累积。可尝试 <strong>K-FAC 或 Shampoo 的全矩阵预条件</strong>。</li>
<li>梯度裁剪阈值需随训练动态调整（如裁剪阈值∝梯度范数滑动平均）。</li>
</ul>
</li>
</ul>
<p>7. <strong>无调度器方法的极限</strong></p>
<ul>
<li><strong>SF-AdamW 的 β₂ 依赖性</strong><br>论文发现 β₂=0.9999 最优，但理论建议 β₂=1−1/T。可：<ul>
<li>验证 β₂=1−c/√T 是否更优（借鉴 AdaBelief 的时变策略）。</li>
<li>探索 <strong>完全无 β₂ 的方法</strong>（如用梯度范数归一化替代二阶矩）。</li>
</ul>
</li>
</ul>
<p>8. <strong>硬件感知的优化器设计</strong></p>
<ul>
<li><strong>通信效率与 Newton-Schulz 迭代</strong><br>Muon/D-Muon 的 Newton-Schulz 步骤在分布式训练中可能成为瓶颈。可：<ul>
<li>测试 <strong>低精度正交化</strong>（如 FP8 下的 Newton-Schulz）对收敛的影响。</li>
<li>设计 <strong>异步预条件更新</strong>（类似 LAMB 的层级缩放）。</li>
</ul>
</li>
</ul>
<p>9. <strong>自动化调参工具</strong></p>
<ul>
<li><strong>Prodigy 的“代理调参”潜力</strong><br>论文提出用 Prodigy 的 γ_eff 指导 AdamW 调参。可扩展为：<ul>
<li>开源工具：输入模型规模与训练时长，输出推荐 γ 和 β₂。</li>
<li>验证该策略在 10B+ 模型上的有效性。</li>
</ul>
</li>
</ul>
<p>优先级建议</p>
<p>方向</p>
<p>短期可行性</p>
<p>长期价值</p>
<p>推荐动作</p>
<p><strong>β₂ 动态策略</strong></p>
<p>高</p>
<p>高</p>
<p>在 7B 模型上测试 β₂=1−c/T 与固定 0.9999 对比</p>
<p><strong>千亿级验证</strong></p>
<p>中</p>
<p>极高</p>
<p>用论文开源脚本扩展至 Llama-7B</p>
<p><strong>下游任务</strong></p>
<p>高</p>
<p>中</p>
<p>复现 3-4 个优化器在 720M 模型上的 MMLU 结果</p>
<p><strong>内存基准</strong></p>
<p>高</p>
<p>中</p>
<p>对比 Signum 与 AdamW 在 24GB GPU 上的最大可训练模型</p>
<p>以上方向均基于论文的 <strong>实证缺口</strong> 与 <strong>可扩展性</strong>，可直接利用其开源代码与超参数表快速启动。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>论文一句话总结</p>
<p>在统一、可复现的框架下，首次系统评估了 11 种现代优化器在 124 M–720 M 密集与 520 M MoE 模型上的预训练表现，给出“何时、如何、用谁”取代 AdamW 的明确指南，并开源全套基准工具。</p>
<p>主要内容速览</p>
<p>维度</p>
<p>关键发现</p>
<p>实用建议</p>
<p><strong>优化器排名</strong></p>
<p>AdEMAMix、MARS 几乎在所有规模/批次/时长下优于 AdamW；SOAP 在 Chinchilla 长度内领先，长训练被反超；Signum/Lion 需大批次才具竞争力；Sophia 长训练易发散。</p>
<p>短/中训练：AdEMAMix/MARS；资源受限：Signum/Lion+大批次；避免 Sophia。</p>
<p><strong>超参数调优</strong></p>
<p>• β₂/β₃ 随训练时长增大（0.999→0.9999）<br>• λ=0.5 仅短训练有效，长训练 λ=0.1<br>• γ_end 应 ≤0.01 γ_max（而非 0.1）<br>• warmup 2 k 步通用，符号法需 8 k+</p>
<p>长训练前重调 β、λ、γ_end；小批次 Prodigy 需开 bias-correction。</p>
<p><strong>批次与规模</strong></p>
<p>大批次显著提升符号法与 MARS；MoE 上可直接复用密集模型超参。</p>
<p>若算力允许，优先放大批次而非延长步数。</p>
<p><strong>消融亮点</strong></p>
<p>• Sophia 在 33.6 B tokens 处必发散<br>• SF-AdamW 必须启用梯度裁剪<br>• Newton-Schulz 5 步即足，&gt;5 无收益</p>
<p>避免盲目相信原论文“禁用裁剪”等声明。</p>
<p><strong>开源贡献</strong></p>
<p>2900 次实验、3 万 GPU 小时、完整脚本与超参表。</p>
<p>直接复现或扩展至更大模型。</p>
<p>一句话给实践者</p>
<p>“把 AdamW 当默认之前，先跑一次 AdEMAMix（β₃=0.9999，λ=0.1，cosine→0.01 γ_max）；若显存吃紧，换 Signum 并放大批次。”</p>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Benchmarking%20Optimizers%20for%20Large%20Language%20Model%20Pretraining，链接是  https://arxiv.org/pdf/2509.01440  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.01440  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Andrei Semenov,Matteo Pagliardini,Martin Jaggi</p>
<p><strong>Categories</strong>: cs.LG</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.01440.pdf">https://arxiv.org/pdf/2509.01440.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.01440">https://arxiv.org/abs/2509.01440</a></p>
<p><strong>Arxiv ID</strong>: 2509.01440</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.01440">https://papers.cool/arxiv/2509.01440</a></p>
<p><strong>Published</strong>: 2025-09-01T12:50:30Z</p>
<p><strong>Updated</strong>: 2025-09-01T12:50:30.000Z</p>
<hr>
<h3 id="19-Attributes-as-Textual-Genes-Leveraging-LLMs-as-Genetic-Algorithm-Simulators-for-Conditional-Synthetic-Data-Generation"><a href="#19-Attributes-as-Textual-Genes-Leveraging-LLMs-as-Genetic-Algorithm-Simulators-for-Conditional-Synthetic-Data-Generation" class="headerlink" title="19. Attributes as Textual Genes: Leveraging LLMs as Genetic Algorithm Simulators for Conditional Synthetic Data Generation"></a>19. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.02040">Attributes as Textual Genes: Leveraging LLMs as Genetic Algorithm Simulators for Conditional Synthetic Data Generation</a></h3><p>Large Language Models (LLMs) excel at generating synthetic data, but ensuring its quality and diversity remains challenging. We propose Genetic Prompt, a novel framework that combines genetic algorithms with LLMs to augment synthetic data generation. Our approach treats semantic text attributes as gene sequences and leverages the LLM to simulate crossover and mutation operations. This genetic process enhances data quality and diversity by creating novel attribute combinations, yielding synthetic distributions closer to real-world data. To optimize parent selection, we also integrate an active learning scheme that expands the offspring search space. Our experiments on multiple NLP tasks reveal several key findings: Genetic Prompt not only significantly outperforms state-of-the-art baselines but also shows robust performance across various generator model sizes and scales. Moreover, we demonstrate that fusing our synthetic data with the original training set significantly boosts downstream model performance, particularly for class-imbalanced scenarios. Our findings validate that Genetic Prompt is an effective method for producing high-quality synthetic data for a wide range of NLP applications.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>大型语言模型（LLM）在生成合成数据方面表现出色，但确保其质量和多样性仍然具有挑战性。我们提出了遗传提示，这是一种新颖的框架，将遗传算法与LLM结合，以增强合成数据生成。我们的方法将语义文本属性视为基因序列，并利用LLM模拟交叉和突变操作。这个遗传过程通过创建新颖的属性组合来提高数据的质量和多样性，从而产生更接近真实世界数据的合成分布。为了优化父代选择，我们还整合了一种主动学习方案，扩展后代搜索空间。我们在多个自然语言处理任务上的实验揭示了一些关键发现：遗传提示不仅显著优于最先进的基线，而且在各类生成模型规模和效能上表现出强大的稳定性。此外，我们还展示了将我们的合成数据与原始训练集融合可以显著提升下游模型的性能，尤其是在类别不平衡的场景中。我们的发现证实了遗传提示是为广泛的自然语言处理应用生成高质量合成数据的一种有效方法。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>该研究聚焦的核心问题是：<br><strong>如何在使用大语言模型（LLM）进行合成数据生成时，同时保证数据的高质量与多样性，从而提升下游任务性能，尤其是在类别不平衡或数据稀缺场景下。</strong></p>
<p>具体而言，论文指出当前 LLM 合成数据方法存在以下局限：</p>
<ul>
<li>依赖人工预定义属性或静态提示，限制了模型推理能力与跨领域泛化性；</li>
<li>现有基于词/句层面的扰动（如简单改写）难以在大规模场景下保持语义多样性与真实分布一致性；</li>
<li>逐样本“适应度”评估不可靠，导致传统遗传算法难以直接用于数据生成。</li>
</ul>
<p>因此，论文提出 <strong>Genetic Prompt 框架</strong>，通过将<strong>文本的语义属性视为“基因”</strong>，利用 LLM 模拟遗传算法中的交叉与变异操作，并引入主动学习策略优化父代选择，从而：</p>
<ol>
<li>自动发现关键属性，减少对人工先验的依赖；</li>
<li>在属性层面进行遗传操作，兼顾质量与多样性；</li>
<li>提升合成数据对真实分布的逼近程度，显著改善下游任务表现，尤其对类别不平衡数据集效果明显。</li>
</ol>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>论文在 §6 Related Work 中系统梳理了两条研究脉络，并指出其与本文方法的关键差异。以下按主题归纳相关研究：</p>
<p>6.1 遗传算法与大语言模型（GA + LLM）</p>
<p>代表工作</p>
<p>核心思路</p>
<p>局限性（作者观点）</p>
<p>Lehman et al. 2022；Lange et al. 2024</p>
<p>把 LLM 当作进化策略或变异算子，用于代码/提示优化</p>
<p>仅在词/句层面做交叉/变异，最终收敛到单一最优解，难以兼顾大规模文本的<strong>质量与多样性</strong></p>
<p>Liu et al. 2024（AutoDAN）</p>
<p>将段落视为基因序列，用分层 GA 搜索最优提示前缀</p>
<p>同样聚焦“找最好提示”，而非<strong>生成大量多样化数据</strong></p>
<p>Guo et al. 2024；Yang et al. 2024</p>
<p>LLM 作为黑箱优化器，迭代改写句子</p>
<p>局限于句子级扰动，难以保持整体语义分布</p>
<p><strong>本文差异</strong>：</p>
<ul>
<li>把“基因”从词/句级提升到<strong>语义属性级</strong>（如风格、结构、极性），利用 LLM 的理解能力做属性交叉/变异；</li>
<li>用<strong>主动学习</strong>替代传统适应度选择，避免逐样本评估不可靠的问题。</li>
</ul>
<p>6.2 基于 LLM 的合成数据生成</p>
<p>类别</p>
<p>代表工作</p>
<p>关键方法</p>
<p>局限性（作者观点）</p>
<p>零样本/少样本生成</p>
<p>ZeroGen (Ye et al. 2022)</p>
<p>直接 prompt LLM 按类别生成</p>
<p>多样性不足，容易模式化</p>
<p>属性控制生成</p>
<p>AttrPrompt (Yu et al. 2023)</p>
<p>人工枚举属性值组合，再让 LLM 生成</p>
<p>属性空间爆炸，约束过多抑制 LLM 推理</p>
<p>知识增强</p>
<p>Knowledge-infused prompting (Xu et al. 2024)</p>
<p>引入外部知识图谱约束生成</p>
<p>依赖领域知识，难以泛化</p>
<p>多步/链式生成</p>
<p>Ada-Instruct (Cui &amp; Wang 2024)</p>
<p>多轮 prompt 逐步细化</p>
<p>流程复杂，成本高</p>
<p>数据整理</p>
<p>Curated LLM (Seedat et al. 2024)</p>
<p>先大规模生成再基于学习动态筛选</p>
<p>仍受限于初始生成质量</p>
<p><strong>本文差异</strong>：</p>
<ul>
<li>不依赖人工枚举属性值，而是让 LLM <strong>自动发现属性基因</strong>；</li>
<li>通过<strong>遗传操作</strong>而非显式约束，实现大规模、高多样性、低分布偏移的合成数据；</li>
<li>在<strong>类别不平衡场景</strong>下优势明显，可直接生成均衡且多样的合成样本。</li>
</ul>
<p>小结</p>
<ul>
<li><strong>GA+LLM 方向</strong>：已有工作聚焦“优化单一提示/代码”，本文聚焦“生成大规模、多样化文本”。</li>
<li><strong>合成数据方向</strong>：已有工作多用“预定义属性+约束”，本文用“属性基因+遗传操作+主动学习”，减少人工先验、提升可扩展性。</li>
</ul>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文通过提出 <strong>Genetic Prompt 框架</strong>，将遗传算法（GA）与大语言模型（LLM）深度耦合，以系统性地解决“高质量 + 高多样性”合成数据生成难题。具体实现路径可概括为以下四个互锁模块：</p>
<p>1. 文本基因识别（Textual Genes Identification）</p>
<ul>
<li><strong>目标</strong>：自动发现对任务最敏感的高层语义属性，而非人工枚举。</li>
<li><strong>做法</strong>：<ol>
<li>输入任务元数据 + 少量真实样本到 LLM；</li>
<li>提问：“若把文本属性视为基因，哪些最重要？”</li>
<li>通过人机协同筛选，得到 <strong>无具体取值限制</strong> 的基因集合  <script type="math/tex; mode=display">G = \\Phi(M, S, \\text{Ins}\_G)</script>其中 $G$ 可包含“句子结构、实体距离、极性、可读性”等抽象维度。</li>
</ol>
</li>
<li><strong>收益</strong>：避免过度约束 LLM，减少人工偏差，为后续遗传操作提供语义单元。</li>
</ul>
<p>2. 主动父代选择（Active Parents Selection）</p>
<ul>
<li><strong>目标</strong>：克服逐样本“适应度”评估不可靠的问题，同时扩大后代搜索空间。</li>
<li><strong>做法</strong>：<ul>
<li>用 Sentence Transformer 编码当前种群，计算语义表示 $E$；</li>
<li>每轮从尚未使用的样本中，选取 <strong>语义欧氏距离最大</strong> 的一对  <script type="math/tex; mode=display">(p\_i^_, p\_j^_) = \\arg\\max\_{e\_i,e\_j \\in E} \\text{dist}(e\_i, e\_j)</script></li>
</ul>
</li>
<li><strong>收益</strong>：确保父代差异最大化，提升交叉后代的多样性与探索性。</li>
</ul>
<p>3. 交叉与变异（Crossover &amp; Mutation）</p>
<ul>
<li><strong>目标</strong>：在属性层面而非词/句层面进行遗传操作，兼顾内容保真与多样性。</li>
<li><strong>交叉</strong>：<ul>
<li>将基因集 $G$ 随机划分为 $G_1,G_2,G_3$；</li>
<li>$G_1$ 继承自父本 $p_i^<em>$，$G_2$ 继承自父本 $p_j^</em>$，形成语义层面的“杂交”。</li>
</ul>
</li>
<li><strong>变异</strong>：<ul>
<li>对 $G_3$ 中的基因进行语义级扰动，如改变实体关系极性、句子功能角色等；</li>
<li>保持整体任务相关性，避免词级替换带来的表面多样性。</li>
</ul>
</li>
<li><strong>实现</strong>：<br>通过 LLM 的上下文指令一次性完成交叉+变异，输出新样本  <script type="math/tex; mode=display">D\_{\\text{syn}} \\sim \\rho\_l\\bigl(\\cdot,;, \\text{Ins}\_l^{\\text{GA}}, (p\_i^_, p\_j^_), G\\bigr).</script></li>
</ul>
<p>4. 下游训练与数据融合（Downstream Training &amp; Synthetic-Gold Fusion）</p>
<ul>
<li><strong>训练</strong>：用合成数据 $D_{\text{syn}}$ 微调 RoBERTa/T5 等下游模型，统一学习率，无特殊 tricks。</li>
<li><strong>融合</strong>：将合成数据与原始训练集 <strong>1:1 混合</strong>，在类别不平衡场景下显著提升 macro-F1；<br>例如 ChemProt：+3.2 % macro-F1 vs +2.3 % micro-F1，验证了对少数类的增益。</li>
</ul>
<p>5. 关键设计总结</p>
<p>传统难点</p>
<p>Genetic Prompt 对策</p>
<p>逐样本适应度难评估</p>
<p>用主动学习选“语义最远”父代，无需显式适应度</p>
<p>词/句级扰动多样性有限</p>
<p>提升到语义属性级交叉+变异</p>
<p>人工预定义属性值空间爆炸</p>
<p>仅定义抽象基因，取值由 LLM 在生成时自由组合</p>
<p>类别不平衡</p>
<p>遗传过程天然可生成任意比例的多样样本，直接平衡数据集</p>
<p>通过上述四步闭环，Genetic Prompt 在 8 个数据集、3 类 NLP 任务上均优于 SimPrompt、AttrPrompt、Curated LLM 等基线，并在消融实验中验证了“主动选择 + 变异 + 语义基因”三者缺一不可。</p>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文围绕 <strong>数据质量、下游任务、数据融合、消融分析、规模效应</strong> 五个维度，设计了系统实验，覆盖 8 个公开数据集、3 类 NLP 任务、4 种 LLM 生成器。具体实验一览如下：</p>
<p>1. 数据集与任务</p>
<p>任务</p>
<p>数据集</p>
<p>规模/类别</p>
<p>特点</p>
<p>文本分类</p>
<p>AGNews、StackExchange</p>
<p>12 万 / 2.7 万；4 类 / 50 类</p>
<p>新闻、技术问答</p>
<p>关系抽取</p>
<p>ChemProt、DDI、SemEval2010、CoNLL04</p>
<p>1k–7k；4–9 类</p>
<p>生物医学、药物交互</p>
<p>文本摘要</p>
<p>SciTLDR、MeQSum</p>
<p>2k–23k；单任务</p>
<p>科学论文、医学问题</p>
<p>2. 实验设置</p>
<ul>
<li><strong>生成器</strong>：Phi-4、Llama-3.1-70B、GPT-3.5-turbo、GPT-4o</li>
<li><strong>下游模型</strong>：RoBERTa-base（分类）、T5-large（摘要）</li>
<li><strong>基线</strong>：SimPrompt、AttrPrompt、Curated LLM</li>
<li><strong>统一控制</strong>：各方法使用相同的 2-shot 真实样本初始化，生成等量合成数据</li>
</ul>
<p>3. 四大核心实验</p>
<p>3.1 内在质量评估（Intrinsic Analysis）</p>
<ul>
<li><strong>指标</strong>：<ul>
<li>APS ↓（平均成对相似度）</li>
<li>CMD ↓（Central Moment Discrepancy，与真实分布距离）</li>
<li>Vocabulary Size ↑（词汇多样性）</li>
</ul>
</li>
<li><strong>结果</strong>：<ul>
<li>8 个数据集中，Genetic Prompt 在 APS、CMD、Vocab 均优于基线；</li>
<li>ChemProt、DDI、CoNLL04 的合成词汇量甚至 <strong>超过真实数据</strong>，显示语义/词汇双重增强。</li>
</ul>
</li>
</ul>
<p>3.2 下游任务表现（Extrinsic Evaluation）</p>
<ul>
<li><strong>指标</strong>：Micro-F1（分类）、Rouge-L（摘要）</li>
<li><strong>结果</strong>：<ul>
<li>8 个数据集全部领先，平均提升 1.8–3.4 pp；</li>
<li>在 <strong>类别极度不平衡</strong> 的 StackExchange（IR=1283）上仍保持稳健；</li>
<li>生成器越大，Genetic Prompt 提升越明显，而基线常出现波动或下降。</li>
</ul>
</li>
</ul>
<p>3.3 合成-真实数据融合（Synthetic-Gold Fusion）</p>
<ul>
<li><strong>协议</strong>：1 : 1 混合训练</li>
<li><strong>结果</strong>：<ul>
<li>平均 Micro-F1 再提升 1.85 pp；</li>
<li><strong>Macro-F1 提升更显著</strong>：ChemProt +3.2 pp、DDI +3.1 pp、StackExchange +3.7 pp，验证了对少数类的增益；</li>
<li>摘要任务中，仅 Genetic Prompt 带来 Rouge-L 正向提升（SciTLDR +0.5）。</li>
</ul>
</li>
</ul>
<p>3.4 消融实验（Ablation Study）</p>
<p>变体</p>
<p>主要发现</p>
<p>w/o Active Learning</p>
<p>随机父代 → 语义空间塌陷，性能平均下降 2–4 pp</p>
<p>w/o Mutation</p>
<p>仅交叉 → 多样性不足，ChemProt F1 掉 3.2 pp</p>
<p>Word-as-Gene</p>
<p>词级基因 → 语义信息丢失，平均掉 8–12 pp</p>
<p>4. 规模效应分析（Effects of Generator Size &amp; Data Scale）</p>
<p>4.1 生成器规模</p>
<ul>
<li><strong>结论</strong>：<ul>
<li>任务敏感度不同：关系抽取（ChemProt）随模型增大显著提升；新闻分类（AGNews）在 70B 时各方法趋同；</li>
<li>Genetic Prompt 在所有规模上 <strong>单调提升</strong>，鲁棒性优于基线。</li>
</ul>
</li>
</ul>
<p>4.2 合成数据规模</p>
<ul>
<li><strong>结论</strong>：<ul>
<li>Genetic Prompt 随数据量增加持续改进，ChemProt 在 2k 后仍上升，而基线 1–2k 即出现 <strong>性能平台或下降</strong>；</li>
<li>不同数据集的最优合成规模差异显著（AGNews≈4k，ChemProt≈2k），提示任务特性决定数据需求。</li>
</ul>
</li>
</ul>
<p>5. 案例研究（Case Study）</p>
<ul>
<li><strong>展示</strong>：SemEval Cause-Effect 类别示例</li>
<li><strong>观察</strong>：<ul>
<li>SimPrompt/Curated LLM 多用显式因果词（cause, lead to）；</li>
<li>Genetic Prompt 通过上下文隐含因果关系，句式更多变，验证其多样性优势。</li>
</ul>
</li>
</ul>
<p>6. 补充实验</p>
<ul>
<li><strong>附录 A</strong>：完整 Micro/Macro-F1、Rouge-1 结果（表 6–9）</li>
<li><strong>附录图 3–4</strong>：生成器规模与数据规模的详细曲线</li>
</ul>
<p>综上，论文通过 <strong>内在指标 + 下游任务 + 融合增益 + 消融 + 规模曲线 + 案例分析</strong> 的六重验证，全面展示了 Genetic Prompt 在质量、多样性、鲁棒性、可扩展性上的优势。</p>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下潜在方向可直接从 Genetic Prompt 框架延伸，分为 <strong>方法改进、跨模态与语言扩展、理论与评估、应用场景</strong> 四大类，供后续研究参考。</p>
<p>1. 方法改进</p>
<ul>
<li><p><strong>动态基因库</strong><br>当前基因集合 $G$ 在首轮固定。可引入 <strong>演化式基因发现</strong>：每若干代让 LLM 重新评估基因重要性，动态增删基因，以应对任务漂移或领域迁移。</p>
</li>
<li><p><strong>多目标主动学习</strong><br>父代选择仅考虑语义距离。可加入 <strong>质量-多样性双目标</strong>（如同时最大化距离与最小化 APS），使用 Pareto 前沿或加权评分，避免单纯远距导致低质样本。</p>
</li>
<li><p><strong>自适应变异强度</strong><br>变异目前对 $G_3$ 随机扰动。可让 LLM 依据当前种群多样性自动调整变异幅度（temperature、top-p），实现 <strong>自适应探索-利用平衡</strong>。</p>
</li>
<li><p><strong>层级遗传操作</strong><br>在段落-句子-属性三层同时做交叉/变异，形成 <strong>层级 GA</strong>，进一步提升长文本生成的结构一致性。</p>
</li>
</ul>
<p>2. 跨模态与语言扩展</p>
<ul>
<li><p><strong>多语言 Genetic Prompt</strong><br>在非英语语料上验证基因定义与遗传操作是否跨语言迁移；探索 <strong>语言特定基因</strong>（如敬语、时态体系）对合成质量的影响。</p>
</li>
<li><p><strong>多模态基因</strong><br>将框架扩展到 <strong>文本-表格</strong> 或 <strong>文本-图像</strong> 合成：</p>
<ul>
<li>表格基因：数值分布、列间依赖、缺失率；</li>
<li>图像基因：物体位置、风格、光照。<br>需设计跨模态交叉/变异提示，并评估下游多模态模型收益。</li>
</ul>
</li>
<li><strong>语音与代码</strong><br>把“基因”概念应用于 <strong>语音合成</strong>（音色、语速、情感）或 <strong>代码生成</strong>（API 使用模式、控制流结构），验证通用性。</li>
</ul>
<p>3. 理论与评估</p>
<ul>
<li><p><strong>收敛性与多样性理论分析</strong><br>建立遗传算子在语义空间的 Markov 模型，给出 <strong>多样性保持上界</strong> 与 <strong>收敛率</strong>，为参数选择提供理论依据。</p>
</li>
<li><p><strong>更鲁棒的分布相似度指标</strong><br>除 CMD 外，引入 <strong>Sinkhorn 距离</strong> 或 <strong>神经最优传输</strong>，更敏感地捕捉高阶分布差异；同时评估指标与下游性能的相关性。</p>
</li>
<li><p><strong>人类评估与对抗检测</strong><br>组织人工盲评与对抗判别器实验，量化合成数据 <strong>“人感”</strong> 与 <strong>“机器可检测性”</strong>，检验真实应用场景的隐蔽性。</p>
</li>
</ul>
<p>4. 应用场景</p>
<ul>
<li><p><strong>联邦学习与隐私计算</strong><br>在联邦场景下，用 Genetic Prompt 在本地生成合成数据替代原始敏感数据上传，评估 <strong>隐私-效用权衡</strong>（结合差分隐私或安全聚合）。</p>
</li>
<li><p><strong>小模型课程蒸馏</strong><br>将大规模合成数据按 <strong>难度-多样性</strong> 自动排序，形成课程，逐步蒸馏给小模型，观察收敛速度与最终精度提升。</p>
</li>
<li><p><strong>持续学习与灾难性遗忘</strong><br>利用遗传算法持续生成 <strong>新任务合成数据</strong> 并回放缓冲，测试对旧任务的遗忘抑制效果。</p>
</li>
<li><p><strong>医疗与法律高风险领域</strong><br>在罕见病病例、法律判例等 <strong>长尾、高成本</strong> 场景中，验证 Genetic Prompt 能否通过属性级变异生成 <strong>合规且多样</strong> 的训练样本，并与专家规则对齐。</p>
</li>
</ul>
<p>5. 工具与社区贡献</p>
<ul>
<li><p><strong>开源生态</strong><br>将基因发现、主动选择、遗传算子封装为 <strong>可插拔库</strong>，支持一键接入 Hugging Face <code>datasets</code> / <code>transformers</code>，降低社区使用门槛。</p>
</li>
<li><p><strong>交互式可视化平台</strong><br>开发 Web 界面实时展示基因演化、父代距离、多样性曲线，帮助研究者直观调试超参数。</p>
</li>
</ul>
<p>通过上述方向的深入，Genetic Prompt 可从 <strong>单语文本生成工具</strong> 演进为 <strong>通用、可解释、跨模态的合成数据引擎</strong>。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p>论文一句话总结</p>
<p>提出 <strong>Genetic Prompt</strong> 框架，把文本的语义属性当作“基因”，用大语言模型模拟遗传算法的交叉与变异，从而在小样本条件下生成高质量、高多样性且类别均衡的合成数据，显著提升多种 NLP 下游任务性能。</p>
<p>核心内容速览</p>
<p>维度</p>
<p>关键信息</p>
<p><strong>问题</strong></p>
<p>LLM 合成数据常受限于人工预定义属性、多样性不足、类别不平衡，难以兼顾质量与规模。</p>
<p><strong>思路</strong></p>
<p>将遗传算法与 LLM 融合：<br>1. 让 LLM 自动发现“文本基因”（风格、结构、极性等高层属性）；<br>2. 用主动学习选“语义最远”的父代；<br>3. 在属性层面做交叉+变异生成后代；<br>4. 与真实数据 1:1 混合训练。</p>
<p><strong>实验</strong></p>
<p>在 8 个数据集（新闻、生医、问答、摘要）上对比 3 类基线：<br>- <strong>内在指标</strong>：APS、CMD、词汇量均最优；<br>- <strong>下游任务</strong>：Micro-F1 / Rouge-L 全面领先，类别不平衡场景 macro-F1 提升 3 pp 以上；<br>- <strong>消融</strong>：移除主动选择、变异或改用词级基因都会显著降性能；<br>- <strong>规模效应</strong>：随 LLM 规模与合成数据量增加，性能单调提升，基线常出现平台或下降。</p>
<p><strong>贡献</strong></p>
<p>首次将“语义属性基因+主动学习+遗传算子”引入 LLM 合成数据流程，兼顾质量、多样性、可扩展性，并给出完整开源实现。</p>
<p>适用场景</p>
<ul>
<li>数据稀缺或类别极度不平衡的文本任务</li>
<li>需要大规模、低成本、高保真训练语料的任何 NLP 领域</li>
</ul>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是Attributes%20as%20Textual%20Genes%3A%20Leveraging%20LLMs%20as%20Genetic%20Algorithm%20Simulators%20for%20Conditional%20Synthetic%20Data%20Generation，链接是  https://arxiv.org/pdf/2509.02040  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.02040  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Guangzeng Han,Weisi Liu,Xiaolei Huang</p>
<p><strong>Categories</strong>: cs.CL</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.02040.pdf">https://arxiv.org/pdf/2509.02040.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.02040">https://arxiv.org/abs/2509.02040</a></p>
<p><strong>Arxiv ID</strong>: 2509.02040</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.02040">https://papers.cool/arxiv/2509.02040</a></p>
<p><strong>Published</strong>: 2025-09-02T07:35:20Z</p>
<p><strong>Updated</strong>: 2025-09-02T07:35:20.000Z</p>
<hr>
<h3 id="20-FlashAdventure-A-Benchmark-for-GUI-Agents-Solving-Full-Story-Arcs-in-Diverse-Adventure-Games"><a href="#20-FlashAdventure-A-Benchmark-for-GUI-Agents-Solving-Full-Story-Arcs-in-Diverse-Adventure-Games" class="headerlink" title="20. FlashAdventure: A Benchmark for GUI Agents Solving Full Story Arcs in Diverse Adventure Games"></a>20. <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2509.01052">FlashAdventure: A Benchmark for GUI Agents Solving Full Story Arcs in Diverse Adventure Games</a></h3><p>GUI agents powered by LLMs show promise in interacting with diverse digital environments. Among these, video games offer a valuable testbed due to their varied interfaces, with adventure games posing additional challenges through complex, narrative-driven interactions. Existing game benchmarks, however, lack diversity and rarely evaluate agents on completing entire storylines. To address this, we introduce FlashAdventure, a benchmark of 34 Flash-based adventure games designed to test full story arc completion and tackle the observation-behavior gap: the challenge of remembering and acting on earlier gameplay information. We also propose CUA-as-a-Judge, an automated gameplay evaluator, and COAST, an agentic framework leveraging long-term clue memory to better plan and solve sequential tasks. Experiments show current GUI agents struggle with full story arcs, while COAST improves milestone completion by bridging the observation-behavior gap. Nonetheless, a marked discrepancy between humans and best-performing agents warrants continued research efforts to narrow this divide.</p>
<details class="toggle" ><summary class="toggle-button" style="">中文摘要</summary><div class="toggle-content"><p>由大型语言模型驱动的图形用户界面代理在与多样化数字环境互动方面表现出希望。其中，视频游戏由于其多样的界面，提供了一个有价值的测试平台，而冒险游戏通过复杂的叙事驱动互动提出了额外的挑战。然而，现有的游戏基准缺乏多样性，很少评估代理完成整个故事情节的能力。为了解决这一问题，我们推出了FlashAdventure，这是一个由34款基于Flash的冒险游戏组成的基准，旨在测试完整故事情节的完成情况，并解决观察-行为差距的问题：记住和利用早期游戏信息的挑战。我们还提出了CUA-as-a-Judge，这是一种自动游戏评估器，和COAST，这是一个利用长期线索记忆来更好地规划和解决顺序任务的代理框架。实验表明，目前的图形用户界面代理在完整故事情节方面表现不佳，而COAST通过弥合观察-行为差距提高了里程碑的完成率。然而，人类与表现最佳的代理之间的显著差异仍然需要继续研究，以缩小这一差距。</p>
</div></details>
<details class="toggle" ><summary class="toggle-button" style="">LLM Analysis</summary><div class="toggle-content"><p><strong>Q1</strong>: 这篇论文试图解决什么问题？</p>
<p>论文针对“图形用户界面（GUI）智能体能否在<strong>多样化冒险游戏</strong>中<strong>完整通关</strong>”这一核心问题，提出并验证了两大关键缺陷：</p>
<ol>
<li><p><strong>现有游戏基准的局限性</strong></p>
<ul>
<li>任务与游戏多样性不足（最多12款，集中于单一任务或短流程）。</li>
<li>缺乏对**完整故事线（full story arc）**的评估，无法验证智能体对长程依赖的处理能力。</li>
</ul>
</li>
<li><p><strong>观察-行为差距（observation-behavior gap）</strong></p>
<ul>
<li>冒险游戏中线索可能在数百步后才被使用，现有智能体因<strong>记忆与规划能力薄弱</strong>，难以跨越长时间滞后，导致无法完成全局目标。</li>
</ul>
</li>
</ol>
<p>为此，论文构建了<strong>FlashAdventure</strong>基准（34款Flash冒险游戏）并配套<strong>COAST框架</strong>，旨在：</p>
<ul>
<li>系统评估智能体在<strong>长流程、多类型冒险游戏</strong>中的完整通关能力。</li>
<li>通过<strong>长期线索记忆与主动子任务生成</strong>，缩小观察-行为差距，提升复杂叙事任务的解决率。</li>
</ul>
<p><strong>Q2</strong>: 有哪些相关研究？</p>
<p>与 FlashAdventure 相关的研究可划分为 <strong>GUI 智能体</strong> 与 <strong>视频游戏基准</strong> 两大主线，关键文献如下：</p>
<p>1. GUI 智能体（Multimodal LLM Agents for GUI Control）</p>
<ul>
<li><strong>端到端架构</strong><ul>
<li>Claude-3.7-Sonnet Computer-Use (Anthropic, 2024)</li>
<li>OpenAI CUA / Operator (OpenAI, 2025b)</li>
<li>UI-TARS-1.5-7B (Qin et al., 2025) – 开源视觉-语言-动作模型</li>
</ul>
</li>
<li><strong>模块化框架</strong><ul>
<li>Cradle (Tan et al., ICML 2025) – 六模块闭环：感知→反思→任务推断→技能策展→动作规划→记忆</li>
<li>Agent S / Agent S2 (Agashe et al., ICLR 2025a; COLM 2025b) – 将 Grounding 与 Planning 解耦，引入 Mixture-of-Grounding 与层次化规划</li>
</ul>
</li>
<li><strong>GUI Grounding 研究</strong><ul>
<li>SeeClick (Cheng et al., ACL 2024)</li>
<li>UGround-V1-7B (Gou et al., ICLR 2025)</li>
<li>OS-ATLAS (Wu et al., ICLR 2025) – 通用 GUI 基础动作模型</li>
</ul>
</li>
</ul>
<p>2. 视频游戏基准（Game Benchmarks）</p>
<p>基准</p>
<p>环境接口</p>
<p>游戏数</p>
<p>完整故事线</p>
<p>备注</p>
<p><strong>FlashAdventure</strong>（本文）</p>
<p>纯像素/截图</p>
<p>34</p>
<p>✅</p>
<p>首个专注完整故事线的多样化冒险游戏集合</p>
<p>VisEscape (Lim et al., 2025)</p>
<p>API + 截图</p>
<p>1（研究定制）</p>
<p>✅</p>
<p>房间逃脱，平均 52.8 步，故事短</p>
<p>Cradle (Tan et al., 2025)</p>
<p>截图</p>
<p>4 AAA</p>
<p>❌</p>
<p>RDR2 等超长流程，仅局部任务</p>
<p>BALROG (Paglieri et al., ICLR 2025)</p>
<p>API + 截图</p>
<p>12</p>
<p>❌</p>
<p>6 种类型 × 2 游戏，无完整故事</p>
<p>PokeLLMon (Hu et al., 2024a)</p>
<p>API</p>
<p>1</p>
<p>❌</p>
<p>宝可梦战斗</p>
<p>MineDojo (Fan et al., NeurIPS 2022)</p>
<p>API + 截图</p>
<p>1</p>
<p>❌</p>
<p>Minecraft 开放世界</p>
<p>OOTB (Hu et al., 2024b)</p>
<p>截图</p>
<p>2 商业游戏</p>
<p>❌</p>
<p>Hearthstone、崩铁</p>
<p>VARP (Chen et al., 2024)</p>
<p>截图</p>
<p>1 AAA</p>
<p>❌</p>
<p>黑神话：悟空</p>
<p>3. 长程记忆与规划</p>
<ul>
<li><strong>记忆机制</strong><ul>
<li>检索增强：Agent S2 的 RAG 模块</li>
<li>总结-遗忘：Cradle 的 Self-Reflection &amp; Memory 模块</li>
<li>Tolman 潜伏学习理论（Tolman &amp; Honzik, 1930; Tolman, 1948）——人类长时线索应用的心理学依据</li>
</ul>
</li>
</ul>
<p>4. 自动评估方法</p>
<ul>
<li><strong>CUA-as-a-Judge</strong>（本文） – 首个无需人工、可自动验证里程碑的像素级游戏评估代理</li>
<li>传统人工评估：Cradle、VARP、OOTB 等均依赖人工标注里程碑完成度</li>
</ul>
<p>综上，FlashAdventure 在 <strong>游戏多样性、完整故事线评估、长程依赖建模</strong> 三方面填补了现有基准与方法的空白。</p>
<p><strong>Q3</strong>: 论文如何解决这个问题？</p>
<p>论文从<strong>基准构建</strong>、<strong>自动评估</strong>与<strong>智能体框架</strong>三条主线协同解决“GUI 智能体难以完成多样化冒险游戏完整故事线”的核心问题。</p>
<p>1. 构建 FlashAdventure 基准：提供可度量的完整故事线测试床</p>
<ul>
<li><strong>34 款 Flash 冒险游戏</strong><ul>
<li>涵盖 5 个子类型（悬疑/侦探、隐藏物品、密室逃脱、视觉小说、模拟经营），保证<strong>跨类型多样性</strong>。</li>
<li>每款游戏 1–2 小时内人类可通关，确保<strong>完整故事线</strong>在可控步数内结束。</li>
</ul>
</li>
<li><strong>里程碑体系</strong><ul>
<li>每游戏 4–12 个离散里程碑（或连续 HUD 分数），用于<strong>细粒度进度度量</strong>。</li>
<li>平均人类步数 1 142，平均观察-行为差距 251 步，凸显<strong>长程依赖</strong>挑战。</li>
</ul>
</li>
</ul>
<p>2. CUA-as-a-Judge：零人工的里程碑验证器</p>
<ul>
<li><strong>基于 Claude-3.7-Sonnet Computer-Use</strong><ul>
<li>在游戏终局<strong>直接交互界面</strong>（点击笔记本、查看 HUD 等），<strong>自动核对</strong>里程碑。</li>
<li>300 样本验证：94 % 准确率、ρ=0.9999 Pearson 相关性，<strong>替代人工评估</strong>。</li>
</ul>
</li>
</ul>
<p>3. COAST 框架：面向线索的长期记忆与规划</p>
<p>采用 <strong>Seek-Map-Solve 三阶段循环</strong> 主动管理线索记忆，缩小观察-行为差距：</p>
<p>阶段</p>
<p>模块</p>
<p>关键机制</p>
<p>作用</p>
<p><strong>Seek</strong></p>
<p>Clue Seeker</p>
<p>每轮探索 <strong>Nseek 步</strong> 收集线索并存入 <strong>M</strong></p>
<p>持续积累潜在信息</p>
<p><strong>Map</strong></p>
<p>Clue Mapper</p>
<p>从 <strong>M</strong> 与轨迹中挑选 <strong>K 对 (clue, observation)</strong>，生成子任务</p>
<p>建立线索→行动的映射</p>
<p><strong>Solve</strong></p>
<p>Problem Solver</p>
<p>针对子任务执行 <strong>Nsolve 步</strong> 动作，成功即加入已解决集合 <strong>GR</strong></p>
<p>避免重复，推进故事</p>
<ul>
<li><strong>无上限线索记忆</strong>：平均 12.8 k tokens，远低于 Claude-3.7 200 k 上下文。</li>
<li><strong>实验收益</strong>：在 34 款游戏上，COAST 将里程碑完成率从 17.11 % 提升到 19.89 %，<strong>首次实现 5.88 % 成功率</strong>（仍远低于人类 97.1 %）。</li>
</ul>
<p>4. 控制实验与消融：验证框架有效性</p>
<ul>
<li><strong>消融实验</strong>：去掉 Mapper 后 MCR 从 65.6 % 降至 42.4 %，证明<strong>三模块缺一不可</strong>。</li>
<li><strong>提示工程对照</strong>：将 COAST 提示直接喂给基线模型，性能反而下降，确认<strong>提升源于架构而非提示</strong>。</li>
</ul>
<p>5. 公开资源与伦理合规</p>
<ul>
<li>开源游戏列表、里程碑定义、人类走查、COAST prompt，确保<strong>可复现</strong>。</li>
<li>通过 Flashpoint Archive 合法访问游戏，仅用于学术研究，规避版权问题。</li>
</ul>
<p>综上，论文通过“<strong>多样化基准 + 自动评估 + 线索驱动框架</strong>”三位一体，系统性地将 GUI 智能体在长流程冒险游戏中的评估与能力提升向前推进。</p>
<p><strong>Q4</strong>: 论文做了哪些实验？</p>
<p>论文围绕 <strong>FlashAdventure 基准</strong> 与 <strong>COAST 框架</strong> 设计并执行了 5 组核心实验，覆盖 <strong>34 款游戏、7 种 GUI 智能体、300 条自动评估样本、13 位人类玩家</strong>，系统验证：</p>
<ol>
<li>现有智能体在长流程冒险游戏中的真实能力；</li>
<li>COAST 对“观察-行为差距”的缓解效果；</li>
<li>各模块的必要性、失败模式与性能上限。</li>
</ol>
<p>1. 主实验：34 游戏 × 7 智能体（单轮）</p>
<ul>
<li><strong>被测智能体</strong><ul>
<li>端到端：Claude-3.7-Sonnet Computer-Use、OpenAI CUA、UI-TARS-1.5-7B</li>
<li>模块化：Cradle（×3 配置）、Agent S2</li>
</ul>
</li>
<li><strong>指标</strong><ul>
<li>Success Rate（SR）：是否达成最终故事目标</li>
<li>Milestone Completion Rate（MCR）：里程碑完成比例</li>
<li>Steps：实际消耗步数（上限 1 000）</li>
</ul>
</li>
<li><strong>结果</strong>（表 2 &amp; 表 13）<ul>
<li>所有基线 SR≈0 %，MCR 4.56 %–17.11 %；人类 SR 97.1 %，MCR 100 %。</li>
<li>仅 OpenAI CUA 与 COAST 在 2 款隐藏物品游戏上取得非零 SR（5.88 %）。</li>
<li>COAST 相对最强基线 MCR↑2.78 pp，验证其有效性但仍远逊人类。</li>
</ul>
</li>
</ul>
<p>2. 子类型对比实验</p>
<ul>
<li><strong>按 5 个子类型</strong>（悬疑/侦探、隐藏物品、密室逃脱、视觉小说、模拟经营）汇总 MCR。</li>
<li><strong>发现</strong>（图 4）：<ul>
<li>视觉小说因观察-行为差距小，COAST 提升有限；</li>
<li>悬疑/密室类差距大，COAST 优势显著。</li>
</ul>
</li>
</ul>
<p>3. 消融实验：Seek / Map / Solver 三模块</p>
<ul>
<li><strong>5 款代表性游戏</strong>（Sherlock Holmes 2、Grim Tales: The Bride 等）</li>
<li><strong>配置</strong><ul>
<li>Seeker only</li>
<li>Seeker + Solver</li>
<li>完整 COAST</li>
</ul>
</li>
<li><strong>结果</strong>（表 3）<ul>
<li>完整框架 MCR 65.6 % &gt; Seek+Solver 57.9 % &gt; Seeker only 42.4 %，证明 <strong>Mapper 是关键瓶颈</strong>。</li>
</ul>
</li>
</ul>
<p>4. 失败模式与缓解分析</p>
<ul>
<li><strong>人工回放 5 款游戏</strong>，将错误归类：<ol>
<li>规划薄弱 2. 视觉感知差 3. 横向思维不足 4. 资源管理低效</li>
</ol>
</li>
<li><strong>结果</strong>（表 4）<ul>
<li>COAST 显著减少 1、3 类错误（规划 &amp; 横向思维）；</li>
<li>对 2、4 类（感知 &amp; 资源管理）改善有限。</li>
</ul>
</li>
</ul>
<p>5. 控制与上限实验</p>
<p>实验</p>
<p>目的</p>
<p>设置</p>
<p>关键结论</p>
<p><strong>多轮实验</strong></p>
<p>稳定性</p>
<p>3 次重复运行 5 游戏</p>
<p>趋势与单轮一致，COAST 仍领先</p>
<p><strong>提示工程对照</strong></p>
<p>排除提示增益</p>
<p>将 COAST 提示直接给 Claude-3.7 Computer-Use</p>
<p>性能略降，证明架构而非提示带来提升</p>
<p><strong>Hint 注入上限</strong></p>
<p>评估任务复杂度</p>
<p>在 Sherlock Holmes 与 Office Escape 中每 50–100 步注入子任务</p>
<p>结构化提示可让前者 758 步通关，后者仍失败，说明<strong>空间-逻辑推理瓶颈独立于提示</strong></p>
<p><strong>污染检测</strong></p>
<p>排除记忆化</p>
<p>10 道游戏情境问答</p>
<p>GPT-4o 3/10 题泄露，Claude-3.7-Sonnet 0/10，但泄露并未转化为游戏优势（knowing-doing gap）</p>
<p><strong>o4-mini 替换</strong></p>
<p>推理模型效果</p>
<p>用 o4-mini+UGround+Cradle</p>
<p>0–2 里程碑，未超越 GPT-4o，显示<strong>高阶推理≠有效动作规划</strong></p>
<p>6. 人类基线</p>
<ul>
<li><strong>13 位受试者</strong>通关全部 34 游戏，平均 1 142 步、26 分钟、97.1 % SR，提供 <strong>可达成上限</strong> 与 <strong>观察-行为差距统计</strong>（平均 251 步）。</li>
</ul>
<p>实验规模一览</p>
<p>维度</p>
<p>数量</p>
<p>游戏</p>
<p>34</p>
<p>智能体</p>
<p>7</p>
<p>单轮评估轨迹</p>
<p>34×7 = 238</p>
<p>自动评估样本（CUA-as-a-Judge）</p>
<p>300</p>
<p>人类轨迹</p>
<p>13×34 = 442</p>
<p>消融/控制实验轨迹</p>
<p>≈ 60</p>
<p>通过上述实验，论文既给出了当前 GUI 智能体在长流程冒险游戏中的<strong>全景性能画像</strong>，也验证了 COAST 框架在<strong>规划与横向思维</strong>维度的有效性，同时指出<strong>感知精度、资源管理、空间推理</strong>仍是主要瓶颈。</p>
<p><strong>Q5</strong>: 有什么可以进一步探索的点？</p>
<p>以下方向可作为 FlashAdventure 之后可立即着手、且对社区有价值的进一步探索，按优先级与可行性排序：</p>
<p>1. 记忆与规划机制的深度优化</p>
<ul>
<li><strong>层级记忆架构</strong><br>在 COAST 的扁平线索记忆之上引入 <strong>Episodic → Semantic → Procedural</strong> 三级存储，利用检索-压缩-遗忘策略（Tan et al., 2025；Park et al., 2023）缓解长程步数增加时的上下文爆炸。</li>
<li><strong>可学习子任务生成器</strong><br>将 Mapper 模块替换为 <strong>轻量级策略网络</strong>（如 LoRA-微调 LLM），直接从轨迹-线索对中生成子任务，减少手工提示依赖，实现跨游戏迁移。</li>
</ul>
<p>2. 感知-动作耦合的增强</p>
<ul>
<li><strong>视觉-语言混合 Grounding</strong><br>结合 <strong>UGround-V2</strong> 与 <strong>SAM-2</strong> 的像素级掩码，先定位可交互区域，再由 LLM 决策动作，降低非标准布局下的误点率。</li>
<li><strong>自监督视觉预训练</strong><br>用 FlashAdventure 34 游戏的大规模回放数据构造 <strong>“动作-下一帧”</strong> 自监督任务，预训练 GUI 视觉编码器，提升隐藏对象、微小线索的识别精度。</li>
</ul>
<p>3. 通用化评估协议</p>
<ul>
<li><strong>时间-事件混合里程碑</strong><br>利用 <strong>叙事流程图（Paschali et al., 2018）</strong> 自动生成里程碑，摆脱人工定义，使基准可扩展至 RPG、动作等新类型。</li>
<li><strong>实时-暂停双模式 CUA-as-a-Judge</strong><br>针对动作或节奏游戏，扩展 Judge 支持 <strong>暂停-查询-继续</strong> 协议，在保持帧级精度的同时评估高速场景。</li>
</ul>
<p>4. 低成本可复现性</p>
<ul>
<li><strong>开源轻量级 GUI 智能体</strong><br>以 <strong>UI-TARS-1.5-7B</strong> 为骨干，集成 COAST 三模块并蒸馏至 3B 以下，实现本地 GPU 运行，降低 API 费用壁垒。</li>
<li><strong>社区排行榜与持续集成</strong><br>建立公开排行榜（类似 MLPerf），支持 PR 式提交；利用 GitHub Actions 每晚跑 3 款游戏回归测试，确保新 commit 不破坏性能。</li>
</ul>
<p>5. 人机协同与可解释性</p>
<ul>
<li><strong>实时解释面板</strong><br>在浏览器层叠加 <strong>“Clue Heatmap”</strong> 与 <strong>“Subtask Trace”</strong>，实时显示智能体当前关注线索与下一步计划，便于人类监督与调试。</li>
<li><strong>交互式提示注入</strong><br>允许人类在运行时通过自然语言向 Mapper 注入 <strong>“假设”</strong>，观察智能体如何调整子任务，研究人机协同的互补边界。</li>
</ul>
<p>6. 跨模态迁移与多语言游戏</p>
<ul>
<li><strong>非英语 Flash 游戏扩展</strong><br>引入日语、西班牙语 Flash 冒险游戏，测试多语言 OCR + 翻译链路对 GUI 智能体的影响。</li>
<li><strong>跨平台迁移</strong><br>将 COAST 迁移至 <strong>Android 冒险手游</strong>（截图+触控），验证框架在移动 UI 元素密度与手势空间下的鲁棒性。</li>
</ul>
<p>7. 强化学习与 LLM 的混合训练</p>
<ul>
<li><strong>离线 RL + 在线微调</strong><br>先用 FlashAdventure 人类轨迹做 <strong>离线 RL（Decision Transformer 或 Q-learning）</strong> 预训练，再在游戏内做 <strong>少量在线 RL</strong> 微调，观察样本效率与稳定性。</li>
<li><strong>奖励塑形</strong><br>将里程碑奖励 R_m 作为稠密奖励信号，训练端到端策略网络，对比 COAST 的模块化方案，量化“规划-执行”解耦的收益。</li>
</ul>
<p>8. 社会与伦理维度</p>
<ul>
<li><strong>公平性审计</strong><br>分析不同性别/文化背景游戏中智能体表现差异，检查训练数据或模型偏差。</li>
<li><strong>版权合规扩展</strong><br>与更多 Flash 游戏版权方签署学术使用协议，建立 <strong>“可商用许可” 子集</strong>，推动工业界采用。</li>
</ul>
<p>快速起步建议（3 个月可交付）</p>
<ol>
<li>开源 <strong>COAST-Lite</strong>（3B 参数级）并在 Hugging Face 发布。</li>
<li>用流程图自动生成 10 款新游戏里程碑，验证协议通用性。</li>
<li>建立 <strong>FlashAdventure-Leaderboard</strong> 网站，支持在线提交与实时排行榜。</li>
</ol>
<p>这些方向既可直接利用现有数据与框架，又能逐步扩展到更复杂的游戏形态与真实应用场景。</p>
<p><strong>Q6</strong>: 总结一下论文的主要内容</p>
<p><strong>一句话总结</strong><br>FlashAdventure 通过 34 款 Flash 冒险游戏、自动里程碑验证器 CUA-as-a-Judge 以及线索驱动的 COAST 框架，首次系统评估并部分缓解了 GUI 智能体在长流程故事任务中的“观察-行为差距”。</p>
<p>1. 问题与动机</p>
<ul>
<li><strong>现有游戏基准</strong><br>游戏少（≤12）、任务短、缺完整故事线，无法验证长程依赖。</li>
<li><strong>观察-行为差距</strong><br>冒险游戏中线索与使用之间常隔数百步，现有智能体因记忆/规划薄弱而失败。</li>
</ul>
<p>2. FlashAdventure 基准</p>
<ul>
<li><strong>34 款 Flash 冒险游戏</strong><br>5 子类型（悬疑、隐藏物品、密室、视觉小说、模拟），平均人类 1 142 步通关。</li>
<li><strong>里程碑体系</strong><br>每游戏 4–12 个人工定义里程碑 + 连续分数，用于细粒度进度度量。</li>
<li><strong>人类基线</strong><br>13 位受试者 97.1 % 成功率，平均观察-行为差距 251 步。</li>
</ul>
<p>3. CUA-as-a-Judge 自动评估</p>
<ul>
<li><strong>基于 Claude-3.7-Sonnet Computer-Use</strong><br>终局直接交互界面验证里程碑，300 样本对比人工：94 % 准确率，ρ=0.9999。</li>
<li><strong>零人工标注</strong><br>解决像素级游戏评估长期依赖人工的问题。</li>
</ul>
<p>4. COAST 框架</p>
<p><strong>Seek-Map-Solve 循环</strong></p>
<ol>
<li>Seek：探索 Nseek 步收集线索 → 存入长期记忆 M。</li>
<li>Map：从 M 与轨迹中生成 K 个子任务（线索-观察对）。</li>
<li>Solve：执行 Nsolve 步完成子任务，避免重复。</li>
</ol>
<ul>
<li><strong>实验结果</strong><br>在 34 游戏、1 000 步限制下，COAST 将最佳基线 MCR 从 17.11 % 提至 19.89 %，成功率达 5.88 %（仍远低于人类 97.1 %）。</li>
<li><strong>消融</strong><br>缺 Mapper 时 MCR 降至 42.4 %，证明三模块缺一不可。</li>
</ul>
<p>5. 发现与展望</p>
<ul>
<li><strong>三大失败模式</strong>：规划薄弱、视觉感知差、横向思维不足。</li>
<li><strong>未来方向</strong>：层级记忆、可学习子任务生成、跨平台迁移、低成本开源实现。</li>
</ul>
<p><strong>Q7</strong>: 想要进一步了解论文</p>
<p>以上只是了解一篇论文的几个基本FAQ。如果你还想与Kimi进一步讨论该论文，请点击 <a target="_blank" rel="noopener" href="http://kimi.com/_prefill_chat?prefill_prompt= 我们要讨论的论文是FlashAdventure%3A%20A%20Benchmark%20for%20GUI%20Agents%20Solving%20Full%20Story%20Arcs%20in%20Diverse%20Adventure%20Games，链接是  https://arxiv.org/pdf/2509.01052  ，已有的FAQ链接是  https://papers.cool/arxiv/kimi?paper=2509.01052  。请以此为基础，继续回答我后面的问题。&amp;system_prompt=你是一个学术助手，后面的对话将围绕着以下论文内容进行，已经通过链接给出了论文的PDF和论文已有的FAQ。用户将继续向你咨询论文的相关问题，请你作出专业的回答，不要出现第一人称，当涉及到分点回答时，鼓励你以markdown格式输出。&amp;send_immediately=true&amp;force_search=false&amp;enable_reasoning=false"><strong>这里</strong></a> 为你跳转Kimi AI网页版，并启动一个与该论文相关的新会话。</p>
</div></details>
<p><strong>Authors</strong>: Jaewoo Ahn,Junseo Kim,Heeseung Yun,Jaehyeon Son,Dongmin Park,Jaewoong Cho,Gunhee Kim</p>
<p><strong>Categories</strong>: cs.AI,cs.CL,cs.CV</p>
<p><strong>PDF URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2509.01052.pdf">https://arxiv.org/pdf/2509.01052.pdf</a></p>
<p><strong>Arxiv URL</strong>: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2509.01052">https://arxiv.org/abs/2509.01052</a></p>
<p><strong>Arxiv ID</strong>: 2509.01052</p>
<p><strong>CoolPaper URL</strong>: <a target="_blank" rel="noopener" href="https://papers.cool/arxiv/2509.01052">https://papers.cool/arxiv/2509.01052</a></p>
<p><strong>Published</strong>: 2025-09-01T01:33:16Z</p>
<p><strong>Updated</strong>: 2025-09-01T01:33:16.000Z</p>
<hr>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://wdndev.github.io">Firefly</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://wdndev.github.io/daily/hf/202509/2025-09-04/">https://wdndev.github.io/daily/hf/202509/2025-09-04/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/AI/">AI</a><a class="post-meta__tags" href="/tags/HuggingFace/">HuggingFace</a><a class="post-meta__tags" href="/tags/Papers/">Papers</a></div><div class="post_share"><div class="social-share" data-image="/img/wdn_icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/daily/hf/202507/2025-07-14/" title="HuggingFace Papers 2025-07-14"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-06-18</div><div class="title">HuggingFace Papers 2025-07-14</div></div></a></div><div><a href="/daily/hf/202507/2025-07-15/" title="HuggingFace Papers 2025-07-15"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-06-18</div><div class="title">HuggingFace Papers 2025-07-15</div></div></a></div><div><a href="/daily/hf/202507/2025-07-16/" title="HuggingFace Papers 2025-07-16"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-06-18</div><div class="title">HuggingFace Papers 2025-07-16</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Latest-Papers"><span class="toc-text">Latest Papers</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-The-Landscape-of-Agentic-Reinforcement-Learning-for-LLMs-A-Survey"><span class="toc-text">1. The Landscape of Agentic Reinforcement Learning for LLMs: A Survey</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-UI-TARS-2-Technical-Report-Advancing-GUI-Agent-with-Multi-Turn-Reinforcement-Learning"><span class="toc-text">2. UI-TARS-2 Technical Report: Advancing GUI Agent with Multi-Turn Reinforcement Learning</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-SimpleTIR-End-to-End-Reinforcement-Learning-for-Multi-Turn-Tool-Integrated-Reasoning"><span class="toc-text">3. SimpleTIR: End-to-End Reinforcement Learning for Multi-Turn Tool-Integrated Reasoning</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-LLaVA-Critic-R1-Your-Critic-Model-is-Secretly-a-Strong-Policy-Model"><span class="toc-text">4. LLaVA-Critic-R1: Your Critic Model is Secretly a Strong Policy Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-ELV-Halluc-Benchmarking-Semantic-Aggregation-Hallucinations-in-Long-Video-Understanding"><span class="toc-text">5. ELV-Halluc: Benchmarking Semantic Aggregation Hallucinations in Long Video Understanding</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-VerlTool-Towards-Holistic-Agentic-Reinforcement-Learning-with-Tool-Use"><span class="toc-text">6. VerlTool: Towards Holistic Agentic Reinforcement Learning with Tool Use</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-POINTS-Reader-Distillation-Free-Adaptation-of-Vision-Language-Models-for-Document-Conversion"><span class="toc-text">7. POINTS-Reader: Distillation-Free Adaptation of Vision-Language Models for Document Conversion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-Baichuan-M2-Scaling-Medical-Capability-with-Large-Verifier-System"><span class="toc-text">8. Baichuan-M2: Scaling Medical Capability with Large Verifier System</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-Kwai-Keye-VL-1-5-Technical-Report"><span class="toc-text">9. Kwai Keye-VL 1.5 Technical Report</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-Reasoning-Vectors-Transferring-Chain-of-Thought-Capabilities-via-Task-Arithmetic"><span class="toc-text">10. Reasoning Vectors: Transferring Chain-of-Thought Capabilities via Task Arithmetic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-Implicit-Actor-Critic-Coupling-via-a-Supervised-Learning-Framework-for-RLVR"><span class="toc-text">11. Implicit Actor Critic Coupling via a Supervised Learning Framework for RLVR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-Jointly-Reinforcing-Diversity-and-Quality-in-Language-Model-Generations"><span class="toc-text">12. Jointly Reinforcing Diversity and Quality in Language Model Generations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-Gated-Associative-Memory-A-Parallel-O-N-Architecture-for-Efficient-Sequence-Modeling"><span class="toc-text">13. Gated Associative Memory: A Parallel O(N) Architecture for Efficient Sequence Modeling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-DynaGuard-A-Dynamic-Guardrail-Model-With-User-Defined-Policies"><span class="toc-text">14. DynaGuard: A Dynamic Guardrail Model With User-Defined Policies</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-DCPO-Dynamic-Clipping-Policy-Optimization"><span class="toc-text">15. DCPO: Dynamic Clipping Policy Optimization</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-GenCompositor-Generative-Video-Compositing-with-Diffusion-Transformer"><span class="toc-text">16. GenCompositor: Generative Video Compositing with Diffusion Transformer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BA%E6%96%87%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%80%BB%E7%BB%93"><span class="toc-text">论文一句话总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#17-OpenVision-2-A-Family-of-Generative-Pretrained-Visual-Encoders-for-Multimodal-Learning"><span class="toc-text">17. OpenVision 2: A Family of Generative Pretrained Visual Encoders for Multimodal Learning</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-Benchmarking-Optimizers-for-Large-Language-Model-Pretraining"><span class="toc-text">18. Benchmarking Optimizers for Large Language Model Pretraining</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-Attributes-as-Textual-Genes-Leveraging-LLMs-as-Genetic-Algorithm-Simulators-for-Conditional-Synthetic-Data-Generation"><span class="toc-text">19. Attributes as Textual Genes: Leveraging LLMs as Genetic Algorithm Simulators for Conditional Synthetic Data Generation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-FlashAdventure-A-Benchmark-for-GUI-Agents-Solving-Full-Story-Arcs-in-Diverse-Adventure-Games"><span class="toc-text">20. FlashAdventure: A Benchmark for GUI Agents Solving Full Story Arcs in Diverse Adventure Games</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By Firefly</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">簡</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><script async src="/js/title.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"left","width":180,"height":360,"hOffset":0,"vOffset":-100},"mobile":{"show":true},"react":{"opacity":0.85},"log":false});</script></body></html>